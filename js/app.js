(function(t){function e(e){for(var i,o,s=e[0],c=e[1],l=e[2],d=0,h=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(h.length)h.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={app:0},a=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"002a":function(t,e,n){"use strict";n("f92b")},"0040":function(t,e,n){},"0085":function(t,e,n){"use strict";n("b63c")},"00b8":function(t,e,n){},"01eb":function(t,e,n){},"0227":function(t,e,n){"use strict";n("9ed9")},"023f":function(t,e,n){"use strict";n("15a2")},"0263":function(t,e,n){},"0333":function(t,e,n){},"0445":function(t,e,n){"use strict";n("3cde")},"04a4":function(t,e,n){"use strict";n("321a")},"04ee":function(t,e,n){},"062b":function(t,e,n){},"071b":function(t,e,n){},"0913":function(t,e,n){"use strict";n("f81c")},"0950":function(t,e,n){},"0b7a":function(t,e,n){},"0b86":function(t,e,n){},"0c4e":function(t,e,n){"use strict";n("fe87")},"0d20":function(t,e,n){},"0da5":function(t,e,n){"use strict";n("eb07")},"0db5":function(t,e,n){"use strict";n("23f6")},"0e1c":function(t,e,n){},"0e1f":function(t,e,n){"use strict";n("071b")},"0e4a":function(t,e,n){"use strict";n("ce75")},1202:function(t,e,n){},"13c2":function(t,e,n){"use strict";n("7080")},"145a":function(t,e,n){"use strict";n("0b86")},"14c9":function(t,e,n){"use strict";n("f452")},"14ee":function(t,e,n){},"15a2":function(t,e,n){},"16d5":function(t,e,n){},"16ed":function(t,e,n){},"178d":function(t,e,n){},"180c":function(t,e,n){"use strict";n("2243")},1845:function(t,e,n){"use strict";n("0333")},1993:function(t,e,n){"use strict";n("6635")},"1bd6":function(t,e,n){},"1c25":function(t,e,n){},"1cac":function(t,e,n){"use strict";n("04ee")},"1d4d":function(t,e,n){},2041:function(t,e,n){"use strict";n("57d4")},2128:function(t,e,n){"use strict";n("76c3")},2243:function(t,e,n){},2288:function(t,e,n){},2289:function(t,e,n){},"22cc":function(t,e,n){"use strict";n("f3a3")},"23ce":function(t,e,n){},"23f6":function(t,e,n){},"247b":function(t,e,n){"use strict";n("ca84")},2655:function(t,e,n){"use strict";n("85d9")},"266f":function(t,e,n){"use strict";n("62bb")},"26fb":function(t,e,n){"use strict";n("6337")},2919:function(t,e,n){"use strict";n("b757")},2977:function(t,e,n){},"29f2":function(t,e,n){"use strict";n("6a67")},"2a5a":function(t,e,n){"use strict";n("3181")},"2afb":function(t,e,n){"use strict";n("7544")},"2c3b":function(t,e,n){},"2cd5c":function(t,e,n){"use strict";n("16ed")},"2ec9":function(t,e,n){"use strict";n("3adb")},3087:function(t,e,n){},3181:function(t,e,n){},"31a4":function(t,e,n){"use strict";n("d3ec")},"321a":function(t,e,n){},3230:function(t,e,n){"use strict";n("5ebd")},"3adb":function(t,e,n){},"3b76":function(t,e,n){"use strict";n("50c8")},"3cde":function(t,e,n){},"3cf1":function(t,e,n){},"3d65":function(t,e,n){"use strict";n("8785")},"3f10":function(t,e,n){"use strict";n("cf16")},"436f":function(t,e,n){"use strict";n("2977")},"43ef":function(t,e,n){},"44a7":function(t,e,n){"use strict";n("caa5")},"45b3":function(t,e,n){"use strict";n("6011")},"45cf":function(t,e,n){"use strict";n("2288")},4853:function(t,e,n){},4869:function(t,e,n){"use strict";n("f9bd")},"4ac5":function(t,e,n){"use strict";n("8ae6")},"4b69":function(t,e,n){"use strict";n("8d75")},"4b97":function(t,e,n){},"4cce":function(t,e,n){},"4d32":function(t,e,n){"use strict";n("bd5b")},"4d7c":function(t,e,n){},"4ea5":function(t,e,n){},"4ea7":function(t,e,n){"use strict";n("e4aa")},"50c8":function(t,e,n){},"511c":function(t,e,n){},"51bd":function(t,e,n){"use strict";n("780a")},"523a":function(t,e,n){"use strict";n("f4c0")},5521:function(t,e,n){},"55ec":function(t,e,n){"use strict";n("2c3b")},5606:function(t,e,n){"use strict";n("3cf1")},5668:function(t,e,n){"use strict";n("1c25")},"567c":function(t,e,n){"use strict";n("b63f")},"56d7":function(t,e,n){"use strict";n.r(e);var i=n("0f37"),r=n("6fd1"),a=(n("f4fb"),n("c924"),n("e8ba"),n("1dc6"),n("f74c"),n("4bf0"),n("c018"),n("1a31")),o=(n("86d1"),n("1918"),{Success:0,NotLogin:1,Err:2,ArgumentErr:3,VCode:4,NotEmailChecked:5}),s={WEB:0,ANDROID:1,IOS:2,CUSTOM:3},c={PX:0,DP:1,PT:2},l={NONE:0,PNG:1,SVG:2,WEBP:4,JPG:8,PDF:16},u={ALL:0,XD:1,SKETCH:2,PHOTOSHOP:4,FIGMA:8,JS_DESIGN:16,getFileExt:function(t){switch(t){case this.XD:return".xd";case this.SKETCH:return".sketch";case this.PHOTOSHOP:return".psd";case this.FIGMA:return".fig";case this.JS_DESIGN:return".jsd";default:return".unknow"}}},d={PASSTHROUGH:"pass-through",NORMAL:"Normal",DARKEN:"Darken",MULTIPLY:"Multiply",COLOR_BURN:"ColorBurn",LIGHTEN:"Lighten",SCREEN:"Screen",COLOR_DODGE:"ColorDodge",OVERLAY:"Overlay",SOFT_LIGHT:"SoftLight",HARD_LIGHT:"HardLight",DIFFERENCE:"Difference",EXCLUSION:"Exclusion",HUE:"Hue",SATURATION:"Saturation",COLOR:"Color",LUMINOSITY:"Luminosity"},h=w(d),f={Thin:100,ExtraLight:200,Light:300,Normal:400,Medium:500,SemiBold:600,Bold:700,ExtraBold:800,Black:900},m=(w(f),{100:"Thin",200:"ExtraLight",300:"Light",400:"Normal",500:"Medium",600:"Semibold",700:"Bold",800:"ExtraBold",900:"Black"}),p=m,v={Layer:0,Group:1,Page:2,Artboard:3,Shape:4,Image:5,ShapePath:6,Text:7,SymbolMaster:8,SymbolInstance:9,HotSpot:10,Slice:11,StyledLayer:12},b={Rectangle:0,Oval:1,Triangle:2,Polygon:3,Star:4,Custom:5},g={left:0,right:1,center:2,justify:3};function w(t){var e={};return Object.keys(t).forEach((function(n){e[t[n]]=n})),e}var x,y=w(g),k={top:0,center:1,bottom:2},C=w(k),S={Color:0,Gradient:1,Pattern:4},T=(w(S),{Linear:0,Radial:1,Angular:2}),A={None:0,FillColor:1,LinearGradientFill:2,ImageFill:3,RadialGradientFill:4,AngularGradientFill:5,DiamondGradientFill:6},I={Center:0,Inside:1,Outside:2},F={Transparent:0,White:1,Black:2},M={Gaussian:0,Motion:1,Zoom:2,Background:3},O={ArtboardList:0,ArtboardDetail:1,ImageViewer:2},_={Success:0,WebUser_NotLogin:1,Err:2,ArgumentErr:3,VCode:4,NotEmailChecked:5,CloudRank_NotComment:6,CloudRank_SourceFile:7,NeedUserConfirm:3001,UserNotConfirm:3002},L={None:0,Artboard_Comment:1,Artboard_Reply:2,Artboard_Comment_At:4,Artboard_Reply_At:8},P="allfolders.opened",E="cloudfolders.visible",N={Folder:0,File:1,Artboard:2},D={Name:0,Date:1,ArtboardRect:2},j={All:0,Artboard:1},R={Small:0,Normal:1,Big:2},V={Other:0,Url:1,XD:2,Sketch:3,XDPlugin:4,SketchPlugin:5,Word:6,PPT:7,Excel:8,Txt:9,Html:10,Image:11,Pdf:12,Zip:13,AxureExport:14,App:15,Dmg:16,PhotoShop:17,AdobeIllustrator:18,AfterEffects:19,Media:20,AxureSourceFile:21,Figma:22,Font:23,AndroidApp:24,Package:25,Lottie:26,JsDesign:27,getName:function(t,e){var n;switch(e){case R.Small:n="fs-";break;case R.Big:n="fb-";break;default:n="fn-";break}var i=["other","url","xd","sketch","xd-plugin","sketch-plugin","word","ppt","excel","txt","html","image","pdf","zip","axure-export","app","dmg","photoshop","adobe-illustrator","after-effects","media","axure-source","figma","font","apk","package","lottie","jsd"],r=i[t];return r||(r=i[0]),n+r},isSupportOnlineViewType:function(t){switch(t){case V.Html:case V.Url:case V.Image:case V.Pdf:case V.AxureExport:case V.Media:case V.Txt:case V.Lottie:return!0}return!1}},B={Folder:0,Artboard:1,File:2},U={Normal:0,File:1,Interaction:2},H={Blue:0,Red:1,Green:2,Yellow:3,Purple:4,getName:function(t){switch(t){case this.Red:return"red";case this.Green:return"green";case this.Yellow:return"yellow";case this.Purple:return"purple";default:return"blue"}}},W={Folder_Add:0,Folder_Edit:1,Remove:2,MoveTo:3,Folder_SetPreview:4,Folder_CancelPreview:5,Artboard_Upload:21,NetDisk_LinkAdd:40,NetDisk_LinkEdit:41,NetDisk_FileReName:42,NetDisk_FileUploadCompleted:47,defined:function(t){switch(t){case this.Folder_Add:case this.Folder_Edit:case this.Folder_SetPreview:case this.Folder_CancelPreview:return!0;case this.Remove:case this.MoveTo:return!0;case this.Artboard_Upload:return!0;case this.NetDisk_FileUploadCompleted:case this.NetDisk_FileReName:case this.NetDisk_LinkAdd:case this.NetDisk_LinkEdit:return!0;default:return!1}}},$={Artboard:1,File:2,Folder:4},G={Change:0,Add:1,Remove:2},z={ALL:-1,Artboard:1,File:2,Folder:4},Y={Public:0,PrivateCode:1,SpecifyMembers:2,getName:function(t){switch(t){case this.PrivateCode:return"加密";case this.SpecifyMembers:return"限定访问";default:return"公开"}}},X={None:0,Read:1,ReadWrite:2,OnlyChildFolderVisit:4,Owner:256,ParentOwner:512,Admin:1024,getAuthorityName:function(t){switch(t){case this.Owner:return"所有者";case this.ParentOwner:return"父级所有者";case this.Admin:return"超级管理员";case this.Read:return"可查看";case this.ReadWrite:return"可编辑";case this.OnlyChildFolderVisit:return"-";default:return null}},canChangeAuthority:function(t){switch(t){case this.Admin:case this.ParentOwner:case this.Owner:return!1}return!0}},K={None:0,Tourist:1,Designer:2,Admin:128,getName:function(t){switch(t){case this.Tourist:return"协作者";case this.Designer:return"设计师";case this.Admin:return"超级管理员";default:return"-"}}},q={Top:1,Middle:2,Bottom:3,getName:function(t){switch(t){case this.Top:return"顶部";case this.Bottom:return"底部";case this.Middle:return"居中";default:return"未知:".concat(t)}}},Q=(n("697b"),n("f4af")),J=(n("8ee9"),n("7d65"),n("cfdd"),n("1b7f"),n("5fb4"),n("bc79"),n("8748")),Z=(n("201d"),n("d77e"),n("f309"),n("bdd9"),n("18b5"),n("92ea"),n("5a19"),n("9758"),n("98f8"),n("67f3"),n("fc06"),n("3308"),n("2eb9"),n("6e6e"),n("e466"),n("8d23"),n("9cd4"),n("088c"),n("c469"),n("dc2e"),n("4437"),n("f0fe"),n("a5cb"),n("dc4c"),n("1a43"),n("b048"),n("216f"),n("2276"),n("20b4"),n("97a5"),n("d3c5"),n("0274"),n("c88e"),n("a932"),n("4c0c"),n("b0cc"),n("9b5a"),n("db09"),n("85bf"),n("aedb"),n("1bf9"),n("e38e"),n("684f"),n("1afe"),n("37d6"),n("601e"),n("b510"),n("6b16"),n("d80c"),n("60bd"),n("d569"),n("36e7"),n("d064"),n("8f0e"),n("43c1")),tt=(n("f356"),n("0d0a"),{add:function(t,e){if("undefined"==typeof t||"undefined"==typeof e||null==t||null==e)return NaN;var n=0,i=0,r=1;try{n=t.toString().split(".")[1].length}catch(a){}try{i=e.toString().split(".")[1].length}catch(a){}return r=Math.pow(10,Math.max(n,i)),(this.mul(t,r)+this.mul(e,r))/r},sub:function(t,e){if("undefined"==typeof t||"undefined"==typeof e||null==t||null==e)return NaN;var n=0,i=0,r=1;try{n=t.toString().split(".")[1].length}catch(a){}try{i=e.toString().split(".")[1].length}catch(a){}return r=Math.pow(10,Math.max(n,i)),(this.mul(t,r)-this.mul(e,r))/r},mul:function(t,e){if("undefined"==typeof t||"undefined"==typeof e||null==t||null==e)return NaN;var n=0,i=t.toString(),r=e.toString();try{n+=i.split(".")[1].length}catch(a){}try{n+=r.split(".")[1].length}catch(a){}return Number(i.replace(".",""))*Number(r.replace(".",""))/Math.pow(10,n)},div:function(t,e){if("undefined"==typeof t||"undefined"==typeof e||null==t||null==e)return NaN;var n=1,i=1,r=0,a=0;try{r=t.toString().split(".")[1].length}catch(o){}try{a=e.toString().split(".")[1].length}catch(o){}return n=Number(t.toString().replace(".","")),i=Number(e.toString().replace(".","")),this.mul(n/i,Math.pow(10,a-r))}}),et="file:"===location.protocol,nt=function(){var t=navigator.platform;return"Mac68K"==t||"MacPPC"==t||"Macintosh"==t||"MacIntel"==t||"MacAmd"==t||"iPhone"==t||"iPad"==t}(),it=/Mobile|Android|Iphone|Ipad/i.test(navigator.userAgent);if(nt&&!it){var rt=window.screen,at=rt.width,ot=rt.height;(768===at&&1024===ot||1536===at&&2048===ot||1668===at&&2224===ot||1668===at&&2388===ot||2048===at&&2732===ot)&&(it=!0)}var st=it,ct=st&&navigator.standalone;function lt(t){for(var e=[],n={},i=0;i<t.length;i++){var r=t[i];n[r]||(n[r]=1,e.push(r))}return e}var ut=null!==(x=Array.isArray)&&void 0!==x?x:function(t){return"[object Array]"===Object.prototype.toString.call(t)},dt=function(t){return"string"===typeof t&&0!==t.length},ht=function(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)},ft=function(t){return yn("1.3.2470.0",t)},mt=function(t){return yn("1.5.2772.0",t)},pt=function(t){return yn("1.6.3656.0",t)},vt=function(t){return yn("3.0.5050.0",t)},bt=function(t){return yn("1.6.3656.0",t)},gt=function(t){return yn("1.6.3656.0",t)},wt=function(t){return yn("1.6.3656.0",t)},xt=function(t){return yn("2.1.4376.0",t)};function yt(t){if(!t)return"-";t instanceof Date||(t=new Date(t));var e=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0"),r=t.getHours().toString().padStart(2,"0"),a=t.getMinutes().toString().padStart(2,"0");return"".concat(e,"-").concat(n,"-").concat(i," ").concat(r,":").concat(a)}function kt(t){if(!t)return"-";t instanceof Date||(t=new Date(t));var e=new Date,n=e-t,i=Math.floor(n/1e3),r=Math.floor(i/60),a=Math.floor(r/60),o=Math.floor(a/24),s=Math.floor(o/30),c=Math.floor(s/12);return c>0?"".concat(c,"年前"):s>0?"".concat(s,"月前"):o>0?"".concat(o,"天前"):a>0?"".concat(a,"小时前"):r>0?"".concat(r,"分钟前"):i>=0?"刚刚":yt(t)}function Ct(t,e,n,i,r,a,o){var s={x:t,y:e},c={x:n,y:i},l=o/a;s.y*=l,c.y*=l,s.y*=-1,c.y*=-1;var u=St(s,c),d=Tt(s,c,u,a,o),h=d[0],f=d[1];r.forEach((function(t){if(f.x!=h.x){var e=s.x+t.stop*(c.x-s.x),n=(e-h.x)/(f.x-h.x);t.cssStop=isNaN(n)?t.stop:n}else{var i=s.y+t.stop*(c.y-s.y),r=(i-h.y)/(f.y-h.y);t.cssStop=isNaN(r)?t.stop:r}}))}function St(t,e){if(t.x==e.x)return e.y>t.y?0:180;if(t.y==e.y)return e.x>t.x?90:-90;var n=t.x,i=t.y+1,r=Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-i,2)),a=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),o=Math.sqrt(Math.pow(e.x-n,2)+Math.pow(e.y-i,2)),s=180*Math.acos((a*a+r*r-o*o)/(2*a*r))/Math.PI;e.x<t.x&&(s*=-1);while(s<0)s+=360;while(s>=360)s-=360;return s}function Tt(t,e,n,i,r){var a=void 0,o=e.y-t.y,s=e.x-t.x;0==o?a=s>0?[{x:0,y:.5},{x:1,y:.5}]:[{x:1,y:.5},{x:0,y:.5}]:0==s&&(a=o>0?[{x:.5,y:-1},{x:.5,y:0}]:[{x:.5,y:0},{x:.5,y:-1}]);var c=r/i;if(a)return a[0].y*=c,a[1].y*=c,a;var l={x:0,y:0},u={x:1,y:0},d={x:1,y:-1},h={x:0,y:-1};l.y*=c,u.y*=c,d.y*=c,h.y*=c;var f=void 0,m=void 0;n<=90?(f=h,m=u):n<=180?(f=l,m=d):n<=270?(f=u,m=h):(f=d,m=l);var p=-s/o,v=At({x:t.x,y:t.y},{x:e.x,y:e.y},{x:f.x,y:f.y},{x:f.x+1,y:f.y+1*p}),b=At({x:t.x,y:t.y},{x:e.x,y:e.y},{x:m.x,y:m.y},{x:m.x+1,y:m.y+1*p});return[v,b]}function At(t,e,n,i){var r=(e.y-t.y)*(i.x-n.x)-(t.x-e.x)*(n.y-i.y);if(0!=r){var a=((e.x-t.x)*(i.x-n.x)*(n.y-t.y)+(e.y-t.y)*(i.x-n.x)*t.x-(i.y-n.y)*(e.x-t.x)*n.x)/r,o=-((e.y-t.y)*(i.y-n.y)*(n.x-t.x)+(e.x-t.x)*(i.y-n.y)*t.y-(i.x-n.x)*(e.y-t.y)*n.y)/r;return{x:a,y:o}}}var It=function(t){var e,n,i,r;if("number"===typeof t&&!isNaN(t)&&isFinite(t)){i=t%256;var a=tt.div(tt.sub(t,i),256);n=a%256,a=tt.div(tt.sub(a,n),256),e=a%256,a=tt.div(tt.sub(a,e),256),r=a%256}else e=n=i=r=255;return{r:e,g:n,b:i,a:r}},Ft=function(t){var e=It(t),n=e.r,i=e.g,r=e.b,a=e.a,o=fn(tt.div(a,255),2);return{r:n,g:i,b:r,a:a,opacity:o,hexa:"#".concat(n.toString(16).padStart(2,"0")).concat(i.toString(16).padStart(2,"0")).concat(r.toString(16).padStart(2,"0")).concat(a.toString(16).padStart(2,"0")),value:"rgba(".concat(n,", ").concat(i,", ").concat(r,", ").concat(o,")"),type:"rgba"}},Mt=function(t){if("string"!==typeof t||9!==t.length||"#"!==t[0])return t;var e=parseInt(t.substr(1,2),16),n=parseInt(t.substr(3,2),16),i=parseInt(t.substr(5,2),16),r=parseInt(t.substr(7,2),16);return Ot(e,n,i,r)},Ot=function(t,e,n,i){var r=tt.mul(i,16777216);return r=tt.add(r,tt.mul(t,65536)),r=tt.add(r,tt.mul(e,256)),r=tt.add(r,n),r},_t=function(t,e){var n,i,r,a;if("number"!==typeof e&&(e=1),"number"===typeof t){if(1===e)return t;t=It(t),n=t.a,i=t.r,r=t.g,a=t.b}else{var o;n=Math.round(255*(null!==(o=t.a)&&void 0!==o?o:1)),i=Math.round(255*t.r),r=Math.round(255*t.g),a=Math.round(255*t.b)}return Ot(i,r,a,Math.round(n*e))},Lt=function(t){if(ht(t))return{value:"#".concat(t.r.toString(16).padStart(2,"0")).concat(t.g.toString(16).padStart(2,"0")).concat(t.b.toString(16).padStart(2,"0")),a:t.a,opacity:null!=t.opacity?t.opacity:tt.div(t.a,255),type:"hex"}},Pt=function(t){if(ht(t))return{value:"#".concat(t.a.toString(16).padStart(2,"0")).concat(t.r.toString(16).padStart(2,"0")).concat(t.g.toString(16).padStart(2,"0")).concat(t.b.toString(16).padStart(2,"0")),type:"ahex"}},Et=function(t){if(ht(t))return{value:"#".concat(t.r.toString(16).padStart(2,"0")).concat(t.g.toString(16).padStart(2,"0")).concat(t.b.toString(16).padStart(2,"0")).concat(t.a.toString(16).padStart(2,"0")),type:"hexa"}},Nt=function(t){var e=t.r,n=t.g,i=t.b;e/=255,n/=255,i/=255;var r,a,o=Math.max(e,n,i),s=Math.min(e,n,i),c=(o+s)/2;if(o==s)r=a=0;else{var l=o-s;switch(a=c>.5?l/(2-o-s):l/(o+s),o){case e:r=(n-i)/l+(n<i?6:0);break;case n:r=(i-e)/l+2;break;case i:r=(e-n)/l+4;break}r/=6}r=Math.round(tt.mul(r,360)),a=Math.round(tt.mul(a,100)),c=Math.round(tt.mul(c,100));var u=null!=t.opacity?t.opacity:tt.div(t.a,255);return u=tt.div(Math.round(tt.mul(u,100)),100),{h:r,s:tt.div(a,100),l:tt.div(c,100),a:t.a,opacity:u,value:"hsla(".concat(r,", ").concat(a,"%, ").concat(c,"%, ").concat(u,")"),type:"hsla"}};function Dt(t,e,n,i){return(n*t*(1-e)+i*e)/(t+e-t*e)}function jt(t,e){var n,i,r=(null!==(n=t.a)&&void 0!==n?n:255)/255,a=(null!==(i=e.a)&&void 0!==i?i:255)/255,o=r+a-r*a,s=t.r/255,c=e.r/255,l=Dt(r,a,s,c),u=t.g/255,d=e.g/255,h=Dt(r,a,u,d),f=t.b/255,m=e.b/255,p=Dt(r,a,f,m);return{r:Math.round(255*l),g:Math.round(255*h),b:Math.round(255*p),a:Math.round(255*o)}}function Rt(t,e,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;if(t)if("number"!==typeof a&&(a=1),t.value){if(e||!i.types.Text&&(!n||!i.types.Group))return{type:A.FillColor,color:bn(vn(r,t.value),a)}}else if(ut(t.colorStops)&&ut(t.endPoints)){var o=t.gradientRadialTransform,s=t.gradientAngularTransform,c=t.gradientDiamondTransform,l=t.type;if(l&&!(o||s||c))switch(l){case"angular":var u=t.rotation;s={rotate:fn(90+u,2),scaleX:1,scaleY:1,endR:1,startR:0};break;case"radial":var d=t.gradientTransform;if(d){var h=d.scaleX,f=d.scaleY,m=d.rotate;o={rotate:fn(90+m,2),scaleX:h,scaleY:f,endR:1,startR:0}}break}if(o||s||c){var p,v;o?(v=A.RadialGradientFill,p=o):s?(v=A.AngularGradientFill,p=s):c&&(v=A.DiamondGradientFill,p=c);var b=[];t.colorStops.forEach((function(t){var e=fn(100*t.stop,2)+"%",n=bn(vn(r,t.color.value),a);b.push({stop:e,color:n})}));var g=t.endR-t.startR||1;return{type:v,colorStops:b,angle:fn(mn(p.rotate,0))+"deg",startX:fn(100*mn(t.startX,.5),2)+"%",startY:fn(100*mn(t.startY,.5),2)+"%",scaleX:fn(100*Math.abs(mn(p.scaleX,.5)*g),2)+"%",scaleY:fn(100*Math.abs(mn(p.scaleY,.5)*g),2)+"%"}}var w,x,y,k,C=[],S=Object(Z["a"])(t.endPoints,4),T=S[0],I=S[1],F=S[2],M=S[3],O=null!==(w=null!==(x=null!==(y=null!==(k=i.globalBounds)&&void 0!==k?k:i.boundsInArtboardOrigin)&&void 0!==y?y:i.boundsInArtboard)&&void 0!==x?x:i.boundsInParent)&&void 0!==w?w:{width:1,height:1},_=O.width,L=O.height;return Ct(T,I,F,M,t.colorStops,_,L),t.colorStops.forEach((function(t){var e,n=fn(100*t.stop,2)+"%",i=fn(100*(null!==(e=t.cssStop)&&void 0!==e?e:t.stop),2)+"%",o=bn(vn(r,t.color.value),a);C.push({stop:n,color:o,cssStop:i})})),{type:A.LinearGradientFill,colorStops:C,endPoints:t.endPoints,angle:Vt({width:_,height:L},t.endPoints)}}}function Vt(t,e){var n=null!==t&&void 0!==t?t:{width:0,height:0},i=n.width,r=n.height;if(0===i||0===r)return"0deg";var a=r/i,o=e[0],s=e[1]*a,c=e[2],l=e[3]*a,u=Ie({y:o,x:s},{y:c,x:l});return u+"deg"}var Bt=n("9c82"),Ut=n("a3df"),Ht=n("0aec"),Wt="function"===typeof createImageBitmap,$t="function"===typeof Image,Gt=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"queue",[]),Object(Ht["a"])(this,"runningCount",0),Object(Ht["a"])(this,"runningMax",10),Object(Ht["a"])(this,"_paused",!1)}return Object(Ut["a"])(t,[{key:"canNext",get:function(){return!this.paused&&(this.runningCount<this.runningMax&&this.queue.length>0)}},{key:"paused",get:function(){return this._paused},set:function(t){if(this._paused=!!t,!this._paused)for(var e=0;e<this.runningMax-this.runningCount;e++)this.run()}},{key:"run",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(){var e,n,r,a,o,s,c=this;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.canNext){t.next=2;break}return t.abrupt("return");case 2:if(e=this.queue.splice(0,1)[0],e){t.next=5;break}return t.abrupt("return");case 5:if(0!==e.list.length){t.next=8;break}return this.run(),t.abrupt("return");case 8:if(this.runningCount++,n=function(t){c.runningCount--;var n=e.list;n&&0!==n.length&&(n.forEach((function(e){try{e.callback(t,e.state)}catch(n){}})),c.run())},t.prev=10,!$t){t.next=18;break}r=new Image,r.onerror=function(){n(null)},r.onload=function(t){n(t.target)},r.src=e.src,t.next=33;break;case 18:if(!Wt){t.next=32;break}return t.next=21,fetch(e.src);case 21:return a=t.sent,t.next=24,a.blob();case 24:return o=t.sent,t.next=27,createImageBitmap(o);case 27:s=t.sent,o=null,n(s),t.next=33;break;case 32:n(null);case 33:t.next=38;break;case 35:t.prev=35,t.t0=t["catch"](10),n(null);case 38:case"end":return t.stop()}}),t,this,[[10,35]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"add",value:function(t,e,n){if(!t)return e(null,n);var i=this._get(t);if(!i)return i={src:t,list:[{callback:e,state:n}]},this.queue.push(i),void this.run();var r=i.list.findIndex((function(t){return e===t.callback&&t.state===n}));-1===r&&(i.list.push({callback:e,state:n}),this.run())}},{key:"remove",value:function(t,e,n){if(t){var i=this._get(t);if(i){var r=i.list.findIndex((function(t){return e===t.callback&&t.state===n}));-1!==r&&i.list.splice(r,1)}}}},{key:"_get",value:function(t){return this.queue.find((function(e){return e.src===t}))}},{key:"clean",value:function(){this.runningCount=0,this.queue.splice(0)}}]),t}(),zt={};function Yt(t,e,n){return Xt.apply(this,arguments)}function Xt(){return Xt=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r){var a,o;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=document.createElement("iframe"),t.prev=1,a.style.cssText="top:-10000px;left:0;width:1px;height:1px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;",t.next=5,new Promise((function(t,i){var o=Me();zt[o]={resolve:t,reject:i},a.onload=function(){a.onerror=a.onload=null;var t=Bn(),i=a.contentWindow,s=i.document;s.open(),s.write('<!DOCTYPE html>\n        <html lang="zh-CN">\n          <head>\n            <meta charset="utf-8">\n            <meta http-equiv="X-UA-Compatible" content="IE=edge">\n            <meta name="viewport" content="width=device-width,initial-scale=1.0">\n            <title>标记狮 MarkLion - https://www.marklion.cn</title>\n            <style>\n            *{margin:0;padding:0;}\n            html,body{width:100%;height:100%;overflow:hidden}\n            #pdfViewer{display:block;position:absolute;}\n            </style>\n          </head>\n          <body>            \n           <canvas id="pdfViewer"></canvas>\n           <script>if(!window.globalThis)window.globalThis=window;<\/script>\n            <script src="'.concat(t,'pdf.util.min.js" charset="utf-8"><\/script>\n            <script>pdfjsLib.GlobalWorkerOptions.workerSrc="').concat(t,"pdf.worker.min.js\";pdf_util.cloverPdfToJpg('").concat(e,"',").concat(n,",").concat(JSON.stringify(r),").then(function(blobs){parent.__cloverPdfToJpgCallback('").concat(o,"',true,blobs)}).catch(function(reason){parent.__cloverPdfToJpgCallback('").concat(o,"',false,reason)});<\/script>\n          </body>\n        </html>")),s.close()},a.onerror=function(){a.onerror=a.onload=null,parent.__cloverPdfToJpgCallback("${rnd}",!1,"iframe error")},a.src="about:blank",document.body.appendChild(a)}));case 5:return t.abrupt("return",t.sent);case 6:t.prev=6;try{o=a.parentNode,o&&o.removeChild(a)}catch(i){}return t.finish(6);case 9:case"end":return t.stop()}}),t,null,[[1,,6,9]])}))),Xt.apply(this,arguments)}function Kt(t,e){var n=t.contentWindow;if(n&&n.pdf_util)n.pdf_util.renderPdf("#pdfViewer",e);else{var i=Bn(),r='<!DOCTYPE html>\n    <html lang="zh-CN">\n      <head>\n        <meta charset="utf-8">\n        <meta http-equiv="X-UA-Compatible" content="IE=edge">\n        <meta name="viewport" content="width=device-width,initial-scale=1.0">\n        <title>标记狮 MarkLion - https://www.marklion.cn</title>\n        <style>\n        *{margin:0;padding:0;}\n        html,body{width:100%;height:100%;overflow:hidden}\n        #pdfViewer{display:block;position:absolute;}\n        </style>\n      </head>\n      <body>            \n       <canvas id="pdfViewer"></canvas>\n       <script>if(!window.globalThis)window.globalThis=window;<\/script>\n        <script src="'.concat(i,'pdf.util.min.js" charset="utf-8"><\/script>\n        <script>pdfjsLib.GlobalWorkerOptions.workerSrc="').concat(i,"pdf.worker.min.js\";pdf_util.renderPdf('#pdfViewer','").concat(e,"');<\/script>\n      </body>\n    </html>"),a=function(){t.onload=null;var e=t.contentWindow;e.__pluginloaded=!0;var n=e.document;n.open(),n.write(r),n.close()};t.src="about:blank",requestAnimationFrame((function(){var e=t.contentWindow;e&&!e.__pluginloaded?a():t.onload=a}))}}window.__cloverPdfToJpgCallback=function(t,e,n){if(dt(t)){var i=zt[t];i&&(delete zt[t],e?i.resolve(n):i.reject(n))}},window.cloverPdfToJpg=Yt,window.createPdfIframe=Kt;var qt,Qt=function(){function t(e,n){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"start",0),Object(Ht["a"])(this,"end",0),null!=e&&null!=n&&(this.start=Math.min(e,n),this.end=Math.max(e,n))}return Object(Ut["a"])(t,[{key:"length",get:function(){return this.end-this.start}}]),t}(),Jt=function(t,e){return t.start<=e.start&&t.end>=e.end},Zt=function(t,e){var n,i;return t.start<=e.start?(n=t,i=e):(n=e,i=t),i.start>=n.start&&i.start<=n.end},te=function(t,e){var n=e.x,i=n+e.width,r=t.x,a=r+t.width,o=e.y,s=o+e.height,c=t.y,l=c+t.height;return!(i<r||i>a)&&(!(n<r||n>a)&&(!(s<c||s>l)&&!(o<c||o>l)))},ee=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"width",0),Object(Ht["a"])(this,"height",0),Object(Ht["a"])(this,"x",0),Object(Ht["a"])(this,"y",0)}return Object(Ut["a"])(t,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}},{key:"set",value:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this}},{key:"isSame",value:function(t){return null!=t&&ne(this,t)}},{key:"isOverlap",value:function(t){return!(this.left>t.right||this.top>t.bottom||t.left>this.right||t.top>this.bottom)}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}}]),t}(),ne=function(t,e){var n,i,r=5;return n=fn(t.x,r),i=fn(e.x,r),n===i&&(n=fn(t.y,r),i=fn(e.y,r),n===i&&(n=fn(t.width,r),i=fn(e.width,r),n===i&&(n=fn(t.height,r),i=fn(e.height,r),n===i)))},ie=function(t,e){var n=new ee;return n.x=Math.min(t.x,e.x),n.y=Math.min(t.y,e.y),n.width=Math.max(t.right,e.right)-n.x,n.height=Math.max(t.bottom,e.bottom)-n.y,n},re=function(t,e){for(var n=t.length,i=[],r=0;r<n;r++)for(var a=t[r],o=function(){var n=t[s];if(a!==n){var r=new Qt(a,n),o=e.find((function(t){return Jt(r,t)}));o||i.push(r)}},s=r+1;s<n;s++)o();return i},ae=0,oe=function(t,e,n,i,r,a){var o,s,c,l,u,d;return n?(o="x",s="right",c="width",l="y",u="bottom",d="height"):(o="y",s="bottom",c="height",l="x",u="right",d="width"),e.forEach((function(e){var h,f,m,p,v={start:i[l],end:i[u],length:i[d]},b={start:r[l],end:r[u],length:r[d]};if(Zt(v,b))h=Math.max(v.start,b.start),f=Math.min(v.end,b.end);else{var g={start:i[o],end:i[s],length:i[c]};Zt(e,g)?(h=b.start,f=b.end,p=i):(h=v.start,f=v.end,p=r)}var w=h+(f-h)/2,x=new ee,y=a(Math.round(100*e.length)/100);if(n?(x.height=1,x.width=e.length,x.x=e.start,x.y=w):(x.height=e.length,x.width=1,x.x=w,x.y=e.start),t.push({rect:x,text:y,isHorizintal:n,id:++ae}),null!=p){if(m=new ee,n){m.width=1;var k,C=Math.min(Math.abs(x.y-p.y),Math.abs(x.y-p.bottom)),S={};[p.x,p.right,x.x,x.right].forEach((function(t){S[t]&&(k=t),S[t]=1})),m.x=k,m.y=x.y>p.y?x.y-C:x.y,m.height=C}else{m.height=1;var T,A=Math.min(Math.abs(x.x-p.x),Math.abs(x.x-p.right)),I={};[p.y,p.bottom,x.y,x.bottom].forEach((function(t){I[t]&&(T=t),I[t]=1})),m.y=T,m.x=x.x>p.x?x.x-A:x.x,m.width=A}t.push({rect:m,isHorizintal:!n,isDashed:!0,id:++ae})}})),t},se=function(t,e,n,i){t.right>n.width&&(t.width=n.width-t.x),t.bottom>n.height&&(t.height=n.height-t.y),e.right>n.width&&(e.width=n.width-e.x),e.bottom>n.height&&(e.height=n.height-e.y),t.width=Math.max(t.width,.001),t.height=Math.max(t.height,.001),e.width=Math.max(e.width,.001),e.height=Math.max(e.height,.001);var r=ie(t,e),a=lt([r.x,r.right,t.x,t.right,e.x,e.right]),o=lt([r.y,r.bottom,t.y,t.bottom,e.y,e.bottom]),s=[new Qt(t.x,t.right),new Qt(e.x,e.right)],c=[new Qt(t.y,t.bottom),new Qt(e.y,e.bottom)],l=re(a,s),u=re(o,c),d=[];return oe(d,l,!0,t,e,i),oe(d,u,!1,t,e,i),d},ce=function(t,e){var n=e.x,i=e.x+e.width,r=e.y,a=e.y+e.height,o=t.x,s=t.x+t.width,c=t.y,l=t.y+t.height,u=i<o||n>s||a<c||r>l;return!u},le=function(t,e){if(ce(t,e)){var n=new ee,i=Math.max(t.x,e.x),r=Math.max(t.y,e.y),a=Math.min(t.x+t.width,e.x+e.width),o=Math.min(t.y+t.height,e.y+e.height),s=a-i,c=o-r;if(!(s<0||c<0))return n.set(i,r,s,c),n}};function ue(t,e,n){return null==t||1===e?t:(t*=e,t=Math.round(100*t)/100,n?Math.ceil(t):t)}function de(t){var e,n;if(ht(t)){t.nameLower=null!==(e=null===(n=t.name)||void 0===n?void 0:n.toLowerCase())&&void 0!==e?e:"";var i=t.boundsInParent;if(i&&i.height>0&&i.width>0){var r=375/812,a=185,o=Math.round(a/i.width*i.height),s=Math.round(a/r);i.viewWidth=a,i.viewRealHeight=o,i.viewHeight=Math.min(s,o),i.thumbViewWidth=36,i.thumbViewHeight=Math.round(i.thumbViewWidth/r)}}}var he="https://user.marklion.cn/",fe="",me="",pe=375,ve=370,be=function(t){return new Promise((function(e){setTimeout((function(){e()}),t||0)}))},ge={cloudKey:null,userKey:null,documentName:"",documentGuid:"",config:null,inCloudMode:!1,cloudFolderId:0,initTitle:"",fileType:u.XD,cloudVersion:"",docsMinScale:{}},we=new Gt;var xe=function(t){var e=nn("unittemplate.".concat(t),!0);return ht(e)||(e={enable:!1,template:"rem(%num%)"}),e.fromInited=!0,e.guid=t,e},ye=function(t,e){var n=nn("platform.".concat(t),!0);return ht(n)||(n={},n.type=e),n.fromInited=!0,n.guid=t,n},ke=function(t,e){return(null!==t&&void 0!==t?t:"").localeCompare(null!==e&&void 0!==e?e:"",["zh"],{numeric:!0,caseFirst:"upper"})},Ce=function(t){return 1==t?"":"@".concat(t,"x")},Se=function(t){if(null==t)return 0;try{return t.replace(/[^\u0020-\u00ff]/g,"aa").length}catch(e){return 0}},Te=function(t){var e=Se(t);return!!(e>=5&&e<=20&&/^[a-zA-Z\u4e00-\u9fa5][\w\u4e00-\u9fa5-]{1,19}$/.test(t))};function Ae(t,e){var n=t[t.length-1];if(!n)return new ee;var i=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,s=function(t){t&&(i=Math.min(t.x,i),r=Math.min(t.y,r),a=Math.max(t.x+t.width,a),o=Math.max(t.y+t.height,o))};t.forEach((function(t){var e=t.artboard.boundsInParentForList||t.artboard.boundsInParent||t.artboard.frame;s(e)})),ut(e)&&e.forEach((function(t){var e=t.boundsInParentForList||t.boundsInParent||t.frame;s(e)}));var c=new ee;return c.x=i,c.y=r,c.width=a-i,c.height=o-r,c}function Ie(t,e){var n=t.x,i=t.y,r=e.x,a=e.y;if(n===r)return i>=a?270:90;if(i===a)return n>=r?0:180;var o=180*Math.atan2(a-i,r-n)/Math.PI;return o=Math.round(100*(180-o))/100,360===o&&(o=0),o}function Fe(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return Math.round(Math.atan2(i-e,n-t)*(180/Math.PI)*100)/100+r}function Me(){return Math.random().toString(16).substring(2)}function Oe(t,e){return Math.floor(Math.random()*(e-t))+t}function _e(t,e,n){if(!t)return e+n;var i=t.mlConfig.linked;if(!ht(i))return e+n;var r=i[n.toLowerCase()];return r?ge.inCloudMode?r:e+r:e+n}var Le=function(t){if(!ht(t))return!1;var e,n=t.mlConfig;return e=ht(n)&&null!=n.resType?n.resType:l.PNG,(e&l.PNG)===l.PNG},Pe=function(t){if(!ht(t))return!1;var e=t.mlConfig;return!!ht(e)&&(e.resType&l.WEBP)===l.WEBP},Ee=function(t){if(!ht(t))return!1;var e=t.mlConfig;return!!ht(e)&&(e.resType&l.SVG)===l.SVG},Ne=function(t){if(!ht(t))return!1;var e=t.mlConfig;return!!ht(e)&&(e.resType&l.PDF)===l.PDF};function De(t,e){var n,i;"string"===typeof e?n=e:(n=URL.createObjectURL(e),i=!0);var r=document.createElement("a");r.href=n,r.style.cssText+="width:0!important;height:0!important;overflow:hidden!important;position: absolute!important;opacity:0!important;top:0!important;left:0!important;",r.download=t,r.target="_blank",document.body.appendChild(r),r.click(),document.body.removeChild(r),r=null,i&&URL.revokeObjectURL(n),n=null}function je(t,e,n,i){return Re.apply(this,arguments)}function Re(){return Re=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a){var o;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,$e(n,r);case 2:return o=t.sent,"string"===typeof o&&(o="data:application/octet-stream;base64,"+o),t.next=6,a(o);case 6:return o=t.sent,De(e,o),t.abrupt("return","success");case 9:case"end":return t.stop()}}),t)}))),Re.apply(this,arguments)}function Ve(t,e,n,i){return Be.apply(this,arguments)}function Be(){return Be=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a){var o;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Yt(n,r,a);case 2:if(o=t.sent[0],o){t.next=5;break}throw"fail";case 5:return De(e,o),t.abrupt("return","success");case 7:case"end":return t.stop()}}),t)}))),Be.apply(this,arguments)}function Ue(t,e,n,i){return He.apply(this,arguments)}function He(){return He=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a){var o,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s="function"===typeof a,s||!dt(n)||!/^(\/resource\/|https?:\/\/)/i.test(n)){t.next=5;break}o=n,t.next=13;break;case 5:return t.next=7,$e(n,r);case 7:if(o=t.sent,"string"===typeof o&&(o="data:application/octet-stream;base64,"+o),!s){t.next=13;break}return t.next=12,a(o);case 12:o=t.sent;case 13:return De(e,o),t.abrupt("return","success");case 15:case"end":return t.stop()}}),t)}))),He.apply(this,arguments)}function We(t){if(et&&!t.mlConfig.supportFileProtocol)throw"画板(".concat(t.name,")导出时[选择导出包支持范围]选择了[精简版];需要部署到HTTP服务上才支持下载切图,请自行前往res目录拷贝切图");return!0}function $e(t,e){return Ge.apply(this,arguments)}function Ge(){return Ge=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!et){t.next=4;break}return t.next=3,Xe(n);case 3:return t.abrupt("return",t.sent);case 4:return r={},ge.inCloudMode&&(r.cache="reload"),t.next=8,fetch(e,r);case 8:return a=t.sent,t.next=11,a.blob();case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t)}))),Ge.apply(this,arguments)}var ze={},Ye=1;function Xe(t){return new Promise((function(e,n){var i=document.createElement("script"),r=function(t){t&&null!=t.parentNode&&setTimeout((function(){t&&null!=t.parentNode&&(t.parentNode.removeChild(t),t=null)}),200)};i._marklionBack=function(t,a){i._marklionBack=null,i._marklionCallId=null,t?e(a):n(a),r(i),i=null},i.addEventListener("error",(function(e){var n=e.target._marklionBack;n&&n(!1,"资源加载失败[".concat(t,"]"))})),i.addEventListener("load",(function(t){r(t.target)}));var a="marklion_".concat(Date.now(),"_").concat(Ye++);i._marklionCallId=a,i.src=t+"?marklion_res_id="+a,ze[a]=i._marklionBack,document.body.appendChild(i)}))}window.marklion_res=function(t,e){if(null!=t){var n=t._marklionBack,i=t._marklionCallId;n&&i&&(t._marklionBack=null,t._marklionCallId=null,ze[i]=null,n(!0,e))}},window.addEventListener("error",(function(t){var e=t.filename;if(e){var n=e.match(/marklion_res_id=(\w+)/);if(n&&(n=n[1],n)){e=e.replace(/\\/g,"/");var i=e.indexOf("/res/");-1!==i&&(e=e.substr(i+1)),i=e.indexOf("?"),-1!==i&&(e=e.substr(0,i)),e=decodeURIComponent(e);var r=ze[n];r&&r(!1,"资源加载失败[".concat(e,"]"))}}}),!0);var Ke=function(t){if(!t)return null;var e=t.mlCustomName;return e||(e=t.name),e},qe=function(t,e,n){var i;switch(n){case l.WEBP:i=".webp";break;case l.JPG:i=".jpg";break;case l.PDF:i=".pdf";break;default:i=".png";break}return 1===t||"1"===t?e+i:"".concat(e,"@").concat(t,"x").concat(i)},Qe=/[\s\\/$:*?"'<>|\0]/g,Je=function(t){if(dt(t)){t=t.replace(Qe,(function(t){return" "===t?t:""})).trim();var e=50;return t.length>e&&(t=t.substr(0,e)),t}return null},Ze=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="/viewer/".concat(t,"/");return e&&(n="".concat(location.origin).concat(n)),n},tn=function(t){window.location.href=Ze(t)},en=function(t,e,n){if(ht(e)&&e.markedForExport){var i=e.guid;if(i){var r="".concat(ge.documentGuid,"_").concat(i);if(n=Je(n),e.mlCustomName!==n){if(dt(n)&&n!==e.name)return t.$set(e,"mlCustomName",n),void rn(r,n);t.$set(e,"mlCustomName",null),an(r)}}}},nn=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var n=localStorage.getItem("marklion."+t);if(!dt(n))return n;if(!e)return n;try{n=JSON.parse(n)}catch(i){}return n}catch(r){return null}},rn=function(t,e){try{"string"!==typeof e&&(e=JSON.stringify(e)),localStorage.setItem("marklion."+t,e)}catch(n){}},an=function(t){try{return localStorage.removeItem("marklion."+t)}catch(e){}},on=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var n=sessionStorage.getItem("marklion."+t);if(!dt(n))return n;if(!e)return n;try{n=JSON.parse(n)}catch(i){}return n}catch(r){return null}},sn=function(t,e){try{"string"!==typeof e&&(e=JSON.stringify(e)),sessionStorage.setItem("marklion."+t,e)}catch(n){}},cn=function(t){try{return sessionStorage.removeItem("marklion."+t)}catch(e){}},ln=function(t,e,n){var i,r,a,o,s="";null==n?(n=window.location.href,r="#"==e?n.split("#"):n.split("#")[0].split("?"),i=1==r.length?"":r[1]):i=n;if(""!=i){a=i.split("&");var c=a.length;o=t+"=";for(var l=0;l<c;l++)if(0==a[l].indexOf(o)){s=a[l].replace(o,"");break}}return decodeURIComponent(s)},un={NORMAL:"normal",PASSTHROUGH:"pass-through",MULTIPLY:"multiply",DARKEN:"darken",COLOR_BURN:"color-burn",LIGHTEN:"lighten",SCREEN:"screen",COLOR_DODGE:"color-dodge",OVERLAY:"overlay",SOFT_LIGHT:"soft-light",HARD_LIGHT:"hard-light",DIFFERENCE:"difference",EXCLUSION:"exclusion",HUE:"hue",SATURATION:"saturation",COLOR:"color",LUMINOSITY:"luminosity",PASS_THROUGH:"pass-through",LINEAR_BURN:"linear-burn",LINEAR_DODGE:"linear-dodge"};function dn(t){try{if(document.execCommand){var e=document.createElement("textarea");e.style.cssText="position:absolute;left:-1000px;top:-1000px;width:50px;height:10px;background:none;border:none;opacity:0.01;z-index:99999;",e.value=t,e.readOnly=!0,document.body.appendChild(e),e.focus(),e.select();var n=document.execCommand("copy");return e.parentNode.removeChild(e),n}if(window.clipboardData)return window.clipboardData.setData("Text",t),!0}catch(i){return!1}return!1}function hn(t){try{if(document.execCommand)return document.execCommand("copy");if(window.clipboardData)return window.clipboardData.setData("Text",t),!0}catch(e){return!1}return!1}var fn=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=Math.pow(10,e);return Math.round(t*n)/n},mn=function(t,e){return"number"===typeof t?t:e},pn=function(t){var e;while(t){var n=t.types;if(1===n.Group)if(t.fillEnabled)if(t.fill){var i=t.fill.value;null!=i&&(e=i),t=t.parentNode}else t=t.parentNode;else t=t.parentNode;else t=t.parentNode}if(e)return Ft(e)},vn=function(t,e){if(null==t)return e;if(null==e)return e;var n=Ft(e),i=Math.round(n.a*t.a/255);return Ot(t.r,t.g,t.b,i)},bn=function(t,e){if(e>=1||"number"!==typeof e)return t;e<0&&(e=0);var n=Ft(t),i=Math.round(n.a*e);return Ot(n.r,n.g,n.b,i)};var gn=function(t){if(void 0!=t){if(null===t)return null;var e=Object(J["a"])(t);switch(e){case"string":var n;try{n=JSON.parse(t)}catch(i){n=t}return n;default:return t}}};function wn(t){for(var e=atob(t),n=e.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=e.charCodeAt(r);return i}var xn=/^\d{1,7}(\.\d{1,7})*$/i,yn=function(t,e){if("string"!==typeof t)return!1;if("string"!==typeof e)return!0;if(!xn.test(t))return!1;if(!xn.test(e))return!0;t=t.split("."),e=e.split(".");var n=t.length,i=e.length;if(n>i){for(var r=i;r<n;r++)e.push("0");i=n}else if(n<i){for(var a=n;a<i;a++)t.push("0");n=i}for(var o=0;o<n;o++){var s=parseInt(t[o]),c=parseInt(e[o]);if(s>c)return!0;if(s<c)return!1}return!0},kn=function(){return window.devicePixelRatio||1},Cn={Normal:0,Fetching:1,Error:2,Success:3},Sn=function(t){return"number"!==typeof t?t:t<1024?"".concat(t,"B"):t<1048576?"".concat((t/1024).toFixed(2),"KB"):t<1073741824?"".concat((t/1048576).toFixed(2),"MB"):t<1099511627776?"".concat((t/1073741824).toFixed(2),"GB"):"".concat((t/1099511627776).toFixed(2),"TB")};function Tn(t){for(var e=new Uint8Array(4),n=0;n<4;n++){var i=t%256;if(e[n]=i,t-=i,t<=0)break;t/=256}return e}function An(t){for(var e,n=new Array,i=0,r=t.length;i<r;i++)e=t.charCodeAt(i),e>=65536&&e<=1114111?(n.push(e>>18&7|240),n.push(e>>12&63|128),n.push(e>>6&63|128),n.push(63&e|128)):e>=2048&&e<=65535?(n.push(e>>12&15|224),n.push(e>>6&63|128),n.push(63&e|128)):e>=128&&e<=2047?(n.push(e>>6&31|192),n.push(63&e|128)):n.push(255&e);return new Uint8Array(n).buffer}function In(t){return new Blob(t)}function Fn(){var t=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var e=0;e<t.length;e++)if(t[e]+"Hidden"in document)return t[e]+"Hidden";return null}function Mn(){var t=["webkit","moz","ms","o"];if("visibilityState"in document)return"visibilityState";for(var e=0;e<t.length;e++)if(t[e]+"VisibilityState"in document)return t[e]+"VisibilityState";return null}function On(){var t=Mn();return null!==t?"visible"!=document[t]:(t=Fn(),!!t&&document[t])}function _n(t){return dt(t)?t:/[<> ]/gi.replace((function(t){switch(t){case" ":return"&nbsp;";case"<":return"&lt;";case">":return"&gt;"}return t}))}function Ln(t,e){var n=[];if(dt(t)&&dt(e)){var i=-1,r=t.toLowerCase(),a=e.toLowerCase(),o=[];while(-1!=(i=r.indexOf(a,i+1)))o.push(i);var s=a.length,c=0;o.forEach((function(e){e>c&&n.push({light:!1,text:t.substr(c,e-c)}),n.push({light:!0,text:t.substr(e,s)}),c=e+s})),c<t.length&&n.push({light:!1,text:t.substr(c)})}else n.push({text:"",light:!1});return n}var Pn=function(t){return"string"===typeof t&&!/^(((https?|file):)?\/)?\//i.test(t)};function En(t,e,n){var i="meta",r=document.querySelector("".concat(i,"[name='").concat(e,"']")),a=!r;a&&(r=document.createElement(i),r.setAttribute("name",e)),r.setAttribute("content",n),a&&t.appendChild(r)}function Nn(t,e,n,i){var r,a="link";i?(r=[],Object.keys(i).forEach((function(t){r.push("[".concat(t,"='").concat(i[t],"']"))})),r=r.join("")):r="";var o=document.querySelector("".concat(a,"[rel='").concat(e,"']").concat(r)),s=!o;s&&(o=document.createElement(a),o.setAttribute("rel",e),i&&Object.keys(i).forEach((function(t){o.setAttribute(t,i[t])}))),o.setAttribute("href",n),s&&t.appendChild(o)}function Dn(t){var e=t?"/favicon_interaction.png":"/favicon.ico",n=document.head;if(n||(n=document.querySelector("head")),n||(n=document.body),st){En(n,"viewport","width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,minimal-ui,viewport-fit=cover,user-scalable=no"),En(n,"apple-mobile-web-app-capable","yes"),En(n,"mobile-web-app-capable","yes"),En(n,"apple-mobile-web-app-status-bar-style","black-translucent"),En(n,"apple-touch-fullscreen","yes"),En(n,"webkit","renderer"),Nn(n,"icon",e),Nn(n,"apple-touch-icon",e,{sizes:"64x64"}),Nn(n,"apple-touch-icon",e,{sizes:"128x128"}),Nn(n,"apple-touch-icon",e,{sizes:"256x256"});var i=document.documentElement;i.classList.add("i-mobile"),ct&&i.classList.add("i-mobile-safari-standalone")}else t&&Nn(n,"icon",e)}function jn(){st&&document.documentElement.addEventListener("touchstart",(function(t){t.touches.length>1&&t.preventDefault()}),{passive:!1})}function Rn(t){if(!dt(t))return null;var e=/\/fileviewer\/\d+\/(\w+)\//i.exec(t);return e?e[1]:null}var Vn=null===(qt=document.currentScript)||void 0===qt?void 0:qt.src;function Bn(){var t=/^.*\/template\/[\w.]+\/js\//i;if(Vn){var e=t.exec(Vn);e&&e[0]}for(var n=document.querySelectorAll("script[src]"),i=0;i<n.length;i++){var r=n[i],a=r.src;if(a){var o=t.exec(a);if(o)return o[0]}}return ge.inCloudMode?"/template/1.0/js/":"js/"}function Un(t){return parseFloat(t)/100}function Hn(t,e){var n,i;t?(n=.02,i=10):(n=.1,i=6);var r=e>1?100:1e4;return e=Math.round(e*r),e=tt.div(e,r),e=Math.min(i,e),e=Math.max(n,e),e}function Wn(t,e){var n,i,r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),a=[];if(e=e||r.length,t)for(n=0;n<t;n++)a[n]=r[0|Math.random()*e];else for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",n=0;n<36;n++)a[n]||(i=0|16*Math.random(),a[n]=r[19==n?3&i|8:i]);return a.join("")}function $n(t){if(!dt(t))return t;var e=parseFloat(t);return isNaN(e)?t:(e-=90,e<-90&&(e+=360),"".concat(fn(e,2),"deg"))}var Gn=n("a027");n("b763");function zn(t,e,n,i){var r,a=e.overrides.find((function(t){if(t.style){var e=t.style[n];return null!=e?t:void 0}}));return a&&(r=a.style[n],null!=r)||t&&(r=t[n],null!=r)?r:i}function Yn(t){if(t&&t.type!==v.Artboard){var e=t.layers;if(!e)return t.type===v.ShapePath;var n=0,i=[];if(e.forEach((function(t,e){if(t)switch(t.type){case v.ShapePath:return void(t.markedForExport||n++);case v.Group:return void(Yn(t)&&(n++,i.push(e)))}})),n===e.length){n>=7&&(t.layers=[]);for(var r=i.length-1;r>=0;r--){var a=i[r];e.splice(a,1)}return!0}return t.type===v.ShapePath}}var Xn=["topLeft","topRight","bottomRight","bottomLeft"];function Kn(t){if(t){var e;switch(t.fillType){case S.Color:var n=t.color;n&&(e={value:Mt(t.color)});break;case S.Gradient:var i=t.gradient;if(i)switch(i.gradientType){case T.Linear:var r=i.from,a=i.to,o=i.stops;if(r&&a&&o){var s=[];e={endPoints:[r.x,r.y,a.x,a.y],colorStops:s},o.forEach((function(t){s.push({stop:t.position,color:{value:Mt(t.color)}})}))}break;case T.Radial:0===i.aspectRatio&&(i.aspectRatio=1);var c=i.from,l=i.to,u=Fe(c.x,c.y,l.x,l.y,90),d=i.stops;if(c&&l&&d){var h=[],f=c.x,m=c.y,p=Math.sqrt(Math.pow(l.x-f,2)+Math.pow(l.y-m,2));e={endPoints:[c.x,c.y,l.x,l.y],colorStops:h,startX:f,startY:m,gradientRadialTransform:{rotate:u,scaleX:p,scaleY:p*i.aspectRatio,endR:1,startR:0}},d.forEach((function(t){h.push({stop:t.position,color:{value:Mt(t.color)}})}))}break;case T.Angular:var v=i.from,b=i.to,g=90,w=i.stops;if(v&&b&&w){var x,y,k=[],C=.5,A=.5,I=1;e={endPoints:[v.x,v.y,b.x,b.y],colorStops:k,startX:C,startY:A,gradientAngularTransform:{rotate:g,scaleX:I,scaleY:I,endR:1,startR:0}},w.sort((function(t,e){var n=t.position-e.position;return 0===n?0:n>0?1:-1}));var F=w[0],M=null!==(x=null===F||void 0===F?void 0:F.position)&&void 0!==x?x:0;0!=M&&(w.forEach((function(t){t.position-=M})),e.gradientAngularTransform.rotate=g=fn(g+360*M,2));var O=w[w.length-1],_=null!==(y=null===O||void 0===O?void 0:O.position)&&void 0!==y?y:1;_<1&&F&&(null===O||void 0===O?void 0:O.color)!=F.color&&w.push({position:1,color:F.color}),w.forEach((function(t){k.push({stop:t.position,color:{value:Mt(t.color)}})}))}break}break;case S.Pattern:e={assetId:"sketch"};break}return e}}function qn(t,e){var n=e.background;if(n&&n.enabled&&n.color&&n.includedInInstance)return!1;var i=e.frame,r=t.frame;if(i.width!==r.width)return!1;if(i.height!==r.height)return!1;var a=e.style;if(!a)return!0;var o=a.opacity;return null==o||o>=1}function Qn(t,e){var n=e.nodeSharedStyles={overrides:[],share:null},i=t.sharedStyles;if(i){var r=e.overrideSharedStyleIds;if(r&&r.forEach((function(t){var e=i[t];e&&n.overrides.push(e)})),e.sharedStyleId){var a=i[e.sharedStyleId];a&&(n.share=a)}}}function Jn(t){var e,n=t.boxTransform={rotation:0,flippedHorizontally:!1,flippedVertically:!1},i=t.transform;ht(i)&&(null!=i.rotation&&(n.rotation=fn(i.rotation,3)),i.flippedHorizontally&&(n.flippedHorizontally=!0),i.flippedVertically&&(n.flippedVertically=!0));var r=null!==(e=t.name)&&void 0!==e?e:"";if(90===n.rotation||-90===n.rotation||270===n.rotation){if(t.type===v.ShapePath&&t.shapeType===b.Custom&&(-1!=r.indexOf("Line")||-1!=r.indexOf("直线")))return void(n.rotation=0);var a=t.frame,o=a.x,s=a.y,c=a.width,l=a.height;if(c===l)return;t._sketchRealStyle={rotation:n.rotation,x:o,y:s,width:c,height:l},t.markedForExport&&(n.rotation=0);var u=(c-l)/2,d=-u;t.frame={x:o+u,y:s+d,width:l,height:c}}}function Zn(t,e,n){if(!e.markedForExport){var i=t.frame;i={x:0,y:0,width:i.width,height:i.height};var r=e.frame,a=n.globalBounds.x-t.globalBounds.x,o=n.globalBounds.y-t.globalBounds.y,s={x:a+r.x,y:o+r.y,width:r.width,height:r.height};i=le(i,s),i||(i={x:0,y:0,width:0,height:0});var c={width:i.width,height:i.height,x:i.x-a,y:i.y-o};if(!ne(c,r)){e.frame=c;var l=e.frame.x-r.x,u=e.frame.y-r.y;e._sketchFixedFrame=1,0===l&&0===u||e.layers&&e.layers.forEach((function(t){t.frame.x-=l,t.frame.y-=u}))}}}function ti(t,e,n){if(n){if(Zn(t,e,n),n._sketchFixedFrame&&!e.markedForExport){var i={x:0,y:0,width:n.frame.width,height:n.frame.height};ei(i,e)}if(e.hasClippingMask){var r=n.layers;if(r)for(var a=!1,o=e.frame,s=0,c=r.length;s<c;s++){var l=r[s];if(l!==e){if(a){if(l.hasClippingMask)break;if(l.shouldBreakMaskChain)break;l.markedForExport||ei(o,l)}}else a=!0}}}}function ei(t,e){var n=e.frame,i=n.x,r=n.y,a=le(t,e.frame);if(a||(a={x:0,y:0,width:0,height:0}),!ne(a,e.frame)){var o=a.x-i,s=a.y-r;e.frame=a,e._sketchFixedFrame=1,0===o&&0===s||e.layers&&e.layers.forEach((function(t){var e=t.frame;e.x-=o,e.y-=s}))}}var ni=[100,100,100,200,300,400,500,500,600,700,800,900,900,900,900,900];function ii(t,e,n){e.boundsInParent=e.frame,e.guid=e.id,e.visible=!e.hidden,e.children=e.layers,Jn(e),Qn(t,e);var i=e.nodeSharedStyles,r=e.style;e.opacity=zn(r,i,"opacity",1);var a=un[h[zn(r,i,"blendingMode",d.NORMAL)]];a&&(e.blendMode=a);var o=zn(r,i,"blur",null);if(null!=o)switch(o.blurType){case M.Gaussian:e.blur={isBackgroundEffect:!1,visible:!0,blurAmount:o.radius};break;case M.Background:e.blur={isBackgroundEffect:!0,visible:!0,blurAmount:o.radius,saturation:o.saturation};break}var s=zn(r,i,"borders",null);s&&s.length>0&&(e.strokeArr=[],s.forEach((function(t){var n=Kn(t);if(n){var a={strokeEnabled:!0,stroke:n,strokeWidth:t.thickness,strokePosition:t.position},o=zn(r,i,"borderOptions",null);if(o&&(a.strokeDashArray=o.dashPattern),0===e.strokeArr.length)for(var s in a)e[s]=a[s];e.strokeArr.push(a)}})));var c=zn(r,i,"shadows",null);c&&c.length>0&&(e.shadowArr=[],c.forEach((function(t){if(t){var n={visible:!0,x:t.x,y:t.y,blur:t.blur,spread:t.spread,color:{value:Mt(t.color)}};0===e.shadowArr.length&&(e.shadow=n),e.shadowArr.push(n)}})));var l=zn(r,i,"innerShadows",null);if(l&&l.length>0&&(e.innerShadowArr=[],l.forEach((function(t){if(t){var n={visible:!0,x:t.x,y:t.y,blur:t.blur,spread:t.spread,color:{value:Mt(t.color)}};0===e.innerShadowArr.length&&(e.innerShadow=n),e.innerShadowArr.push(n)}}))),e.type!==v.SymbolMaster&&e.type!==v.Artboard){var u=zn(r,i,"fills",null);ut(u)&&(e.fillArr=[],u.forEach((function(t){t&&(t=Kn(t),0===e.fillArr.length&&(e.fillEnabled=!0,e.fill=t),e.fillArr.push({fillEnabled:!0,fill:t}))})))}if(ti(t,e,n),t===e||null==n)e.globalBounds=e.globalDrawBounds=Object(Q["a"])({},e.frame);else{var f=n.globalBounds,m=e.frame;e.globalBounds=e.globalDrawBounds={x:f.x+m.x,y:f.y+m.y,width:m.width,height:m.height}}if(!e.types)switch(e.types={GraphicNode:1},e.type){case v.SymbolInstance:e.types.SymbolInstance=1;break;case v.Artboard:e.types.Artboard=1;var p=e.background;p&&p.enabled&&p.color&&(e.fillEnabled=!0,e.fill={value:Mt(p.color)});break;case v.Group:e.types.Group=1;break;case v.Text:e.types.Text=1,e.paragraphSpacing=zn(r,i,"paragraphSpacing",0),e.lineSpacing=zn(r,i,"lineHeight",0);var w=zn(r,i,"alignment",g.left);e.textAlign=y[w],null==e.textAlign&&(e.textAlign=w);var x=zn(r,i,"verticalAlignment",k.top);x!==k.top&&(e.textVerticalAlign=C[x]);var S={fill:{},charSpacing:zn(r,i,"kerning",null),fontFamily:zn(r,i,"fontFamily",""),fontWeight:ni[zn(r,i,"fontWeight",4)],fontItalic:zn(r,i,"fontStyle",""),fontSize:zn(r,i,"fontSize",""),underline:!!zn(r,i,"textUnderline",""),strikethrough:!!zn(r,i,"textStrikethrough","")};null==S.fontWeight&&(S.fontWeight=400),S.fontWeightCss=S.fontWeight.toString(),S.fontStyle=S.fontWeight.toString(),S.fontItalic?S.fontStyle+=" "+S.fontItalic:S.fontItalic="normal",e.styleRanges=[S];var T=zn(r,i,"textColor","");T&&(S.fill.value=Mt(T));break;case v.ShapePath:switch(e.types.Rectangle=1,e.shapeType){case b.Rectangle:var A=e.points,I=null;ut(A)&&A.length>0&&(I={topLeft:0,topRight:0,bottomRight:0,bottomLeft:0},A.forEach((function(t,e){t&&(I[Xn[e]]=t.cornerRadius)}))),e.cornerRadii=I;break;default:break}break}}n("9f22"),n("55b0"),n("e328"),n("aa2f"),n("074f"),n("92f9");var ri=75,ai="quality.jpg",oi={None:-1,Brush:0,Line:1,Rectangle:2,Ellipse:3,Text:4,Arrow:5,Image:6,Move:7,Deleted:8,End:9},si=[14,16,18,20,24,28,32,36,48,72],ci=36,li={Fine:3,Normal:6,Crude:12},ui=[{color:"#545454",border:"#434343",name:"black"},{color:"#ffffff",border:"#cccccc",name:"white"},{color:"#f34e1e",border:"#c23e18",name:"orange"},{color:"#ffc701",border:"#cc9f07",name:"yellow"},{color:"#0ea958",border:"#0d8747",name:"green"},{color:"#417dee",border:"#2b63ce",name:"blue"},{color:"#9847ff",border:"#7e3bd2",name:"purple"},{color:"#d27c2c",border:"#a76323",name:"brown"}],di=function(){function t(e,n){return Object(Bt["a"])(this,t),Object(Ht["a"])(this,"_x",0),Object(Ht["a"])(this,"_y",0),this.x=null!=e?e:0,this.y=null!=n?n:0,this}return Object(Ut["a"])(t,[{key:"x",get:function(){return this._x},set:function(t){this._x=t}},{key:"y",get:function(){return this._y},set:function(t){this._y=t}},{key:"top",get:function(){return this._y},set:function(t){this._y=t}},{key:"left",get:function(){return this._x},set:function(t){this._x=t}},{key:"toJSON",value:function(){var t=this.x,e=this.y;return{x:t,y:e}}}]),t}(),hi=1,fi=Object(Ut["a"])((function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"id",0),Object(Ht["a"])(this,"data",null),Object(Ht["a"])(this,"blob",null),Object(Ht["a"])(this,"thumbBlob",null),this.id=hi++})),mi=Object(Ut["a"])((function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"type",""),Object(Ht["a"])(this,"thumbType",""),Object(Ht["a"])(this,"name",""),Object(Ht["a"])(this,"length",0),Object(Ht["a"])(this,"thumbLength",0),Object(Ht["a"])(this,"fold",null),Object(Ht["a"])(this,"fileName",null),Object(Ht["a"])(this,"thumbFileName",null),Object(Ht["a"])(this,"imageSize",null),Object(Ht["a"])(this,"thumbImageSize",null)}));function pi(t){return new Promise((function(e,n){if(t instanceof Image)return e(t);var i,r=!1;"string"===typeof t?i=t:(i=URL.createObjectURL(t),r=!0);var a=function(){r&&URL.revokeObjectURL(i),i=t=void 0};try{var o=new Image;o.onload=function(t){a(),e(t.target)},o.onerror=function(){a(),n("图片加载失败,不支持的图片类型")},o.src=i}catch(s){a(),n(s)}}))}var vi="image/jpeg";function bi(t,e){return gi.apply(this,arguments)}function gi(){return gi=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a,o,s,c,l,u,d;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.naturalWidth,a=e.naturalHeight,o=Math.max(Math.ceil(a/r*n),1),t.prev=2,s=document.createElement("canvas"),c=function(t){return t},l=new yi(c(n),c(o)),s.width=l.width,s.height=l.height,s.style.cssText="top:-10000px;left:0;width:1px;height:1px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;",document.body.appendChild(s),u=s.getContext("2d"),u.fillStyle="#fff",u.fillRect(0,0,l.width,l.height),u.drawImage(e,0,0,r,a,0,0,l.width,l.height),t.next=16,Ni(s,vi,.75);case 16:return t.t0=t.sent,t.t1=n,t.t2=o,t.abrupt("return",{blob:t.t0,width:t.t1,height:t.t2});case 20:return t.prev=20,s&&(d=s.parentNode,d&&d.removeChild(s)),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[2,,20,23]])}))),gi.apply(this,arguments)}function wi(t){return xi.apply(this,arguments)}function xi(){return xi=Object(r["a"])(Object(i["a"])().mark((function t(e){var n,r,a,o,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e instanceof Blob||e instanceof File){t.next=2;break}throw new Error("附件异常,不支持的图片格式");case 2:return t.next=4,pi(e);case 4:if(n=t.sent,r=new fi,a=new mi,r.data=a,a.imageSize=new yi(n.naturalWidth,n.naturalHeight),a.type=e.type,a.name=e.name,a.length=e.size,o=300,r.blob=e,!(a.imageSize.width<=o)){t.next=20;break}a.thumbImageSize=a.imageSize,a.thumbLength=0,a.thumbType=a.type,t.next=27;break;case 20:return t.next=22,bi(n,o);case 22:s=t.sent,a.thumbImageSize=new yi(s.width,s.height),a.thumbLength=s.blob.size,a.thumbType=vi,r.thumbBlob=s.blob;case 27:return t.abrupt("return",r);case 28:case"end":return t.stop()}}),t)}))),xi.apply(this,arguments)}var yi=function(){function t(e,n){return Object(Bt["a"])(this,t),Object(Ht["a"])(this,"_width",0),Object(Ht["a"])(this,"_height",0),this.width=null!=e?e:0,this.height=null!=n?n:0,this}return Object(Ut["a"])(t,[{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}},{key:"toJSON",value:function(){var t=this.width,e=this.height;return{width:t,height:e}}}]),t}(),ki={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},Ci=72,Si=3,Ti=450;function Ai(t,e){null==e&&(e=1);var n=t.toLowerCase();if(!n)return n;ki[n]&&(n=ki[n]);var i=/^\s*rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i;if(/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(n)){if(4===n.length){for(var r="#",a=1;a<4;a+=1)r+=n.slice(a,a+1).concat(n.slice(a,a+1));n=r}for(var o=[],s=1;s<7;s+=2)o.push(parseInt("0x"+n.slice(s,s+2)));o.push(e),n="RGBA("+o.join(",")+")"}else n=i.test(n)?n.replace(i,"rgba($1,$2,$3,"+e+")"):n.replace(/^\s*rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)\s*$/i,"rgba($1,$2,$3,"+e+")");return n}function Ii(t,e){return{x:t.x*Math.cos(e)+t.y*Math.sin(e),y:t.y*Math.cos(e)-t.x*Math.sin(e)}}function Fi(t,e,n,i){var r,a,o,s=Math.atan((i.x-n.x)/(i.y-n.y)),c=Ii(i,-s),l=Ii(n,-s),u={x:0,y:0},d={x:0,y:0},h={x:0,y:0},f={x:0,y:0},m=c.y-l.y;switch(t){case li.Fine:m=m>0?6:-6,r=m>0?12:-12,a=m>0?2:-2,o=m>0?4:-4;break;case li.Crude:m=m>0?10:-10,r=m>0?20:-20,a=m>0?6:-6,o=m>0?12:-12;break;default:m=m>0?8:-8,r=m>0?16:-16,a=m>0?4:-4,o=m>0?8:-8}m*=e,r*=e,a*=e,o*=e,u.x=c.x+m,u.y=c.y-r,d.x=c.x-m,d.y=c.y-r,h.x=c.x+a,h.y=c.y-o,f.x=c.x-a,f.y=c.y-o;var p=Ii(u,s),v=Ii(d,s),b=Ii(h,s),g=Ii(f,s);return{h1:p,h2:v,h3:b,h4:g}}function Mi(t){var e=t[t.length-1];if(e){var n=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;t.forEach((function(t){n=Math.min(t.x,n),i=Math.min(t.y,i),r=Math.max(t.x+t.width,r),a=Math.max(t.y+t.height,a)}));var o=new ee;return o.x=n,o.y=i,o.width=r-n,o.height=a-i,o}}function Oi(t){var e=t[t.length-1];if(e){var n=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;t.forEach((function(t){var e=(new ee).set(t.x,t.y,1,1);n=Math.min(e.x,n),i=Math.min(e.y,i),r=Math.max(e.right,r),a=Math.max(e.bottom,a)}));var o=new ee;return o.x=n,o.y=i,o.width=r-n,o.height=a-i,o}}var _i=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"action",oi.None),Object(Ht["a"])(this,"startPoint",null),Object(Ht["a"])(this,"endPoint",null),Object(Ht["a"])(this,"eventRect",null),Object(Ht["a"])(this,"color",null),Object(Ht["a"])(this,"brushSize",0),Object(Ht["a"])(this,"fontSize",0),Object(Ht["a"])(this,"text",null),Object(Ht["a"])(this,"family",null),Object(Ht["a"])(this,"lineHeight",0),Object(Ht["a"])(this,"textareaSize",null),Object(Ht["a"])(this,"points",null),Object(Ht["a"])(this,"textSplit",null),Object(Ht["a"])(this,"brushHash",null),Object(Ht["a"])(this,"dragFrom",-1),Object(Ht["a"])(this,"dragOn",-1),Object(Ht["a"])(this,"dragOffset",null),Object(Ht["a"])(this,"dragTarget",null)}return Object(Ut["a"])(t,[{key:"getBrushSize",value:function(){var t=this.action,e=this.brushSize;if(t!==oi.Brush)return e;switch(e){case li.Crude:return 6;case li.Fine:return 1;default:return 3}}},{key:"makeBrushHash",value:function(t){return"".concat(t.offset.x,"-").concat(t.offset.y,"-").concat(t.scale,"-").concat(t.sceneWidth,"-").concat(t.sceneHeight)}},{key:"getArrowEventRect",value:function(){var t=this.startPoint,e=this.endPoint,n=1,i=Fi(this.getBrushSize(),n,t,e);return Oi([t,e,i.h1,i.h2,i.h3,i.h4])}},{key:"makePoint",value:function(t){switch(this.action){case oi.Arrow:this.eventRect=this.getArrowEventRect();break;case oi.Text:var e;t.font="".concat(this.fontSize,"px ").concat(null!==(e=this.family)&&void 0!==e?e:"sans-serif"),this.text=this.text.replace(/\r/g,"");for(var n=this.text,i={},r=0,a=this.textSplit=[],o=0,s=Ti,c=n.length,l=this.lineHeight,u=new yi(0,0),d=0;d<c;d++){var h=n[d];if("\n"!==h){var f=i[h];f||(f=i[h]=t.measureText(h).width);var m=o+f;m>s?(u.width=Math.max(u.width,o),u.height+=l,o=f,a.push({index:r,length:d-r}),r=d):o=m}else u.width=Math.max(u.width,o),u.height+=l,o=0,a.push({index:r,length:d-r}),r=d+1}u.width=Math.max(u.width,o),r<=c-1&&(u.height+=l,a.push({index:r,length:c-r}));var p=this.startPoint;this.endPoint=new di(p.x+u.width,p.y+u.height);var v=l/2-l/8;this.eventRect=(new ee).set(p.x,p.y-v,u.width,u.height);break;case oi.Brush:var b,g=null!==(b=Oi(this.points))&&void 0!==b?b:new ee,w=this.getBrushSize(),x=Math.ceil(w/2);this.startPoint=new di(g.x-x,g.y-x),this.endPoint=new di(g.right,g.bottom),this.eventRect=(new ee).set(g.x-x,g.y-x,g.width+w,g.height+w),this.brushHash=null;break;default:var y=this.startPoint,k=this.endPoint;if(this.eventRect=new ee,y&&k){var C=Math.min(y.x,k.x),S=Math.min(y.y,k.y),T=Math.round(Math.abs(y.x-k.x)),A=Math.round(Math.abs(y.y-k.y));this.eventRect.set(C,S,T,A)}break}}},{key:"isVaildData",value:function(){switch(this.action){case oi.Deleted:var t=this.dragTarget;return!!t;case oi.Move:var e=this.startPoint,n=this.endPoint,i=this.dragTarget,r=this.dragOffset;return!!i&&(!(!e||!n)&&((e.x!==n.x||e.y!==n.y)&&(this.dragOffset=new di(n.x-e.x+r.x,n.y-e.y+r.y),!0)));case oi.Arrow:case oi.Ellipse:case oi.Rectangle:var a=this.startPoint,o=this.endPoint;return null!=a&&null!=o&&(a.x!==o.x||a.y!==o.y);case oi.Text:var s=this.text;return!!s&&(s=s.trim(),s.length>0);case oi.Brush:var c=this.points;return!(!ut(c)||c.length<=1);default:return!1}}},{key:"isOverlapPoint",value:function(t,e,n){Li.arrow(this,e,n)}}]),t}(),Li={arrow:function(t,e,n){var i=t.startPoint,r=t.endPoint;if(i&&r){var a=Di.getCanvasLocation(e,t.startPoint,n),o=Di.getCanvasLocation(e,t.endPoint,n),s=e.scale*e.canvasScale,c=Fi(t.getBrushSize(),s,a,o);return{triangle1:{p0:new di(a.x,a.y),p1:new di(c.h3.x,c.h3.y),p2:new di(c.h4.x,c.h4.y)},triangle2:{p0:new di(o.x,o.y),p1:new di(c.h1.x,c.h1.y),p2:new di(c.h2.x,c.h2.y)}}}}},Pi=Object(Ut["a"])((function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"offset",null),Object(Ht["a"])(this,"scale",1),Object(Ht["a"])(this,"sceneWidth",1),Object(Ht["a"])(this,"sceneHeight",1),Object(Ht["a"])(this,"canvasScale",1)}));function Ei(t){return new Promise((function(e,n){var i=new Image;i.onload=function(t){e(t.target)},i.onerror=function(){n("画板预览图加载失败")},i.crossOrigin="*",i.src=t}))}function Ni(t,e,n){return new Promise((function(i,r){try{t.toBlob((function(t){i(t)}),e,n)}catch(a){r(a)}}))}var Di={_supportCanvasEllipse:-1,get supportCanvasEllipse(){var t=this._supportCanvasEllipse;return-1===t&&(t="function"===typeof CanvasRenderingContext2D.prototype.ellipse?1:0),t},getCanvasLocation:function(t,e,n){var i=new di(e.x-t.offset.x,e.y-t.offset.y);n&&(i.x+=n.x,i.y+=n.y);var r=t.scale*t.canvasScale;return i.x=Math.floor(i.x*r),i.y=Math.floor(i.y*r),i},getCanvasRect:function(t,e,n){var i=(new ee).set(e.x-t.offset.x,e.y-t.offset.y,e.width,e.height);n&&(i.x+=n.x,i.y+=n.y);var r=t.scale*t.canvasScale;return i.x=Math.floor(i.x*r),i.y=Math.floor(i.y*r),i.width=Math.ceil(i.width*r),i.height=Math.ceil(i.height*r),i},getMidPointBtw:function(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}},setStrokeStyle:function(t,e,n,i){t.lineCap=t.lineJoin=null!==i&&void 0!==i?i:"round",t.fillStyle=t.strokeStyle=e.color;var r=e.getBrushSize(),a=Math.ceil(r*n.scale*n.canvasScale);t.lineWidth=a},drawRectangle:function(t,e,n,i,r,a){var o=e.startPoint,s=e.endPoint;if(o&&s){var c=this.getCanvasLocation(n,e.startPoint,a),l=this.getCanvasLocation(n,e.endPoint,a);r?this.drawSelectItem(t,e,n,a):i&&this.drawBackground(t,e,n,a),this.setStrokeStyle(t,e,n);var u=Math.round(t.lineWidth/2),d=Math.min(c.x,l.x)+u,h=Math.min(c.y,l.y)+u,f=Math.max(0,Math.abs(c.x-l.x)-2*u),m=Math.max(0,Math.abs(c.y-l.y)-2*u);t.strokeRect(d,h,f,m),r&&this.drawSelectItemBorder(t,e,n,a)}},drawEllipse:function(t,e,n,i,r,a){var o=e.startPoint,s=e.endPoint;if(o&&s){var c=this.getCanvasLocation(n,e.startPoint,a),l=this.getCanvasLocation(n,e.endPoint,a);r?this.drawSelectItem(t,e,n,a):i&&this.drawBackground(t,e,n,a),this.setStrokeStyle(t,e,n);try{var u=Math.ceil(t.lineWidth/2),d=Math.round(Math.abs(c.x-l.x)/2),h=Math.round(Math.abs(c.y-l.y)/2),f=Math.min(c.x,l.x)+d,m=Math.min(c.y,l.y)+h;if(d=Math.max(0,d-u),h=Math.max(0,h-u),this.supportCanvasEllipse)return t.beginPath(),t.ellipse(f,m,d,h,0*Math.PI/180,0,2*Math.PI),t.closePath(),void t.stroke();t.save();var p=d>h?d:h,v=d/p,b=h/p;t.scale(v,b),t.beginPath(),t.arc(f/v,m/b,p,0,2*Math.PI,!1),t.closePath(),t.stroke(),t.restore()}finally{r&&this.drawSelectItemBorder(t,e,n,a)}}},drawArrow:function(t,e,n,i,r,a){if(t){var o=Li.arrow(e,n,a);o&&(r?this.drawSelectItem(t,e,n,a):i&&this.drawBackground(t,e,n,a),this.setStrokeStyle(t,e,n,"buff"),t.beginPath(),t.moveTo(o.triangle1.p0.x,o.triangle1.p0.y),t.lineTo(o.triangle1.p1.x,o.triangle1.p1.y),t.lineTo(o.triangle1.p2.x,o.triangle1.p2.y),t.closePath(),t.fill(),t.beginPath(),t.moveTo(o.triangle2.p0.x,o.triangle2.p0.y),t.lineTo(o.triangle2.p1.x,o.triangle2.p1.y),t.lineTo(o.triangle2.p2.x,o.triangle2.p2.y),t.closePath(),t.fill(),r&&this.drawSelectItemBorder(t,e,n,a))}},drawSelectItem:function(t,e,n,i){return this.drawBackground(t,e,n,i)},drawSelectItemBorder:function(t,e,n,i){if(e.eventRect){var r=this.getCanvasRect(n,e.eventRect,i),a="#1886ff";t.strokeStyle=a,t.lineCap="round";var o=Math.max(Math.ceil(n.scale*n.canvasScale),1);t.lineWidth=o,t.strokeRect(r.x,r.y,r.width,r.height)}},drawBackground:function(t,e,n,i){if(e.eventRect){var r=this.getCanvasRect(n,e.eventRect,i),a="#1886ff";a=Ai(a,.2),t.fillStyle=a,t.fillRect(r.x,r.y,r.width,r.height)}},drawText:function(t,e,n,i,r,a){var o,s=e.startPoint,c=e.textSplit;if(s&&c){var l=this.getCanvasLocation(n,e.startPoint,a);if(void 0!=t){r?this.drawSelectItem(t,e,n,a):i&&this.drawBackground(t,e,n,a);var u=n.canvasScale*n.scale,d=e.text,h=Math.max(1,Math.round(e.lineHeight*u)),f=new di(l.x,l.y-Math.round(h/4));t.imageSmoothingEnabled=!0,t.imageSmoothingQuality="high",t.font="".concat(Math.max(1,Math.round(e.fontSize*n.scale)*n.canvasScale),"px ").concat(null!==(o=e.family)&&void 0!==o?o:"sans-serif"),t.fillStyle=e.color,t.textAlign="left",t.textBaseline="top",c.forEach((function(e){if(e.length>0){var n=d.substr(e.index,e.length);t.fillText(n,f.x,f.y)}f.y+=h})),r&&this.drawSelectItemBorder(t,e,n,a)}}},drawBrush:function(t,e,n,i,r,a,o){if(ut(e.points)&&!(e.points.length<=1)){var s=0;o=!1,o&&(s=e.points.length-2);var c,l=this.getCanvasLocation(n,e.points[s],a);r?this.drawSelectItem(t,e,n,a):i&&this.drawBackground(t,e,n,a),this.setStrokeStyle(t,e,n),t.beginPath(),t.moveTo(l.x,l.y);for(var u=s+1,d=e.points.length;u<d;u++){var h=this.getCanvasLocation(n,e.points[u],a);o?t.lineTo(h.x,h.y):(c=this.getMidPointBtw(l,h),t.quadraticCurveTo(h.x,h.y,c.x,c.y)),l=h}c&&t.lineTo(stop.x,stop.y),t.stroke(),t.closePath(),r&&this.drawSelectItemBorder(t,e,n,a),t=null}},save:function(t,e,n,a){var o=this;return Object(r["a"])(Object(i["a"])().mark((function r(){var s,c,l,u,d,h,f,m,p,v,b,g,w,x,y,k,C,S;return Object(i["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(dt(e)){i.next=2;break}throw"artboardPreviewPath is empty";case 2:return i.next=4,Ei(e+"?r="+Math.random());case 4:if(s=i.sent,c=a>=n.length-1?n:n.slice(0,a+1),0!==c.length){i.next=8;break}throw"没有截图操作信息";case 8:return l=[],u=[t],c.forEach((function(t){var e,i=t.action;switch(i){case oi.Brush:case oi.Rectangle:case oi.Ellipse:case oi.Arrow:case oi.Text:var r=o.getHistoryTagetWithDragOn(n,t,a);if(r){if(r.action===oi.Deleted)return;e=r.dragOffset}var s=new ee;s.set(t.eventRect.x,t.eventRect.y,t.eventRect.width,t.eventRect.height),e&&(s.x+=e.x,s.y+=e.y),l.push({target:t,offset:e}),u.push(s);break}})),d=Mi(u),h=new di(-d.x,-d.y),i.prev=13,m=2,f=document.createElement("canvas"),p=function(t){return t*m},f.width=p(d.width),f.height=p(d.height),v=500,b=Math.round(d.height/d.width*v),f.style.cssText="top:-10000px;left:0;width:".concat(v,"px;height:").concat(b,"px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;"),document.body.appendChild(f),g=f.getContext("2d"),g.fillStyle="#fafafa",g.fillRect(0,0,p(d.width),p(d.height)),w=new yi(s.width,s.height),g.drawImage(s,0,0,w.width,w.height,p(h.x+t.x),p(h.y+t.y),p(t.width),p(t.height)),x=!1,y=!1,k=new Pi,k.offset=new di,k.canvasScale=m,k.scale=1,k.sceneWidth=d.width,k.sceneHeight=d.height,C=new di,l.forEach((function(t){var e=t.target;switch(C.x=h.x,C.y=h.y,t.offset&&(C.x+=t.offset.x,C.y+=t.offset.y),e.action){case oi.Brush:var n=!1;o.drawBrush(g,e,k,x,y,C,n);break;case oi.Rectangle:o.drawRectangle(g,e,k,x,y,C);break;case oi.Ellipse:o.drawEllipse(g,e,k,x,y,C);break;case oi.Arrow:o.drawArrow(g,e,k,x,y,C);break;case oi.Text:o.drawText(g,e,k,x,y,C);break}})),i.next=41,Ni(f,"image/jpeg",.75);case 41:return i.abrupt("return",i.sent);case 42:return i.prev=42,f&&(S=f.parentNode,S&&S.removeChild(f)),i.finish(42);case 46:case"end":return i.stop()}}),r,null,[[13,,42,46]])})))()},getHistoryTagetWithDragOn:function(t,e,n){if(null==e)return null;if(e.action===oi.Move)return null;var i=e.dragOn;if(-1===i)return e;if(i>n)return e;var r,a=null;while(i<=n){var o=t[i];if(!o)return null;if(o.action!==oi.Move&&o.action!==oi.Deleted)return null;if(r=i,i=o.dragOn,-1===i)return o;if(i>n)return o;var s=t[i];if(!s)return o;if(s.action!==oi.Move&&s.action!==oi.Deleted)return o;if(s.dragFrom!==r)return o;a=o}return a}},ji="function"===typeof AbortController,Ri={},Vi=function(t){if(null!=t){var e=Ri[t];if(e){delete Ri[t];try{e()}catch(n){}}}};function Bi(t,e,n,i){return Ui.apply(this,arguments)}function Ui(){return Ui=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a){var o,s,c,l,u,d,h,f;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(r>0||null!=a)){t.next=43;break}if(Vi(a),!ji){t.next=27;break}return o=new AbortController,s=!1,c=!1,l=0,null!=a&&(Ri[a]=function(){c=!0,l>0&&clearTimeout(l);try{var t;null===(t=o)||void 0===t||t.abort()}catch(e){}o=null}),r>0&&(l=setTimeout((function(){s=!0,null!=a&&delete Ri[a];try{var t;null===(t=o)||void 0===t||t.abort()}catch(e){}o=null}),r)),t.prev=9,t.next=12,fetch(e,Object(Q["a"])(Object(Q["a"])({},n),{},{signal:o.signal}));case 12:u=t.sent,t.next=20;break;case 15:if(t.prev=15,t.t0=t["catch"](9),!s){t.next=19;break}throw"Timeout: 接口请求超时了";case 19:throw t.t0;case 20:return t.prev=20,l>0&&clearTimeout(l),!c&&delete Ri[a],t.finish(20);case 24:return t.abrupt("return",u);case 27:return d=0,h=[],f=!1,r>0&&h.push(new Promise((function(t,e){d=setTimeout((function(){f||e("Timeout: 接口请求超时了")}),r)}))),h.push(fetch(e,n)),null!=a&&h.push(new Promise((function(t,e){Ri[a]=function(){f=!0,d>0&&clearTimeout(d),delete Ri[a],e("Error: The user aborted a request.")}}))),t.prev=33,t.next=36,Promise.race(h);case 36:return t.abrupt("return",t.sent);case 37:return t.prev=37,d>0&&clearTimeout(d),!f&&delete Ri[a],t.finish(37);case 41:t.next=46;break;case 43:return t.next=45,fetch(e,n);case 45:return t.abrupt("return",t.sent);case 46:case"end":return t.stop()}}),t,null,[[9,15,20,24],[33,,37,41]])}))),Ui.apply(this,arguments)}var Hi=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Wi(e,Object(Q["a"])(Object(Q["a"])({},n),{},{method:"GET"}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Wi=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a,o,s,c;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return ht(n)||(n={}),r=n.timeout,null==r&&(r=0),(ht(n.body)||ut(n.body))&&(n.body=JSON.stringify(n.body)),Pn(e)&&(e="".concat(me,"/api/").concat(e)),a=n.abortKey,delete n.abortKey,t.next=9,Bi(e,Object(Q["a"])({method:"POST",credentials:void 0},n),r,a);case 9:o=t.sent,t.t0=o.status,t.next=200===t.t0?13:500===t.t0||403===t.t0?19:23;break;case 13:return t.next=15,o.text();case 15:if(s=t.sent,dt(s)){t.next=18;break}return t.abrupt("return","");case 18:return t.abrupt("return",gn(s));case 19:return t.next=21,o.text();case 21:throw c=t.sent,"[".concat(o.status,"] ").concat(c);case 23:throw"接口".concat(e,"请求失败");case 24:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),$i={T:"top",R:"right",B:"bottom",L:"left"},Gi={linear:"linear","ease-in":"ease-in","ease-out":"ease-out","ease-in-out":"ease-in-out"},zi={goToArtboard:"goToArtboard",overlay:"overlay",goBack:"goBack",speak:"speak",goUrl:"url",replace:"replace",goBackAndCloseAllOverlay:"goBackAndCloseAllOverlay",closeCurrentOverlay:"closeCurrentOverlay",getTypeName:function(t){switch(t){case zi.goBack:case zi.goBackAndCloseAllOverlay:return"返回";case zi.goToArtboard:return"跳转";case zi.closeCurrentOverlay:return"关闭";case zi.replace:return"替换";case zi.goUrl:return"链接";case zi.overlay:return"覆盖";default:return"未知"}}},Yi={none:"none",slideFromLeft:"slideFromLeft",slideFromRight:"slideFromRight",slideFromBottom:"slideFromBottom",slideFromTop:"slideFromTop",slideOutFromLeft:"slideOutFromLeft",slideOutFromRight:"slideOutFromRight",slideOutFromBottom:"slideOutFromBottom",slideOutFromTop:"slideOutFromTop",pushFromLeft:"pushFromLeft",pushFromRight:"pushFromRight",pushFromBottom:"pushFromBottom",pushFromTop:"pushFromTop",moveFromLeft:"moveFromLeft",moveFromRight:"moveFromRight",moveFromBottom:"moveFromBottom",moveFromTop:"moveFromTop",moveOutFromLeft:"moveOutFromLeft",moveOutFromRight:"moveOutFromRight",moveOutFromBottom:"moveOutFromBottom",moveOutFromTop:"moveOutFromTop"},Xi={tap:"tap",drag:"drag",time:"time",voice:"voice"},Ki={CENTER:"CENTER",TOP_LEFT:"TOP_LEFT",TOP_CENTER:"TOP_CENTER",TOP_RIGHT:"TOP_RIGHT",BOTTOM_LEFT:"BOTTOM_LEFT",BOTTOM_CENTER:"BOTTOM_CENTER",BOTTOM_RIGHT:"BOTTOM_RIGHT",MANUAL:"MANUAL"},qi=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=3,Hi(e,{timeout:1e4});case 3:if(n=t.sent,ht(n)){t.next=6;break}throw new Error("无法解析".concat(e,"的返回值:").concat(n));case 6:return t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function Qi(t,e){return"".concat(t,":").concat(e)}function Ji(t){var e={};return t.forEach((function(t){var n=t.artboard;e[Qi(n.fileType,n.guid)]=n})),e}function Zi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(ut(t)){var n=Ji(t);(ut(e)?e:t).forEach((function(t){tr(t.artboard,n)}))}}function tr(t,e){return er.apply(this,arguments)}function er(){return er=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a,o,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.pathInteraction,a=e.interactionInfo,r){t.next=6;break}return a.fetchState=Cn.Success,a.errMsg=null,a.data=null,t.abrupt("return");case 6:return a.fetchState=Cn.Fetching,a.errMsg=null,t.prev=8,t.next=11,qi(r);case 11:o=t.sent,s=e.fileType,rr(o,e),nr(o,s,n),a.data=o,a.fetchState=Cn.Success,t.next=25;break;case 19:t.prev=19,t.t0=t["catch"](8),a.fetchState=Cn.Error,a.errMsg=t.t0,a.data=null;case 25:case"end":return t.stop()}}),t,null,[[8,19]])}))),er.apply(this,arguments)}function nr(t,e,n){return ir.apply(this,arguments)}function ir(){return ir=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r){var a,o;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=null===e||void 0===e?void 0:e.interactions,ut(a)){t.next=3;break}return t.abrupt("return");case 3:o=e.renderInteractions=[],a.forEach((function(t){if(ht(t)&&ut(t.interactions)){var e=t.renderInteractions=[];t.interactions.forEach((function(t){if(ht(t)){switch(t.trigger_type){case Xi.tap:break;default:return}switch(t.type){case zi.goBack:case zi.closeCurrentOverlay:case zi.goBackAndCloseAllOverlay:case zi.goUrl:e.push(t);break;case zi.goToArtboard:case zi.overlay:case zi.replace:var i=t.toArtboard;if(!dt(i))return;var a=r[Qi(n,i)];t.toArtboardItem=a,e.push(t);break;default:return}var o=t.transition,s=t.animationType;if(s&&!o)switch(o=t.transition={duration:.3,easing:"linear"},s){case Yi.slideFromBottom:o.type="slide",o.fromSide="T";break;case Yi.slideFromLeft:o.type="slide",o.fromSide="R";break;case Yi.slideFromRight:o.type="slide",o.fromSide="L";break;case Yi.slideFromTop:o.type="slide",o.fromSide="B";break;default:o.type="dissolve";break}}})),e.length>0&&(t.renderTapInteraction=e.find((function(t){return t.trigger_type===Xi.tap})),o.push(t),t.mlIgnoreEvent=!1,t.mlIgnoreLeftSide=!1,t.mlIgnoreScene=!1)}}));case 5:case"end":return t.stop()}}),t)}))),ir.apply(this,arguments)}function rr(t,e){if(ht(t)){var n,i={artScale:null!==(n=ga(e.pageGuid,e.docGuid))&&void 0!==n?n:t.scale,fileType:null},r=t.interactions,a=t.artboardMap;switch(t.docGuid=e.docGuid,t.pluginPlatform){case"xd":i.fileType=u.XD,ut(r)&&r.forEach((function(t){zr(a,t,null,i)}));break;case"figma":i.fileType=u.FIGMA,zr(a,a,null,i),ut(r)&&r.forEach((function(t){t.reactions=t.interactions,delete t.interactions,zr(a,t,null,i)}));break;case"sketch":i.fileType=u.SKETCH;var o={};if(ut(r)&&r.forEach((function(t){o[t.guid]=t})),ht(a)){var s=["boundsInParent","globalBounds","frame","globalDrawBounds","globalBounds","boundsInArtboard","boundSameWithArtboard"],c=function t(e,n){var r;zr(a,e,n,i),null===(r=e.layers)||void 0===r||r.forEach((function(n){n&&(n.parentNode=e,t(n,e))}));var c=o[e.guid];c&&s.forEach((function(t){c[t]=e[t]}))};c(a,null)}break;default:throw new Error("lost pluginPlatform")}}}function ar(t,e){var n=new di(t.maxRect.x-t.rect.x,t.maxRect.y-t.rect.y),i=new di(e.maxRect.x-e.rect.x,e.maxRect.y-e.rect.y);return i.x-=n.x,i.y-=n.y,i}function or(t,e,n,i,r){var a,o=null===e||void 0===e?void 0:e.renderTapInteraction;if(!o)return null;var s,c,l=!1,u=!1;switch(o.type){case zi.goToArtboard:case zi.overlay:a=!1;break;case zi.goBack:case zi.goBackAndCloseAllOverlay:case zi.closeCurrentOverlay:a=!0;break;case zi.goUrl:u=!0;break;default:return null}var d=!0;if(s=Object(Q["a"])({},e.boundsInArtboard),a||u)c=Object(Q["a"])(Object(Q["a"])({},s),{},{width:1,height:1}),c.x+=80+s.width,c.y=c.y+Math.round(s.height/2)-40;else{if(!o.toArtboardItem)return;var h=o.toArtboardItem.pageGuid||o.toArtboardItem.docGuid;if(d=i===h,c=Object(Q["a"])({},o.toArtboardItem.boundsInParentForList),c.x-=n.x,c.y-=n.y,!d){var f=t.find((function(t){return t.guid===i||t.docGuid===i})),m=t.find((function(t){return t.guid===h||t.docGuid===h}));if(!f)return;if(null!=m){var p=ar(f,m);c.x-=p.x,c.y-=p.y}else l=!0,c=Object(Q["a"])(Object(Q["a"])({},s),{},{width:1,height:1}),c.x+=80+s.width,c.y=c.y+Math.round(s.height/2)-40}}var v=r?0:40,b={width:20,height:20},g=b.width,w=s.x+s.width,x=s.y+v,y=x+Math.round(s.height/2),k=c.x-g,C=c.y+v-5,S=C+Math.round(c.height/2),T=Math.abs(k-w)<b.width;T&&Math.abs(S-y)<2*b.height&&(y=x+Math.round(2*s.height/3)),T&&Math.abs(S-y)<2*b.height&&(S=C+Math.round(c.height/3));var A,I,F,M,O=k-w,_=S-y,L=O>0?1:-1,P=_>0?1:-1;if(1===L)I=y+P*_*.2,A=w+.3*O,M=S-.1*P*_,F=w+.66*O;else{var E=Math.abs(O),N=Math.abs(_);E=Math.max(.3*E,200),N=Math.max(.1*E,80),A=w+E,I=y+P*N,F=k-E,M=S-P*N}var D=(new ee).set(s.x,s.y+v,s.width,s.height),j={start:new di(w,y),p1:new di(A,I),p2:new di(F,M),end:new di(k+1,S)},R=u?"link":l?"otherpage":a?"back":"go",V=R+"_default",B=Object(Q["a"])(Object(Q["a"])({},b),{},{x:k,y:S-g/2,href:r?void 0:hr.urls[R],href_default:r?void 0:hr.urls[V],img:r?hr.imgs[R]:void 0,img_default:r?hr.imgs[V]:void 0});return{isBack:a,isOtherPage:l,drawRect:Mi([(new ee).set(D.x,D.y,D.width,D.height),(new ee).set(j.start.x,j.start.y,1,1),(new ee).set(j.p1.x,j.p1.y,1,1),(new ee).set(j.p2.x,j.p2.y,1,1),(new ee).set(j.end.x,j.end.y,1,1),(new ee).set(B.x,B.y,B.width,B.height)]),nodeRect:D,curve:j,arrowIcon:B,sameParent:d}}function sr(t,e,n,i){var r=or(t,e,n,i,!1);if(!r)return null;var a=r.nodeRect,o=r.curve;return r.nodeRect="M ".concat(a.x," ").concat(a.y," \n  l 0 ").concat(a.height,"\n  l ").concat(a.width," 0\n  l 0 -").concat(a.height,"\n  l -").concat(a.width," 0\n  Z"),r.curve="M ".concat(o.start.x," ").concat(o.start.y,"\n  C ").concat(o.p1.x,",").concat(o.p1.y,"\n    ").concat(o.p2.x,",").concat(o.p2.y,"\n  ").concat(o.end.x," ").concat(o.end.y),r}var cr="#1886FF",lr="#cdcdda",ur={otherpage:'<?xml version="1.0" encoding="UTF-8"?>\n  <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <g  stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g  transform="translate(-827.000000, -471.000000)">\n              <g  transform="translate(827.000000, 471.000000)">\n                  <rect  fill="#1886FF" x="0" y="0" width="20" height="20" rx="4"></rect>\n                  <g  transform="translate(5.000000, 5.000000)" stroke="#FFFFFF" stroke-linecap="round" stroke-linejoin="round">\n                      <path d="M3.18917988,0 L1.3,0 C0.582029825,3.53933586e-16 -3.09970593e-16,0.582029825 0,1.3 L0,8.7 C8.79259876e-17,9.41797017 0.582029825,10 1.3,10 L8.7,10 C9.41797017,10 10,9.41797017 10,8.7 L10,6.92115218 L10,6.92115218" ></path>\n                      <polyline  points="5.59135462 1.13732349e-13 10 1.13732349e-13 10 4.53043169"></polyline>\n                      <line x1="4.16417796" y1="5.7565608" x2="10" y2="1.13664457e-13" ></line>\n                  </g>\n              </g>\n          </g>\n      </g>\n  </svg>',link:'<?xml version="1.0" encoding="UTF-8"?>\n  <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-899.000000, -471.000000)">\n              <g transform="translate(899.000000, 471.000000)">\n                  <rect fill="#1886FF" x="0" y="0" width="20" height="20" rx="4"></rect>\n                  <path d="M13.0932433,4 C14.2116336,4.06761548 15.2120028,4.61417394 15.7234275,5.83688719 C16.2517123,7.07650431 16.0100501,8.23723671 15.1108418,9.24019965 C14.4645359,9.93889294 13.7676495,10.6037785 13.0932433,11.2630294 C12.8066207,11.5503952 12.3289163,11.5672991 12.076014,11.2968372 C11.8231117,11.0263752 11.8399719,10.6488555 12.1603148,10.3445858 C12.8234809,9.67970027 13.5035071,9.01481472 14.1610531,8.33865993 C15.1445622,7.31879311 14.7061981,5.70165623 13.3461457,5.34667496 C12.7672804,5.19454014 12.2277554,5.29596336 11.8006315,5.70165623 C11.1037451,6.34963791 10.440579,7.0483312 9.7493127,7.69067825 C9.59757131,7.82590921 9.36152914,7.9442363 9.17044739,7.92733243 C8.6590227,7.89352469 8.40612039,7.27935075 8.76580368,6.90746561 C9.53013069,6.10734911 10.2944577,5.34104034 11.1093652,4.59163544 C11.5814495,4.15213483 12.2446156,4 13.0932433,4 L13.0932433,4 Z M4,12.9308779 C4,12.0800498 4.30348278,11.3306449 4.89920824,10.716471 C5.56237432,10.0346815 6.2255404,9.36979599 6.89994658,8.71054507 C7.22028952,8.38937154 7.61369312,8.37246767 7.8834556,8.64292959 C8.15321807,8.93029537 8.13635791,9.29091126 7.79915482,9.61208479 C7.1528489,10.2600665 6.51216303,10.8855097 5.88271726,11.5334913 C5.1015301,12.3336078 5.06780979,13.4041863 5.78155633,14.1366873 C6.47844272,14.8353806 7.61369312,14.8353806 8.32743966,14.1366873 C8.99060574,13.4887056 9.61443146,12.8463586 10.2607374,12.1983769 C10.6485209,11.8095879 11.2442464,11.9617227 11.3454073,12.4688388 C11.3791276,12.6547814 11.311687,12.9308779 11.1768058,13.0661089 C10.4630592,13.8155138 9.76617285,14.5649187 8.98498569,15.2410735 C8.03519699,16.0749977 6.93366689,16.2102287 5.77593628,15.7031126 C4.69688639,15.2410735 4,14.1535912 4,12.9308779 L4,12.9308779 Z M12.6380192,8.06256339 C12.6042989,8.14708274 12.5537184,8.29921757 12.4356973,8.41754465 C11.1318454,9.74731575 9.83923352,11.0545484 8.51852142,12.3674156 C8.24875894,12.6378775 7.83849518,12.6209736 7.58559287,12.3674156 C7.31583039,12.0969537 7.33269055,11.7363378 7.61931317,11.4320681 L11.4802886,7.55544729 C11.6826104,7.35260085 11.9411328,7.2680815 12.2277554,7.38640859 C12.5031379,7.50473568 12.621159,7.69067825 12.6380192,8.06256339 Z" fill="#FFFFFF" fill-rule="nonzero"></path>\n              </g>\n          </g>\n      </g>\n  </svg>',back:'<?xml version="1.0" encoding="UTF-8"?>\n  <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-827.000000, -447.000000)">\n              <g transform="translate(827.000000, 447.000000)">\n                  <rect fill="#1886FF" x="0" y="0" width="20" height="20" rx="4"></rect>\n                  <g transform="translate(5.000000, 3.999689)" stroke="#FFFFFF" stroke-linecap="round" stroke-linejoin="round">\n                      <polyline transform="translate(2.988418, 2.988418) rotate(-45.000000) translate(-2.988418, -2.988418) " points="1.01650178 5.1015487 0.875287378 0.875287378 5.1015487 1.01650178"></polyline>\n                      <path d="M0.685919732,3.01908886 L6.50938891,3.01908886 C8.43720018,3.01908886 10,4.58188868 10,6.50969995 C10,8.43751123 8.43720018,10.000311 6.50938891,10.000311 L2.06828362,10.000311 L2.06828362,10.000311"></path>\n                  </g>\n              </g>\n          </g>\n      </g>\n  </svg>',go:'<?xml version="1.0" encoding="UTF-8"?>\n  <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-807.000000, -392.000000)">\n              <g transform="translate(807.000000, 392.000000)">\n                  <path d="M0,0 L16,0 C18.209139,-4.05812251e-16 20,1.790861 20,4 L20,16 C20,18.209139 18.209139,20 16,20 L0,20 L0,20 L0,0 Z" fill="#1886FF" transform="translate(10.000000, 10.000000) scale(-1, 1) translate(-10.000000, -10.000000) "></path>\n                  <polyline stroke="#FFFFFF" stroke-linecap="round" stroke-linejoin="round" transform="translate(8.000000, 10.000000) scale(-1, 1) rotate(-45.000000) translate(-8.000000, -10.000000) " points="4 14 4 6 12 6"></polyline>\n              </g>\n          </g>\n      </g>\n  </svg>',flowStartIcon:'<?xml version="1.0" encoding="UTF-8"?>\n  <svg width="16px" height="26px" viewBox="0 0 16 26" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-232.000000, -323.000000)">\n              <g transform="translate(240.000000, 336.000000) scale(-1, 1) translate(-240.000000, -336.000000) translate(232.000000, 323.000000)">\n                  <path d="M0,0 L16,0 L16,26 L4,26 C1.790861,26 2.705415e-16,24.209139 0,22 L0,0 L0,0 Z" fill="#1886FF" transform="translate(8.000000, 13.000000) scale(-1, 1) translate(-8.000000, -13.000000) "></path>\n                  <path d="M8.04115209,9 L12,12.8990659 L12,13.7290307 L11.012,13.729 L11.0126751,16.7147272 L9.01944469,16.7147272 L9.019,13.729 L7.026,13.729 L7.02621423,16.7147272 L5.03298378,16.7147272 L5.032,13.729 L4,13.7290307 L4,12.8990659 L8.04115209,9 Z" fill="#FFFFFF" transform="translate(8.000000, 12.857364) scale(-1, 1) translate(-8.000000, -12.857364) "></path>\n              </g>\n          </g>\n      </g>\n  </svg>'};function dr(t){return t=btoa(t),"data:image/svg+xml;base64,".concat(t)}var hr={urls:{},imgs:{},sizes:{}};function fr(t){var e=new Image;hr.imgs[t]=e,e.onload=function(e){var n,i,r=hr.sizes[t],a=e.target;r.width=null!==(n=a.naturalWidth)&&void 0!==n?n:a.width,r.height=null!==(i=a.naturalHeight)&&void 0!==i?i:a.height},e.src=hr.urls[t]}function mr(t){var e=ur[t];e&&(e=e.replace(new RegExp(cr,"ig"),lr),ur["".concat(t,"_default")]=e)}function pr(t){hr.urls[t]=dr(ur[t]),hr.sizes[t]=new yi}function vr(t){if(!t)return null;if(!t.flowStart)return null;var e=t.docName,n=t.flowName,i=t.fileType,r=t.pageName;return"原型起始画板\n来自文档: ".concat(e).concat(u.getFileExt(i)).concat(dt(r)?"/".concat(r):"").concat(dt(n)?"\n自定义标签名: ".concat(n):"")}["otherpage","go","back","link"].forEach((function(t){mr(t)})),Object.keys(ur).forEach((function(t){pr(t),fr(t)}));n("36db");function br(t,e,n){if(e.width<=n||e.height<=n)t.fillRect(e.x,e.y,e.width,e.height);else{var i=new di(e.x+n,e.y),r=new di(e.x+e.width,e.y),a=new di(e.x+e.width,e.y+e.height),o=new di(e.x,e.y+e.height),s=new di(e.x,e.y);t.beginPath(),t.moveTo(i.x,i.y),t.arcTo(r.x,r.y,a.x,a.y,n),t.arcTo(a.x,a.y,o.x,o.y,n),t.arcTo(o.x,o.y,s.x,s.y,n),t.arcTo(s.x,s.y,i.x,i.y,n),t.fill()}}function gr(t,e,n){var i;e.guid||(e.guid=e.id),yr(e);var r=e.x,a=e.y,o=e.width,s=e.height;if(!e.absoluteBoundingBox){if(n){var c=n.globalBounds,l=c.x,u=c.y;r+=l,a+=u}e.absoluteBoundingBox=e.absoluteRenderBounds={x:r,y:a,width:o,height:s}}if(e.globalBounds=e.absoluteBoundingBox,e.globalDrawBounds=null!==(i=e.absoluteRenderBounds)&&void 0!==i?i:e.absoluteBoundingBox,e.boundsInParent=t==e?e.absoluteBoundingBox:{x:r,y:a,width:o,height:s},e.blendMode){var d=un[e.blendMode];d&&(e.blendMode=d)}Sr(t,e),kr(e,n),Pr(e),_r(e),Lr(e),Er(e),Nr(e),Ar(e),Ir(t,e)}var wr={isMask:!1,layoutAlign:"INHERIT",constrainProportions:!1,layoutPositioning:"AUTO",layoutGrow:0,blendMode:"PASS_THROUGH"},xr=Object.keys(wr);function yr(t){xr.forEach((function(e){void 0===t[e]&&(t[e]=wr[e])}))}function kr(t,e){if(e&&t.isMask){t.mlIgnoreScene=!0;var n=e.children;if(n&&!(n.length<1))for(var i=!1,r=t.absoluteBoundingBox,a=0,o=n.length;a<o;a++){var s=n[a];if(s!==t){if(i){if(s.isMask)break;if(!s.markedForExport){var c=s.absoluteBoundingBox,l=le(c,r);l&&(ne(l,c)||(c.x=l.x,c.y=l.y,c.width=l.width,c.height=l.height))}}}else i=!0}}}function Cr(t){if(!t)return null;var e;while(null!=(e=t.parentNode)){var n=e,i=n.clipsContent;if(i)return e;t=e}return null}function Sr(t,e){var n;if(!e.markedForExport){var i=null!==(n=Cr(e))&&void 0!==n?n:t,r=e.absoluteBoundingBox,a=le(r,i.absoluteBoundingBox);a&&(ne(a,r)||(r.x=a.x,r.y=a.y,r.width=a.width,r.height=a.height))}}function Tr(t){switch(t){case"BOTTOM":case"TOP":case"RIGHT":return t=t.substring(0,1),"B"===t?t="T":"T"===t&&(t="B"),t;default:return"L"}}function Ar(t){var e=t.reactions;if(ut(e)){var n=[];e.forEach((function(t){if(ht(t)){var e=t.action,i=t.trigger;if(ht(e)&&ht(i)){var r=i.delay,a=i.type;switch(a){case"MOUSE_DOWN":case"MOUSE_UP":case"ON_CLICK":a=Xi.tap;break;default:return void("number"!==typeof r&&(r=0))}var o,s=e.type,c=e.frameGuid,l=e.frameId,u=e.navigation,d=e.transition,h=e.overlayBackground,f=e.overlayBackgroundInteraction,m=e.overlayPositionType,p=e.url;if(dt(p)&&!/https?:\/\//i.test(p)&&(p="http://"+p),ht(h))try{h=Ft(_t(h)).value}catch(R){}switch(s){case"BACK":s=zi.goBackAndCloseAllOverlay;break;case"CLOSE":s=zi.closeCurrentOverlay;break;case"URL":s=zi.goUrl;break;case"NODE":if(!dt(c))return;switch(u){case"NAVIGATE":s=zi.goToArtboard;break;case"OVERLAY":s=zi.overlay;break;case"SWAP":s=zi.replace;break;default:return}break;default:return}if(ht(d)){var v,b,g=d.type,w=d.easing,x=d.duration,y=d.direction,k=!1;switch(g){case"MOVE_IN":v=Tr(y),g="move";break;case"MOVE_OUT":v=Tr(y),g="move_out";break;case"PUSH":v=Tr(y),g="push";break;case"SLIDE_IN":v=Tr(y),g="slide";break;case"SLIDE_OUT":v=Tr(y),g="slide_out";break;default:o=null,g="dissolve";break}if(ht(w)){var C=w.type,S=w.easingFunctionCubicBezier;switch(C){case"CUSTOM_CUBIC_BEZIER":b="cubic-bezier(".concat(S.x1,",").concat(S.y1,",").concat(S.x2,",").concat(S.y2,")"),k=!0;break;case"CUSTOM_SPRING":case"GENTLE":case"QUICK":case"BOUNCY":case"SLOW":b="ease-in-out",k=!0;break;case"EASE_IN_BACK":var T=.58,A=-.25,I=1,F=.42;b="cubic-bezier(".concat(T,", ").concat(A,", ").concat(I,", ").concat(F,")"),k=!0;break;case"EASE_OUT_BACK":var M=0,O=.58,_=.42,L=1.25;b="cubic-bezier(".concat(M,", ").concat(O,", ").concat(_,", ").concat(L,")"),k=!0;break;case"EASE_IN_AND_OUT_BACK":var P=.58,E=-.25,N=.42,D=1.25;b="cubic-bezier(".concat(P,", ").concat(E,", ").concat(N,", ").concat(D,")"),k=!0;break;case"EASE_IN":case"EASE_IN_AND_OUT":case"EASE_OUT":case"LINEAR":b=C.toLowerCase().replace(/_/g,"-").replace(/-and/g,"");break}}g&&(o={type:g,duration:x,fromSide:v,customEasing:k,easing:b})}var j={trigger_type:a,type:s,delay:r,toArtboard:c,toArtboardFigmaId:l,transition:o,overlayBackground:h,overlayBackgroundInteraction:f,overlayPositionType:m};s===zi.goUrl&&(j.toUrl=p),n.push(j)}}})),n.length>0&&(t.interactions=n)}}function Ir(t,e){var n=e.types={GraphicNode:1};switch(e.type){case"FRAME":t===e?n.Artboard=1:n.Group=1,e.clipsContent||(n.GroupVisibleOutChild=1);break;case"GROUP":n.Group=1;break;case"LINE":n.Line=1;break;case"TEXT":n.Text=1,jr(e);break;case"VECTOR":n.Path=1;break;case"COMPONENT":case"COMPONENT_SET":case"INSTANCE":n.Group=1,e.clipsContent||(n.GroupVisibleOutChild=1),"INSTANCE"===e.type&&(n.FigmaInstance=1,void 0===e.isExposedInstance&&(e.isExposedInstance=!1));break;case"BOOLEAN_OPERATION":n.Group=1;var i=e.children;(null===i||void 0===i?void 0:i.length)>0&&i.forEach((function(t){if(t){var e=t.fills;e&&e.length>0&&e.splice(0)}}));break;case"RECTANGLE":n.Rectangle=1;break}}function Fr(t){var e=Ft(t);return t=1===e.opacity?Lt(e).value:e.value,t}function Mr(t){if(t){t.cssStyle={data:{},style:{},render:{},nameSize:{}};var e=t.fills;if(ut(e)){e=t.fills=e.map((function(t){var e,n=!(null===(e=t)||void 0===e||!e.fromPage);return t=Or(t),t&&(t.fromPage=n),t})).filter((function(t){return!!t}));var n=function(e){var n,i=!(null===(n=e)||void 0===n||!n.fromPage);return e=Rt(e,!1,!1,t,null),e&&(e.fromPage=i),e},i=t.cssStyle.data.background=e.map(n).filter((function(t){return!!t})),r=i.find((function(t){return t&&!t.fromPage}));if(!r){var a=n({value:4282400832});a&&i.push(a)}if(e=t.cssStyle.data.background,e.length>0){var o,s=[];e.forEach((function(t){switch(t.type){case A.FillColor:var e=Fr(t.color);s.push({color:e,image:"linear-gradient(0deg,".concat(e,",").concat(e,")"),render:function(t,n,i){t.fillStyle=e,br(t,(new ee).set(i(n.x),i(n.y),i(n.width),i(n.height)),i(5))}});break;case A.RadialGradientFill:case A.DiamondGradientFill:o="radial-gradient(ellipse ".concat(t.scaleX," ").concat(t.scaleY," at ").concat(t.startX," ").concat(t.startY," ,").concat(t.colorStops.map((function(t){return"".concat(Fr(t.color)," ").concat(t.stop)})).join(","),")"),s.push({image:o,scaleX:Un(t.scaleX),scaleY:Un(t.scaleY),startX:Un(t.startX),startY:Un(t.startY),colorStops:t.colorStops.map((function(t){var e=Un(t.stop);if(!isNaN(e)){var n=Fr(t.color);return{stop:e,color:n}}})).filter((function(t){return!!t})),render:function(t,e,n){e=(new ee).set(n(e.x),n(e.y),n(e.width),n(e.height));var i=this.scaleX,r=this.scaleY,a=this.startX,o=this.startY,s=this.colorStops,c=Math.round(i*e.width),l=Math.round(r*e.height),u=e.x+Math.round(a*e.width),d=e.y+Math.round(o*e.height),h=t.createRadialGradient(u,d,0,u,d,Math.max(c,l));s.forEach((function(t){h.addColorStop(t.stop,t.color)})),t.fillStyle=h,br(t,e,n(5))}});break;case A.AngularGradientFill:o="conic-gradient(from ".concat(t.angle," at ").concat(t.startX," ").concat(t.startY," ,").concat(t.colorStops.map((function(t){return"".concat(Fr(t.color)," ").concat(t.stop)})).join(","),")"),s.push({image:o,angle:parseFloat(t.angle),startX:Un(t.startX),startY:Un(t.startY),colorStops:t.colorStops.map((function(t){var e=Un(t.stop);if(!isNaN(e)){var n=Fr(t.color);return{stop:e,color:n}}})).filter((function(t){return!!t})),render:function(t,e,n){e=(new ee).set(n(e.x),n(e.y),n(e.width),n(e.height));var i=this.colorStops,r=this.angle,a=this.startX,o=this.startY;a=e.x+a*e.width,o=e.y+o*e.height;var s=t.createConicGradient((r-90)*Math.PI/180,a,o);i.forEach((function(t){s.addColorStop(t.stop,t.color)})),t.fillStyle=s,br(t,e,n(5))}});break;case A.LinearGradientFill:o="linear-gradient(".concat(t.angle,",").concat(t.colorStops.map((function(t){return"".concat(Fr(t.color)," ").concat(t.stop)})).join(","),")"),s.push({image:o,endPoints:t.endPoints,colorStops:t.colorStops.map((function(t){var e=Un(t.stop);if(!isNaN(e)){var n=Fr(t.color);return{stop:e,color:n}}})).filter((function(t){return!!t})),render:function(t,e,n){e=(new ee).set(n(e.x),n(e.y),n(e.width),n(e.height));var i=Object(Z["a"])(this.endPoints,4),r=i[0],a=i[1],o=i[2],s=i[3],c=this.colorStops;r=Math.round(e.x+r*e.width),a=Math.round(e.y+a*e.height),o=Math.round(e.x+o*e.width),s=Math.round(e.y+s*e.height);var l=t.createLinearGradient(r,a,o,s);c.forEach((function(t){l.addColorStop(t.stop,t.color)})),t.fillStyle=l,br(t,e,n(5))}});break;case A.ImageFill:break}}));var c=s.length;c>0&&(o=s.map((function(t,e){var n=0===e;return n&&t.color?t.color:t.image})).reverse().join(","),t.cssStyle.render.backgrounds=s,t.cssStyle.style.background=o)}}}}function Or(t){var e,n;if(ut(t)){var i=[];return t.forEach((function(t){t=Or(t),t&&i.push(t)})),i}if(!t.visible)return null;var r={blendMode:null!==(e=un[t.blendMode])&&void 0!==e?e:t.blendMode};switch(t.type){case"SOLID":var a=t.color;if(!a)return null;r.value=_t(a,t.opacity);break;case"IMAGE":return r.imageFill=!0,r;case"GRADIENT_LINEAR":var o=t.gradientStops,s=t.opacity,c=t.gradientParams;if(!o||!c)return null;var l=c.start,u=c.end;if(!l||!u)return null;"number"===typeof c.cssAngle&&(r.angle=fn(c.cssAngle,2)+"deg");var d=r.colorStops=[];o.forEach((function(t){d.push({stop:t.position,color:{value:_t(t.color,s)}})})),r.endPoints=[l[0],l[1],u[0],u[1]];break;case"GRADIENT_RADIAL":case"GRADIENT_ANGULAR":case"GRADIENT_DIAMOND":var h=t.gradientStops,f=t.opacity,m=t.gradientParams;if(!h||!m)return null;var p,v=m.radius,b=m.center;if(!v||!b)return;switch(t.type){case"GRADIENT_RADIAL":p="gradientRadialTransform",m.cssAngle=fn((null!==(n=m.rotation)&&void 0!==n?n:0)+90,2);break;case"GRADIENT_ANGULAR":var g,w;p="gradientAngularTransform";var x=h[0],y=null!==(g=null===x||void 0===x?void 0:x.position)&&void 0!==g?g:0;0!=y&&(h.forEach((function(t){t.position-=y})),m.cssAngle+=fn(360*y,2));var k=h[h.length-1],C=null!==(w=null===k||void 0===k?void 0:k.position)&&void 0!==w?w:1;C<1&&x&&(null===k||void 0===k?void 0:k.color)!=x.color&&h.push({position:1,color:x.color});break;case"GRADIENT_DIAMOND":p="gradientDiamondTransform";break}r[p]={rotate:m.cssAngle,scaleX:v[0],scaleY:v[1],endR:1,startR:0},r.startX=b[0],r.startY=b[1],r.endPoints=[0,0,0,0];var S=r.colorStops=[];return h.forEach((function(t){S.push({stop:t.position,color:{value:_t(t.color,f)}})})),r}return r}function _r(t){var e=t.rotation,n=t.markedForExport;null==e||0===e||n||(e=fn(e,2),e=-e,t.boxTransform={rotation:e,flippedHorizontally:!1,flippedVertically:!1})}function Lr(t){var e,n,i,r=t.strokeWeight,a=t.strokeTopWeight,o=t.strokeBottomWeight,s=t.strokeLeftWeight,c=t.strokeRightWeight,l=t.strokeAlign,u=t.strokes,d=t.dashPattern,h=[];switch(l){case"INSIDE":e=I.Inside;break;case"OUTSIDE":e=I.Outside;break;default:e=I.Center;break}if(null!=a&&a===o&&a===s&&a===c?(n=a,i=null):(n=null!==r&&void 0!==r?r:a,null!=a&&(i=[a,c,o,s])),ut(u)&&u.length>0&&u.forEach((function(t){if(t&&t.visible){var r=Or(t);r&&h.push({stroke:r,strokePosition:e,strokeEnabled:!0,strokeWidth:n,strokeWidths:i,strokeDashArray:d})}})),h.length>0){var f=h[0];t.strokeArr=h,t.stroke=f.stroke,t.strokeEnabled=f.strokeEnabled,t.strokeWidth=f.strokeWidth,t.strokeWidthArr=f.strokeWidthArr,t.strokePosition=f.strokePosition,t.strokeDashArray=f.strokeDashArray}}function Pr(t){var e=t.fills;if(e&&0!==e.length){var n=[];e.forEach((function(t){t&&t.visible&&(t=Or(t),t&&n.unshift({fill:t,fillEnabled:!0}))})),n.length>0&&(t.fillArr=n,t.fillEnabled=!0,t.fill=n[0].fill)}}function Er(t){var e=t.cornerRadius,n=t.bottomLeftRadius,i=t.bottomRightRadius,r=t.topLeftRadius,a=t.topRightRadius;0!==e&&("number"===typeof e&&(void 0===n&&(n=e),void 0===i&&(i=e),void 0===r&&(r=e),void 0===a&&(a=e)),void 0!==n&&void 0!==i&&void 0!==r&&void 0!==a&&(t.cornerRadii={bottomLeft:n,bottomRight:i,topLeft:r,topRight:a}))}function Nr(t){var e=t.effects;if(ut(e)&&0!==e.length){var n=[],i=[],r=[];e.forEach((function(t){if(t&&t.visible)switch(t.type){case"BACKGROUND_BLUR":t.radius>=0&&n.push({visible:!0,blurAmount:t.radius,isBackgroundEffect:!0});break;case"LAYER_BLUR":t.radius>=0&&n.push({visible:!0,blurAmount:t.radius,isBackgroundEffect:!1});break;case"DROP_SHADOW":var e,a,o,s,c;i.push({visible:!0,x:null!==(e=null===(a=t.offset)||void 0===a?void 0:a.x)&&void 0!==e?e:0,y:null!==(o=null===(s=t.offset)||void 0===s?void 0:s.y)&&void 0!==o?o:0,blur:t.radius,spread:t.spread,showShadowBehindNode:t.showShadowBehindNode,color:{value:_t(t.color)},blendMode:null!==(c=un[t.blendMode])&&void 0!==c?c:t.blendMode});break;case"INNER_SHADOW":var l,u,d,h,f;r.push({visible:!0,x:null!==(l=null===(u=t.offset)||void 0===u?void 0:u.x)&&void 0!==l?l:0,y:null!==(d=null===(h=t.offset)||void 0===h?void 0:h.y)&&void 0!==d?d:0,blur:t.radius,spread:t.spread,showShadowBehindNode:t.showShadowBehindNode,color:{value:_t(t.color)},blendMode:null!==(f=un[t.blendMode])&&void 0!==f?f:t.blendMode});break}})),n.length>0&&(t.blurs=n),i.length>0&&(t.shadowArr=i,t.shadow=i[0]),r.length>0&&(t.innerShadowArr=r,t.innerShadow=r[0])}}var Dr=["fontSize","fontName","fontWeight","textDecoration","textCase","lineHeight","letterSpacing","fills","textStyleId","fillStyleId","listOptions","indentation","hyperlink"];function jr(t){var e,n,i,r;t.text=t.characters;var a=t.textSegments,o=ut(a);if(o&&a.length>0){var s=a[0];s&&Dr.forEach((function(e){void 0===t[e]&&(t[e]=s[e])}))}var c=t.lineHeight;if(c)if("number"===typeof c)t.lineSpacing=c;else switch(c.unit){case"AUTO":t.lineSpacing=0;break;case"PIXELS":t.lineSpacing=c.value;break;case"PERCENT":t.lineSpacing=c.value+"%";break}else t.lineSpacing=0;t.textAlign=null!==(e=null===(n=t.textAlignHorizontal)||void 0===n?void 0:n.toLowerCase())&&void 0!==e?e:"left";var l=null!==(i=null===(r=t.textAlignVertical)||void 0===r?void 0:r.toLowerCase())&&void 0!==i?i:"top";"top"!==l&&(t.textVerticalAlign=l);var u=[];o&&a.forEach((function(e){var n,i=null!==(n=Or(e.fills))&&void 0!==n?n:[];i.reverse();var r={fill:i.length>0?i[i.length-1]:{},fills:i,figmaFills:i.length>0?i.map((function(e){return Rt(e,!0,!1,t,null)})):void 0,textCase:e.textCase,charSpacing:e.letterSpacing&&0!==e.letterSpacing.value?"PIXELS"===e.letterSpacing.unit?e.letterSpacing.value:e.letterSpacing.value+"%":null,fontFamily:e.fontName.family,fontWeight:e.fontWeight,fontItalic:/italic/i.test(e.fontName.style)?"italic":"normal",fontSize:e.fontSize,underline:"UNDERLINE"===e.textDecoration,strikethrough:"STRIKETHROUGH"===e.textDecoration};r.text=e.characters,r.length=e.characters.length,null==r.fontWeight&&(r.fontWeight=400),r.fontWeightCss=r.fontWeight.toString(),r.fontStyle=r.fontWeight.toString(),r.fontItalic?r.fontStyle+=" "+r.fontItalic:r.fontItalic="normal",u.push(r)})),t.styleRanges=u}window.addEventListener("error",(function(t){var e=t.filename;if(e){var n=e.match(/marklion_artboard_id=(\w+)/);if(n&&(n=n[1],n)){e=e.replace(/\\/g,"/");var i=e.indexOf("/res/");-1!==i&&(e=e.substr(i+1)),i=e.indexOf("?"),-1!==i&&(e=e.substr(0,i)),e=decodeURIComponent(e);var r=Rr[n];r&&r(!1,"画板数据加载失败[".concat(e,"]"))}}}),!0),window.marklion_artboard=function(t,e){var n=null,i=null;if(arguments.length>2&&(n=arguments[0],t=arguments[1],e=arguments[2],arguments.length>3&&(i=arguments[3])),null!=t){var r=t._marklionBack,a=t._marklionCallId;if(r&&a){if(t._marklionBack=null,t._marklionCallId=null,Rr[a]=null,ut(n)){var o=n;n={},o.forEach((function(t){if(ht(t)){var e=t.name;dt(e)&&(n[e.toLowerCase()]=t.value)}}))}else if(ht(n)){var s=n;n={},Object.keys(s).forEach((function(t){n[t.toLowerCase()]=s[t]}))}r(!0,{artboard:e,linked:n,sizeMap:i})}}};var Rr={},Vr=1;function Br(t){return new Promise((function(e,n){var i=document.createElement("script"),r=function(t){t&&null!=t.parentNode&&setTimeout((function(){t&&null!=t.parentNode&&(t.parentNode.removeChild(t),t=null)}),200)};i._marklionBack=function(t,a){i._marklionBack=null,i._marklionCallId=null,t?e(a):n(a),r(i),i=null},i.addEventListener("error",(function(e){var n=e.target._marklionBack;n&&n(!1,"画板数据加载失败[".concat(t,"]"))})),i.addEventListener("load",(function(t){r(t.target)}));var a="marklion_".concat(Date.now(),"_").concat(Vr++);i._marklionCallId=a,i.src=t+"?marklion_artboard_id="+a,Rr[a]=i._marklionBack,document.body.appendChild(i)}))}function Ur(t,e,n,i){if(void 0===t.markedForExport&&(t.markedForExport=!1),null==t.mlOutputTime&&(t.mlOutputTime=Date.now()),n){var r,a,o,s,c,l,u;t.cid=n.cid,t.replies=n.replies,t.scale=n.scale,t.commentUpdateTime=n.commentUpdateTime;var d=n.boundsInParent||n.frame,h=t.boundsInParent||t.frame;d&&h&&(ge.inCloudMode?(h.x=d.x,h.y=d.y,h.width=d.width,h.height=d.height):(h.x=d.x,h.y=d.y)),t.pageGuid||(t.pageGuid=n.pageGuid),null==t.flowStart&&(t.flowStart=null!==(r=n.flowStart)&&void 0!==r&&r),null==t.flowName&&(t.flowName=null!==(a=n.flowName)&&void 0!==a?a:""),null==t.sectionId&&(t.sectionId=null!==(o=n.sectionId)&&void 0!==o?o:null),null==t.sectionInfo&&(t.sectionInfo=null!==(s=n.sectionInfo)&&void 0!==s?s:null),t.docName=null!==(c=t.docName)&&void 0!==c?c:n.docName,t.pageName=null!==(l=t.pageName)&&void 0!==l?l:n.pageName,t.fileType=null!==(u=t.fileType)&&void 0!==u?u:n.fileType,t.comments=n.comments,t.resNodeCount=n.resNodeCount,t.pathData=n.pathData,t.pathPreview=n.pathPreview,t.pathPreviewWebp=n.pathPreviewWebp,t.pathInteraction=n.pathInteraction,t.pathPreviewMini=n.pathPreviewMini,t.updaterName=n.updaterName,t.updateTimeStr=n.updateTimeStr,t.updateTimeTimes=n.updateTimeTimes,t.docGuid=n.docGuid,t.interactionInfo=n.interactionInfo,t.boundsInParentForList=n.boundsInParentForList,n.name&&(t.name=n.name)}else ge.inCloudMode&&(t.interactionInfo={fetchState:Cn.Normal,data:null,errMsg:null});ge.inCloudMode?(t.artboardPreviewPng=t.pathPreview,t.artboardPreviewWebp=t.pathPreviewWebp,t.artboardPreviewThumbPng=t.pathPreviewMini,t.artboardPreviewJS=null):t.artboardPath&&(t.artboardPath="res/".concat(encodeURIComponent(t.artboardPath)),t.artboardPreviewPng=t.artboardPath+"/preview.png",t.artboardPreviewWebp=null,t.artboardPreviewJS=t.artboardPath+"/preview.js",t.artboardPreviewThumbPng=t.artboardPath+"/preview.mini.png");var f=t.mlConfig;f||(f=t.mlConfig={});var m=f.scalesObj={};if(f.linked=e||{},f.sizeMap=i||{},ut(f.scales)){f.scales.forEach((function(t){m[t]=1}));var p=null;[2,3,1.5,1,4].forEach((function(t){null==p&&1===m[t]&&(p=t)})),f.previewScalePath=p?1===p?"":"@".concat(p,"x"):""}}var Hr=function(t){if(t){var e=t.guid;if(e)if(t.markedForExport){var n="".concat(ge.documentGuid,"_").concat(e),i=nn(n,!1);t.mlCustomName=Je(i)}else t.mlCustomName=null}};function Wr(t,e,n){n.mlUserSelectDown=!1,e.push(n);var i=n.mlConfig;i||(i=n.mlConfig={});var r=t.artboardPath;if(Le(t)){var a="".concat(n.exportPath).concat(t.mlConfig.previewScalePath,".png");i.pngPreview=_e(t,"".concat(r,"/png/"),a)}else if(Pe(t)){var o="".concat(n.exportPath).concat(t.mlConfig.previewScalePath,".webp");i.pngPreview=_e(t,"".concat(r,"/png/"),o)}else if(Ee(t)){var s="".concat(n.exportPath,".svg");i.svgPreview=_e(t,"".concat(r,"/svg/"),s)}else if(Ne(t)){var c="".concat(n.exportPath,".pdf");i.pdfPreview=_e(t,"".concat(r,"/svg/"),c)}}function $r(t){if(t){var e=t;while(null!=(e=e.parentNode))if(e.maskGroup)return e}}function Gr(t,e){if(e!==t&&1!==e.types.Artboard&&!e.markedForExport){var n=$r(e);if(n){var i=n.globalBounds,r=e.globalBounds;if(!te(i,r)){var a=le(i,r);a||(a=new ee);var o=r.x-a.x,s=r.y-a.y,c=e.boundsInArtboard,l=e.boundsInParent;c&&(c.x-=o,c.y-=s,c.width=a.width,c.height=a.height),l&&(l.x-=o,l.y-=s,l.width=a.width,l.height=a.height),r.x=a.x,r.y=a.y,r.width=a.width,r.height=a.height}}}}function zr(t,e,n,i){var r,a;void 0===e.markedForExport&&(e.markedForExport=!1),i||(i=t.mlConfig);var o,s,c=null!==(r=null===(a=i)||void 0===a?void 0:a.fileType)&&void 0!==r?r:null;switch(null==c&&(c=u.XD),c){case u.FIGMA:gr(t,e,n);break;case u.SKETCH:ii(t,e,n);break;case u.XD:var l=e.styleRanges;ut(l)&&l.length>0&&l.forEach((function(t){var e=t.fontStyle;if(dt(e)){var n=/(?:\s|^)(thin|hairline|extralight|ultralight|light|regular|book|roman|medium|semibold|demibold|black|heavy|extrabold|ultrabold|bold|bolder|lighter|medium|\d+)(?:\s|$)/i.exec(e);if(n)switch(t.fontWeight=n[1],t.fontWeight.toLowerCase()){case"thin":case"hairline":t.fontWeightCss="100";break;case"ultralight":case"extralight":t.fontWeightCss="200";break;case"light":t.fontWeightCss="300";break;case"regular":case"book":case"roman":case"normal":t.fontWeight="normal",t.fontWeightCss="400";break;case"medium":t.fontWeightCss="500";break;case"semibold":case"demibold":t.fontWeightCss="600";break;case"bold":t.fontWeightCss="700";break;case"extrabold":case"ultrabold":t.fontWeightCss="800";break;case"black":case"heavy":t.fontWeightCss="900";break;default:t.fontWeightCss=t.fontWeight}else t.fontWeight="Normal",t.fontWeightCss="400";n=/(?:\s|^)(italic|oblique)(?:\s|$)/i.exec(e),t.fontItalic=n?n[1].toLowerCase():"normal"}else t.fontWeight="Normal",t.fontWeightCss="400",t.fontItalic="normal"})),Gr(t,e);break}o=t.globalBounds,s=e.markedForExport?e.globalDrawBounds:e.globalBounds;var d=s.x-o.x,h=s.y-o.y,f=s.width,m=s.height;if(ge.inCloudMode){e.boundsInArtboardOrigin=(new ee).set(d,h,f,m);var p=i?i.artScale:1;(null==p||p<=0)&&(p=1),1!==p&&(d=ue(d,p,!1),h=ue(h,p,!1),f=ue(s.width,p,e.markedForExport),m=ue(s.height,p,e.markedForExport))}e.boundsInArtboard=(new ee).set(d,h,f,m),e.boundSameWithArtboard=t!==e&&e.boundsInArtboard.isSame(t.boundsInArtboard)}function Yr(t,e,n,i,r){var a=n.children||n.layers;a.forEach((function(a){if(a)if(a.parentNode=n,zr(t,a,n),Hr(a),a.markedForExport){if(Wr(t,r,a),e.push(a),i.push(a),ut(a.children||a.layers)){var o=[];Yr(t,e,a,o,r),a.children&&(a.children=o),a.layers&&(a.layers=o)}}else ut(a.children||a.layers)&&Yr(t,e,a,i,r),a.children=a.layers=null}))}function Xr(t,e,n,i){if(!i.markedForExport){var r=i.opacity;if(0!=r||null!=i.shadow||null!=i.innerShadow||null!=i.fill&&i.fillEnabled||null!=i.stroke&&i.strokeEnabled){var a=i.types;if(t){if(!ce(e.boundsInArtboard,i.boundsInArtboard))return i.mlIgnoreEvent=!0,void(i.mlIgnoreLeftSide=!0);if((i.type===v.Group||i.type===v.SymbolMaster)&&qn(n,i))return void(i.mlIgnoreEvent=!0);if(1===a.Group&&1==r&&null==i.shadow&&null==i.innerShadow&&(null==i.stroke||!i.strokeEnabled)&&(null==i.fill||!i.fillEnabled||i.fill.value))return void(i.mlIgnoreEvent=!0)}(!i.boundSameWithArtboard||1!==a.Group&&(1!==a.Path||null!=i.fill&&i.fillEnabled))&&(1!==r||1!==a.Path&&i.type!==v.HotSpot&&1!==a.RepeatGrid&&(1!==a.Group||i.maskGroup||a.FigmaInstance)&&(1!==a.SymbolInstance||i.maskGroup)||null!=i.shadow||null!=i.innerShadow||null!=i.fill&&i.fillEnabled||null!=i.stroke&&i.strokeEnabled)&&(1!==r||1!==a.Rectangle||null!=i.shadow||null!=i.innerShadow||null!=i.fill&&i.fillEnabled||null!=i.stroke&&i.strokeEnabled||!n||n.mlIgnoreEvent||!ne(n.boundsInArtboard,i.boundsInArtboard))||(i.mlIgnoreEvent=!0)}else i.mlIgnoreEvent=!0}}function Kr(t,e,n,i,r,a){zr(n,t,r),Hr(t);var o=t.markedForExport;o&&Wr(n,i,t);var s=t.children||t.layers;if(ut(s))if(o){var c=[];Yr(n,e,t,c,i),t.children=c}else s.forEach((function(r){r.parentNode=t,e.push(r);try{Kr(r,e,n,i,t,a),Xr(a,n,t,r)}finally{r.mlIgnoreEvent&&!r.mlIgnoreLeftSide&&(r.mlIgnoreLeftSide=!r.children||0===r.children.length)}}))}function qr(t){var e=0;while(null!=(t=t.parentNode))if(e++,t.types.Artboard)break;return e}var Qr=function(t,e){return new Promise((function(n,i){if(t.isLoaded)return n(t);if(t.isFetching)return i(t);var r=t.artboard,o=r.pathData||r.artboardPath+"/data.js";t.isLoaded=!1,t.isFetching=!0,t.isError=!1,Br(o).then((function(i){var o,s,c=i.artboard,l=i.linked,d=i.sizeMap,h=null!==(o=null===(s=c.mlConfig)||void 0===s?void 0:s.fileType)&&void 0!==o?o:u.XD,f=h===u.SKETCH;f&&Yn(c),Ur(c,l,r,d);var m=[c],p=[];Kr(c,m,c,p,null,f),de(c),t.artboard=c,c.nodeDepthIndex=0;var v=[],b=m.length,g=b-1,w={interactions:[]};if(m.forEach((function(t,e){if(a["a"].set(t,"nodeDepthIndex",qr(t)),ut(t.interactions)&&w.interactions.push(t),0!==e&&t.markedForExport&&!(e>=g)){for(var n=-1,i=e+1;i<=g;i++){var r=m[i];if(!r)break;if(r.markedForExport||!r.boundsInArtboard||!r.boundsInArtboard.isSame(t.boundsInArtboard))break;n=i}-1!==n&&v.push({from:e,to:n})}})),ge.inCloudMode){var x=Ji(e);nr(w,h,x)}v.length>0&&v.forEach((function(t){var e=t.from,n=t.to,i=m[e],r=m[n];m[e]=r,m[n]=i})),t.childs=m,t.exportNodes=p,t.isLoaded=!0,t.isFetching=!1,t.isError=!1,n(t)})).catch((function(e){t.isLoaded=!0,t.isError=!0,t.isFetching=!1,t.loadErrMsg=e,console.error("artboard load error",e),i(t)}))}))};function Jr(t){t=Object(Gn["a"])(t);var e={};return t.forEach((function(t){var n=e[t.docGuid];n||(n=e[t.docGuid]=[]),n.push(t)})),Object.keys(e).forEach((function(n){var i=e[n];if(1!==i.length){var r=i[0],a=r.docGuid,o=r.docName,s=r.fileType,c=[],l=[];if(i.forEach((function(t){c.push.apply(c,Object(Gn["a"])(t.arts)),ut(t.sections)&&t.sections.length>0&&l.push.apply(l,Object(Gn["a"])(t.sections))})),ge.inCloudMode){var u={arts:c,guid:a,name:o,fileType:s,docFullName:o,docGuid:a,docName:o,docSeparator:!0,sections:l};u.maxRect=Ae(c,l),u.rect=(new ee).set(0,0,u.maxRect.width,u.maxRect.height),t.push(u)}}else i[0].docSeparator=!0})),t.sort((function(t,e){return ke(t.docFullName,e.docFullName)})),t}function Zr(t,e,n,i){var r=i.orderDesc,a=i.sortType;if(a===D.Date)t.sort((function(t,i){n===N.Artboard&&(t=t.artboard,i=i.artboard);var a=t[e]>i[e]?1:-1;return r?-a:a}));else if(a===D.ArtboardRect&&n===N.Artboard){var o={},s=[];t.forEach((function(t){var e=t.artboard,n=e.docName,i=e.docGuid,r=e.pageGuid,a=e.pageName,c=r||i||"",l=a||n||"",u="".concat(n).concat(a?"/".concat(a):""),d=o[c];d||(d=o[c]={arts:[],guid:c,name:l,fileType:e.fileType,docFullName:u,docGuid:i,docName:n},s.push(d)),d.arts.push(e)})),o=null;var c=function(t,e){var n=t.boundsInParent||t.frame,i=e.boundsInParent||e.frame;if(t.updateTimeTimes>0&&e.updateTimeTimes>0){var r=(new ee).set(n.x,n.y,n.width,n.height),a=(new ee).set(i.x,i.y,i.width,i.height);if(r.isOverlap(a)){var o=t.updateTimeTimes-e.updateTimeTimes;if(Math.abs(o)>1500){if(o>0)return 1;if(o<0)return-1}}}var s=n.y,c=i.y,l=s-c;if(l>100)return 1;if(l<-100)return-1;var u=n.x,d=i.x,h=u-d;return 0===h?0===l?0:l>0?1:-1:h>0?1:-1};s.sort((function(t,e){var n=ke(t.docFullName,e.docFullName);return r?-n:n}));var l=0,u={};s.forEach((function(t){t.arts.sort((function(t,e){var n=c(t,e);return r?-n:n})),t.arts.forEach((function(t){u[t.cid]=l++}))})),t.sort((function(t,e){return u[t.artboard.cid]-u[e.artboard.cid]>0?1:-1}))}else t.sort((function(t,e){n===N.Artboard&&(t=t.artboard,e=e.artboard);var i=ke(t.name,e.name);return r?-i:i}))}function ta(t,e,n,i){var r=i.orderDesc,a=i.sortType;t.sort((function(t,i){return n===N.Artboard&&(t=t.artboard,i=i.artboard),t.rootId!==i.rootId||t.deepCount!==i.deepCount?0:(o=a===D.Date?t[e]>i[e]?1:-1:ke(t.name,i.name),r?-o:o);var o}))}function ea(t,e){ut(t.subFolders)?Zr(t.subFolders,"updateTimes",N.Folder,e):t.subFolders=[],ut(t.subFiles)?(t.subFiles.forEach((function(t){t.name=t.fileName+t.fileExt})),Zr(t.subFiles,"updateTimeTimes",N.File,e)):t.subFiles=[]}function na(t){var e=t.artboardSections,n=t.artboards;ht(e)&&(Object.keys(e).forEach((function(t){var n=gn(e[t]);ht(n)?e[t]=n:delete e[t]})),ut(n)&&n.forEach((function(t){if(t){var n=t.sectionId,i=t.fileType;if(n){var r=e["".concat(i,":").concat(n)];t.sectionInfo=r||null}else t.sectionId=t.sectionInfo=null}})))}function ia(t){ge.docsMinScale={},t.forEach((function(t){ra(t.artboard)}))}function ra(t){var e=t.boundsInParent,n=t.scale,i=t.docGuid,r=t.pageGuid;if(e&&(("number"!==typeof n||n<=0)&&(n=1),1!==n)){var a=r||i,o=ge.docsMinScale[a];null==o&&(o=1),o>n&&(ge.docsMinScale[a]=n)}}function aa(t,e){var n=t.artboard,i=e.artboard,r=n.boundsInParentForList||n.boundsInParent||n.frame,a=i.boundsInParentForList||i.boundsInParent||i.frame;if(n.updateTimeTimes>0&&i.updateTimeTimes>0){var o=(new ee).set(r.x,r.y,r.width,r.height),s=(new ee).set(a.x,a.y,a.width,a.height);if(o.isOverlap(s)){var c=n.updateTimeTimes-i.updateTimeTimes;if(Math.abs(c)>1500){if(c>0)return 1;if(c<0)return-1}}}var l=r.y,u=a.y,d=l-u;if(d>100)return 1;if(d<-100)return-1;var h=r.x,f=a.x,m=h-f;return 0===m?0===d?0:d>0?1:-1:m>0?1:-1}function oa(t){if(!ht(t))return!1;var e=t.fills,n=t.ver,i=t.types;return 1===(null===i||void 0===i?void 0:i.Section)||!("number"!==typeof n||n<1)&&(!(!ut(e)||e.length<1)&&null!=e.find((function(t){return!(!ht(t)||!t.visible)})))}function sa(t,e){if(t.splice(0),ge.inCloudMode){var n={},i={};return e.forEach((function(e){var r=e.artboard,a=r.docName,o=r.docGuid,s=r.pageGuid,c=r.pageName,l=r.sectionId,u=r.sectionInfo,d=r.updateTimeTimes,h=s||o||"",f=c||a||"",m="".concat(a).concat(c?"/".concat(c):"");wa(r);var p=n[h];if(p||(p=n[h]={arts:[],guid:h,name:f,fileType:r.fileType,docFullName:m,docGuid:o,docName:a,sections:[]},t.push(p)),p.arts.push(e),l&&oa(u)){var v=i[h];v||(v=i[h]={});var b=!v[l],g=!b&&v[l]<d;if(b||g){var w;if(v[l]=d,1===(null===(w=u.types)||void 0===w?void 0:w.Section)){if(g){var x=p.sections.findIndex((function(t){return t.guid===l}));-1!=x&&p.sections.splice(x,1)}return void p.sections.push(u)}var y=u.frame,k=u.parent,C=u.fills,S=u.page;ut(C)||(C=u.fills=[]);while(null!=k){var T,A=k,I=A.frame,F=A.fills;if(ht(I)&&(y.x+=I.x,y.y+=I.y),ut(F))(T=C).unshift.apply(T,Object(Gn["a"])(F));k=k.parent}if(ht(S)&&ut(S.fills)&&S.fills.forEach((function(t){ht(t)&&(t=Object(Q["a"])(Object(Q["a"])({},t),{},{fromPage:!0}),C.unshift(t))})),u.boundsInArtboard=u.boundsInParent=y,u.pageGuid=s,u.docGuid=o,u.types={Section:1},wa(u),Mr(u),g){var M=p.sections.findIndex((function(t){return t.guid===l}));-1!=M&&p.sections.splice(M,1)}p.sections.push(u)}}})),n=null,t.forEach((function(t){t.arts.sort(aa),t.maxRect=Ae(t.arts,t.sections),t.rect=(new ee).set(0,0,t.maxRect.width,t.maxRect.height)})),void t.sort((function(t,e){return ke(t.docFullName,e.docFullName)}))}if(e.forEach((function(t){var e=t.artboard;e.boundsInParentForList=e.boundsInParent})),ge.fileType==u.SKETCH||ge.fileType==u.FIGMA){var r={},a=ge.documentName,o=ge.documentGuid;return e.forEach((function(e){var n=e.artboard,i=n.pageGuid||"",s=n.pageName||a||"",c=r[i],l=s;c||(c=r[i]=[],t.push({arts:c,guid:i,name:s,fileType:ge.fileType,docFullName:l,docGuid:o,docName:a})),c.push(e)})),r=null,t.forEach((function(t){t.arts.sort(aa),t.maxRect=Ae(t.arts,null),t.rect=(new ee).set(0,0,t.maxRect.width,t.maxRect.height)})),void t.sort((function(t,e){return ke(t.docFullName,e.docFullName)}))}e.sort(aa);var s=ge.documentName,c=ge.documentGuid,l=c||"",d=s||"",h=u.XD,f="".concat(s).concat(u.getFileExt(h)),m={arts:e,guid:l,name:d,fileType:h,docFullName:f,docGuid:c,docName:s};m.arts.sort(aa),m.maxRect=Ae(m.arts,null),m.rect=(new ee).set(0,0,m.maxRect.width,m.maxRect.height),t.push(m)}function ca(t){var e=1;while(t){var n=t,i=n.opacity;null==i&&(i=1),e*=i,t=t.parentNode}return e}function la(t){return null==t&&(t=1),Math.round(100*t)+"%"}function ua(t){var e;if(!t)return"";var n=null!==(e=t.artboardCount+t.folderCount+t.fileCount)&&void 0!==e?e:0,i="number"===typeof t.fileCount,r="共 ".concat(n," 项");n>0&&(r+="：".concat(t.artboardCount," 画板，").concat(i?"".concat(t.fileCount," 文件，"):"").concat(t.folderCount," 文件夹"));var a="".concat(t.name,"\n").concat(r).concat(t.updateTimes?"\n最后更新：".concat(yt(t.updateTimes)):"");return a}function da(t){var e,n,i;return t?(null!==(e=t.artboardCount)&&void 0!==e?e:0)+(null!==(n=t.folderCount)&&void 0!==n?n:0)+(null!==(i=t.fileCount)&&void 0!==i?i:0):0}function ha(t){if(!t)return"";var e=(null===t||void 0===t?void 0:t.fileType)===V.Url;return"".concat(t.name,"\n文件大小: ").concat(Sn(t.fileSize)).concat(e?"\n链接到: ".concat(t.webLoc):"","\n提交者: ").concat(t.updaterName,"\n提交于: ").concat(yt(t.updateTimeTimes))}function fa(t){if(!t)return"";var e=t.comments,n=t.replies,i=t.updaterName,r=t.name,a=t.updateTimeTimes,o=(null!==e&&void 0!==e?e:0)+(null!==n&&void 0!==n?n:0);return"".concat(r,"\n提交者: ").concat(i,"\n提交于: ").concat(yt(a)).concat(o>0?"\n评论数: ".concat(o):"")}function ma(t){if(!t)return"";var e=t.updaterName,n=t.updateTimeTimes,i=t.updateTimes;return"".concat(kt(null!==n&&void 0!==n?n:i)," ").concat(e)}function pa(t,e){var n="";return e&&(n="".concat(t.updaterName," 提交于 ").concat(kt(t.updateTimeTimes),",")),"".concat(n,"双击查看 ").concat(t.name," 标注详情")}var va={count:0,loaded:0,resolve:null,initdata:[],artboards:null,defaultArtboardGuid:"",permission:!0,fileInfo:null,renderMode:U.Normal,folderNotFound:!1,folderInSpecify:!1,cloudNeedLogin:!1,cloudIsLogin:!1,cloudNickName:null,cloudUserEmail:null,cloudUserId:0,cloudUserIsDesigner:!1,cloudUserIsOwner:!1,cloudUserKey:null,cloudName:null,cloudKey:null,cloudVersion:null,cloudFolderUpdateTimes:null,cloudUserFolderSpecifyMemberAuthority:X.ReadWrite,documents:[]};function ba(t){if(va.loaded+=1,t&&t({current:va.loaded,count:va.count}),va.loaded>=va.count){var e=va.resolve;e&&(va.resolve=null,sa(va.documents,va.initdata),e())}}function ga(t,e){var n=t||e||"",i=ge.docsMinScale[n];return null==i&&(i=1),i}function wa(t){var e,n=ga(t.pageGuid,t.docGuid),i=t.boundsInParent;i&&(e=Object(Q["a"])({},i)),e&&1!==n&&n>0&&(e.x=Math.round(e.x*n),e.y=Math.round(e.y*n),e.width=Math.ceil(e.width*n),e.height=Math.ceil(e.height*n)),t.boundsInParentForList=e}function xa(t,e){var n={count:0,loaded:0,resolve:null,artboards:null,defaultArtboardGuid:"",permission:!0,fileInfo:null,folderNotFound:!1,folderInSpecify:!1,cloudNeedLogin:!1,cloudIsLogin:!1,cloudNickName:null,cloudUserEmail:null,cloudUserId:0,cloudUserIsDesigner:!1,cloudUserIsOwner:!1,cloudUserKey:null,cloudName:null,cloudKey:null,cloudVersion:null};va.documents.splice(0),va.initdata.splice(0),Object.keys(n).forEach((function(t){va[t]=n[t]})),ht(t)||(t={artboards:[],guid:"No Data",name:"No Data",config:{guid:"",scales:[1,1.5,2,3,4],compressPNG:!0,supportFileProtocol:!1,platform:0}}),null==t.fileType&&(t.fileType=u.XD);var i,r=t.cloudData;if(ge.docsMinScale={},ge.initTitle=document.title,ge.inCloudMode=ht(r),ge.fileType=t.fileType,ge.inCloudMode){var a,o,s;if(ge.documentGuid=r.folderId.toString(),ge.documentName=r.folderName,ge.config={guid:ge.documentGuid,scales:[1,1.5,2,3,4],compressPNG:!0,supportFileProtocol:!0,platform:0},va.defaultArtboardGuid=r.artboardGuid,va.parentFolder=r.parent,va.currentFolderId=r.folderId,r.fileInfo)r.fileInfo.name="".concat(r.fileInfo.fileName).concat(null!==(o=r.fileInfo.fileExt)&&void 0!==o?o:"");if(va.fileInfo=r.fileInfo,va.renderMode=null!==(a=r.renderMode)&&void 0!==a?a:U.Normal,ge.cloudFolderId=r.folderId,va.permission=r.permission,va.folderNotFound=r.folderNotFound,va.folderInSpecify=r.folderInSpecify,va.cloudNeedLogin=r.needLogin,va.cloudIsLogin=r.isLogin,va.cloudNickName=r.nickName,va.cloudUserEmail=r.email,va.cloudUserId=r.userId,va.cloudUserIsDesigner=r.isDesigner,va.cloudUserIsOwner=!!r.isOwner,ge.userKey=va.cloudUserKey=r.userKey,va.cloudName=r.cloudName,ge.cloudKey=va.cloudKey=r.cloudKey,va.cloudVersion=r.cloudVersion,ht(r.folderInfo))i=r.folderInfo.artboards,va.cloudFolderUpdateTimes=r.folderInfo.updateTimes,va.cloudUserFolderSpecifyMemberAuthority=null!==(s=r.folderInfo.userSpecifyMemberAuthority)&&void 0!==s?s:X.ReadWrite,va.subFolders=r.folderInfo.folders,va.subFiles=r.folderInfo.files,na(r.folderInfo)}else switch(ge.userKey=null,ge.cloudKey=null,ge.documentGuid=t.guid,ge.documentName=t.name,ge.config=t.config,t.fileType){case u.SKETCH:case u.FIGMA:var c=t.pages;i=[],ut(c)&&c.forEach((function(t){t&&ut(t.artboards)&&t.artboards.forEach((function(e){e&&(e.pageGuid=t.guid,e.pageName=t.name,i.push(e))}))}));break;default:i=t.artboards;break}ea(va,e),ut(i)||(i=[]),va.artboards=i,va.count=i.length}var ya={dataInit:xa,get inCloudMode(){return ge.inCloudMode},get documentName(){return ge.documentName},get documentGuid(){return ge.documentGuid},get config(){return ge.config},get permission(){return va.permission},get cloudNeedLogin(){return va.cloudNeedLogin},get cloudIsLogin(){return va.cloudIsLogin},get cloudNickName(){return va.cloudNickName},get cloudUserEmail(){return va.cloudUserEmail},get cloudUserId(){return va.cloudUserId},get cloudUserIsDesigner(){return va.cloudUserIsDesigner},get cloudUserIsOwner(){return va.cloudUserIsOwner},get cloudUserKey(){return va.cloudUserKey},get cloudName(){return va.cloudName},get cloudKey(){return va.cloudKey},get cloudVersion(){return va.cloudVersion},get documentArtboards(){return va.initdata},get documents(){return va.documents},cloud:{get folderInSpecify(){return va.folderInSpecify},get folderNotFound(){return va.folderNotFound},get defaultArtboardGuid(){return va.defaultArtboardGuid},get parentFolder(){return va.parentFolder},get currentFolderId(){return va.currentFolderId},get subFolders(){return va.subFolders},get subFiles(){return va.subFiles},get renderMode(){return va.renderMode},get fileInfo(){return va.fileInfo},get folderUpdateTimes(){return va.cloudFolderUpdateTimes},get userFolderSpecifyMemberAuthority(){return va.cloudUserFolderSpecifyMemberAuthority}},allArtboardLoadChecked:function(t){return new Promise((function(e){0!==va.count?(va.resolve=e,va.artboards.forEach((function(e){Ur(e),de(e);var n={artboard:e,childs:[],exportNodes:[],loadErrMsg:null,isLoaded:!1,isFetching:!1,isError:!1,mlUserSelectDown:!0,removed:!1};if(va.initdata.push(n),ge.inCloudMode)return ra(e),void ba(t);Qr(n,[]).catch((function(t){var e=va.initdata.findIndex((function(e){return e===t}));-1!==e&&va.initdata.splice(e,1)})).finally((function(){ba(t)}))}))):e()}))}};n("e5b3");var ka,Ca=n("7736"),Sa={device:{android:/([ ;/)(,]|^)Android([ ;/)(,]|$)/i,iphone:/([ ;/)(,]|^)iPhone([ ;/)(,]|$)/i,ipad:/([ ;/)(,]|^)ipad([ ;/)(,]|$)/i,ios:/([ ;/)(,]|^)ios([ ;/)(,]|$)/i,macos:/([ ;/)(,]|^)mac os([ ;/)(,]|$)/i,windows:/([ ;/)(,]|^)Windows([ ;/)(,]|$)/i,linux:/([ ;/)(,]|^)linux([ ;/)(,]|$)/i},maker:{mot:/([ ;/)(,]|^)mot([ ;/)(,]|$)/i},browser:{uc:/([ ;/)(,]|^)(UCBrowser|UCWEB)([ ;/)(,]|$)/i,safria:/([ ;/)(,]|^)Safari([ ;/)(,]|$)/i,aol:/([ ;/)(,]|^)aol([ ;/)(,]|$)/i,arora:/([ ;/)(,]|^)Arora([ ;/)(,]|$)/i,qqbrowser:/([ ;/)(,]|^)QQBrowser([ ;/)(,]|$)/i,mqqbrowser:/([ ;/)(,]|^)mQQBrowser([ ;/)(,]|$)/i,chrome:/([ ;/)(,]|^)(?:chrome|CriOS)([ ;/)(,]|$)/i,qq:/([ ;/)(,]|^)qq([ ;/)(,]|$)/i,microMessenger:/([ ;/)(,]|^)MicroMessenger([ ;/)(,]|$)/i,sogouMobileBrowser:/([ ;/)(,]|^)sogouMobileBrowser([ ;/)(,]|$)/i,baidubrowser:/([ ;/)(,]|^)baidubrowser([ ;/)(,]|$)/i,weibo:/([ ;/)(,]|^)weibo([ ;/)(,]|$)/i,firefox:/([ ;/)(,]|^)Firefox([ ;/)(,]|$)/i,baiduboxapp:/([ ;/)(,]|^)baiduboxapp([ ;/)(,]|$)/i,msie:/(?:[ ;/)(,]|^)(?:msie|rv)\s*:?\s*([\d.]+)/i,Edge:/(?:[ ;/)(,]|^)(?:Edge)\s*:?\s*([\d.]+)/i}},Ta={safria:"Safria"},Aa=function(t){if(!t)return"";var e=Sa.browser;if(e.uc.test(t))return"UC浏览器";if(e.aol.test(t))return"AOL";if(e.Edge.test(t))return"Edge";if(e.arora.test(t))return"Arora";if(e.sogouMobileBrowser.test(t))return"搜狗浏览器";if(e.baidubrowser.test(t))return"百度浏览器";if(e.baiduboxapp.test(t))return"手机百度";if(e.weibo.test(t))return"微博客户端";if(e.microMessenger.test(t))return Sa.device.windows.test(t)||e.qqbrowser.test(t)?"微信电脑端":"微信手机端";if(e.qq.test(t))return"手机QQ";if(e.mqqbrowser.test(t))return"QQ浏览器";if(e.firefox.test(t))return"Firefox";if(e.chrome.test(t))return"Chrome";if(e.safria.test(t))return Ta.safria;var n=e.msie.exec(t);return n?"IE"+n[1]:"Other"},Ia={android:"Android",iPhone:"iPhone",iPad:"iPad",iOS:"iOS",macOS:"macOS",windows:"Windows",linux:"Linux",other:"Other"},Fa=function(t){if(t){var e=Sa.device;if(e.android.test(t))return{name:Ia.android,type:"android"};if(e.iphone.test(t))return{name:Ia.iPhone,type:"ios"};if(e.ipad.test(t))return{name:Ia.iPad,type:"ios"};if(e.ios.test(t))return{name:Ia.iOS,type:"ios"};if(e.macos.test(t))return{name:Ia.macOS,type:"ios"};if(e.windows.test(t))return{name:Ia.windows,type:"windows"};if(e.linux.test(t))return{name:Ia.linux,type:"linux"}}return{name:Ia.other,type:"other"}},Ma=function(t){if(void 0!==ka)return t(ka),void(t=null);var e=new Image,n=function(i){e.onerror=e.onload=null;var r=!(!i||"load"!==i.type)&&1==e.width;ka=r?Oa.Support:Oa.NotSupport,n=e=null,t(ka),t=null};e.onerror=n,e.onload=n,e.src="data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA="},Oa={Checking:0,NotSupport:1,Support:2},_a=function(){var t=navigator.userAgent,e=Fa(t);switch(e.name){case Ia.macOS:case Ia.iPhone:case Ia.iPad:case Ia.iOS:break;default:return!1}var n=Aa(t);return n===Ta.safria}(),La=Object(Ut["a"])((function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"X",0),Object(Ht["a"])(this,"Y",0),Object(Ht["a"])(this,"Width",0),Object(Ht["a"])(this,"Height",0),Object(Ht["a"])(this,"Down",null),Object(Ht["a"])(this,"Right",null),Object(Ht["a"])(this,"Used",!1)})),Pa=function(){function t(e,n){if(Object(Bt["a"])(this,t),Object(Ht["a"])(this,"Root",null),Object(Ht["a"])(this,"Margin",0),this.Margin=n,null!=e){e=Object(Gn["a"])(e);var i=0;e.forEach((function(t){i=Math.max(t.rect.width,i)})),e.unshift({rect:(new ee).set(0,0,i,-n)});var r=e.length,a=null,o=null,s=0,c=0,l=2*n;if(!(r>0)){var u=this.Root=new La;return u.Width=l,u.Height=l,u.X=n,void(u.Y=n)}o=e[0],s=o.rect.width+l,c=o.rect.height+l;var d=this.Root=new La;d.Width=s,d.Height=c,d.X=n,d.Y=n;for(var h=0;h<r;h++){o=e[h],s=o.rect.width+n,c=o.rect.height+n,a=this.findNode(this.Root,s,c);var f=null;f=null!=a?this.splitNode(a,s,c):this.growNode(s,c),f&&(o.rect.x=f.X-n,o.rect.y=f.Y-n,o.rect.width=f.Width-n,o.rect.height=f.Height-n)}}}return Object(Ut["a"])(t,[{key:"compareMaxSide",value:function(t,e){var n;return n=this.compareMax_WH(t,e),0!=n?n>0?1:-1:(n=this.compareHeight_Width(t,e),0!=n?n>0?1:-1:1)}},{key:"compareMax_WH",value:function(t,e){var n=Math.max(e.rect.width,e.rect.height)-Math.max(t.rect.width,t.rect.height);return n}},{key:"compareHeight_Width",value:function(t,e){var n=this.compareHeight(t,e);return 0!=n?n>0?1:-1:this.compareWidth(t,e)}},{key:"compareWidth",value:function(t,e){return e.rect.width-t.rect.width}},{key:"compareHeight",value:function(t,e){return e.rect.height-t.rect.height}},{key:"findNode",value:function(t,e,n){if(null==t)return null;if(t.Used){var i=this.findNode(t.Right,e,n);return null!=i?i:this.findNode(t.Down,e,n)}return e<=t.Width&&n<=t.Height?t:null}},{key:"splitNode",value:function(t,e,n){t.Used=!0;var i=t.Right=new La;i.X=t.X+e,i.Y=t.Y,i.Width=t.Width-e,i.Height=n;var r=t.Down=new La;return r.X=t.X,r.Y=t.Y+n,r.Width=t.Width,r.Height=t.Height-n,t}},{key:"growNode",value:function(t,e){var n=!1;t<=this.Root.Width&&(n=!0);var i=!1;e<=this.Root.Height&&(i=!0);var r=i&&this.Root.Height>=this.Root.Width+t,a=n&&this.Root.Width>=this.Root.Height+e;return r?this.growRight(t,e):a?this.growDown(t,e):i?this.growRight(t,e):n?this.growDown(t,e):null}},{key:"growRight",value:function(t,e){var n=this.Root,i=this.Root=new La;i.Used=!0,i.Width=n.Width+t,i.Height=n.Height,i.Y=this.Margin,i.X=this.Margin,i.Down=n;var r=i.Right=new La;r.X=n.Width,r.Width=t,r.Height=n.Height,r.Y=this.Margin;var a=this.findNode(this.Root,t,e);return null!=a?this.splitNode(a,t,e):null}},{key:"growDown",value:function(t,e){var n=this.Root,i=this.Root=new La;i.Used=!0,i.Width=n.Width,i.Height=n.Height+e,i.Y=this.Margin,i.X=this.Margin,this.Root.Right=n;var r=this.Root.Down=new La;r.Y=n.Height,r.Width=n.Width,r.Height=e,r.X=this.Margin;var a=this.findNode(this.Root,t,e);return null!=a?this.splitNode(a,t,e):null}}]),t}(),Ea=Object(Ut["a"])((function t(e){var n=e.name,i=void 0===n?null:n,r=e.list,a=void 0===r?null:r;Object(Bt["a"])(this,t),Object(Ht["a"])(this,"name",null),Object(Ht["a"])(this,"list",null),Object(Ht["a"])(this,"type",Na.Group),this.name=i,this.list=a})),Na={Group:0,Web:1,Mobile:2,Custom:3},Da=Object(Ut["a"])((function t(e){var n=e.name,i=void 0===n?null:n,r=e.width,a=void 0===r?0:r,o=e.height,s=void 0===o?0:o,c=e.type,l=void 0===c?Na.Mobile:c,u=e.hasBangs,d=void 0!==u&&u,h=e.iosDynamicIsland,f=void 0!==h&&h;Object(Bt["a"])(this,t),Object(Ht["a"])(this,"name",null),Object(Ht["a"])(this,"type",Na.Mobile),Object(Ht["a"])(this,"width",0),Object(Ht["a"])(this,"height",0),Object(Ht["a"])(this,"hasBangs",!1),Object(Ht["a"])(this,"iosDynamicIsland",!1),this.name=i,this.type=l,this.width=a,this.height=s,this.hasBangs=d,this.iosDynamicIsland=f})),ja=[new Da({name:"Web",type:Na.Web}),new Ea({name:"iPhone",list:[new Da({name:"iPhone 14/15 Pro Max",width:430,height:932,hasBangs:!1,iosDynamicIsland:!0}),new Da({name:"iPhone 14/15 Pro",width:393,height:852,hasBangs:!1,iosDynamicIsland:!0}),new Da({name:"iPhone 13 Pro Max",width:428,height:926,hasBangs:!0}),new Da({name:"iPhone 13 Pro",width:428,height:844,hasBangs:!0}),new Da({name:"iPhone XR",width:414,height:896,hasBangs:!0}),new Da({name:"iPhone X",width:375,height:812,hasBangs:!0}),new Da({name:"iPhone 8 plus",width:414,height:736}),new Da({name:"iPhone SE",width:375,height:667})]}),new Ea({name:"Android",list:[new Da({name:"Google Pixel 6 Pro",width:412,height:891}),new Da({name:"OnePlus 9 Pro",width:412,height:919}),new Da({name:"HuaWei Mate40 Pro",width:448,height:924}),new Da({name:"XiaoMi 11",width:412,height:915}),new Da({name:"Oppo 11",width:360,height:780}),new Da({name:"Vivo 11",width:360,height:760})]}),new Da({name:"iPad",width:768,height:1024}),new Da({name:"自定义尺寸",type:Na.Custom})],Ra=function(){for(var t="iPhone X",e=0,n=ja.length;e<n;e++){var i=ja[e];if(i)switch(i.type){case Na.Group:var r,a=null===(r=i.list)||void 0===r?void 0:r.find((function(e){return(null===e||void 0===e?void 0:e.name)===t}));if(a)return a;break;default:if(i.name===t)return i}}return null}(),Va=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"historyList",[]),Object(Ht["a"])(this,"historyIndex",0),Object(Ht["a"])(this,"onpopstate",null),ct&&this.pushState(null)}return Object(Ut["a"])(t,[{key:"length",get:function(){return ct?Math.min(this.historyList.length,this.historyIndex+1):history.length}},{key:"state",get:function(){if(ct){var t=this.historyList[this.historyIndex];return t?t.state:null}return history.state}},{key:"href",get:function(){if(ct){var t,e=this.historyList[this.historyIndex];return e&&(null!==(t=e.href)&&void 0!==t)?t:""}return location.href}},{key:"replaceState",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(ct){var i=this.historyList,r=this.historyIndex,a=i.length;if(r!=a-1&&i.splice(r+1),n||(n=location.href),i.length>0){var o=i[i.length-1];o.state=t,o.href=n}else i.push({state:t,href:n});this.historyIndex=i.length-1}else n&&history.replaceState(t,e,n)}},{key:"pushState",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(ct){var i=this.historyList,r=this.historyIndex,a=i.length;return r!=a-1&&i.splice(r+1),n||(n=location.href),i.push({state:t,href:n}),void(this.historyIndex=i.length-1)}n&&history.pushState(t,e,n)}},{key:"go",value:function(t){if(ct){if(0===t)return;var e=this.historyList,n=this.historyIndex,i=this.onpopstate,r=e.length,a=t>0?Math.min(n+t,r-1):Math.max(0,n+t);if(n===a)return;this.historyIndex=a;var o=e[a];i&&i({state:o.state,marklion_href:o.href})}else history.go(t)}}]),t}(),Ba=new Va;function Ua(t,e){if(ge.inCloudMode&&ut(e)){var n={};e.forEach((function(t){t&&(t.boundsInParentForList=t.boundsInParent,Ur(t),de(t),n[t.cid]=t)}));var i=[];return t.forEach((function(t,e){if(t){var r=t.artboard;if(r){var a=r.cid,o=r.updateTimeTimes,s=n[a];if(s){var c=s.updateTimeTimes;o===c||i.push({type:G.Change,art:t,newArtboard:s,index:e}),delete n[a]}else i.unshift({type:G.Remove,art:t,index:e})}}})),Object.keys(n).forEach((function(t){i.push({type:G.Add,newArtboard:n[t]})})),i}}a["a"].use(Ca["a"]);var Ha,Wa=!1;function $a(){if(ge.inCloudMode&&history.pushState){var t=function(t){var e,n,i,r,a=t.state,o=t.marklion_href;if(ht(a))e=a.artboardGuid,n=a.nodeGuid,i=a.filterDocumentGuid,r=a.curArtboardExtral;else{var s=o||window.location.href,c=/\/(?:file|interaction)?viewer\/(\d+)(?:\/([\w-]+)(?:\/([\w-]+)\/)?)?/.exec(s);c?(e=c[2],n=c[3]):(n=null,e=null),i=ln("filterDoc")}if("none"!==i&&dt(i)){if(i){var l=Ka.state.sortDocumentsWithSketchDocument.find((function(t){return t.guid===i}));if(l){var u=Ka.state.documentArtboards.find((function(t){var n=t.artboard;return n.guid===e&&n.docGuid===l.guid||n.pageGuid===l.guid}));e&&!u&&(i=null)}else i=null}}else i=null;var d=null,h=null;e&&(d=Ka.state.documentArtboards.find((function(t){return t.artboard.guid===e})),d&&n&&(h=d.childs.find((function(t){return t.guid===n})))),Wa=!0,setTimeout((function(){Wa=!1}),50),d!=Ka.state.curArtboard&&Ka.commit("curArtboard",{artboard:d,extral:r}),h!=Ka.state.curNode&&Ka.commit("curNode",h),i!=Ka.state.filterDocumentGuid&&Ka.commit("setFilterDocumentGuid",i)};Ba.onpopstate=t,window.addEventListener("popstate",t)}}function Ga(){var t=Ka.state,e=t.cloudNeedLogin,n=t.inCloudMode,i=t.cloudIsLogin,r=t.cloud,a=t.curArtboard,o=t.cloudName,s="";n?(e&&!i||(r.folderInSpecify?s+="没有访问权限 - ":r.folderNotFound?s+="链接已失效 - ":r.renderMode==U.File&&null!=r.fileInfo?s+="".concat(r.fileInfo.name," - ").concat(ge.documentName," - "):s+=a?"".concat(a.artboard.name," - ").concat(ge.documentName," - "):"".concat(ge.documentName," - ")),o&&(s+="".concat(o," - "))):s+="".concat(ge.documentName," - "),document.title=s+ge.initTitle}function za(t){t.allArtboardLoadChecked&&(clearTimeout(Ha),Ha=setTimeout((function(){Ya(t)}),33))}function Ya(t){var e=t.curArtboard,n=t.curNode,i=t.filterDocumentGuid,r=t.curArtboardExtral;if(Ga(),ge.inCloudMode){if(t.cloudNeedLogin&&!t.cloudIsLogin||!t.permission)return;if(!history.pushState)return;if(Wa)return;var a,o,s,c=!1;switch(t.cloud.renderMode){case U.File:a="fileviewer";break;case U.Interaction:a="interactionviewer";break;default:a="viewer",c=!0;break}a="/".concat(a,"/").concat(ge.cloudFolderId,"/"),e&&(o=e.artboard.guid,a+="".concat(encodeURIComponent(o),"/")),n&&(s=n.guid,a+="".concat(encodeURIComponent(s),"/"));var l=!1,u=function(t,e){a+="".concat(l?"&":"?").concat(t,"=").concat(encodeURIComponent(e)),l=!0};i&&u("filterDoc",i);var d=Ba.href;if(d.indexOf(a)===d.length-a.length)return;var h={artboardGuid:o,nodeGuid:null,filterDocumentGuid:i,curArtboardExtral:r};if(c){var f=/\/(?:file|interaction)?viewer\/(\d+)(?:\/([\w-]+)(?:\/([\w-]+)\/)?)?/.exec(d),m={folderId:null,artboardGuid:null,filterDocumentGuid:null};if(f&&(m.folderId=+f[1],m.artboardGuid=f[2],m.filterDocumentGuid=ln("filterDoc",d),"none"!==m.filterDocumentGuid&&dt(m.filterDocumentGuid)||(m.filterDocumentGuid=null),m.folderId===ge.cloudFolderId&&m.artboardGuid===h.artboardGuid&&m.filterDocumentGuid===h.filterDocumentGuid))return void Ba.replaceState(h,null,a)}t.replaceInteractionCurrentState?(t.replaceInteractionCurrentState=!1,Ba.replaceState(h,null,a)):Ba.pushState(h,null,a)}else{var p,v="#";if(e&&(p=e.artboard.guid,v+="/artboard/".concat(p)),n&&(v+="/node/".concat(n.guid)),location.hash!==v){var b=/^#\/artboard\/([\w-]+)/.exec(location.hash),g={artboardGuid:null};if(b&&history.replaceState&&(g.artboardGuid=b[1],g.artboardGuid===p))return void history.replaceState(null,null,"".concat(location.origin).concat(location.pathname).concat(location.search).concat(v));location.hash=v}}}function Xa(t){var e;if(!t)return null;var n=t.cid;return null!==(e=Ka.state.documentArtboards.find((function(t){var e;return(null===t||void 0===t||null===(e=t.artboard)||void 0===e?void 0:e.cid)===n})))&&void 0!==e?e:null}var Ka=new Ca["a"].Store({state:{webViewHidden:On(),webViewFocus:!0,folderPrecis:{changeArtboards:[],showArtboardLogNow:0},config:null,allArtboardLoadChecked:!1,replaceInteractionCurrentState:!1,artboardLoadProgress:{current:0,count:1},documentGuid:null,documentName:null,curArtboard:null,curArtboardExtral:null,curNode:null,clickedNode:null,enterNode:null,enterArtboard:null,documentArtboards:[],renderDocumentArtboards:[],documents:[],sortDocumentsWithSketchDocument:[],renderDocuments:[],filterDocumentGuid:null,isSupportWebp:Oa.Checking,netdiskUploader:{linkbox:{visible:!1,data:null},filebox:{visible:!1,parentId:0}},scale:{artboard:1,list:1,resetList:0,resetArtboard:0,resetCenterWithRect:null,resetCenterArtboard:null},setting:{color:{items:["rgba","hex","ahex","hexa","hsla"],current:0},numberAutoRound:!1,exportBoxBackground:F.Transparent},platform:{type:s.WEB,customUnit:c.PX,customDocWidth:0},unitTemplate:{template:"",enable:!1},androidUseMipmap:"1"===nn("androidUseMipmap",!1),textTip:{visible:!1,text:"",handle:0},inMultDownMode:!1,inArtboardMultDownMode:!1,inOutput:!1,artboardMenu:{visible:!1,x:0,y:0,artboard:null},helper:{visible:!1,handle:0},inCloudMode:!1,permission:!0,cloudNeedLogin:!1,cloudIsLogin:!1,cloudNickName:null,cloudUserEmail:null,cloudUserId:0,cloudUserIsDesigner:!1,cloudUserIsOwner:!1,cloudUserKey:null,cloudName:null,cloudKey:null,cloudVersion:null,cloudListSort:{sortType:D.Name,orderDesc:!1},cloud:{folderNotFound:!1,folderInSpecify:!1,defaultArtboardGuid:"",parentFolder:null,currentFolderId:0,subFolders:[],subFiles:[],allFoldersBoxVisible:!1,renderMode:U.Normal,fileInfo:null,folderUpdateTimes:null,userFolderSpecifyMemberAuthority:X.ReadWrite},resetScaleSceneCenter:null,selectArtboardChanged:null,artRenderInCanvasMode:!0,artShowInListMode:!1,noviceGuide:{artShowInListMode:!1},artboardShowInteractionLine:!0,artboardInComment:"1"===nn("artboardInComment",!1),artboardCommentVisible:!1,pointCommentShowAlways:!1,editComment:{drawing:!1,instance:null,drawInfo:{action:oi.None,histories:[],historyIndex:-1,historyIndexChanges:0,colorIndex:2,fontSize:ci,brushSize:li.Normal,selectItem:null,enterItem:null},pointInfo:{preventPoint:{x:0,y:0,enable:!1},point:{x:0,y:0,enable:!1,pointIndex:0},instance:null}},imageViewer:{visible:!1,imgList:null,scale:0,currentIndex:0,resetScale:0},commentEditorVisibleId:0,userNotify:{cloudList:{},visible:!1,location:{top:120,right:0},sysTipIds:{},commentUpdateStates:{},cloudUsersByCloud:{}},autoIntoInfo:{commentId:0,commentArtboardId:0,isReply:!1},artboardDetail:{leftSideVisible:"1"===nn("leftside.visible",!1),comments:null,commentUsers:null,maxPointIndex:0,selectComment:null,notScrollList:!1,interactionSet:{hoverGuid:"",headerVisible:"0"!==nn("interaction.header.visible",!1),history:[],verticalAlign:q.Middle,backgroundColor:"#f5f5f5",rectAlwaysVisible:"0"!==nn("interaction.rect-always-visible",!1),pcDeviceSet:{name:"Web",type:Na.Web,width:0,height:0,isHorizontal:!1,hasBangs:!1,iosDynamicIsland:!1},overlayArtboards:[],gobackArtboard:null,gotoArtboard:null,goOverlayArtboard:null}},mobileInteraction:{listFetchState:Cn.Normal,listConfig:{sortType:D.Name,orderDesc:!1,renderType:j.All},searchText:"",controlVisible:!1,mobileSize:{width:0,height:0},scrollYCache:{}},netdiskFileUploadDatas:{}},mutations:{setFolderSubFile:function(t,e){if(t.inCloudMode&&ht(e)){var n=e.files,i=e.folderUpdateTimes;if(ut(n)){var r=t.cloud.subFiles,a=t.cloudListSort,o=t.cloud,s={};r.forEach((function(t,e){s[t.viewUrl]=e})),n.forEach((function(t){var e=s[t.viewUrl];if(null==e)r.push(t);else{var n=r[e];Object.keys(n).forEach((function(e){n[e]=t[e]}))}})),ea({subFiles:r,subFolders:[]},a),i>0&&(o.folderUpdateTimes=i)}}},removeArtboard:function(t,e){if(t.inCloudMode&&dt(e)){var n=t.documentArtboards,i=t.documents,r=-1,a=n.find((function(t,n){var i;return(null===t||void 0===t||null===(i=t.artboard)||void 0===i?void 0:i.guid)===e&&(r=n,!0)}));if(-1!==r){a.removed=!0,n.splice(r,1);var o=!1;ia(n),sa(i,n),t.sortDocumentsWithSketchDocument=Jr(i);var s=t.filterDocumentGuid;s&&!i.find((function(t){return t.docGuid===s||t.guid===s}))?this.commit("setFilterDocumentGuid",null):this.commit("setRenderDocuments"),o&&this.commit("setScale",{reset:!0}),Zi(n)}}},setFolderPrecis:function(t,e){if(t.inCloudMode&&ht(e)){e.folders||(e.folders=[]),e.artboards||(e.artboards=[]),e.files||(e.files=[]);var n=e.updateTimes,i=e.userSpecifyMemberAuthority,r=e.name,a=t.cloud,o=t.documentArtboards,s=t.documents;if(null!=n){a.folderUpdateTimes=n,t.documentName=r,null!=i&&(a.userFolderSpecifyMemberAuthority=i);var c=a.renderMode,l=a.subFolders,u=a.subFiles;if(c===U.Normal){l.splice(0);var d={subFolders:e.folders,subFiles:e.files};ea(d,t.cloudListSort),na(e),d.subFolders.length>0&&l.push.apply(l,Object(Gn["a"])(d.subFolders)),u.splice(0),d.subFiles.length>0&&u.push.apply(u,Object(Gn["a"])(d.subFiles))}var h=Ua(o,e.artboards),f=[];if((null===h||void 0===h?void 0:h.length)>0){var m=t.folderPrecis.changeArtboards,p={};m.forEach((function(t){p[t.cid]=1}));var v=!1;h.forEach((function(t){var e,n,i,r,a,s=null!==(e=t.newArtboard)&&void 0!==e?e:null===(n=t.art)||void 0===n?void 0:n.artboard;switch(s&&(i=s.cid,r=s.guid,a=s.name,i>0&&!p[i]&&(p[i]=1,m.push({cid:i,guid:r,name:a}))),t.type){case G.Change:var c=t.art,l=t.newArtboard;if(!v){var u=c.artboard,d=u.scale,h=u.boundsInParent,b=l.scale,g=l.boundsInParent;d==b&&ne(h,g)||(v=!0)}c.isError=!1,c.isFetching=!1,c.isLoaded=!1,c.loadErrMsg=null,c.artboard=l,c.removed=!1,f.push(c);break;case G.Remove:var w=t.index,x=t.art;x.removed=!0,o.splice(w,1),v=!0;break;case G.Add:var y=t.newArtboard,k={artboard:y,childs:[],exportNodes:[],loadErrMsg:null,isLoaded:!1,isFetching:!1,isError:!1,mlUserSelectDown:!0,removed:!1};o.push(k),v=!0,f.push(k);break}})),m.sort((function(t,e){return ke(t.name,e.name)})),ia(o),sa(s,o),t.sortDocumentsWithSketchDocument=Jr(s);var b=t.filterDocumentGuid;b&&!s.find((function(t){return t.docGuid===b||t.guid===b}))?this.commit("setFilterDocumentGuid",null):this.commit("setRenderDocuments"),v&&this.commit("setScale",{reset:!0}),Zi(o,f)}}}},setWebViewFocus:function(t,e){t.webViewFocus=e,qa()},setWebViewHidden:function(t,e){t.webViewHidden=e,qa()},setCloudListSortConfig:function(t,e){var n="cloudlist-item-sort",i=t.cloudListSort,r=t.cloud,a=!1;if(ht(e)){if(e.sortType===i.sortType&&null==e.orderDesc)e.orderDesc=!i.orderDesc;else if(e.sortType!==i.sortType&&null==e.orderDesc)switch(e.sortType){case D.Date:e.orderDesc=!0;break;default:e.orderDesc=!1;break}}else an(n),a=!0,e={sortType:D.Name,orderDesc:!1};Object.keys(e).forEach((function(t){void 0!==i[t]&&(i[t]=e[t])})),ea(r,i),a||rn(n,i)},setMobileInteractionListConfig:function(t,e){var n="m-interaction-list-config",i=t.mobileInteraction.listConfig,r=!1;ht(e)||(an(n),r=!0,e={sortType:D.Name,orderDesc:!1,renderType:j.All}),Object.keys(e).forEach((function(t){void 0!==i[t]&&(i[t]=e[t])})),r||rn(n,i)},setPCDeviceSet:function(t,e){if(ht(e)){var n=t.artboardDetail.interactionSet.pcDeviceSet;if(Object.keys(n).forEach((function(t){var i=e[t];void 0!==i&&(n[t]=i)})),n.type===Na.Mobile){var i=Math.max(n.width,n.height),r=Math.min(n.width,n.height);n.isHorizontal?(n.width=i,n.height=r):(n.width=r,n.height=i)}else n.type===Na.Custom&&(n.isHorizontal=n.width>n.height);rn("interaction.pcdeviceset",n)}},setInteractionRectAlwaysVisible:function(t,e){t.artboardDetail.interactionSet.rectAlwaysVisible!==e&&(t.artboardDetail.interactionSet.rectAlwaysVisible=e,rn("interaction.rect-always-visible",e?"1":"0"))},setInteractionBackground:function(t,e){t.artboardDetail.interactionSet.backgroundColor!==e&&(t.artboardDetail.interactionSet.backgroundColor=e,rn("interaction.background",e))},setInteractionHeaderVisible:function(t,e){t.artboardDetail.interactionSet.headerVisible!==e&&(t.artboardDetail.interactionSet.headerVisible=e,rn("interaction.header.visible",e?"1":"0"))},setInteractionArtboard:function(t,e){var n=this;return Object(r["a"])(Object(i["a"])().mark((function r(){var a,o,s,c,l,u,d,h,f,m,p,v,b,g,w,x,y,k,C,S,T,A,I,F,M,O,_,L;return Object(i["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e){i.next=2;break}return i.abrupt("return");case 2:if(a=t.artboardDetail.interactionSet,!(a.gotoArtboard||a.gobackArtboard||a.goOverlayArtboard)){i.next=5;break}return i.abrupt("return");case 5:o=a.overlayArtboards,s=null,c=t.cloud.renderMode===U.Interaction,l=e.type,l!==zi.overlay||c||(l=zi.goToArtboard),u=c&&(st||a.pcDeviceSet.type!==Na.Web),i.t0=l,i.next=i.t0===zi.replace?14:i.t0===zi.closeCurrentOverlay?38:i.t0===zi.goBackAndCloseAllOverlay?54:i.t0===zi.goBack?60:i.t0===zi.goToArtboard?88:i.t0===zi.overlay?110:i.t0===zi.goUrl?128:131;break;case 14:if(s=Xa(e.toArtboardItem),s){i.next=19;break}return n.commit("Tip_showTextTip",{text:"目标画板未上传到私有云"}),i.abrupt("return");case 19:if(0!==o.length){i.next=28;break}if(s.artboard.cid!==(null===(d=t.curArtboard)||void 0===d||null===(d=d.artboard)||void 0===d?void 0:d.cid)){i.next=23;break}return n.commit("Tip_showTextTip",{text:"目标画板和当前画板是同一个画板"}),i.abrupt("return");case 23:return t.replaceInteractionCurrentState=!0,e=Object(Q["a"])({},e),e.type=zi.goToArtboard,n.commit("setInteractionArtboard",e),i.abrupt("return");case 28:if(h=o[o.length-1],h.visible=!0,h.renderTapInteraction=e,h.artboard=s,!u){i.next=37;break}return a.goOverlayArtboard={renderTapInteraction:e,fromArtboard:s},i.next=36,be(1e3*((null===(f=e.transition)||void 0===f?void 0:f.duration)||0));case 36:a.goOverlayArtboard=null;case 37:return i.abrupt("break",133);case 38:if(c){i.next=41;break}return n.commit("Tip_showTextTip",{text:"关闭当前最顶部遮罩层"}),i.abrupt("return");case 41:if(0!==o.length){i.next=44;break}return n.commit("Tip_showTextTip",{text:"当前画板不是以遮罩层的形式打开的,关闭遮罩的命令无效"}),i.abrupt("return");case 44:if(m=o[o.length-1],!m.visible){i.next=52;break}if(m.visible=!1,!u){i.next=52;break}return a.goOverlayArtboard={renderTapInteraction:m.renderTapInteraction,fromArtboard:Xa(e.toArtboardItem)},i.next=51,be(1e3*((null===(p=m.renderTapInteraction.transition)||void 0===p?void 0:p.duration)||0));case 51:a.goOverlayArtboard=null;case 52:return o.splice(o.length-1),i.abrupt("return");case 54:if(c){i.next=57;break}return n.commit("Tip_showTextTip",{text:"返回到原型的上一个画板"}),i.abrupt("return");case 57:return o.length>0&&o.splice(0),n.commit("setInteractionArtboard",{type:zi.goBack}),i.abrupt("return");case 60:if(c){i.next=63;break}return n.commit("Tip_showTextTip",{text:"返回到原型的上一个画板"}),i.abrupt("return");case 63:if(!(o.length>0)){i.next=71;break}if(v=o[o.length-1],!v.visible){i.next=69;break}return v.visible=!1,i.next=69,be(1e3*((null===(b=v.renderTapInteraction.transition)||void 0===b?void 0:b.duration)||.3));case 69:return o.splice(0),i.abrupt("return");case 71:if(null!=Ba.state){i.next=74;break}return n.commit("Tip_showTextTip",{text:"没有可返回的上一个画板"}),i.abrupt("return");case 74:if(Ba.go(-1),g=t.curArtboardExtral,!ht(g)){i.next=87;break}if(w=g.renderTapInteraction,x=g.fromArtboard,!w||!x){i.next=87;break}if(!u){i.next=87;break}return a.gotoArtboard=null,a.goOverlayArtboard=null,a.gobackArtboard={renderTapInteraction:w,fromArtboard:t.curArtboard},i.next=86,be(1e3*((null===(y=w.transition)||void 0===y?void 0:y.duration)||.3));case 86:a.gobackArtboard=null;case 87:return i.abrupt("break",133);case 88:if(s=Xa(e.toArtboardItem),s){i.next=92;break}return n.commit("Tip_showTextTip",{text:"目标画板未上传到私有云"}),i.abrupt("return");case 92:if(C=s.artboard.cid,C!==(null===(k=t.curArtboard)||void 0===k?void 0:k.artboard.cid)){i.next=96;break}return n.commit("Tip_showTextTip",{text:"目标画板和当前画板是同一个画板"}),i.abrupt("return");case 96:if(S=t.mobileInteraction.scrollYCache,delete S[C],e=Object(Q["a"])({},e),delete e.toArtboardItem,!u){i.next=108;break}return a.gobackArtboard=null,a.goOverlayArtboard=null,a.gotoArtboard={renderTapInteraction:e,fromArtboard:s},i.next=107,be(1e3*((null===(T=e.transition)||void 0===T?void 0:T.duration)||.3));case 107:a.gotoArtboard=null;case 108:return n.commit("curArtboard",{artboard:s,extral:{renderTapInteraction:e,fromArtboard:t.curArtboard}}),i.abrupt("break",133);case 110:if(s=Xa(e.toArtboardItem),s){i.next=115;break}return n.commit("Tip_showTextTip",{text:"目标画板未上传到私有云"}),i.abrupt("return");case 115:if(e=Object(Q["a"])({},e),delete e.toArtboardItem,!(o.length>0)){i.next=121;break}if(F=o[o.length-1],(null===(A=F.artboard)||void 0===A?void 0:A.cid)!==(null===(I=s.artboard)||void 0===I?void 0:I.cid)){i.next=121;break}return i.abrupt("return");case 121:if(o.push({artboard:s,renderTapInteraction:e,visible:!0}),!u){i.next=127;break}return a.goOverlayArtboard={renderTapInteraction:e,fromArtboard:s},i.next=126,be(1e3*((null===(M=e.transition)||void 0===M?void 0:M.duration)||.3));case 126:a.goOverlayArtboard=null;case 127:return i.abrupt("break",133);case 128:return O=e,_=O.toUrl,_?(L=window.open(_),L.opener=null):n.commit("Tip_showTextTip",{text:"无法跳转网址,因为网址参数丢失了"}),i.abrupt("return");case 131:return n.commit("Tip_showTextTip",{text:"未知的原型操作,无法跳转"}),i.abrupt("return");case 133:case"end":return i.stop()}}),r)})))()},setRenderDocuments:function(t){var e,n=t.filterDocumentGuid;e=dt(n)?t.documents.filter((function(t){return t.guid===n||t.docGuid===n})):t.documents,e.forEach((function(e){e.maxRect=Ae(e.arts,t.inCloudMode?e.sections:null),e.rect=(new ee).set(0,0,e.maxRect.width,e.maxRect.height)})),e.length>1&&(new Pa(e,150),e.forEach((function(t){t.rect.width=t.maxRect.width,t.rect.height=t.maxRect.height}))),t.renderDocuments=e;var i=[];e.forEach((function(t){t&&ut(t.arts)&&t.arts.forEach((function(t){i.push(t)}))})),t.renderDocumentArtboards=i},setFilterDocumentGuid:function(t,e){if(t.filterDocumentGuid!=e){if(t.filterDocumentGuid=e,this.commit("setRenderDocuments"),e){var n=t.curArtboard;if(n){var i=n.artboard,r=i.docGuid,a=i.pageGuid;if(r!=e&&a!=e){var o=t.sortDocumentsWithSketchDocument.find((function(t){return t.guid==e})),s=null===o||void 0===o?void 0:o.arts[0];return void this.commit("curArtboard",{artboard:s})}}}za(t)}},setAllFoldersBoxVisible:function(t,e){t.cloud.allFoldersBoxVisible=e,e?sn(E,"1"):cn(E)},leftSideVisible:function(t,e){t.artboardDetail.leftSideVisible!==e&&(t.artboardDetail.leftSideVisible=e,rn("leftside.visible",e?"1":"0"))},pointCommentShowAlways:function(t,e){t.pointCommentShowAlways=e,rn("point-comment-showalways",e?"1":"0")},artboardCommentVisible:function(t,e){t.artboardCommentVisible=e},setSelectComment:function(t,e){e=e||{};var n=e,i=n.comment,r=n.notScrollList,o=n.openEditor,s=t.artboardDetail;i&&(t.artboardCommentVisible=!0),s.notScrollList=!!r,o&&(null===i||void 0===i?void 0:i.id)>0&&a["a"].set(i,"autoOpenEditor",!0),s.selectComment=i},setCommentEditorVisibleId:function(t,e){t.commentEditorVisibleId=e},setImageViewer:function(t,e){var n=t.imageViewer;ht(e)&&ut(e.imgList)&&e.imgList.length>0?(n.imgList=e.imgList.map((function(t){return{imgSrc:t,width:0,height:0}})),n.currentIndex="number"===typeof e.currentIndex&&e.currentIndex>=0&&e.currentIndex<e.imgList.length?e.currentIndex:0,n.visible=!0):(n.currentIndex=0,n.visible=!1,n.imgList=null)},startDraw:function(t,e){var n=t.editComment;n.drawing||(n.instance=e,n.drawing=!0)},setArtboardInComment:function(t,e){t.artboardInComment=e,rn("artboardInComment",e?"1":"0"),e?t.artboardCommentVisible=!0:t.artboardDetail.selectComment&&(t.artboardDetail.selectComment=null)},artboardShowInteractionLine:function(t,e){rn("list-interaction-line",e?"1":"0"),t.artboardShowInteractionLine=e},artShowInListMode:function(t,e){rn("art-in-list",e?"1":"0"),location.reload(!0),setTimeout((function(){t.artShowInListMode=e}),1e3)},artRenderInCanvasMode:function(t,e){rn("list-view-mode",e?"1":"0"),we.paused=!e,location.reload(!0),setTimeout((function(){t.artRenderInCanvasMode=e}),1e3)},selectArtboardChanged:function(t,e){t.selectArtboardChanged=e},resetScaleSceneCenter:function(t,e){t.resetScaleSceneCenter=e},isSupportWebp:function(t,e){t.isSupportWebp=e},artboardLoadProgress:function(t,e){if(ht(e)){var n=e.current,i=e.count;t.artboardLoadProgress.current=n,t.artboardLoadProgress.count=i}},allArtboardLoadChecked:function(t,e){t.allArtboardLoadChecked=e},setHelperVisible:function(t,e){var n=t.helper;clearTimeout(n.handle),e?n.visible=!0:n.handle=setTimeout((function(){n.visible=!1}),50)},setInOutput:function(t,e){t.inOutput=e},setAndroidUseMipmap:function(t,e){t.androidUseMipmap!==e&&(t.androidUseMipmap=e,rn("androidUseMipmap",e?"1":"0"))},setArtboardMenu:function(t,e){if(ht(e)){var n=e.visible,i=e.x,r=e.y,a=e.artboard,o=t.artboardMenu;null!=i&&(o.x=i),null!=r&&(o.y=r),null!=n&&(o.visible=n),!1===n?o.artboard=null:null!=a&&(o.artboard=a)}},setInMultDownMode:function(t,e){t.inMultDownMode=e},setInArtboardMultDownMode:function(t,e){t.inArtboardMultDownMode=e},Tip_showTextTip:function(t,e){var n=e.second,i=void 0===n?5:n,r=e.text,a=t.textTip;a.visible=!0,a.text=r,clearTimeout(a.handle),i>0&&(a.handle=setTimeout((function(t){clearTimeout(t.handle),t.handle=0,t.visible=!1}),1e3*i,a))},Tip_hideTextTip:function(t){var e=t.textTip;e.visible=!1,clearTimeout(e.handle),e.handle=0},setUnitTemplate:function(t,e){var n=e.enable,i=e.template,r=e.fromInited,a=e.guid,o=t.unitTemplate;if((o.enable!=n||o.template!=i)&&(o.enable=n,dt(i)||(i="rem(%num%)"),o.template=i,!r)){var s="unittemplate.".concat(a);o.enable||"rem(%num%)"!=o.template?rn(s,o):an(s)}},setPlatform:function(t,e){var n=e.type,i=e.customUnit,r=e.customDocWidth,a=e.fromInited,o=e.guid,l=t.platform,u=!1;if(null!==n){var d;switch(n){case s.ANDROID:case s.IOS:case s.CUSTOM:d=n;break;default:d=s.WEB;break}d!==l.type&&(u=!0,l.type=d)}if(null!=i&&null!=r){switch(u=!0,i){case c.DP:case c.PT:l.customUnit=i;break;default:l.customUnit=c.PX;break}"number"===typeof r&&isFinite(r)&&!isNaN(r)&&r>=1?l.customDocWidth=Math.round(r):l.customDocWidth=0}if(u&&!a){var h="platform.".concat(o);rn(h,l)}},resetCenterWithRect:function(t,e){t.scale.resetCenterWithRect=e},resetCenterArtboard:function(t,e){t.scale.resetCenterArtboard=e},setScale:function(t,e){if(ht(e)){var n=e.artboard,i=e.list,r=e.reset;null!=n&&(t.scale.artboard=Hn(!1,n)),null!=i&&(t.scale.list=Hn(!0,i)),!0===r&&(null==t.curArtboard?t.scale.resetList=Date.now():t.scale.resetArtboard=Date.now())}},exportBoxBackgroundType:function(t,e){t.setting.exportBoxBackground=e,rn("export-box-background",e)},setInteractionArtboardVerticalAlign:function(t,e){t.artboardDetail.interactionSet.verticalAlign=e,rn("interaction-vertical-align",e)},setNumberAutoRound:function(t,e){t.setting.numberAutoRound=e,rn("number-auto-round",e?"1":"0")},setSettingColor:function(t,e){var n=t.setting.color;(e<0||e>=n.items.length)&&(e=0),n.current=e,rn("colortype",e)},curArtboard:function(t,e){e||(e={});var n=e,i=n.artboard,r=n.extral;if(ht(i)||(i=null),t.curArtboard!==i){if(i){var a,o,s=t.filterDocumentGuid;s&&(null===(a=i.artboard)||void 0===a?void 0:a.docGuid)!==s&&(null===(o=i.artboard)||void 0===o?void 0:o.pageGuid)!==s&&this.commit("setFilterDocumentGuid",null)}if(t.curArtboard=i,t.curArtboardExtral=null!==r&&void 0!==r?r:null,t.curNode=null,t.artboardDetail.interactionSet.overlayArtboards.splice(0),za(t),null!=i&&i.isLoaded){var c=i.artboard;if(ht(c)){var l=c.mlConfig;if(ht(l)&&"number"===typeof l.platform){var u=ye(c.docGuid,l.platform);this.commit("setPlatform",u)}var d=xe(c.docGuid);this.commit("setUnitTemplate",d)}}}},curNode:function(t,e){ht(e)||(e=null),t.curNode=e,za(t)},clickedNode:function(t,e){t.clickedNode=e},enterNode:function(t,e){t.enterNode=e},enterArtboard:function(t,e){t.enterArtboard=e},setCloudNickName:function(t,e){t.cloudNickName=e},setMyState:function(t,e){ht(e)&&(t.permission=e.permission,t.cloudNeedLogin=e.needLogin,t.cloudIsLogin=e.isLogin,t.cloudNickName=e.nickName,t.cloudUserEmail=e.email,t.cloudUserId=e.userId,t.cloudUserIsDesigner=e.isDesigner,t.cloudUserIsOwner=!!e.isOwner,ge.userKey=t.cloudUserKey=e.userKey,t.cloudName=e.cloudName,t.cloudVersion=e.cloudVersion)},setUserLogout:function(t){t.cloudIsLogin=!1,t.cloudNickName="",t.cloudUserEmail="",t.cloudUserId=0,t.cloudUserIsDesigner=!1,t.cloudUserIsOwner=!1,ge.userKey=t.cloudUserKey=""},setDocument:function(t,e){var n=e.documentName,i=e.documentArtboards,r=e.documentGuid,a=e.config,o=e.permission,s=e.inCloudMode,c=e.cloud,l=e.documents,u=e.cloudNeedLogin,d=e.cloudIsLogin,h=e.cloudNickName,f=e.cloudUserEmail,m=e.cloudUserId,p=e.cloudUserIsDesigner,v=e.cloudUserIsOwner,b=e.cloudUserKey,g=e.cloudName,w=e.cloudKey,x=e.cloudVersion;t.documentArtboards=i,t.documents=l,t.sortDocumentsWithSketchDocument=Jr(l),t.documentName=n,t.documentGuid=r,t.config=a,t.permission=o,t.cloudNeedLogin=u,t.cloudIsLogin=d,t.cloudNickName=h,t.cloudUserEmail=f,t.cloudUserId=m,t.cloudUserIsDesigner=p,t.cloudUserIsOwner=v,ge.userKey=t.cloudUserKey=b,t.cloudName=g,t.cloudKey=w,t.cloudVersion=x,t.inCloudMode=s,ge.cloudVersion=x;var y=t.cloud;ht(c)&&Object.keys(c).forEach((function(t){y[t]=c[t]})),this.commit("setRenderDocuments");var k=ye(r,a.platform);this.commit("setPlatform",k);var C=xe(r);this.commit("setUnitTemplate",C),Ga()}},actions:{}});function qa(){var t=Ka.state.artboardDetail.interactionSet,e=nn("interaction.background",!1)||"#f5f5f5";t.backgroundColor!==e&&(t.backgroundColor=e)}function Qa(){var t=parseInt(nn("colortype",!1));if(!(isNaN(t)||!isFinite(t)||t<0)){var e=Ka.state.setting.color;t<e.items.length&&(e.current=t)}}function Ja(){var t="1"===nn("number-auto-round",!1);t&&(Ka.state.setting.numberAutoRound=!0)}function Za(){var t=+nn("interaction-vertical-align",!1);switch(t){case q.Bottom:case q.Top:case q.Middle:break;default:t=q.Middle;break}Ka.state.artboardDetail.interactionSet.verticalAlign=t}function to(){var t=+nn("export-box-background",!1);switch(t){case F.Black:case F.Transparent:break;default:t=F.Transparent}t!==F.Transparent&&(Ka.state.setting.exportBoxBackground=t)}function eo(){var t=nn("list-interaction-line");switch(t){case"0":Ka.state.artboardShowInteractionLine=!1;break;default:Ka.state.artboardShowInteractionLine=!0;break}}function no(){var t=nn("list-view-mode");switch(t){case"0":Ka.state.artRenderInCanvasMode=!1;break;default:Ka.state.artRenderInCanvasMode=!0;break}}function io(){var t=nn("art-in-list");switch(t){case"1":Ka.state.artShowInListMode=!0;break;case"0":Ka.state.artShowInListMode=!1;break;default:Ka.state.artShowInListMode=!1,Ka.state.noviceGuide.artShowInListMode=!0;break}}function ro(){var t=nn("interaction.pcdeviceset",!0);if(ht(t)){!t.hasBangs||"iPhone 14 Pro Max"!==t.name&&"iPhone 14 Pro"!==t.name||(t.hasBangs=!1,t.iosDynamicIsland=!0);var e=Ka.state.artboardDetail.interactionSet.pcDeviceSet;Object.keys(e).forEach((function(n){var i=t[n];void 0!==i&&(e[n]=i)}))}else{var n=Ra;n&&Ka.commit("setPCDeviceSet",Ra)}}function ao(){var t=nn("point-comment-showalways");switch(t){case"0":Ka.state.pointCommentShowAlways=!1;break;default:Ka.state.pointCommentShowAlways=!0;break}}function oo(){var t=Ka.state.mobileInteraction.listConfig,e=nn("m-interaction-list-config",!0);ht(e)||(e={}),t.sortType=function(t){switch(t){case D.ArtboardRect:case D.Date:return t;default:return D.Name}}(e.sortType),t.orderDesc=!!e.orderDesc,t.renderType=function(t){switch(t){case j.Artboard:return t;default:return j.All}}(e.renderType)}function so(){var t;function e(){var n=Ka.state,i=n.webViewHidden,r=n.webViewFocus,a=document.hasFocus();a!==r&&Ka.commit("setWebViewFocus",a),clearTimeout(t),i||setTimeout(e,200)}document.addEventListener("visibilitychange",(function(){var t=Ka.state.webViewHidden,n=On();t!=n&&Ka.commit("setWebViewHidden",n),e()}),!1),e()}function co(){var t=Ka.state.cloudListSort,e=nn("cloudlist-item-sort",!0);ht(e)||(e={}),t.sortType=function(t){switch(t){case D.ArtboardRect:case D.Date:return t;default:return D.Name}}(e.sortType),t.orderDesc=!!e.orderDesc}var lo=Ka;function uo(){so(),qa(),$a(),Qa(),Ja(),to(),no(),io(),ro(),eo(),ao(),oo(),Za()}var ho=function(){var t=this,e=t._self._c;return e("section",{ref:"main",attrs:{id:"main"}},[!t.cloudNeedLogin||t.cloudIsLogin?e("div",{staticClass:"loading",class:{on:!t.allArtboardLoadChecked,local:!t.inCloudMode}},[t._v("正在加载画板数据中("+t._s(t.artboardLoadProgressText)+"),请稍后...")]):t._e(),t.cloudNeedLogin&&!t.cloudIsLogin?e("CloudNeedLoginTip"):t.allArtboardLoadChecked?[e("Header"),e("main",[e("FolderNav"),t.cloudFolderNotFound?e("EmptyData",{attrs:{text:t.cloudFolderErrorText,showLoginBtn:t.cloudFolderInSpecify}}):t.permission?t.isEmptyFolder?e("EmptyData",{attrs:{text:t.emptyText}}):t.inNetDiskFileMode?e("NetDiskFileMain"):t.inArtboardMode?e("ArtboardInfo"):t._e():e("Authority",{attrs:{include:!0}}),e("keep-alive",[t.cloudFolderNotFound||!t.permission||t.isEmptyArtboardData||t.inArtboardMode||t.inNetDiskFileMode||t.artShowInListMode?t._e():e("ArtboardList")],1),e("InOutputTip"),e("ArtboardListItemMenu")],1)]:t._e(),e("SafariWebpTip"),t.inNetDiskFileMode?t._e():e("ImageViewer"),e("Tip"),e("AutomaticSync"),e("ChangeArtboardsTip")],2)},fo=[],mo=function(){var t=this,e=t._self._c;return t.visible?e("div"):t._e()},po=[],vo=1e4,bo={methods:{autoGetFolderPrecis:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(clearTimeout(t.autoGetFolderPrecisHandler),t.inCloudMode){e.next=3;break}return e.abrupt("return");case 3:if(!t.cloudFolderNotFound){e.next=5;break}return e.abrupt("return");case 5:if(!t.cloudIsLogin){e.next=7;break}return e.abrupt("return");case 7:if(!t.inNetDiskFileMode){e.next=9;break}return e.abrupt("return");case 9:if(e.prev=9,!t.webViewHidden&&t.webViewFocus){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,t.getFolderPrecis(t.cloudCurrentFolderId,t.folderUpdateTimes);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](9);case 19:return e.prev=19,t.autoGetFolderPrecisHandler=setTimeout((function(){t.autoGetFolderPrecis()}),vo),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[9,16,19,22]])})))()},autoCheckCloudNotify:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s,c,l,u,d,h;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(clearTimeout(t.autoCheckCloudNotifyHandler),t.inCloudMode&&t.cloudIsLogin){e.next=3;break}return e.abrupt("return");case 3:if(e.prev=3,!t.webViewHidden&&t.webViewFocus){e.next=6;break}return e.abrupt("return");case 6:return a=t.cloudKey,o=t.userNotifyCloudList[a],s=0,c=null!==(n=t.sysTipIds[a])&&void 0!==n?n:0,l=null!==(r=t.curArtboardId)&&void 0!==r?r:0,o&&(s=null!==(u=null===(d=o.list[0])||void 0===d?void 0:d.id)&&void 0!==u?u:0),t.lastAutoGetTime=Date.now(),e.prev=13,e.next=16,t.getCloudNotifies(s,l,t.cloudCurrentFolderId,t.folderUpdateTimes);case 16:if(h=e.sent,ut(h)){e.next=19;break}return e.abrupt("return");case 19:if(h=h.filter((function(t){return t.id>c&&!t.readed})),0!==h.length){e.next=22;break}return e.abrupt("return");case 22:e.next=27;break;case 25:e.prev=25,e.t0=e["catch"](13);case 27:e.next=31;break;case 29:e.prev=29,e.t1=e["catch"](3);case 31:return e.prev=31,t.checkUpdateCloudUsers(),t.autoCheckCloudNotifyHandler=setTimeout((function(){t.autoCheckCloudNotify()}),vo),e.finish(31);case 35:case"end":return e.stop()}}),e,null,[[3,29,31,35],[13,25]])})))()},checkUpdateCloudUsers:function(){var t=this;clearTimeout(this.checkUpdateCloudUsersHandle);var e=this.cloudUsersByCloudData,n=e.userListState,a=e.needUpdate;if(a){var o=nn("getcloudusers",!0);ht(o)||(o={});var s=o,c=s.time,l=s.state;l===n&&c>0&&Math.abs(Date.now()-c)<18e4||(this.checkUpdateCloudUsersHandle=setTimeout(Object(r["a"])(Object(i["a"])().mark((function e(){var r,a,o,s,c;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return rn("getcloudusers",{time:Date.now(),state:n}),e.prev=1,e.next=4,t.cryptoMarklionWeb2("getcloudusers",{userListState:n},1e4);case 4:r=e.sent,ht(r.data)&&(a=r.data,o=a.cloudUserListNeedUpdate,s=a.cloudUserListState,c=a.cloudUserListTimes,t.updateCloudUsersByCloud({needUpdate:o,userListState:s,times:c})),e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](1);case 10:case"end":return e.stop()}}),e,null,[[1,8]])}))),100))}}},computed:{folderUpdateTimes:function(){return this.inCloudMode?this.$store.state.cloud.folderUpdateTimes:0},cloudUsersByCloudData:function(){var t;return null!==(t=this.$store.state.userNotify.cloudUsersByCloud[this.cloudKey])&&void 0!==t?t:{}},sysTipIds:function(){return this.$store.state.userNotify.sysTipIds},userNotifyCloudList:function(){return this.$store.state.userNotify.cloudList}},watch:{webViewFocus:function(t){if(t){var e=Date.now()-this.lastAutoGetTime;e>=vo&&(this.autoCheckCloudNotify(),this.autoGetFolderPrecis())}},webViewHidden:function(t){if(!t){var e=Date.now()-this.lastAutoGetTime;e>=vo&&(this.autoCheckCloudNotify(),this.autoGetFolderPrecis())}},cloudIsLogin:function(){this.autoCheckCloudNotify(),this.autoGetFolderPrecis()}},data:function(){return{visible:!1,checkUpdateCloudUsersHandle:0,autoCheckCloudNotifyHandler:0,autoGetFolderPrecisHandler:0,lastAutoGetTime:0}},beforeDestroy:function(){clearTimeout(this.autoCheckCloudNotifyHandler),clearTimeout(this.autoGetFolderPrecisHandler),clearTimeout(this.checkUpdateCloudUsersHandle)},created:function(){this.autoCheckCloudNotifyHandler=setTimeout(this.autoCheckCloudNotify,1e3),this.autoGetFolderPrecisHandler=setTimeout(this.autoGetFolderPrecis,1e3)}},go=bo,wo=n("829d"),xo=Object(wo["a"])(go,mo,po,!1,null,null,null),yo=xo.exports,ko=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"change-artboards-tip"},[e("div",{staticClass:"box"},[t._v("发现"+t._s(t.changeArtboardsCount)+"个画板有更新"),e("a",{staticClass:"btn-review-log",attrs:{href:"javascript:;"},on:{click:t.clickShowLog}},[t._v("查看日志")]),e("a",{staticClass:"btn-close",attrs:{href:"javascript:;"},on:{click:t.clearChangeArtboards}})])]):t._e()},Co=[],So={methods:{clickShowLog:function(){this.$store.state.folderPrecis.showArtboardLogNow=Date.now(),this.clearChangeArtboards()},clearChangeArtboards:function(){this.changeArtboards.splice(0)}},computed:{visible:function(){return this.changeArtboardsCount>0},changeArtboardsCount:function(){return this.changeArtboards.length},changeArtboards:function(){return this.$store.state.folderPrecis.changeArtboards}}},To=So,Ao=(n("ccd9"),Object(wo["a"])(To,ko,Co,!1,null,"f2591c9e",null)),Io=Ao.exports,Fo=function(){var t=this,e=t._self._c;return e("div",{staticClass:"netdiskfile-main"},[t.EnumNetDiskFileType.Pdf===t.fileType?e("ViewPdf"):t.EnumNetDiskFileType.Media===t.fileType?e("ViewMedia"):t.EnumNetDiskFileType.Image===t.fileType?e("ViewImage"):t.EnumNetDiskFileType.Lottie===t.fileType?e("ViewLottie"):e("div",[t._v("当前界面库暂不支持展示文件["+t._s(t.curNetDiskFile.name)+"],请下载到本地查看:"),e("a",{attrs:{href:t.fileDownloadUrl}},[t._v("下载 媒体文件")])])],1)},Mo=[],Oo=function(){var t=this,e=t._self._c;return e("div",{staticClass:"netdiskfile-pdf"},[e("object",{staticClass:"object",attrs:{data:t.fileViewUrl,type:t.contentType}},[t._v(" 当前浏览器不支持预览PDF文件,请下载PDF到本地查看:"),e("a",{attrs:{href:t.fileDownloadUrl}},[t._v("下载 PDF")])])])},_o=[],Lo={computed:{},data:function(){return{contentType:_a?null:"application/pdf"}}},Po=Lo,Eo=(n("d2eb"),Object(wo["a"])(Po,Oo,_o,!1,null,"273b8108",null)),No=Eo.exports,Do=function(){var t=this,e=t._self._c;return e("div",{staticClass:"netdiskfile-media"},[e("video",{staticClass:"video",attrs:{src:t.fileViewUrl,autoplay:"",controls:""}},[t._v(" 当前浏览器不支持预览媒体文件,请下载到本地查看:"),e("a",{attrs:{href:t.fileDownloadUrl}},[t._v("下载 媒体文件")])])])},jo=[],Ro={computed:{}},Vo=Ro,Bo=(n("b8be"),Object(wo["a"])(Vo,Do,jo,!1,null,"20e5bee7",null)),Uo=Bo.exports,Ho=function(){var t=this,e=t._self._c;return e("div",{staticClass:"netdiskfile-image"},[e("ImageViewer",{attrs:{canClose:!1}})],1)},Wo=[],$o=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"image-viewer"},[e("div",{staticClass:"header"},[e("div",{staticClass:"control"},[e("div",{staticClass:"btn-prev",class:{disable:0===t.imgList.length||t.currentIndex<1},on:{click:t.clickPrev}}),e("ScaleControl",{attrs:{type:t.EnumScaleType.ImageViewer}}),e("div",{staticClass:"btn-next",class:{disable:0===t.imgList.length||t.currentIndex>=t.imgList.length-1},on:{click:t.clickNext}}),t.canClose?e("div",{staticClass:"line"}):t._e(),t.canClose?e("div",{staticClass:"btn-close",attrs:{title:"关闭 (Esc)"},on:{click:t.clickHide}}):t._e()],1)]),e("div",{staticClass:"main"},[e("ZoomContainer",{attrs:{type:t.EnumScaleType.ImageViewer}})],1)]):t._e()},Go=[],zo=function(){var t=this,e=t._self._c;return e("section",{staticClass:"scale-control",class:{light:t.lightTheme}},[e("a",{staticClass:"btn-zoom btn-zoom-out",attrs:{href:"javascript:;"},on:{click:function(e){return t.setScaleZoomOut()}}}),e("span",{staticClass:"text"},[e("a",{attrs:{href:"javascript:;",title:"设置缩放为100%"},on:{click:function(e){return t.setScale(1)}}},[t._v(t._s(t.scaleText))])]),e("a",{staticClass:"btn-zoom btn-zoom-in",attrs:{href:"javascript:;"},on:{click:function(e){return t.setScaleZoomIn()}}}),e("a",{staticClass:"btn-scene-reset",attrs:{href:"javascript:;",title:"重置场景比例和偏移信息"},on:{click:t.clickResetScene}})])},Yo=[],Xo={methods:{clickResetScene:function(){switch(this.type){case O.ArtboardList:case O.ArtboardDetail:this.$store.commit("setScale",{reset:!0});break;case O.ImageViewer:this.resetImageViewerScale();break}},quickKey:function(t){var e=t.code||t.key;switch(e){case"-":case"Minus":var n=t.ctrlKey||t.metaKey;n&&(this.setScaleZoomOut(),t.preventDefault());break;case"=":case"Equal":var i=t.ctrlKey||t.metaKey;i&&(this.setScaleZoomIn(),t.preventDefault());break}},setScaleZoomOut:function(){var t=this.scale,e=Math.max(.3*t,.25);e=Math.min(2,e),t-=e,this.setScale(t)},setScaleZoomIn:function(){var t=this.scale,e=Math.max(.3*t,.25);e=Math.min(2,e),t+=e,this.setScale(t)},setScale:function(t){var e=this.type,n=this.scale;switch(t=Hn(e===O.ArtboardList,t),e){case O.ArtboardList:this.setScaleList(t),this.resetScaleSceneCenter(t,n);break;case O.ArtboardDetail:this.setScaleArtboard(t),this.resetScaleSceneCenter(t,n);break;case O.ImageViewer:this.setScaleImageViewer(t);break}},resetScaleSceneCenter:function(t,e){e!==this.scale&&this.$store.commit("resetScaleSceneCenter",{newScale:t,oldScale:e})}},computed:{lightTheme:function(){return this.type===O.ImageViewer},EnumScaleType:function(){return O},scale:function(){switch(this.type){case O.ArtboardList:return this.scaleList;case O.ArtboardDetail:return this.scaleArtboard;case O.ImageViewer:return this.scaleImageViewer;default:return 0}},scaleText:function(){var t=tt.mul(this.scale,100).toFixed(1);return-1!=t.indexOf(".0")&&(t=t.replace(".0","")),t+"%"}},created:function(){window.addEventListener("keydown",this.quickKey)},beforeDestroy:function(){window.removeEventListener("keydown",this.quickKey)},props:{type:Number}},Ko=Xo,qo=(n("b403"),Object(wo["a"])(Ko,zo,Yo,!1,null,"28225f33",null)),Qo=qo.exports,Jo=function(){var t=this,e=t._self._c;return e("section",{ref:"$info",staticClass:"zoom-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.clickZoomContainer(e)},mousedown:function(e){return t.mousedownZoomContainer(e)}}},[t.inCloudMode&&t.inArtboardInfoMode?e("DrawView",{attrs:{sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight,sceneX:t.sceneX,sceneY:t.sceneY,sceneOffsetX:t.sceneOffsetX,sceneOffsetY:t.sceneOffsetY,scale:t.scale}}):t._e(),t.cloudArtInfoMode?e("section",{staticClass:"zoom-box info-canvas"},[e("CanvasModeArtboardInfo",{attrs:{dragging:t.dragging,scale:t.scale,sceneX:t.sceneX+t.infoCanvasOffset.x,sceneY:t.sceneY+t.infoCanvasOffset.y,sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight,sceneScaleKeepX:t.sceneScaleKeepX,sceneScaleKeepY:t.sceneScaleKeepY,sceneOffsetX:t.sceneOffsetX,sceneOffsetY:t.sceneOffsetY}})],1):t._e(),e("section",{staticClass:"zoom-box",style:t.zoomBoxOffset,on:{click:function(e){return e.target!==e.currentTarget?null:t.clickZoomContainer(e)}}},[t.cloudArtListMode?e("CanvasModeArtboardList",{ref:"$instance",attrs:{dragging:t.dragging,scale:t.scale,sceneX:t.sceneX,sceneY:t.sceneY,sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight,sceneScaleKeepX:t.sceneScaleKeepX,sceneScaleKeepY:t.sceneScaleKeepY,sceneOffsetX:t.sceneOffsetX,sceneOffsetY:t.sceneOffsetY}}):t.type===t.EnumScaleType.ArtboardList?e("ArtboardList",{ref:"$instance",attrs:{dragging:t.dragging,sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight}}):t.inArtboardInfoMode?e("ArtboardInfo",{ref:"$instance",attrs:{dragging:t.dragging,scaling:t.scaling,sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight}}):t.inImageViewerMode?e("ViewerBox",{ref:"$instance",attrs:{sceneX:t.sceneX,sceneY:t.sceneY,sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight},on:{setConfig:t.setConfig}}):t._e()],1),t.inCloudMode&&t.inArtboardInfoMode?e("CommentPoints",{attrs:{sceneWidth:t.sceneWidth,sceneHeight:t.sceneHeight,sceneX:t.sceneX,sceneY:t.sceneY,sceneOffsetX:t.sceneOffsetX,sceneOffsetY:t.sceneOffsetY,scale:t.scale*t.calcArtScale},on:{setConfig:t.setConfig}}):t._e()],1)},Zo=[],ts=(n("5adb"),function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"draw-view"},[e("DrawControl"),e("canvas",{ref:"canvas_history",class:{move:t.inElementMoveState},attrs:{width:t.sceneWidth*t.canvasScale,height:t.sceneHeight*t.canvasScale},on:{mousedown:t.onMouseDown,mousemove:t.onMouseMoveInCanvas,dragstart:function(t){t.preventDefault()}}}),e("canvas",{ref:"canvas_current",staticClass:"current",attrs:{width:t.sceneWidth*t.canvasScale,height:t.sceneHeight*t.canvasScale}}),e("div",{staticClass:"input"},[t.isCurrentInTextMode?e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.currentDrawData.text,expression:"currentDrawData.text"}],ref:"input",style:t.textareaStyle,attrs:{spellcheck:"false"},domProps:{value:t.currentDrawData.text},on:{input:[function(e){e.target.composing||t.$set(t.currentDrawData,"text",e.target.value)},t.resetTextareaSize],keydown:t.onInputKeyDown,mousedown:function(t){t.stopPropagation()}}}):t._e()])],1):t._e()}),es=[],ns=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"draw-control-box"},[e("div",{staticClass:"draw-control",class:{black:t.artboardDetailSkin},on:{mousedown:function(t){t.stopPropagation()}}},[e("ul",[e("li",{staticClass:"tool_move",class:{on:t.drawAction===t.EnumDrawAction.Move},attrs:{title:"选择对象"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Move)}}}),e("li",{staticClass:"tool_pen",class:{on:t.drawAction===t.EnumDrawAction.Brush},attrs:{title:"画笔"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Brush)}}}),e("li",{staticClass:"tool_text",class:{on:t.drawAction===t.EnumDrawAction.Text},attrs:{title:"文本输入"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Text)}}}),e("li",{staticClass:"tool_rectangle",class:{on:t.drawAction===t.EnumDrawAction.Rectangle},attrs:{title:"矩形"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Rectangle)}}}),e("li",{staticClass:"tool_ellipse",class:{on:t.drawAction===t.EnumDrawAction.Ellipse},attrs:{title:"椭圆"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Ellipse)}}}),e("li",{staticClass:"tool_arrow",class:{on:t.drawAction===t.EnumDrawAction.Arrow},attrs:{title:"箭头"},on:{click:function(e){return t.clickDrawAction(t.EnumDrawAction.Arrow)}}})]),e("ul",[e("li",{staticClass:"his_prev",class:{off:0===t.historyCount||t.historyIndex<0},attrs:{title:"回退到上一步"},on:{click:t.clickHistoryPrev}}),e("li",{staticClass:"his_next",class:{off:0===t.historyCount||t.historyIndex>=t.historyCount-1},attrs:{title:"前进到下一步"},on:{click:t.clickHistoryNext}})]),e("ul",[e("li",{staticClass:"sys_save",attrs:{title:"保存截图"},on:{click:t.clickSave}}),e("li",{staticClass:"sys_cancel",attrs:{title:"取消截图"},on:{click:t.clickCancel}})])]),t.subControlVisible?e("div",{staticClass:"draw-control-sub",class:{black:t.artboardDetailSkin},on:{mousedown:function(t){t.stopPropagation()}}},[e("div",{staticClass:"box"},[t.drawAction===t.EnumDrawAction.Text?e("div",{staticClass:"font-size"},[e("div",{staticClass:"select"},[e("div",{staticClass:"select-text",class:{on:t.fontSizeSelectOpen},on:{click:function(e){t.fontSizeSelectOpen=!t.fontSizeSelectOpen}}},[t._v(t._s(t.drawInfo.fontSize)+"px")]),t.fontSizeSelectOpen?e("ul",{staticClass:"select-list",on:{mousewheel:function(t){t.stopPropagation()},DOMMouseScroll:function(t){t.stopPropagation()}}},t._l(t.DrawFontSize,(function(n,i){return e("li",{key:i,staticClass:"select-item",class:{on:n===t.drawInfo.fontSize},on:{click:function(e){return t.clickFontSize(n)}}},[t._v(t._s(n)+"px")])})),0):t._e()])]):e("ul",{staticClass:"brush-size"},t._l(t.EnumBrushSizeType,(function(n,i){return e("li",{key:i,class:[i,t.drawInfo.brushSize===n?"on":""],on:{click:function(e){t.drawInfo.brushSize=n}}})})),0),e("ul",{staticClass:"colors"},t._l(t.DrawColors,(function(n,i){return e("li",{key:i,class:{on:t.drawInfo.colorIndex===i},on:{click:function(e){t.drawInfo.colorIndex=i}}},[e("span",{style:{borderColor:n.border,backgroundColor:n.color}})])})),0)])]):t._e()]):t._e()},is=[],rs=".webp",as=[".jpeg",".jpg",".gif",".png",rs,".bmp"],os=10485760,ss=5;function cs(t,e,n,i,r){if(ht(t)&&i){dt(n)&&us(t,n),0===e.id&&(e.id=t.userId);var a=r[e.id];a?Object.keys(e).forEach((function(t){a[t]=e[t]})):a=r[e.id]=e,t.user=a;var o=0===i.id;return o||(0!=t.replyUserId&&(a=r[t.replyUserId],t.replyUser=a||null),t.parent=i),t.atUsers={},ut(t.atUserIds)&&t.atUserIds.forEach((function(e){t.atUsers[e]=r[e]})),i.comments.push(t),t}}function ls(t,e){ht(t)||(t={});var n=t,i=n.list,r=n.users;r||(r={});var a=dt(e);return ut(i)?i.forEach((function(t){ht(t)&&(t.user=r[t.userId],t.replyUser=null,t.atUsers={},ut(t.atUserIds)&&t.atUserIds.forEach((function(e){t.atUsers[e]=r[e]})),ut(t.comments)&&t.comments.forEach((function(n){n.parent=t,n.user=r[n.userId],n.replyUser=r[n.replyUserId],n.atUsers={},ut(n.atUserIds)&&n.atUserIds.forEach((function(t){n.atUsers[t]=r[t]})),a&&us(n,e)})),a&&us(t,e))})):i=[],i}function us(t,e){var n=t.attachMents;if(ut(n))for(var i=0,r=n.length;i<r;i++){var a=n[i];if(a){var o=a.fold;o&&"/"===o[0]&&(a.fold=e+o.substr(1))}}else t.attachMents=[]}var ds={methods:{clickHistoryPrev:function(){var t=this.historyIndex,e=this.drawInfo;t<0||(t-=1,e.historyIndex=t,e.historyIndexChanges=Date.now())},clickHistoryNext:function(){var t=this.historyIndex,e=this.drawInfo,n=this.histories;t>=n.length-1||(t+=1,e.historyIndex=t,e.historyIndexChanges=Date.now())},clickCleanHistory:function(){this.histories.splice(0),this.drawInfo.historyIndex=-1},clickFontSize:function(t){this.drawInfo.fontSize=t},clickDrawAction:function(t){var e;switch(this.drawAction===t&&(t=oi.None),t){case oi.Move:e="进入拖拽模式,可拖动对象,选中后可按delete键删除";break}e&&this.showTextTip(e),this.drawInfo.action=t},clickSave:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!0!==t.saving){e.next=2;break}return e.abrupt("return");case 2:if(-1!==t.historyIndex&&0!==t.histories.length){e.next=5;break}return t.alert({text:"没有修改信息,无法保存"}),e.abrupt("return");case 5:return a=null!==(n=null===(r=t.artboard)||void 0===r?void 0:r.boundsInArtboard)&&void 0!==n?n:new ee,a=(new ee).set(0,0,a.width,a.height),e.prev=7,t.saving=!0,e.next=11,Di.save(a,t.pathPreview,t.histories,t.historyIndex);case 11:if(s=e.sent,s&&!(s.size<1)){e.next=15;break}return t.alert({text:"保存信息失败,请联系我们反馈该问题"}),e.abrupt("return");case 15:if(!(s.size>os)){e.next=18;break}return t.alert({text:"保存信息失败,图片大小[".concat(Sn(s.size),"]太大,不能超过[").concat(Sn(os),"]")}),e.abrupt("return");case 18:s.name="userdraw.jpg",s.lastModified=Date.now(),s.lastModifiedDate=new Date(s.lastModified),null===(o=t.editComment.instance)||void 0===o||o.addAttachMent(s).then((function(){t.showTextTip("图片已添加到评论附件列表")})).catch((function(e){t.showTextTip(e)})),t.editComment.drawing=!1,e.next=28;break;case 25:e.prev=25,e.t0=e["catch"](7),t.showTextTip(e.t0);case 28:return e.prev=28,t.saving=!1,e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[7,25,28,31]])})))()},clickCancel:function(){this.saving=!1,this.editComment.drawing=!1},hideFontSizeSelectLater:function(){this.fontSizeSelectOpen=!1}},computed:{artboard:function(){var t;return null===(t=this.curArtboard)||void 0===t?void 0:t.artboard},pathPreview:function(){var t,e=this.artboard;return e?(this.isSupportWebp&&(t=e.pathPreviewWebp),t||(t=e.pathPreview),t):null},isSupportWebp:function(){return this.$store.state.isSupportWebp===Oa.Support},DrawFontSize:function(){return si},EnumBrushSizeType:function(){return li},DrawColors:function(){return ui},artboardDetailSkin:function(){return this.$store.state.artboardDetailSkin},drawInfo:function(){return this.editComment.drawInfo},EnumDrawAction:function(){return oi},drawAction:function(){return this.drawInfo.action},historyIndex:function(){return this.drawInfo.historyIndex},historyCount:function(){return this.histories.length},histories:function(){return this.drawInfo.histories},subControlVisible:function(){var t=this.drawAction;return t!==oi.None&&t!==oi.Move},visible:function(){return this.editComment.drawing}},watch:{fontSizeSelectOpen:function(t){var e=this;clearTimeout(this.fontSizeHandle),t?this.fontSizeHandle=setTimeout((function(){window.addEventListener("click",e.hideFontSizeSelectLater)}),66.67):window.removeEventListener("click",this.hideFontSizeSelectLater)}},beforeDestroy:function(){clearTimeout(this.fontSizeHandle),window.removeEventListener("click",this.hideFontSizeSelectLater)},data:function(){return{fontSizeSelectOpen:!1,fontSizeHandle:0,saving:!1}}},hs=ds,fs=(n("0da5"),Object(wo["a"])(hs,ns,is,!1,null,"3e7107a0",null)),ms=fs.exports,ps={components:{DrawControl:ms},methods:{onCanvasKeyDown:function(t){var e=t.keyCode,n=t.target;if(n){var i=n.tagName;if("INPUT"!==i&&"TEXTAREA"!==i){var r=n,a=document.documentElement;while(null!=r&&r!=a){if(r.isContentEditable)return;r=r.parentNode}if(46===e||8===e){var o=this.drawInfo,s=this.histories,c=this.historyIndex,l=o.selectItem;if(!l)return;o.selectItem=null;var u=new _i;u.action=oi.Deleted,u.dragTarget=l,u.drawOffset=new di,u.makePoint(),u.isVaildData(),c<s.length-1&&s.splice(c+1),s.push(u),o.historyIndex=s.length-1;var d=u.dragTarget,h=s.findIndex((function(t){return t===d}));if(-1===h)console.error("异常信息,无法找到原始数据",u);else{var f=0;while(-1!==f){if(f=s.findIndex((function(t){return t.action===oi.Move&&t.dragFrom===h})),-1===f)break;var m=s[f];d.dragOn=f,h=f,d=m}u.dragFrom=h,d.dragOn=s.length-1}this.drawAll()}}}},getCanvasDrawNum:function(t){return Math.round(t*this.canvasScale)},getLocation:function(t){var e=t.pageX,n=t.pageY,i=t.sceneX,r=t.sceneY,a=t.scale,o=t.sceneWidth,s=t.sceneHeight,c=e,l=n,u=this.sceneOffsetX,d=this.sceneOffsetY,h=this.rect,f=(o-h.width*a)/2,m=(s-h.height*a)/2;return c-=u,l-=d,c-=f,l-=m,c-=i,l-=r,c=Math.round(c/a),l=Math.round(l/a),new di(c,l)},saveTextToHistory:function(){if(this.isCurrentInTextMode){var t=this.currentDrawData;if(t.isVaildData()){t.makePoint(this.getCurrentContext(),this.currentSceneInfo);var e=this.histories,n=this.historyIndex;n<e.length-1&&e.splice(n+1),e.push(t),this.drawInfo.historyIndex=e.length-1,this.drawHistories(t)}return this.currentDrawData=null,!0}return!1},getHistoryTagetWithDragFrom:function(t){if(null==t)return null;if(t.action!==oi.Move)return null;var e=t.dragFrom;if(-1===e)return null;var n=this.histories;while(-1!==e){var i=n[e];if(!i)return null;if(i.action!==oi.Move)return i;if(e=i.dragFrom,-1===e)return null}},getHistoryByPointExact:function(t){for(var e=this.histories,n=Math.min(this.historyIndex+1,e.length),i=(new ee).set(t.x,t.y,1,1),r=n-1;r>=0;r--){var a=e[r],o=this.getRectOverlapDrawData(i,e,a,r);if(null!=o)return o}return null},getHistoryByPoint:function(t){for(var e=this.histories,n=Math.min(this.historyIndex+1,e.length),i=(new ee).set(t.x,t.y,1,1),r=n-1;r>=0;r--){var a=e[r],o=this.getRectOverlapDrawData(i,e,a,r);if(null!=o)return o}return null},getRectOverlapDrawData:function(t,e,n,i){var r,a=n.action,o=null!==(r=n.dragOffset)&&void 0!==r?r:new di;if(a===oi.Deleted)return null;if(a===oi.Move){if(-1!==n.dragOn){var s=e[n.dragOn];if(s&&(s.action===oi.Move||s.action===oi.Deleted)&&s.dragFrom===i)return null}var c=this.getHistoryTagetWithDragFrom(n);if(!c)return null;var l=c.eventRect;if(!l)return null;var u=(new ee).set(l.x+o.x,l.y+o.y,l.width,l.height);if(u.isOverlap(t))return{target:c,offset:o}}else{var d=Di.getHistoryTagetWithDragOn(e,n,this.historyIndex);if(d&&d.action===oi.Deleted)return null;d||(d=n);var h,f=n.eventRect;if(d===n)return f&&f.isOverlap(t)?{target:d,offset:new di}:null;o=null!==(h=d.dragOffset)&&void 0!==h?h:new di;var m=(new ee).set(f.x+o.x,f.y+o.y,f.width,f.height);if(m.isOverlap(t))return{target:n,offset:o}}return null},onMouseMoveInCanvas:function(t){var e=this.currentDrawData,n=this.drawInfo,i=this.inDrawAndNotMove,r=this.histories,a=this.moveInfo,o=n.action;if(o===oi.Move&&!e&&0!==r.length){var s=this.inMacOS?t.metaKey:t.ctrlKey;if(!i||!s){a.pageX=t.pageX,a.pageY=t.pageY,a.scale=this.scale,a.sceneX=this.sceneX,a.sceneY=this.sceneY,a.sceneWidth=this.sceneWidth,a.sceneHeight=this.sceneHeight;var c=this.getLocation(a),l=this.getHistoryByPointExact(c),u=n.enterItem,d=null===l||void 0===l?void 0:l.target;u!=d&&(n.enterItem=d,this.drawAll())}}},onMouseDown:function(t){var e=this.inMacOS?t.metaKey:t.ctrlKey,n=this.startInfo,i=this.inDrawAndNotMove,r=this.drawAction,a=this.drawInfo;if(i){if(e)return;t.stopPropagation()}if(r!==oi.Text||!this.saveTextToHistory()){switch(r){case oi.Move:case oi.Brush:case oi.Text:case oi.Rectangle:case oi.Ellipse:case oi.Arrow:n.pageX=t.pageX,n.pageY=t.pageY,n.scale=this.scale,n.sceneX=this.sceneX,n.sceneY=this.sceneY,n.sceneWidth=this.sceneWidth,n.sceneHeight=this.sceneHeight;break;default:return}var o=this.getLocation(n),s=new _i;if(r===oi.Move){var c=this.getHistoryByPoint(o);if(null==c)return void(a.selectItem&&(a.selectItem=null,this.drawAll()));if(c.action===oi.Deleted)return;s.dragTarget=c.target,s.dragOffset=c.offset}switch(this.currentDrawData=s,s.action=r,s.color=this.currentColor.color,r!==oi.Move&&this.cleanCurrent(),r){case oi.Move:s.startPoint=s.endPoint=o,this.drawHistories(),this.drawCurrent();break;case oi.Brush:s.brushSize=this.currentBrushSize,s.points=[o];break;case oi.Rectangle:case oi.Ellipse:case oi.Arrow:s.brushSize=this.currentBrushSize,s.startPoint=o;break;case oi.Text:return s.startPoint=o,s.text="",s.fontSize=this.currentFontSize,s.lineHeight=s.fontSize+2,s.textareaSize=new yi(Ci,s.lineHeight),void(s.family=nt?"-apple-system":"'PingFang SC', 'PingFang TC','Helvetica Neue', sans-serif")}window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp)}},onMouseMove:function(t){var e=this.currentDrawData;if(e){var n=e.action;if(n!==oi.Text){var i=this.getCurrentContext();if(i){var r=this.getLocation({pageX:t.pageX,pageY:t.pageY,scale:this.scale,sceneX:this.sceneX,sceneY:this.sceneY,sceneWidth:this.sceneWidth,sceneHeight:this.sceneHeight}),a=this.currentSceneInfo;switch(n){case oi.Move:e.endPoint=r,this.drawCurrent();break;case oi.Brush:e.points.push(r);var o=!1,s=e.makeBrushHash(a);s===e.brushHash?o=!0:(this.cleanCurrent(i),e.brushHash=s),Di.drawBrush(i,e,a,!1,!1,null,o);break;case oi.Rectangle:e.endPoint&&this.cleanCurrent(i),e.endPoint=r,Di.drawRectangle(i,e,a);break;case oi.Ellipse:e.endPoint&&this.cleanCurrent(i),e.endPoint=r,Di.drawEllipse(i,e,a);break;case oi.Arrow:e.endPoint&&this.cleanCurrent(i),e.endPoint=r,Di.drawArrow(i,e,a);break;default:return}}}}},onMouseUp:function(t){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp);var e=this.currentDrawData;this.currentDrawData=null;var n=this.drawInfo;if(e&&e.isVaildData()){e.makePoint();var i=this.histories,r=this.historyIndex;if(r<i.length-1&&i.splice(r+1),i.push(e),n.historyIndex=i.length-1,e.action===oi.Move){var a=e.dragTarget,o=i.findIndex((function(t){return t===a}));if(-1===o)console.error("异常信息,无法找到原始数据",e);else{var s=0;while(-1!==s){if(s=i.findIndex((function(t){return t.action===oi.Move&&t.dragFrom===o})),-1===s)break;var c=i[s];a.dragOn=s,o=s,a=c}e.dragFrom=o,a.dragOn=i.length-1}n.selectItem=this.getDrawDataFromMouse(t)}this.drawHistories(e.action===oi.Move?null:e),this.cleanCurrent()}else e.action===oi.Move&&(n.selectItem=this.getDrawDataFromMouse(t),this.drawHistories(),this.cleanCurrent())},getDrawDataFromMouse:function(t){var e=this.getLocation({pageX:t.pageX,pageY:t.pageY,scale:this.scale,sceneX:this.sceneX,sceneY:this.sceneY,sceneWidth:this.sceneWidth,sceneHeight:this.sceneHeight}),n=this.getHistoryByPointExact(e);return null===n||void 0===n?void 0:n.target},getDrawTarget:function(){},drawHistories:function(t){var e,n=this.getHistoryContext();if(n){var i,r=!t,a=this.histories,o=this.historyIndex,s=this.drawInfo;if(r){if(n.clearRect(0,0,this.getCanvasDrawNum(this.sceneWidth),this.getCanvasDrawNum(this.sceneHeight)),-1===o)return;if(i=o>=a.length-1?a:a.slice(0,o+1),0===i.length)return}else i=[t];var c=this.currentSceneInfo,l=null===(e=this.currentDrawData)||void 0===e?void 0:e.dragTarget;i.forEach((function(t){if(t!==l){var e,i=s.action===oi.Move,r=i&&t==s.enterItem,u=i&&t==s.selectItem,d=t.action;switch(d){case oi.Brush:case oi.Rectangle:case oi.Ellipse:case oi.Arrow:case oi.Text:var h=Di.getHistoryTagetWithDragOn(a,t,o);if(h){if(h.action===oi.Deleted)return;e=h.dragOffset}break}switch(d){case oi.Brush:var f=!1;Di.drawBrush(n,t,c,r,u,e,f);break;case oi.Rectangle:Di.drawRectangle(n,t,c,r,u,e);break;case oi.Ellipse:Di.drawEllipse(n,t,c,r,u,e);break;case oi.Arrow:Di.drawArrow(n,t,c,r,u,e);break;case oi.Text:Di.drawText(n,t,c,r,u,e);break;default:return}}}))}},cleanCurrent:function(t){(t||(t=this.getCurrentContext(),t))&&t.clearRect(0,0,this.getCanvasDrawNum(this.sceneWidth),this.getCanvasDrawNum(this.sceneHeight))},drawCurrent:function(){var t=this.currentDrawData;if(t){var e=this.getCurrentContext();if(e){this.cleanCurrent(e);var n=this.currentSceneInfo,i=t.action,r=i!==oi.Move,a=!r;switch(i){case oi.Move:var o=t.dragTarget;if(!o)return;var s=t.startPoint,c=t.endPoint,l=t.dragOffset;if(!s||!c)return;var u=new di(c.x-s.x+l.x,c.y-s.y+l.y);switch(o.action){case oi.Brush:var d=!1;Di.drawBrush(e,o,n,r,a,u,d);break;case oi.Rectangle:Di.drawRectangle(e,o,n,r,a,u);break;case oi.Ellipse:Di.drawEllipse(e,o,n,r,a,u);break;case oi.Arrow:Di.drawArrow(e,o,n,r,a,u);break;case oi.Text:Di.drawText(e,o,n,r,a,u);break}break;case oi.Brush:var h=!1;t.brushHash=t.makeBrushHash(n),Di.drawBrush(e,t,n,!1,!1,null,h);break;case oi.Rectangle:Di.drawRectangle(e,t,n);break;case oi.Ellipse:Di.drawEllipse(e,t,n);break;case oi.Arrow:Di.drawArrow(e,t,n);break;default:return}}}},getHistoryContext:function(){var t=this.$refs.canvas_history;if(t){var e=t.getContext("2d");return e}},getCurrentContext:function(){var t=this.$refs.canvas_current;if(t){var e=t.getContext("2d");return e}},drawAll:function(){var t=this;this.visible&&(cancelAnimationFrame(this.handleDraw),this.handleDraw=requestAnimationFrame((function(){try{t.drawCurrent(),t.drawHistories()}finally{}})))},measureTextSize:function(t,e,n){var i,r=this.currentSceneInfo,a=r.scale;a=1;var o=Math.max(12,Math.round(e.fontSize*a*1e3)/1e3);t.font="".concat(o,"px ").concat(null!==(i=e.family)&&void 0!==i?i:"sans-serif");for(var s=e.lineHeight,c=n||e.text,l=new yi(0,s),u=0,d=Math.round(Ti*a),h={},f=0,m=c.length;f<m;f++){var p=c[f];if("\n"!==p){if("\r"!==p){var v=h[p];v||(v=h[p]=Math.ceil(t.measureText(p).width));var b=u+v+1;b>d?(l.width=Math.max(u,l.width),l.height+=s,u=v):u=b}}else l.width=Math.max(u,l.width),u=0,l.height+=s}return l.width=Math.ceil(Math.max(u,l.width)/a),l},resetTextareaSize:function(){var t=this.currentDrawData;if(t&&t.action===oi.Text){var e=this.$refs.input;if(e){var n=this.getCurrentContext();if(n){var i=this.measureTextSize(n,t,e.value);i.width=Math.max(i.width,Ci),t.textareaSize=i}}}},onInputKeyDown:function(t){var e=t.keyCode;switch(e){case 27:this.isCurrentInTextMode&&(this.currentDrawData=null)}},resetData:function(){this.currentDrawData=null;var t=this.drawInfo,e=this.histories;e.splice(0),t.historyIndex=-1,t.action=oi.None}},watch:{inElementSelect:function(t){t?window.addEventListener("keydown",this.onCanvasKeyDown):window.removeEventListener("keydown",this.onCanvasKeyDown)},artboardInComment:function(t){t||(this.editComment.drawing=!1)},historyIndexChanges:function(){this.drawAll()},visible:function(t){t&&this.resetData()},curArtboardId:function(){this.editComment.drawing=!1},currentFontSize:function(t){var e=this;if(this.isCurrentInTextMode){var n=this.currentDrawData;n&&(n.fontSize=t,n.lineHeight=n.fontSize+2,requestAnimationFrame((function(){e.resetTextareaSize();var t=e.$refs.input;t&&t.focus()})))}},scale:function(){var t=this;requestAnimationFrame((function(){t.resetTextareaSize()}))},currentColor:function(t){var e=this;if(this.isCurrentInTextMode){var n=this.currentDrawData;n&&(n.color=t.color,requestAnimationFrame((function(){var t=e.$refs.input;t&&t.focus()})))}},isCurrentInTextMode:function(t){var e=this;t&&this.$nextTick((function(){requestAnimationFrame((function(){var t=e.$refs.input;t&&t.focus()}))}))},drawAction:function(t,e){if(e===oi.Text&&this.saveTextToHistory(),e===oi.Move||t===oi.Move){var n=this.drawInfo;n.enterItem=n.selectItem=null,this.drawAll()}},"histories.length":function(t,e){t<e&&this.drawAll()},currentSceneInfo:function(){this.drawAll()}},computed:{inElementSelect:function(){var t=this.drawInfo,e=t.action;return e===oi.Move&&null!=t.selectItem},inElementMoveState:function(){var t=this.drawInfo,e=t.action;return e===oi.Move&&null!=t.enterItem},historyIndexChanges:function(){return this.drawInfo.historyIndexChanges},isCurrentInTextMode:function(){var t=this.currentDrawData;return t&&t.action===oi.Text},currentSceneInfo:function(){var t=new Pi,e=this.sceneX,n=this.sceneY,i=this.scale,r=this.sceneWidth,a=this.sceneHeight,o=this.canvasScale,s=this.sceneOffsetX,c=this.sceneOffsetY,l=this.getLocation({pageX:s,pageY:c,sceneX:e,sceneY:n,scale:i,sceneWidth:r,sceneHeight:a});return t.offset=l,t.scale=i,t.canvasScale=o,t.sceneWidth=r,t.sceneHeight=a,t},currentBrushSize:function(){return this.drawInfo.brushSize},currentFontSize:function(){return this.drawInfo.fontSize},textareaStyleLeft:function(){var t=this.currentSceneInfo,e=this.currentDrawData;return Math.round((e.startPoint.x-t.offset.x-Si)*this.scale)},textareaStyle:function(){if(this.isCurrentInTextMode){var t=this.currentDrawData,e=this.currentSceneInfo,n=this.scale,i=Math.max(1,Math.round(t.lineHeight*n)),r=Math.max(1,Math.round(t.fontSize*n*1e3)/1e3),a=1,o=12;return r<o&&(a=r/o,r=o),{backgroundColor:this.currentTextBackgroundColor,borderColor:this.currentColor.color,color:this.currentColor.color,fontSize:r+"px",transform:"scale(".concat(a.toFixed(5),")"),lineHeight:i+"px",left:this.textareaStyleLeft+"px",top:Math.round((t.startPoint.y-e.offset.y-t.lineHeight/2-Si+1)*n)+"px",padding:Math.round(Si*n)+"px",height:Math.max(1,Math.round(t.textareaSize.height*n))+"px",width:Math.max(1,Math.round((t.textareaSize.width+2)*n/a))+"px"}}},currentTextBackgroundColor:function(){var t=this.currentColor.color,e=this.drawAction;return e===oi.Text&&(t=Ai(t,.2)),t},currentColor:function(){var t;return null!==(t=ui[this.drawInfo.colorIndex])&&void 0!==t?t:ui[0]},artboard:function(){var t;return null===(t=this.curArtboard)||void 0===t?void 0:t.artboard},rect:function(){var t,e=this.artboard,n=null!==(t=null===e||void 0===e?void 0:e.boundsInArtboard)&&void 0!==t?t:new ee;return(new ee).set(0,0,n.width,n.height)},inDrawAndNotMove:function(){var t=this.drawAction;switch(t){case oi.None:return!1;default:return!0}},drawInfo:function(){return this.editComment.drawInfo},EnumDrawAction:function(){return oi},drawAction:function(){return this.drawInfo.action},histories:function(){return this.drawInfo.histories},historyIndex:function(){return this.drawInfo.historyIndex},visible:function(){return this.editComment.drawing}},data:function(){return{handleDraw:0,canvasScale:kn(),startInfo:{pageX:0,pageY:0,sceneX:0,sceneY:0,scale:1,sceneWidth:0,sceneHeight:0},moveInfo:{pageX:0,pageY:0,sceneX:0,sceneY:0,scale:1,sceneWidth:0,sceneHeight:0},currentDrawData:null}},props:{sceneWidth:Number,sceneHeight:Number,sceneX:Number,sceneY:Number,sceneOffsetX:Number,sceneOffsetY:Number,scale:Number},created:function(){this.resetData()},beforeDestroy:function(){this.editComment.drawing=!1,cancelAnimationFrame(this.handleDraw),window.removeEventListener("keydown",this.onCanvasKeyDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)}},vs=ps,bs=(n("ec5d"),Object(wo["a"])(vs,ts,es,!1,null,"6cd68412",null)),gs=bs.exports,ws=function(){var t=this,e=t._self._c;return e("div",{ref:"box",staticClass:"viewer-box",style:t.style,on:{contextmenu:function(t){t.preventDefault()}}},[t.fetchState===t.FetchState.Fetching?e("div",{staticClass:"loading"},[t._v("图片加载中...")]):t.fetchState===t.FetchState.Error?e("div",{staticClass:"error"},[t._v(" 图片加载失败,"),e("a",{attrs:{href:"javascript:;"},on:{click:t.clickReload}},[t._v("重新加载")])]):t._e(),e("img",{directives:[{name:"show",rawName:"v-show",value:t.fetchState===t.FetchState.Success,expression:"fetchState===FetchState.Success"}],staticClass:"preview",attrs:{src:t.currentImgShowSrc},on:{load:t.onImgLoad,error:t.onImgError}})])},xs=[],ys={methods:{clickReload:function(){this.fetchState=Cn.Fetching,this.randomUrl=Date.now()},clickZoomContainer:function(){},canEmitEvent:function(){return this.fetchState===Cn.Success},onSceneResize:function(t,e,n){var i=this.canScale&&0!==this.scale;if(!i||n){var r=this.rect;if(r&&0!==t&&0!==e){var a=r.width/t,o=r.height/e,s=Math.max(a,o);0!==s&&(s=.92/s,s>2&&(s=2),this.setScaleImageViewer(s))}}},onImgLoad:function(t){var e=this.currentImg;if(e){var n=t.target;if(n){this.fetchState=Cn.Success;var i=this.currentImgSrcBlobUrl||this.currentImgSrc,r=n.src;-1!==r.indexOf(i)&&(e.width=n.naturalWidth,e.height=n.naturalHeight),this.resetImageViewerScale(),this.disposeBlobUrl()}}},onImgError:function(){this.fetchState=Cn.Error,this.disposeBlobUrl()},disposeBlobUrl:function(t){var e=this.currentImgSrcBlobUrl;e&&(URL.revokeObjectURL(e),t&&(this.currentImgSrcBlobUrl=null))},createBlobUrl:function(t){(t instanceof File||t instanceof Blob)&&(this.currentImgSrcBlobUrl=URL.createObjectURL(t))}},computed:{FetchState:function(){return Cn},rect:function(){if(this.canScale){var t=this.currentImg;return(new ee).set(0,0,t.width,t.height)}},canScale:function(){var t=this.currentImg;return!!t&&(0!==t.width||0!==t.height)},imgList:function(){return this.imageViewer.imgList},currentIndex:function(){return this.imageViewer.currentIndex},currentImg:function(){var t=this.imgList;return t?t[this.currentIndex]:null},currentImgSrc:function(){var t,e;return null!==(t=null===(e=this.currentImg)||void 0===e?void 0:e.imgSrc)&&void 0!==t?t:""},currentImgShowSrc:function(){var t=this.currentImgSrcBlobUrl||this.currentImgSrc;if(!t)return t;var e=this.randomUrl;return 0===e?t:"".concat(t,"?r=").concat(e)},imageViewer:function(){return this.$store.state.imageViewer},scale:function(){return this.scaleImageViewer},style:function(){var t=this.scale,e=this.currentImg;return e?this.fetchState!==Cn.Success?{transform:"translate3d(".concat(-this.sceneX,"px, ").concat(-this.sceneY,"px, 1px)")}:{width:Math.ceil(e.width*t)+"px",height:Math.ceil(e.height*t)+"px"}:null}},watch:{currentImgSrc:function(t){this.disposeBlobUrl(!0),this.fetchState=Cn.Fetching,this.randomUrl=0,this.$emit("setConfig",{sceneX:0,sceneY:0}),this.createBlobUrl(t)}},data:function(){return{fetchState:Cn.Normal,randomUrl:0,currentImgSrcBlobUrl:""}},props:{sceneWidth:Number,sceneHeight:Number,sceneX:Number,sceneY:Number},beforeDestroy:function(){this.disposeBlobUrl(!0)},created:function(){var t=this.currentImgSrc;t&&(this.fetchState=Cn.Fetching,this.createBlobUrl(t))}},ks=ys,Cs=(n("0c4e"),Object(wo["a"])(ks,ws,xs,!1,null,"ff3b7fe6",null)),Ss=Cs.exports,Ts=function(){var t=this,e=t._self._c;return t.visible?e("div",{ref:"commentPoints",staticClass:"comment-points",class:{prevent:t.preventPointEnable,"in-drawing":t.inDrawing},on:{mousedown:t.onMouseDownInScene}},[t._l(t.pointComments,(function(n){return e("CommentPointItem",{key:n.id,attrs:{comment:n,text:n.pointIndex,pointX:n.pointX,pointY:n.pointY,sceneInfo:t.currentSceneInfo,artboardRect:t.rect},on:{onLocationChange:t.onLocationChangeComment,setConfig:t.setConfig}})})),t.pointInfo.point.enable?e("CommentPointItem",{attrs:{comment:null,text:t.nextPointIndex,pointX:t.pointInfo.point.x,pointY:t.pointInfo.point.y,sceneInfo:t.currentSceneInfo,artboardRect:t.rect},on:{onLocationChange:t.onLocationChangeEditor,setConfig:t.setConfig}}):t._e(),t.preventPointEnable?e("CommentPointItem",{attrs:{comment:null,text:t.nextPointIndex,pointX:t.pointInfo.preventPoint.x,pointY:t.pointInfo.preventPoint.y,prevent:!0,artboardRect:t.rect,sceneInfo:t.currentSceneInfo}}):t._e()],2):t._e()},As=[],Is=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"comment-point",class:{prevent:t.prevent,on:t.isSelectCurrent,canMove:t.canMove},style:t.style},[e("div",{staticClass:"text",class:{on:t.isSelectCurrent},on:{mousedown:function(e){return e.stopPropagation(),t.onMouseDown.apply(null,arguments)},click:t.onClick}},[t._v(t._s(t.text))]),t.comment&&t.popMsg.visible?e("CommentPointItemCommentContent",{attrs:{comment:t.comment,popMsg:t.popMsg},on:{clickGoComment:t.setSelectComment,clickIgnore:t.ignoreThisClickPopMsg}}):t._e()],1):t._e()},Fs=[],Ms=function(){var t=this,e=t._self._c;return e("div",{staticClass:"comment-detail",on:{"!click":function(e){return t.clickIgnore.apply(null,arguments)}}},[e("div",{staticClass:"content"},[e("div",{staticClass:"summary"},[e("span",{domProps:{innerHTML:t._s(t.summaryHTML)}})]),t.attachMentImgs.length>0?e("ul",{staticClass:"attachments"},t._l(t.attachMentImgs,(function(n,i){return e("li",{key:i,on:{click:function(e){return e.preventDefault(),t.clickAttach(n)}}},[e("BlobImage",{attrs:{image:n.preview}})],1)})),0):t._e(),e("div",{staticClass:"date"},[t._v(t._s(t.comment.dateStr))])]),e("div",{staticClass:"info"},[e("div",{staticClass:"name"},[e("UserFace2",{attrs:{self:t.isSelfComment,tourist:t.isTourist,title:t.userFaceTitle,text:t.userFaceText}}),e("span",{staticClass:"name-value",attrs:{title:t.userFaceTitle}},[t._v(t._s(t.userNickName))])],1),e("a",{attrs:{href:"javascript:;"},on:{click:t.clickGoComment}},[t._v("回复")])])])},Os=[],_s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"image"},[t.loadState===t.FetchState.Fetching?e("div",{staticClass:"loading"}):t.loadState===t.FetchState.Error?e("div",{staticClass:"error",attrs:{title:"图片加载失败"}}):t._e(),t.localUrl&&t.loadState!==t.FetchState.Error?e("img",{class:{on:t.loadState===t.FetchState.Success},attrs:{src:t.localUrl},on:{load:t.onImageLoad,error:t.onImgError}}):t._e()])},Ls=[],Ps={methods:{onImageLoad:function(){this.loadState=Cn.Success,this.disposeBlobUrl()},onImgError:function(){this.loadState=Cn.Error,this.disposeBlobUrl()},loadImage:function(){var t=this.image;if(t){if(dt(t))return this.localUrl=t,void(this.loadState=Cn.Fetching);this.loadState=Cn.Fetching;try{this.localUrl=URL.createObjectURL(t)}catch(e){this.loadState=Cn.Error,this.localUrl=""}}},disposeBlobUrl:function(){var t=this.localUrl;t&&0===t.indexOf("blob:")&&URL.revokeObjectURL(t)},unloadImage:function(){var t=this.localUrl;t&&0===t.indexOf("blob:")&&(URL.revokeObjectURL(t),this.localUrl="",this.loadState=Cn.Normal)}},computed:{FetchState:function(){return Cn}},watch:{image:function(){this.unloadImage(),this.loadImage()}},beforeDestroy:function(){this.unloadImage()},created:function(){this.loadImage()},data:function(){return{localUrl:"",loadState:Cn.Normal}},props:{image:{type:[File,Blob,String]}}},Es=Ps,Ns=(n("0db5"),Object(wo["a"])(Es,_s,Ls,!1,null,"04f311d2",null)),Ds=Ns.exports,js=function(){var t=this,e=t._self._c;return e("div",{staticClass:"userface",class:{self:t.self,tourist:t.tourist},attrs:{title:t.title}},[t._v(" "+t._s(t.text)+" ")])},Rs=[],Vs={props:{title:String,text:String,self:Boolean,tourist:Boolean}},Bs=Vs,Us=(n("4d32"),Object(wo["a"])(Bs,js,Rs,!1,null,"1eb5422f",null)),Hs=Us.exports,Ws=[{name:"solve",text:"确认",enumValue:7},{name:"lookat",text:"看这",enumValue:8},{name:"great",text:"哇",enumValue:9},{name:"compare",text:"对比",enumValue:10},{name:"zhenbang",text:"赞",enumValue:6},{name:"aixin",text:"爱心",enumValue:1},{name:"wenhao",text:"问号",enumValue:4},{name:"666",text:"666",enumValue:11},{name:"tanhao",text:"惊叹",enumValue:3},{name:"zantong",text:"+1",enumValue:5},{name:"haode",text:"OK",enumValue:2},{name:"tuding",text:"图钉",enumValue:12}],$s={};function Gs(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return dt(t)?t.replace(/[<>]/g,(function(t){switch(t){case"<":return"&lt;";case">":return"&gt;"}return t})).replace(/\[([^\]]{1,4})\]/g,(function(t,n){var i=$s[n];return i?e?"":'<span class="icon-emoji emoji-'.concat(i.name,'"></span>'):t})):t}function zs(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return dt(t)&&ht(e)?(n||(t=Ys(t)),t.replace(/\[@uid:(\d+);\]/g,(function(t,i){var r=e[i];return r?n?"@".concat(r.nickName):'<span class="at-user-item" title="'.concat(r.nickName,"(").concat(r.email,')">@').concat(r.nickName,"</span>"):t}))):t}function Ys(t){return t.replace(/https?:\/\/([\w-]+\.)+[\w-]+(:\d+)?(\/[\w-+./?%&=#]*)?/gi,(function(t){return'<a class="out-link" target="_blank" title="'.concat(t,'" href="').concat(t,'">').concat(t,"</a>")}))}function Xs(t,e){return zs(Gs(t,!0),e,!0)}Ws.forEach((function(t){$s[t.text]=t,t.texts&&t.texts.forEach((function(e){$s[e]=t}))}));var Ks={components:{UserFace2:Hs,BlobImage:Ds},methods:{clickGoComment:function(){this.$emit("clickGoComment",this.comment,!0)},clickIgnore:function(){this.$emit("clickIgnore")},setCommentEditorVisibleId:function(t){this.$store.commit("setCommentEditorVisibleId",t)},clickAttach:function(t){var e=this.attachMentImgs.map((function(t){return t.imgSrc})),n=e.findIndex((function(e){return e===t.imgSrc}));-1===n&&(n=0),this.$store.commit("setImageViewer",{imgList:e,currentIndex:n})}},computed:{summaryHTML:function(){return zs(Gs(this.comment.summary),this.comment.atUsers)},users:function(){var t;return null!==(t=this.$store.state.artboardDetail.commentUsers)&&void 0!==t?t:{}},selectComment:function(){return this.$store.state.artboardDetail.selectComment},attachMentImgs:function(){var t,e=null===(t=this.comment)||void 0===t?void 0:t.attachMents,n=[];return e?(e.forEach((function(t){if(t){var e=t.thumbFileName||t.fileName;e&&n.push({imgSrc:t.fold+t.fileName,preview:t.fold+e})}})),n):n},userFaceTitle:function(){var t=this.comment;if(!t)return null;var e=t.user;return e?"".concat(e.nickName,"(").concat(e.email,")"):null},userNickName:function(){var t=this.comment;if(!t)return"-";var e=t.user;if(!e)return"-";var n=e.nickName;return n||"-"},isSelfComment:function(){var t=this.comment;if(!t)return!1;var e=t.user;return!!e&&e.userKey===this.cloudUserKey},isTourist:function(){var t=this.comment;if(!t)return!1;var e=t.user;if(!e)return!1;switch(e.authority){case K.Admin:case K.Designer:return!1}return!0},userFaceText:function(){var t=this.userNickName;return t[t.length-1]}},props:{popMsg:Object,comment:Object}},qs=Ks,Qs=(n("5705"),Object(wo["a"])(qs,Ms,Os,!1,null,"063d1465",null)),Js=Qs.exports,Zs=300,tc=227,ec=270,nc={components:{CommentPointItemCommentContent:Js},methods:{onMouseDown:function(t){this.moving=!1,window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp);var e=this.moveData;e.startX=t.clientX,e.startY=t.clientY},onMouseMove:function(t){var e=this.moveData;e.endX=t.clientX,e.endY=t.clientY,!this.moving&&(Math.abs(e.endX-e.startX)>=3||Math.abs(e.endY-e.startY)>=3)&&(this.moving=!0,this.canMove||this.showTextTip("只能移动自己发表的评注,请联系评论发布者或管理员")),this.canMove||(e.endX=e.startX,e.endY=e.startY)},onMouseUp:function(t){var e=this;window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp);var n=this.moveData,i=this.moving,r=this.canMove;if(r){if(i&&!this.prevent){n.endX=t.clientX,n.endY=t.clientY;var a=new di(this.pointX,this.pointY);if(!this.prevent){var o=this.moveData;a=Di.getCanvasLocation(this.sceneInfo,a),this.moving&&(a.left+=o.endX-o.startX,a.top+=o.endY-o.startY)}requestAnimationFrame((function(){e.$emit("onLocationChange",e.comment,a.x,a.y)}))}}else requestAnimationFrame((function(){e.moving=!1}))},onClick:function(){var t=this,e=this.comment,n=this.moving;if(!n)if(e){if(this.pointCommentShowAlways&&!this.artboardInComment)return void setTimeout((function(){var e=t.popMsg;e.ignoreThisClick=!1,e.visible=!0,t.pointInView||t.movePointToSceneCenter()}),10);this.setSelectComment(e)}else{this.showTextTip("待提交的评论评注"),this.artboardInComment||this.$store.commit("setArtboardInComment",!0);var i=300;this.artboardCommentVisible&&(i=50),this.$store.commit("artboardCommentVisible",!0),setTimeout((function(){var e=t.pointInfo.instance;e&&e.focus()}),i)}},setSelectComment:function(t,e){this.artboardInComment||this.$store.commit("setArtboardInComment",!0),this.$store.commit("setSelectComment",{comment:t,openEditor:e})},movePointToSceneCenter:function(){var t=this.sceneInfo,e=this.artboardRect,n=this.pointX,i=this.pointY,r=t.scale,a=(e.width/2-n)*r,o=(e.height/2-i)*r;this.$emit("setConfig",{sceneX:a,sceneY:o})},ignoreThisClickPopMsg:function(){var t=this.popMsg;t.ignoreThisClick=!0},hidePopMsg:function(){var t=this.popMsg;this.moving||(clearTimeout(t.handleHide),t.handleHide=setTimeout((function(){t.ignoreThisClick?t.ignoreThisClick=!1:t.visible=!1}),50))}},beforeDestroy:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("click",this.popMsg.hidePopMsg,!0),clearTimeout(this.popMsg.handleHide)},computed:{pointCommentShowAlways:function(){return this.$store.state.pointCommentShowAlways},commentVisible:function(){return this.artboardInComment&&this.artboardCommentVisible},artboardCommentVisible:function(){return this.$store.state.artboardCommentVisible},leftVisible:function(){return this.$store.state.artboardDetail.leftSideVisible},pointInfo:function(){return this.$store.state.editComment.pointInfo},isSelectCurrent:function(){var t=this.comment,e=this.selectComment;return e===t&&null!=t},selectComment:function(){return this.$store.state.artboardDetail.selectComment},canMove:function(){return!this.prevent&&(this.isSelfComment||this.cloudUserIsOwner)},isSelfComment:function(){var t=this.comment;if(!t)return!0;var e=t.user;return!!e&&e.userKey===this.cloudUserKey},pointInView:function(){var t=this.location,e=this.pointRadius/2,n=this.sceneInfo,i=n.sceneWidth,r=n.sceneHeight,a=(new ee).set(e,e,i-2*e,r-2*e);this.leftVisible&&(a.x+=tc),this.commentVisible?a.width-=Zs:this.artboardInComment||(this.curNode&&(a.width-=Zs),a.width-=ec,a.width+=2*e);var o=(new ee).set(t.x,t.y,1,1);return o.isOverlap(a)},visible:function(){if(this.prevent)return!0;if(this.isSelectCurrent)return!0;if(this.moving)return!0;var t=this.location,e=2*this.pointRadius,n=this.sceneInfo,i=n.sceneWidth,r=n.sceneHeight,a=(new ee).set(0,0,i,r),o=(new ee).set(t.x-e,t.y-e,2*e,2*e);return o.isOverlap(a)},location:function(){var t=new di(this.pointX,this.pointY);if(!this.prevent){var e=this.moveData,n=this.sceneInfo;t=Di.getCanvasLocation(n,t),this.moving&&(t.left+=e.endX-e.startX,t.top+=e.endY-e.startY)}return t},style:function(){var t=this.location,e=this.pointRadius;return{top:t.top-e+"px",left:t.left-e+"px"}}},watch:{"popMsg.visible":function(t){t?window.addEventListener("click",this.hidePopMsg,!0):window.removeEventListener("click",this.hidePopMsg,!0)},artboardInComment:function(t){t&&(this.popMsg.visible=!1)},isSelectCurrent:function(t){t&&(this.pointInView||this.movePointToSceneCenter())},pointX:function(){this.moving=!1},pointY:function(){this.moving=!1}},props:{artboardRect:{type:Object,default:null},sceneInfo:{type:Object,default:null},comment:{type:Object,default:null},text:[String,Number],pointX:Number,pointY:Number,prevent:{type:Boolean,default:!1}},data:function(){return{popMsg:{visible:!1,handleHide:0,ignoreThisClick:!1},pointRadius:15,moving:!1,moveData:{startX:0,startY:0,endX:0,endY:0}}}},ic=nc,rc=(n("b5cc"),Object(wo["a"])(ic,Is,Fs,!1,null,"37bf8e2d",null)),ac=rc.exports,oc={components:{CommentPointItem:ac},methods:{setConfig:function(t){this.$emit("setConfig",t)},onLocationChangeComment:function(t,e,n){var a=this;return Object(r["a"])(Object(i["a"])().mark((function r(){var o,s,c,l,u,d,h;return Object(i["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t){i.next=2;break}return i.abrupt("return");case 2:if(o=a.getLocation({pageX:e+a.sceneOffsetX,pageY:n+a.sceneOffsetY}),o.x!==t.pointX||o.y!==t.pointY){i.next=5;break}return i.abrupt("return");case 5:return t.pointX=o.x,t.pointY=o.y,s=t.id,c=t.artboardId,l=t.commentId,u=t.pointX,d=t.pointY,i.prev=8,i.next=11,a.fetchPostCloudApi("setcommentpointbyweb",{body:{id:s,commentId:l,artboardId:c,pointEnable:!0,pointX:u,pointY:d}});case 11:if(h=i.sent,ht(h)){i.next=14;break}return i.abrupt("return");case 14:if(h.success){i.next=16;break}throw new Error(h.errMsg);case 16:i.next=21;break;case 18:i.prev=18,i.t0=i["catch"](8),a.showTextTip("移动评注失败:".concat(i.t0));case 21:case"end":return i.stop()}}),r,null,[[8,18]])})))()},onLocationChangeEditor:function(t,e,n){var i=this.pointInfo.point,r=this.getLocation({pageX:e+this.sceneOffsetX,pageY:n+this.sceneOffsetY});r.x===i.x&&r.y===i.y||(i.x=r.x,i.y=r.y)},getLocation:function(t){var e=t.pageX,n=t.pageY,i=e,r=n,a=this.sceneOffsetX,o=this.sceneOffsetY,s=this.rect,c=this.sceneX,l=this.sceneY,u=this.scale,d=this.sceneWidth,h=this.sceneHeight,f=(d-s.width*u)/2,m=(h-s.height*u)/2;return i-=a,r-=o,i-=f,r-=m,i-=c,r-=l,i=Math.round(i/u),r=Math.round(r/u),new di(i,r)},onMouseMove:function(t){if(this.preventPointEnable){var e=this.pointInfo.preventPoint;e.x=t.clientX,e.y=t.clientY}},onMouseDownInScene:function(t){if(this.preventPointEnable){var e=this.getLocation({pageX:t.clientX,pageY:t.clientY}),n=this.pointInfo,i=n.point,r=n.preventPoint,a=n.instance;r.enable=!1,i.pointIndex=this.nextPointIndex,i.enable=!0,i.x=e.x,i.y=e.y,requestAnimationFrame((function(){a&&a.focus()}))}},onMouseDown:function(){var t=this.pointInfo.preventPoint;t.enable=!1}},watch:{nextPointIndex:function(t){var e=this.pointInfo.point;e.enable&&(e.pointIndex=t)},preventPointEnable:function(t){t?(window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mousedown",this.onMouseDown)):(window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mousedown",this.onMouseDown))}},computed:{currentSceneInfo:function(){var t=new Pi,e=this.scale,n=this.sceneWidth,i=this.sceneHeight,r=this.sceneOffsetX,a=this.sceneOffsetY,o=this.getLocation({pageX:r,pageY:a});return t.offset=o,t.scale=e,t.canvasScale=1,t.sceneWidth=n,t.sceneHeight=i,t},artboard:function(){var t;return null===(t=this.curArtboard)||void 0===t?void 0:t.artboard},rect:function(){var t,e=this.artboard,n=null!==(t=null===e||void 0===e?void 0:e.boundsInArtboard)&&void 0!==t?t:new ee,i=this.calcArtScale,r=n.width,a=n.height;return i>0&&(r=Math.round(r/i),a=Math.round(a/i)),(new ee).set(0,0,r,a)},preventPointEnable:function(){return this.pointInfo.preventPoint.enable},pointInfo:function(){return this.$store.state.editComment.pointInfo},comments:function(){return this.$store.state.artboardDetail.comments},maxPointIndex:function(){return this.$store.state.artboardDetail.maxPointIndex},nextPointIndex:function(){var t=this.pointComments,e=this.maxPointIndex;if(e>0)return e+1;var n=t[t.length-1];return n?n.pointIndex+1:1},pointComments:function(){var t=[],e=this.comments;return ut(e)?(e.forEach((function(e){ht(e)&&(e.pointEnable&&t.push(e),ut(e.comments)&&e.comments.forEach((function(e){ht(e)&&e.pointEnable&&t.push(e)})))})),t.sort((function(t,e){var n=t.pointIndex,i=e.pointIndex;return n===i&&(n=t.id,i=e.id),n>i?1:-1})),t):t},visible:function(){return this.artboardInComment||this.pointCommentShowAlways},inDrawing:function(){var t=this.$store.state.editComment;return t.drawing},artboardCommentVisible:function(){return this.$store.state.artboardCommentVisible},pointCommentShowAlways:function(){return this.$store.state.pointCommentShowAlways}},props:{sceneWidth:Number,sceneHeight:Number,sceneX:Number,sceneY:Number,sceneOffsetX:Number,sceneOffsetY:Number,scale:Number},beforeDestroy:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mousedown",this.onMouseDown)},created:function(){0}},sc=oc,cc=(n("4ac5"),Object(wo["a"])(sc,Ts,As,!1,null,"46262e84",null)),lc=cc.exports,uc=function(){var t=this,e=t._self._c;return e("section",{ref:"box",staticClass:"art-info",class:{dragging:t.dragging,scaling:t.scaling,canvas:t.useCanvasMode,figma:t.isFigmaArtboard},style:t.style,on:{contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)},click:t.clickInfoBox}},[t.useCanvasMode?t._e():[e("div",{staticClass:"name",attrs:{title:t.curArtboard.artboard.name}},[t._v(t._s(t.curArtboard.artboard.name))]),e("img",{staticClass:"preview",class:{loading:t.imgLoading},attrs:{src:t.artboardPreviewPng},on:{load:t.onImgLoad,error:t.onImgError}}),t.imgLoading?e("div",{staticClass:"img-loading"},[e("div",{staticClass:"loading"},[t._v("正在加载画板预览图...")])]):t._e()],t.artboardInComment||t.scaling?t._e():[e("NodeItem",{attrs:{parentRect:t.curArtboard.artboard.boundsInArtboard,item:t.curArtboard.artboard,shiftKey:t.shiftKey}}),t._l(t.exportNodes,(function(t,n){return e("SliceTip",{key:"".concat(n,"+").concat(t.guid),attrs:{node:t}})})),e("NodeInfoCurrent"),e("NodeIntersectInfo",{attrs:{width:t.rect.width,height:t.rect.height}})]],2)},dc=[],hc=function(){var t=this,e=t._self._c;return t.visibleMax?e("div",{staticClass:"node-item-wrap",class:{master:t.visibleOutChild},style:t.style},[t.item.mlIgnoreEvent?t._e():e("div",{staticClass:"node-item",on:{click:function(e){return e.stopPropagation(),t.clickNode.apply(null,arguments)},mouseenter:function(e){return e.stopPropagation(),t.mouseEnterNode.apply(null,arguments)},mouseleave:function(e){return e.stopPropagation(),t.mouseLeaveNode.apply(null,arguments)}}}),t._l(t.children,(function(n,i){return e("NodeItem",{key:"".concat(i,"_").concat(n.guid),attrs:{parentRect:t.item.boundsInArtboard,item:n,shiftKey:t.shiftKey}})}))],2):t.visibleMin?e("div",{staticClass:"node-item-wrap on",class:{hotspot:t.isHotSpot},style:t.style,on:{click:function(e){return e.stopPropagation(),t.clickNode.apply(null,arguments)},mouseenter:function(e){return e.stopPropagation(),t.mouseEnterNode.apply(null,arguments)},mouseleave:function(e){return e.stopPropagation(),t.mouseLeaveNode.apply(null,arguments)}}}):t._e()},fc=[],mc={name:"NodeItem",methods:{mouseLeaveNode:function(){this.inMultDownMode||this.shiftKey&&null!=this.curNode||this.setEnterNode(null)},mouseEnterNode:function(){this.inMultDownMode||this.shiftKey&&null!=this.curNode||this.setEnterNode(this.item)},getNodesFromPoint:function(t){var e=t.target;if(e){var n,i=t.offsetX;null==i?(i=t.layerX,n=t.layerY):n=t.offsetY;var r=this.scale;i/=r,n/=r;var a="".concat(i,"_").concat(n),o=this.cachePointNodes;if(o.key===a)return o.nodes;var s=this.item.boundsInArtboard,c=(new ee).set(s.x+i,s.y+n,1,1),l=this.curArtboard.childs,u=[];return l.forEach((function(t){if(t&&t.visible&&!t.mlIgnoreEvent){var e=t.boundsInArtboard;if(e.width<=2||e.height<=2){var n=e,i=n.x,r=n.y,a=n.width,o=n.height;e=(new ee).set(i,r,a,o),e.width<=2&&(e.width+=2,e.x-=1),e.height<=2&&(e.height+=2,e.y-=1)}ce(e,c)&&u.push(t)}})),o.key=a,o.nodes=u,u}},clickNode:function(t){var e=this.item;if(this.inMultDownMode)e.markedForExport&&(e.mlUserSelectDown=!e.mlUserSelectDown);else{var n=this.curNode,i=!1;if(null!=n&&this.shiftKey&&(n=this.enterNode,i=!0),null!=n&&this.clickedNode===e&&Math.abs(this.clickPageX-t.pageX)<2&&Math.abs(this.clickPageY-t.pageY)<2){var r=this.getNodesFromPoint(t),a=r.findIndex((function(t){return t===n}));if(-1===a)a=r.length-1;else{var o=n.boundsInArtboard;while(a--&&a>=0){var s=r[a],c=s.boundsInArtboard;if(!ne(c,o)||s.markedForExport||s.renderTapInteraction||1===s.types.Artboard||1!==s.types.GraphicNode&&1!==s.types.Group&&1!==s.types.SymbolMaster&&1!==s.types.SymbolInstance||s.fillEnabled||s.strokeEnable||s.shadow||s.innerShadow)break}a<0&&(a=r.length-1)}var l=r[a];n=l||e}else n=e;this.clickPageX=t.pageX,this.clickPageY=t.pageY,i?this.setEnterNode(n):this.setCurNode(n),this.setClickedNode(e)}}},computed:{visibleOutChild:function(){var t;return 1===(null===(t=this.item.types)||void 0===t?void 0:t.GroupVisibleOutChild)},children:function(){return this.item.children||[]},visibleMax:function(){return this.visible&&this.children.length>0},visibleMin:function(){return!this.visibleMax&&this.visible&&!this.item.mlIgnoreEvent&&!this.item.mlIgnoreScene},visible:function(){var t=this.item;return!!t&&(!!t.visible&&!t.mlIgnoreLeftSide)},isHotSpot:function(){var t=this.item;return!!t&&t.type===v.HotSpot},scale:function(){return this.scaleArtboard},style:function(){var t=this.item.boundsInArtboard,e=this.parentRect,n=this.scale,i=Math.ceil(Math.max(1,t.width*n)),r=Math.ceil(Math.max(1,t.height*n)),a=Math.round((t.y-e.y)*n),o=Math.round((t.x-e.x)*n);return i<3&&(i+=2,o-=1),r<3&&(r+=2,a-=1),{top:a+"px",left:o+"px",width:i+"px",height:r+"px"}}},props:{item:Object,shiftKey:Boolean,parentRect:Object},data:function(){return{clickPageX:0,clickPageY:0,cachePointNodes:{nodes:null,key:""}}}},pc=mc,vc=(n("b2f4"),Object(wo["a"])(pc,hc,fc,!1,null,"7ded3e93",null)),bc=vc.exports,gc=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"node-info-current",class:{"only-enter":null==t.curNode},style:t.showNodeStyle},[t.curNode?t._l(t.borRadios,(function(n){return e("div",{key:n,class:["bor bor-"+n],style:t.borderStyle})})):t._e(),t.showNodeSize?[e("div",{staticClass:"item width",style:t.nodeWidthStyle},[e("span",[t._v(t._s(t.nodeRect.showWidth))])]),e("div",{staticClass:"item height",style:t.nodeHeightStyle},[e("span",[t._v(t._s(t.nodeRect.showHeight))])])]:t._e()],2):t._e()},wc=[],xc={computed:{showNodeSize:function(){var t=this.curNode,e=this.enterNode;return t?!e||e===t:!!e},nodeRect:function(){if(!this.showNodeSize)return{width:0,height:0,top:0,left:0};var t=this.showNode,e=t.boundsInArtboard,n=this.scaleArtboard,i=t.markedForExport,r={width:Math.ceil(e.width*n),height:Math.ceil(e.height*n),left:Math.floor(e.x*n),top:Math.floor(e.y*n),showWidth:this.getCalcPlatformValue(e.width,{markedForExport:i}),showHeight:this.getCalcPlatformValue(e.height,{markedForExport:i})};return r},nodeWidthStyle:function(){var t=this.nodeRect;return{left:Math.ceil(t.width/2)+"px"}},nodeHeightStyle:function(){var t=this.nodeRect;return{left:t.width+1+"px",top:Math.ceil(t.height/2)+"px"}},borderStyle:function(){var t=this.borderWidth;return"width:".concat(t,";height:").concat(t,";")},borderWidth:function(){var t=2.3*this.scaleArtboard+3;return t=Math.round(t),t+"px"},borRadios:function(){return[0,1,2,3]},visible:function(){if(this.inMultDownMode)return!1;var t=this.showNode;return!!t},showNode:function(){var t=this.curNode;return t||(t=this.enterNode),t},showNodeStyle:function(){var t=this.showNode;if(t){var e=t.boundsInArtboard,n=this.scaleArtboard;return{top:Math.floor(e.y*n)+"px",left:Math.floor(e.x*n)+"px",width:Math.ceil(Math.max(1,e.width)*n)+"px",height:Math.ceil(Math.max(1,e.height)*n)+"px"}}}}},yc=xc,kc=(n("4ea7"),Object(wo["a"])(yc,gc,wc,!1,null,"b0c4333c",null)),Cc=kc.exports,Sc=function(){var t=this,e=t._self._c;return t.visible?e("section",{staticClass:"node-info"},[e("div",{staticClass:"enter-item-box",style:t.enterNodeStyle}),t._l(t.markLines,(function(n){return e("div",{key:n.id,staticClass:"item",class:{horizintal:n.isHorizintal,vertical:!n.isHorizintal,dashed:n.isDashed},style:t.getMarkStyle(n)},[n.text?e("span",[t._v(t._s(n.text))]):t._e()])}))],2):t._e()},Tc=[],Ac={methods:{getMarkStyle:function(t){var e=this.scale,n=this.markScale;0===n&&(n=1),e/=n;var i,r,a=t.rect,o={top:Math.floor(a.top*e)+"px",left:Math.floor(a.left*e)+"px"};return t.isHorizintal?(i="height",r="width"):(i="width",r="height"),o[i]=a[i]+"px",o[r]=Math.ceil(a[r]*e)+"px",o},getMarkLines:function(){var t=this;if(!this.visible)return[];var e=this.curNode,n=this.enterNode,i=e.boundsInArtboard,r=n.boundsInArtboard,a=(new ee).set(i.x,i.y,i.width,i.height),o=(new ee).set(r.x,r.y,r.width,r.height),s={width:this.getCalcValue(this.width),height:this.getCalcValue(this.height)},c=e.markedForExport;a.x=this.getCalcValue(a.x),a.y=this.getCalcValue(a.y),a.width=this.getCalcValue(a.width,c),a.height=this.getCalcValue(a.height,c);var l=n.markedForExport;return o.x=this.getCalcValue(o.x),o.y=this.getCalcValue(o.y),o.width=this.getCalcValue(o.width,l),o.height=this.getCalcValue(o.height,l),this.markScale=this.getCalcRectScale(),se(a,o,s,(function(e){return t.getCalcUnitTemplateValue(e)}))}},watch:{curNode:function(){this.markLines=this.getMarkLines()},enterNode:function(){this.markLines=this.getMarkLines()},visible:function(t){t&&(this.markLines=this.getMarkLines())}},computed:{enterNodeStyle:function(){var t=this.enterNode;if(t){var e=t.boundsInArtboard,n=this.scaleArtboard;return{top:Math.floor(e.y*n)+"px",left:Math.floor(e.x*n)+"px",width:Math.ceil(Math.max(1,e.width)*n)+"px",height:Math.ceil(Math.max(1,e.height)*n)+"px"}}},scale:function(){return this.scaleArtboard},visible:function(){return!this.inMultDownMode&&null!=this.curNode&&null!=this.enterNode&&this.enterNode!==this.curNode}},props:{width:Number,height:Number},data:function(){return{markScale:1,markLines:[]}},mounted:function(){this.markLines=this.getMarkLines()}},Ic=Ac,Fc=(n("dd65"),Object(wo["a"])(Ic,Sc,Tc,!1,null,"52b47548",null)),Mc=Fc.exports,Oc=function(){var t=this,e=t._self._c;return t.inMultDownMode&&t.node.mlUserSelectDown?e("div",{staticClass:"slice-tip",class:{out:!t.inArtboard},style:t.style,on:{click:function(e){e.stopPropagation(),t.node.mlUserSelectDown=!1}}},[e("div",{staticClass:"name",attrs:{title:"点击取消选择\n".concat(t.nodeName)}},[t._v(" "+t._s(t.nodeName)+" ")])]):t.inMultDownMode||t.inArtboard?e("div",{staticClass:"slice-tip-min",class:{off:t.curNode==t.node||t.enterNode==t.node,out:!t.inArtboard},style:t.style,on:{click:t.clickSliceTipMin}}):t._e()},_c=[],Lc={methods:{clickSliceTipMin:function(){(this.inMultDownMode||this.inArtboard)&&(this.node.mlUserSelectDown=!0)}},computed:{nodeName:function(){return Ke(this.node)},style:function(){var t=this.node.boundsInArtboard,e=this.scaleArtboard;return{top:Math.floor(t.y*e)+"px",left:Math.floor(t.x*e)+"px",width:Math.ceil(Math.max(1,t.width)*e)+"px",height:Math.ceil(Math.max(1,t.height)*e)+"px"}},inArtboard:function(){var t=this.node.boundsInArtboard,e=ce(t,this.curArtboard.artboard.boundsInArtboard);return e}},props:{node:Object}},Pc=Lc,Ec=(n("2919"),Object(wo["a"])(Pc,Oc,_c,!1,null,"a981df72",null)),Nc=Ec.exports,Dc={components:{NodeItem:bc,NodeIntersectInfo:Mc,NodeInfoCurrent:Cc,SliceTip:Nc},methods:{onImgLoad:function(){this.imgState=Cn.Success},onImgError:function(){this.imgState=Cn.Error},setSelectComment:function(t){this.$store.commit("setSelectComment",t)},onContextmenu:function(t){var e=this,n=t.pageX,i=t.pageY,r=this.curArtboard;requestAnimationFrame((function(){e.$store.commit("setArtboardMenu",{visible:!0,x:n,y:i,artboard:r})}))},setArtboardCommentVisible:function(t){this.$store.commit("artboardCommentVisible",t)},clickInfoBox:function(){this.setSelectComment(null),this.setArtboardCommentVisible(!0)},clickZoomContainer:function(){this.artboardInComment?(this.setSelectComment(null),this.setArtboardCommentVisible(!1)):this.setCurNode(null)},onSceneResize:function(t,e,n){if(!this.initScale||n){var i=this.rect;if(i&&0!==t&&0!==e){this.initScale=!0;var r=i.width/t,a=i.height/e,o=Math.max(r,a);0!==o&&this.setScaleArtboard(.92/o)}}},quickKey:function(t){this.shiftKey=t.shiftKey}},computed:{isFigmaArtboard:function(){return this.fileType===u.FIGMA},fileType:function(){var t,e,n=this.artboard;return null!==(t=null===(e=n.mlConfig)||void 0===e?void 0:e.fileType)&&void 0!==t?t:n.fileType},artRenderInCanvasMode:function(){return this.$store.state.artRenderInCanvasMode},useCanvasMode:function(){return this.inCloudMode&&this.artRenderInCanvasMode},imgLoading:function(){return this.imgState===Cn.Fetching},artboardCommentVisible:function(){return this.$store.state.artboardCommentVisible},exportVisible:function(){return this.inMultDownMode&&this.exportNodes.length>0},exportNodes:function(){var t=this.curArtboard;if(!t)return[];var e=t.exportNodes;return e||[]},rect:function(){var t=this.artboard,e=t.boundsInArtboard,n=e.x+e.width,i=e.y+e.height;return(new ee).set(0,0,n,i)},artboard:function(){return this.curArtboard.artboard},artboardPreviewPng:function(){var t,e=this.inCloudMode,n=this.artboard;return e&&this.isSupportWebp&&(t=n.artboardPreviewWebp,t)?t:(t=n.artboardPreviewPng,e?t:"".concat(t,"?").concat(n.mlOutputTime))},isSupportWebp:function(){return this.$store.state.isSupportWebp===Oa.Support},style:function(){var t,e=this.useCanvasMode,n=this.artboard,i=this.scale,r=n.boundsInArtboard;if(!e&&n.fill&&n.fillEnabled){var a=n.fill.value;a&&(t=Ft(a).value)}return{backgroundColor:t,width:Math.ceil(r.width*i)+"px",height:Math.ceil(r.height*i)+"px"}},scale:function(){return this.scaleArtboard}},watch:{artboardPreviewPng:function(t){t&&(this.imgState=Cn.Fetching)},curArtboard:function(){this.initScale=!1},artboardInComment:function(t){t&&this.setCurNode(null)}},data:function(){return{imgState:Cn.Normal,previewImage:null,shiftKey:!1,initScale:!1}},props:{sceneWidth:Number,sceneHeight:Number,dragging:Boolean,scaling:Boolean},created:function(){window.addEventListener("keydown",this.quickKey),window.addEventListener("keyup",this.quickKey)},beforeDestroy:function(){window.removeEventListener("keydown",this.quickKey),window.removeEventListener("keyup",this.quickKey);var t=this.previewImage;t&&(t.src=null,t=null)}},jc=Dc,Rc=(n("51bd"),Object(wo["a"])(jc,uc,dc,!1,null,"64765ae4",null)),Vc=Rc.exports,Bc=function(){var t=this,e=t._self._c;return e("section",{ref:"box",staticClass:"art-list",class:{dragging:t.dragging},style:t.style},[e("div",{staticClass:"box-size",style:t.boxSize}),t._l(t.renderDocuments,(function(n){return e("div",{key:n.guid,staticClass:"art-doc"},[n.sections?t._l(n.sections,(function(i){return e("SectionItem",{key:n.guid+i.guid,attrs:{sectionItem:i,maxRect:{x:n.maxRect.x-n.rect.x+t.rect.x,y:n.maxRect.y-n.rect.y+t.rect.y}}})})):t._e(),t._l(n.arts,(function(i){return e("ArtboardListItem",{key:n.guid+i.artboard.guid,attrs:{item:i,maxRect:{x:n.maxRect.x-n.rect.x+t.rect.x,y:n.maxRect.y-n.rect.y+t.rect.y}}})}))],2)}))],2)},Uc=[],Hc=function(){var t=this,e=t._self._c;return e("section",{ref:"$item",staticClass:"item",class:{on:t.selected,figma:t.isFigmaArtboard},style:t.style},[e("div",{staticClass:"info",domProps:{textContent:t._s(t.artboard.name)}}),e("div",{staticClass:"img",style:t.imgStyle,attrs:{title:t.goInfoTip},on:{mouseenter:t.onMouseEnter,dblclick:function(e){return t.dlbClickArtboard()},click:t.clickArtboard,mouseleave:t.onMouseLevel,contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)}}},[t.artboard.flowStart?e("div",{staticClass:"interaction-home"}):t._e(),t.errorText?e("div",{staticClass:"error"},[t._v(t._s(t.errorText))]):e("img",{attrs:{src:t.artboardPreviewPng}})]),t.interactionVisible?e("artboard-item-interactions",{attrs:{renderInteractions:t.renderInteractions,item:t.item}}):t._e()],1)},Wc=[],$c=function(){var t=this,e=t._self._c;return t.visible?e("svg",{staticClass:"artboard-interaction-list",class:{light:t.light}},[t._l(t.arrows,(function(n){return[e("path",{key:n.key+"_rect",class:t.getPathCls(n,"rect"),attrs:{d:n.item.nodeRect}}),e("path",{key:n.key+"_line",class:t.getPathCls(n,"line"),attrs:{d:n.item.curve}}),e("image",{key:n.key+"_arrow_icon",attrs:{x:n.item.arrowIcon.x,y:n.item.arrowIcon.y,width:n.item.arrowIcon.width,height:n.item.arrowIcon.height,href:t.isLightArrow(n)?n.item.arrowIcon.href:n.item.arrowIcon.href_default}})]}))],2):t._e()},Gc=[],zc={methods:{isLightArrow:function(t){var e,n=this.enterArtboard,i=this.light;return!!i||null!=t.toArtboardItem&&null!=n&&(null===(e=n.artboard)||void 0===e?void 0:e.cid)===t.toArtboardItem.cid},getPathCls:function(t,e){var n,i=[];e&&(ut(e)||(e=[e]),i.push.apply(i,Object(Gn["a"])(e)));var r=this.enterArtboard;return null!=t.toArtboardItem&&null!=r&&(null===(n=r.artboard)||void 0===n?void 0:n.cid)===t.toArtboardItem.cid&&i.push("light"),i}},computed:{light:function(){var t=this.enterArtboard,e=this.item;return t===e},enterArtboard:function(){return this.$store.state.enterArtboard},visible:function(){return!this.inArtboardMultDownMode&&this.arrows.length>0},arrows:function(){var t=[],e=this.item.artboard,n=e.pageGuid||e.docGuid,i=e.boundsInParentForList,r=this.renderDocuments;return this.renderInteractions.forEach((function(e){var a,o=sr(r,e,i,n);o&&t.push({item:o,key:e.guid,toArtboardItem:null===(a=e.renderTapInteraction)||void 0===a?void 0:a.toArtboardItem})})),t}},props:{renderInteractions:Array,item:Object}},Yc=zc,Xc=(n("3d65"),Object(wo["a"])(Yc,$c,Gc,!1,null,"1dbb33d3",null)),Kc=Xc.exports,qc={components:{ArtboardItemInteractions:Kc},methods:{onMouseEnter:function(){this.$store.commit("enterArtboard",this.item)},onMouseLevel:function(){this.$store.commit("enterArtboard",null)},onContextmenu:function(t){var e=this,n=t.pageX,i=t.pageY,r=this.item;requestAnimationFrame((function(){e.$store.commit("setArtboardMenu",{visible:!0,x:n,y:i,artboard:r})}))},dlbClickArtboard:function(){clearTimeout(this.tipHandle),this.inArtboardMultDownMode||(this.hideTextTip(),this.setCurArtboard(this.item))},clickArtboard:function(){var t=this;clearTimeout(this.tipHandle),this.inArtboardMultDownMode?this.item.mlUserSelectDown=!this.item.mlUserSelectDown:this.tipHandle=setTimeout((function(){t.showTextTip(t.goInfoTip2,7)}),200)},loadedImage:function(t){if(null==t)return this.imgErrored=!0,void(this.imgLoaded=!1);this.imgErrored=!1,this.imgLoaded=!0},loadImage:function(){var t=this.artboardPreviewPng;t&&(this.imgErrored=!1,this.imgLoaded=!1,we.add(t,this.loadedImage))}},beforeDestroy:function(){clearTimeout(this.tipHandle),we.remove(this.artboardPreviewPng,this.loadedImage)},created:function(){this.loadImage()},watch:{artboardPreviewPng:function(t,e){this.imgErrored=!1,we.remove(e,this.loadedImage),this.loadImage()}},computed:{isFigmaArtboard:function(){return this.fileType===u.FIGMA},fileType:function(){var t,e,n=this.artboard;return null!==(t=null===(e=n.mlConfig)||void 0===e?void 0:e.fileType)&&void 0!==t?t:n.fileType},artboardShowInteractionLine:function(){return this.$store.state.artboardShowInteractionLine},renderInteractions:function(){var t;if(!this.inCloudMode)return null;var e=this.item.artboard.interactionInfo;if(!e)return null;if(e.fetchState!==Cn.Success)return null;var n=null===(t=e.data)||void 0===t?void 0:t.renderInteractions;return ut(n)&&n.length>0?n:null},interactionVisible:function(){return this.artboardShowInteractionLine&&!!this.renderInteractions},errorText:function(){return this.imgErrored?"画板预览图加载失败":this.imgLoaded?null:"预览图加载中..."},outlineWidth:function(){if(this.inArtboardMultDownMode)return Math.ceil(3/this.scaleList)+"px"},selected:function(){return this.inArtboardMultDownMode&&this.item.mlUserSelectDown},goInfoTip2:function(){return pa(this.item.artboard,this.inCloudMode)},goInfoTip:function(){if(this.inArtboardMultDownMode)return"单击选中/取消选中";var t=this.item.artboard;return this.inCloudMode?fa(t):"双击查看 ".concat(t.name," 标注详情")},style:function(){var t=40,e=this.artboard.boundsInParentForList,n=this.maxRect,i=Math.floor(e.y-n.y-t),r=Math.floor(e.x-n.x),a=Math.ceil(e.width),o=Math.ceil(e.height+t);return"top:".concat(i,"px;left:").concat(r,"px;width:").concat(a,"px;height:").concat(o,"px;")},imgStyle:function(){var t=this.artboard.boundsInParentForList;return"height:".concat(t.height,"px;outline-width:").concat(this.outlineWidth)},artboardPreviewPng:function(){var t,e=this.inCloudMode,n=this.artboard;return e&&this.isSupportWebp&&(t=n.artboardPreviewWebp,t)?t:(t=n.artboardPreviewPng,e?t:"".concat(t,"?").concat(n.mlOutputTime))},isSupportWebp:function(){return this.$store.state.isSupportWebp===Oa.Support},artboard:function(){return this.item.artboard}},data:function(){return{tipHandle:0,imgErrored:!1,imgLoaded:!1}},props:{item:Object,maxRect:Object}},Qc=qc,Jc=(n("1cac"),Object(wo["a"])(Qc,Hc,Wc,!1,null,"37d1506c",null)),Zc=Jc.exports,tl=function(){var t=this,e=t._self._c;return e("div",{staticClass:"section-item",style:t.style},[e("div",{staticClass:"title"},[t._v(t._s(t.sectionItem.name))])])},el=[],nl={computed:{style:function(){var t,e,n=this.sectionItem,i=0,r=n.boundsInParentForList,a=this.maxRect,o=Math.floor(r.y-a.y-i)+"px",s=Math.floor(r.x-a.x)+"px",c=Math.ceil(r.width)+"px",l=Math.ceil(r.height+i)+"px";return Object(Q["a"])(Object(Q["a"])({},null!==(t=null===(e=n.cssStyle)||void 0===e?void 0:e.style)&&void 0!==t?t:{}),{},{top:o,left:s,width:c,height:l})}},props:{maxRect:Object,sectionItem:Object}},il=nl,rl=(n("8a88"),Object(wo["a"])(il,tl,el,!1,null,"152f7b94",null)),al=rl.exports,ol={components:{ArtboardListItem:Zc,SectionItem:al},methods:{quickKey:function(t){if(!this.inArtboardMode){var e=t.keyCode||t.which;switch(e){case 112:case 113:case 114:var n=e-111;this.inArtboardMode||this.showTextTip("快捷键[F".concat(n,"]仅在画板详情面板可用,您当前处于画板列表面板,双击画板可进入详情")),t.preventDefault();break}}},onSceneResize:function(t,e,n){if(!this.initScale||n){var i=this.rect;if(i&&0!==t&&0!==e){this.initScale=!0;var r=i.width/t,a=i.height/e,o=Math.max(r,a);if(0!==o){o=.96/o;var s=this.scale;this.setScaleList(o),o=this.scale,this.resetScaleSceneCenter(o,s)}}}},resetScaleSceneCenter:function(t,e){e!==this.scale&&this.$store.commit("resetScaleSceneCenter",{newScale:t,oldScale:e})}},created:function(){window.addEventListener("keydown",this.quickKey)},beforeDestroy:function(){window.removeEventListener("keydown",this.quickKey)},data:function(){return{initScale:!1}},computed:{rect:function(){var t=40,e=this.renderDocuments,n=[];e.forEach((function(t){n.push({artboard:{boundsInParent:t.rect}})}));var i=Ae(n);return i.y-=t,i.height+=t,i},scale:function(){return this.scaleList},style:function(){var t=this.rect;if(t)return{transform:"scale(".concat(this.scale,") translate3d(0,0,0)")}},boxSize:function(){var t=this.rect;if(t)return{width:t.width+"px",height:t.height+"px"}}},props:{sceneWidth:Number,sceneHeight:Number,dragging:Boolean}},sl=ol,cl=(n("71f6"),Object(wo["a"])(sl,Bc,Uc,!1,null,"438edef5",null)),ll=cl.exports,ul=function(){var t=this,e=t._self._c;return e("div",{staticClass:"canvas-box",attrs:{title:t.mouseenterArtboardTitle},on:{mousemove:t.onMouseMove,mouseleave:t.onMouseLeave,dblclick:t.dblClickCanvas,click:t.clickCanvas,contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)}}},[t.sectionVisible?e("canvas",{ref:"canvasSection",style:t.canvasStyleSection,attrs:{width:t.canvasWidth,height:t.canvasHeight}}):t._e(),e("canvas",{ref:"canvas",style:t.canvasStyle,attrs:{width:t.canvasWidth,height:t.canvasHeight}}),t.mouseenterArtboardStyle?e("div",{staticClass:"artboard-hover",style:t.mouseenterArtboardStyle}):t._e()])},dl=[],hl={methods:{getInViewerInteractions:function(){var t=[];if(!this.artboardShowInteractionLine)return t;var e=this.sceneX,n=this.sceneY,i=this.scale,r=this.sceneWidth,a=this.sceneHeight,o=this.artboardInteractions,s=this.mouseenterArtboard;if(0===i||0===r||0===a)return t;var c=(new ee).set(-e/i,-n/i,r/i,a/i);return Object.keys(o).forEach((function(e){var n=o[e];ut(n)&&0!==n.length&&n.forEach((function(e){var n,i,r=Object(Q["a"])({},e.canvasData.drawRect);r.x+=e.art.rect.x,r.y+=e.art.rect.y,e.isEnter=null!=s&&(s===e.art||(null===(n=e.toArtboardItem)||void 0===n?void 0:n.cid)===(null===(i=s.artboard)||void 0===i||null===(i=i.artboard)||void 0===i?void 0:i.cid));var a=ce(r,c);a&&t.push(e)}))})),t.sort((function(t,e){return t.isEnter&&e.isEnter?0:t.isEnter?1:e.isEnter?-1:0})),t},attachImgs:function(t,e){var n=this;ut(t)&&(e?t.forEach((function(t){we.add(t.imgSrc,n.imgLoaded,t),we.add(t.miniImgSrc,n.miniImgLoaded,t)})):t.forEach((function(t){we.remove(t.imgSrc,n.imgLoaded,t),we.remove(t.miniImgSrc,n.miniImgLoaded,t),t.img=null,t.loaded=!1})))},getRenderInteractions:function(t){var e;if(!this.inCloudMode)return null;var n=t.interactionInfo;if(!n)return null;if(n.fetchState!==Cn.Success)return null;var i=null===(e=n.data)||void 0===e?void 0:e.renderInteractions;return ut(i)&&i.length>0?i:null},onContextmenu:function(t){var e=this,n=this.mouseenterArtboard;if(n){var i=t.pageX,r=t.pageY;requestAnimationFrame((function(){e.$store.commit("setArtboardMenu",{visible:!0,x:i,y:r,artboard:n.artboard})}))}},dblClickCanvas:function(){var t=this.mouseenterArtboard,e=this.inArtboardMultDownMode;!e&&t&&(clearTimeout(this.tipHandle),this.hideTextTip(),this.setCurArtboard(t.artboard))},clickCanvas:function(){var t=this,e=Math.abs(Date.now()-this.draggingTime);if(!(e<66)){clearTimeout(this.tipHandle);var n=this.mouseenterArtboard,i=this.inArtboardMultDownMode;if(n){if(i)return n.artboard.mlUserSelectDown=!n.artboard.mlUserSelectDown,void this.draw(n,!0);var r=n.artboard;this.tipHandle=setTimeout((function(){t.showTextTip(t.goInfoTip2(r),7)}),200)}}},goInfoTip2:function(t){return pa(t.artboard,this.inCloudMode)},onMouseMove:function(t){var e=this.mouseLoc;e.x=t.layerX,e.y=t.layerY,null==e.x&&(e.x=t.pageX-this.sceneOffsetX,e.y=t.pageY-this.sceneOffsetY)},onMouseLeave:function(){var t=this.mouseLoc;t.x=t.y=-10},quickKey:function(t){var e=t.keyCode||t.which;switch(e){case 112:case 113:case 114:var n=e-111;this.inArtboardMode||this.showTextTip("快捷键[F".concat(n,"]仅在画板详情面板可用,您当前处于画板列表面板,双击画板可进入详情")),t.preventDefault();break}},drawAllDelay:function(){var t=this,e=Date.now();e-this.drawAllTime>=100?(this.drawAllTime=e,clearTimeout(this.handleDrawAllDelay),this.draw(null,!0)):(clearTimeout(this.handleDrawAllDelay),this.handleDrawAllDelay=setTimeout((function(){clearTimeout(t.handleDrawAllDelay),t.draw(null,!0)}),66.67))},drawSection:function(t,e){var n=this;if(t||e)requestAnimationFrame((function(){n._drawSection(t,e)}));else{var i=this.sceneInfoSection,r=this.sceneWidth,a=this.sceneHeight,o=i.sceneWidth!==r||i.sceneHeight!==a||Date.now()-this.sceneDelayTimes.section>100?1:0;if(o)return clearTimeout(this.sceneDelayHandleSection),cancelAnimationFrame(this.handleSection),void(this.handleSection=requestAnimationFrame((function(){n._drawSection(t)})));clearTimeout(this.sceneDelayHandleSection),cancelAnimationFrame(this.handleSection),this.sceneDelayHandleSection=setTimeout((function(){cancelAnimationFrame(n.handleSection),n.handleSection=requestAnimationFrame((function(){n._drawSection(t)}))}),33)}},draw:function(t,e){var n=this;if(t||e)requestAnimationFrame((function(){n._draw(t,e)}));else{var i=this.sceneInfo,r=this.sceneWidth,a=this.sceneHeight,o=this.inArtboardMultDownMode,s=i.sceneWidth!==r||i.sceneHeight!==a||Date.now()-this.sceneDelayTimes.artboard>100?1:0;if(s||o!=i.inArtboardMultDownMode)return clearTimeout(this.sceneDelayHandle),cancelAnimationFrame(this.handle),void(this.handle=requestAnimationFrame((function(){n._draw(t)})));clearTimeout(this.sceneDelayHandle),cancelAnimationFrame(this.handle),this.sceneDelayHandle=setTimeout((function(){cancelAnimationFrame(n.handle),n.handle=requestAnimationFrame((function(){n._draw(t)}))}),33)}},getRectSections:function(t){var e=[],n=null===t||void 0===t?void 0:t.rect;if(!n)return e;n=(new ee).set(n.x,n.y,n.width,n.height);var i=this.inViewerSections;return i.forEach((function(t){var i=(new ee).set(t.rect.x,t.rect.y,t.rect.width,t.rect.height);i.isOverlap(n)&&e.push(t)})),e},getRectArtboards:function(t){var e,n=this,i=[],r=null===t||void 0===t?void 0:t.rect;if(!r)return i;r=(new ee).set(r.x,r.y,r.width,r.height),t.artboard.artboard.flowStart&&(e=this.getFlowStartIconRect(t),e=(new ee).set(e.x,e.y,e.width,e.height));var a=this.inViewerArtboards;return a.forEach((function(t){var a=(new ee).set(t.rect.x,t.rect.y,t.rect.width,t.rect.height);if(a.isOverlap(r))i.push(t);else if(e&&e.isOverlap(a))i.push(t);else if(t.artboard.artboard.flowRect){var o=n.getFlowStartIconRect(t);if(o=(new ee).set(o.x,o.y,o.width,o.height),o.isOverlap(r))return void i.push(t);if(e&&e.isOverlap(o))return void i.push(t)}})),i},_drawSection:function(t,e){var n=this;clearTimeout(this.sceneDelayHandleSection),cancelAnimationFrame(this.handleSection),this.sceneDelayTimes.section=Date.now();var i=this.sceneX,r=this.sceneY,a=this.scale,o=this.sceneWidth,s=this.sceneHeight,c=this.sceneInfoSection,l=this.drawInfoSection;if(c.sceneX=i,c.sceneY=r,c.scale=a,c.sceneWidth=o,c.sceneHeight=s,0!==a&&0!==o&&0!==s){var u=!t,d=!(l.scale===a&&l.sceneX===i&&l.sceneY===r&&l.sceneWidth===o&&l.sceneHeight===s);if(!u||d||e){var h=this.$refs.canvasSection;if(h){l.scale=a,l.sceneX=i,l.sceneY=r,l.sceneWidth=o,l.sceneHeight=s;var f,m=h.getContext("2d"),p=!1;u||d?(this.drawAllTimeSection=Date.now(),m.clearRect(0,0,this.getCanvasDrawNum(o),this.getCanvasDrawNum(s)),f=this.inViewerSections,p=!0):f=this.getRectSections(t);var v=(new ee).set(-i,-r,o,s),b=(new ee).set(v.x/a,v.y/a,v.width/a,v.height/a);!p&&f.forEach((function(t){n._cleanBackgroundSection(m,t,v,a)})),f.forEach((function(t){n._drawSectionItem(m,v,b,a,t)}))}}}},_draw:function(t,e){var n=this;clearTimeout(this.sceneDelayHandle),cancelAnimationFrame(this.handle),this.sceneDelayTimes.artboard=Date.now();var i=this.sceneX,r=this.sceneY,a=this.scale,o=this.sceneWidth,s=this.sceneHeight,c=this.sceneInfo,l=this.inArtboardMultDownMode;if(c.sceneX=i,c.sceneY=r,c.scale=a,c.sceneWidth=o,c.sceneHeight=s,c.inArtboardMultDownMode=l,0!==a&&0!==o&&0!==s){var u=this.drawInfo,d=!t,h=!(u.scale===a&&u.sceneX===i&&u.sceneY===r&&u.sceneWidth===o&&u.sceneHeight===s&&u.inArtboardMultDownMode===l);if(!d||h||e){var f=this.$refs.canvas;if(f){u.scale=a,u.sceneX=i,u.sceneY=r,u.sceneWidth=o,u.sceneHeight=s,u.inArtboardMultDownMode=l;var m,p=f.getContext("2d"),v=!1;d||h?(this.drawAllTime=Date.now(),p.clearRect(0,0,this.getCanvasDrawNum(o),this.getCanvasDrawNum(s)),m=this.inViewerArtboards,v=!0):m=this.getRectArtboards(t);var b=(new ee).set(-i,-r,o,s),g=(new ee).set(b.x/a,b.y/a,b.width/a,b.height/a),w=Math.max(2,Math.min(6,Math.ceil(3*this.scale)));!v&&m.forEach((function(t){n._cleanBackground(p,t,b,a)}));var x=this.artboardShowInteractionLine&&!l;if(m.forEach((function(t){n._drawArtboard(p,b,g,a,t,l,w)})),x){var y=this.getInViewerInteractions();y.forEach((function(t){var e=t.canvasData.drawRect,i=t.art.rect,r=(new ee).set(i.x+e.x,i.y+e.y,e.width,e.height),o=ce(r,g);o&&n._drawInteraction(p,t.art,t,b,g,a)}))}}}}},_cleanBackgroundSection:function(t,e,n,i){var r=this._getScaleRect(e.rect.x,e.rect.y,e.rect.width,e.rect.height,n,i),a=Math.round(this.titleHeight*i);t.clearRect(this.getCanvasDrawNum(r.x),this.getCanvasDrawNum(r.y-a),this.getCanvasDrawNum(r.width),this.getCanvasDrawNum(r.height+a))},_cleanBackground:function(t,e,n,i){var r=this._getScaleRect(e.rect.x,e.rect.y,e.rect.width,e.rect.height,n,i),a=Math.round(this.titleHeight*i);t.clearRect(this.getCanvasDrawNum(r.x),this.getCanvasDrawNum(r.y-a),this.getCanvasDrawNum(r.width),this.getCanvasDrawNum(r.height+a));var o=e.artboard.artboard.flowStart;o&&(r=this.getFlowStartIconRect(e),r=this._getScaleRect(r.x,r.y,r.width,r.height,n,i),t.clearRect(this.getCanvasDrawNum(r.x),this.getCanvasDrawNum(r.y),this.getCanvasDrawNum(r.width),this.getCanvasDrawNum(r.height)))},getFlowStartIconRect:function(t){var e=t.rect,n=e.x,i=e.y;n-=16;var r=16,a=26;return{x:n,y:i,width:r,height:a}},_drawSectionBackground:function(t,e,n,i){var r=this,a=n.cssStyle,o=n.name,s=null===a||void 0===a?void 0:a.render.backgrounds,c=function(t){return r.getCanvasDrawNum(t)};if(s&&s.forEach((function(n){try{n.render&&n.render(t,e,c)}catch(i){}})),o){var l=Math.round(this.titleHeight*i),u=Math.min(Math.max(2,Math.round(14*i)),24);if(u<4)return;t.font="".concat(this.getCanvasDrawNum(u),"px Arial");var d=a.nameSize[u];if(null==d){var h=t.measureText(o),f=h.width;d=a.nameSize[u]={width:f}}var m=Math.round(.1*d.width),p=Math.ceil(2*m+d.width),v=this.getCanvasDrawNum(3*i),b=this.getCanvasDrawNum(Math.min(2*u,l-v)),g=this.getCanvasDrawNum(e.x),w=this.getCanvasDrawNum(e.y)-b-v;t.fillStyle="#404040",br(t,(new ee).set(g,w,p,b),5),t.fillStyle="#fff",t.textAlign="left",t.textBaseline="middle",t.fillText(o,g+m,w+b/2,this.getCanvasDrawNum(e.width))}},_drawArtboardBackground:function(t,e,n,i,r){var a=Math.round(this.titleHeight*i),o=r===u.FIGMA;if(o?(t.lineWidth=Math.max(1*i,1),t.strokeStyle="rgba(166,169,180, 0.1)",t.strokeRect(this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(e.y),this.getCanvasDrawNum(e.width),this.getCanvasDrawNum(e.height))):(t.fillStyle="#fff",t.fillRect(this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(e.y),this.getCanvasDrawNum(e.width),this.getCanvasDrawNum(e.height))),n){var s=this.getCanvasDrawNum(Math.min(Math.max(2,Math.round(14*i)),24));s>3&&(t.fillStyle="#a6a9b4",t.textAlign="left",t.textBaseline="bottom",t.font="".concat(s,"px Arial"),t.fillText(n,this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(Math.round(e.y-Math.min(a/2,8*i))),this.getCanvasDrawNum(e.width)))}},_drawArtboardText:function(t,e,n){t.textAlign="center",t.font="".concat(this.getCanvasDrawNum(Math.min(Math.max(6,Math.min(n.width,n.height)/15),36)),"px Arial"),t.fillText(e,this.getCanvasDrawNum(Math.floor(n.x+n.width/2)),this.getCanvasDrawNum(Math.ceil(n.y+n.height/2)),this.getCanvasDrawNum(n.width))},_getScaleRect:function(t,e,n,i,r,a){var o={x:t,y:e,width:n,height:i};return o.x=o.x*a-r.x,o.y=o.y*a-r.y,o.width=o.width*a,o.height=o.height*a,o},_drawInteraction:function(t,e,n,i,r,a){var o=e.rect,s="#1886ff",c="#cdcdda",l="rgba(24, 134, 255, 0.05)",u=n.canvasData,d=n.isEnter;t.lineWidth=1,t.lineWidth=.5;var h=Object(Q["a"])({},u.nodeRect);h.x+=o.x,h.y+=o.y,ce(h,r)&&(t.setLineDash([5,2]),t.lineDashOffset=2,h=this._getScaleRect(h.x,h.y,h.width,h.height,i,a),d&&(t.fillStyle=l,t.fillRect(this.getCanvasDrawNum(h.x),this.getCanvasDrawNum(h.y),this.getCanvasDrawNum(h.width),this.getCanvasDrawNum(h.height))),t.fillStyle=t.strokeStyle=d?s:c,t.strokeRect(this.getCanvasDrawNum(h.x),this.getCanvasDrawNum(h.y),this.getCanvasDrawNum(h.width),this.getCanvasDrawNum(h.height))),t.strokeStyle=d?s:c,t.lineWidth=Math.max(Math.min(2*a,2),.5),t.setLineDash([]),t.lineDashOffset=0;var f=u.curve;h=(new ee).set(f.start.x+o.x,f.start.y+o.y,1,1),t.beginPath(),h=this._getScaleRect(h.x,h.y,h.width,h.height,i,a),t.moveTo(this.getCanvasDrawNum(h.x),this.getCanvasDrawNum(h.y));var m=this._getScaleRect(f.p1.x+o.x,f.p1.y+o.y,1,1,i,a),p=this._getScaleRect(f.p2.x+o.x,f.p2.y+o.y,1,1,i,a),v=this._getScaleRect(f.end.x+o.x,f.end.y+o.y,1,1,i,a);t.bezierCurveTo(this.getCanvasDrawNum(m.x),this.getCanvasDrawNum(m.y),this.getCanvasDrawNum(p.x),this.getCanvasDrawNum(p.y),this.getCanvasDrawNum(v.x),this.getCanvasDrawNum(v.y)),t.stroke();var b=u.arrowIcon;h=(new ee).set(b.x+o.x,b.y+o.y,b.width,b.height);var g=d?b.img:b.img_default;ce(h,r)&&g&&(h=this._getScaleRect(h.x,h.y,h.width,h.height,i,a),t.drawImage(g,0,0,b.width,b.height,this.getCanvasDrawNum(h.x),this.getCanvasDrawNum(h.y),this.getCanvasDrawNum(h.width),this.getCanvasDrawNum(h.height)))},_drawSectionItem:function(t,e,n,i,r){var a=ce(r.rect,n);if(a){var o=this._getScaleRect(r.rect.x,r.rect.y,r.rect.width,r.rect.height,e,i);this._drawSectionBackground(t,o,r.section,i)}},_drawArtboard:function(t,e,n,i,r,a,o){var s,c,l=ce(r.rect,n);if(l){var u=this._getScaleRect(r.rect.x,r.rect.y,r.rect.width,r.rect.height,e,i);this._drawArtboardBackground(t,u,r.artboard.artboard.name,i,null!==(s=null===(c=r.artboard.artboard.mlConfig)||void 0===c?void 0:c.fileType)&&void 0!==s?s:r.artboard.artboard.fileType);var d=r.miniImgSize,h=r.miniImg,f=r.img,m=this.isDrawMiniImg(r);if(m)t.drawImage(h,0,0,d.width,d.height,this.getCanvasDrawNum(u.x),this.getCanvasDrawNum(u.y),this.getCanvasDrawNum(u.width),this.getCanvasDrawNum(u.height));else if(r.loaded)if(f){var p=r.imgSize;t.drawImage(f,0,0,p.width,p.height,this.getCanvasDrawNum(u.x),this.getCanvasDrawNum(u.y),this.getCanvasDrawNum(u.width),this.getCanvasDrawNum(u.height))}else this._drawArtboardText(t,"预览图加载失败",u);else this._drawArtboardText(t,"画板预览图加载中...",u);var v=r.artboard.artboard.flowStart;if(v){var b=hr.imgs.flowStartIcon,g=hr.sizes.flowStartIcon;b&&(u=this.getFlowStartIconRect(r),u=this._getScaleRect(u.x,u.y,u.width,u.height,e,i),t.drawImage(b,0,0,g.width,g.height,this.getCanvasDrawNum(u.x),this.getCanvasDrawNum(u.y),this.getCanvasDrawNum(u.width),this.getCanvasDrawNum(u.height)))}if(a&&r.artboard.mlUserSelectDown){var w=Math.round(o/2);t.strokeStyle="#1886ff",t.setLineDash([]),t.lineDashOffset=2,t.lineWidth=this.getCanvasDrawNum(o),t.strokeRect(this.getCanvasDrawNum(u.x+w),this.getCanvasDrawNum(u.y+w),this.getCanvasDrawNum(u.width-o),this.getCanvasDrawNum(u.height-o))}}},getCanvasDrawNum:function(t){return Math.round(t*this.canvasScale)},isDrawMiniImg:function(t){return t.miniLoaded&&t.loaded&&t.miniImg&&t.img&&2*t.miniImgSize.width/3>this.scale*t.rect.width},imgLoaded:function(t,e){if(e.loaded=!0,e.img=t,t){var n=e.imgSize;n.width=t.width,n.height=t.height;var i=this.isDrawMiniImg(e);if(i&&!e.miniLoaded)return}this.drawAllDelay(e)},miniImgLoaded:function(t,e){if(e.miniLoaded=!0,e.miniImg=t,t){var n=e.miniImgSize;n.width=t.width,n.height=t.height;var i=this.isDrawMiniImg(e);if(!i&&e.loaded&&e.img)return}this.drawAllDelay(e)},onSceneResize:function(t,e,n){if(!this.initScale||n){var i=this.rect;if(i&&0!==t&&0!==e){this.initScale=!0;var r=i.width/t,a=i.height/e,o=Math.max(r,a);if(0!==o){o=.96/o;var s=this.scale;this.setScaleList(o),o=this.scale,this.resetScaleSceneCenter(o,s)}}}},resetScaleSceneCenter:function(t,e){e!==this.scale&&this.$store.commit("resetScaleSceneCenter",{newScale:t,oldScale:e})}},computed:{sectionVisible:function(){return this.sections.length>0},artboardInteractions:function(){var t=this,e={},n=this.artboards,i=this.renderDocuments;return n.forEach((function(n){var r=n.artboard.artboard,a=r.boundsInParentForList,o=r.pageGuid||r.docGuid,s=t.getRenderInteractions(r),c=[];s&&s.forEach((function(t){var e,r=or(i,t,a,o,!0);r&&c.push({art:n,canvasData:r,key:t.guid,toArtboardItem:null===(e=t.renderTapInteraction)||void 0===e?void 0:e.toArtboardItem,isEnter:!1})})),c.length>0&&(e[r.cid]=c)})),e},selectNodeCount:function(){var t=0;return this.renderDocumentArtboards.forEach((function(e){e.mlUserSelectDown&&(t+=1)})),t},mouseenterArtboardTitle:function(){var t=this.mouseenterArtboard,e=this.inArtboardMultDownMode;if(t){if(e)return"单击选中/取消选中";var n=t.artboard.artboard;return this.inCloudMode?fa(n):"双击查看 ".concat(n.name," 标注详情")}},mouseenterArtboardStyle:function(){var t=this.canvasStyle;if(t)return null;var e=this.mouseenterArtboard;if(!e)return null;var n=this.sceneX,i=this.sceneY,r=this.scale,a=e.rect,o={};o.left=Math.floor(a.x*r+n)+"px",o.top=Math.floor(a.y*r+i)+"px",o.width=Math.ceil(a.width*r)+"px",o.height=Math.ceil(a.height*r)+"px";var s=Math.min(20,Math.max(5,Math.round(20*r)));return o.boxShadow="0 0 ".concat(s,"px #3d7eaf99"),o},canvasWidth:function(){var t=this.sceneWidth,e=this.canvasScale;return t*e},canvasHeight:function(){var t=this.sceneHeight,e=this.canvasScale;return t*e},canvasStyleSection:function(){var t=this.sceneInfoSection;if(0!==t.scale){var e=this.sceneX,n=this.sceneY,i=this.scale,r=this.sceneWidth,a=this.sceneHeight,o=Math.round(e-t.sceneX),s=Math.round(n-t.sceneY),c=i/t.scale;if(0!==o||0!==s||1!==c||t.sceneWidth!==r||t.sceneHeight!==a){var l={transform:""};return 1!==c?(o=t.sceneX/t.scale*i-e,s=t.sceneY/t.scale*i-n,o=-Math.round(o),s=-Math.round(s),l.transform+="translate3d(".concat(o,"px, ").concat(s,"px, 0px) scale(").concat(c.toFixed(5),")")):0===o&&0===s||(l.transform+=" translate3d(".concat(o,"px, ").concat(s,"px, 0px)")),l}}},canvasStyle:function(){var t=this.sceneInfo;if(0!==t.scale){var e=this.sceneX,n=this.sceneY,i=this.scale,r=this.sceneWidth,a=this.sceneHeight,o=Math.round(e-t.sceneX),s=Math.round(n-t.sceneY),c=i/t.scale;if(0!==o||0!==s||1!==c||t.sceneWidth!==r||t.sceneHeight!==a){var l={transform:""};return 1!==c?(o=t.sceneX/t.scale*i-e,s=t.sceneY/t.scale*i-n,o=-Math.round(o),s=-Math.round(s),l.transform+="translate3d(".concat(o,"px, ").concat(s,"px, 0px) scale(").concat(c.toFixed(5),")")):0===o&&0===s||(l.transform+=" translate3d(".concat(o,"px, ").concat(s,"px, 0px)")),l}}},rect:function(){var t=this.titleHeight,e=this.renderDocuments,n=[];e.forEach((function(t){n.push({artboard:{boundsInParent:t.rect}})}));var i=Ae(n);return i.y-=t,i.height+=t,i},isSupportWebp:function(){return this.$store.state.isSupportWebp===Oa.Support},artboardShowInteractionLine:function(){return this.$store.state.artboardShowInteractionLine},mouseenterArtboard:function(){if(this.dragging)return null;var t=this.mouseLoc,e=this.scale,n=this.sceneX,i=this.sceneY,r=this.inViewerArtboards,a=r.length;if(0===a)return null;for(var o=(new ee).set((t.x-n)/e,(t.y-i)/e,1,1),s=a-1;s>=0;s--){var c=r[s];if(ce(c.rect,o))return c}return null},inViewerSections:function(){var t=[],e=this.sceneX,n=this.sceneY,i=this.scale,r=this.sceneWidth,a=this.sceneHeight,o=this.sections;if(0===i||0===r||0===a)return t;var s=(new ee).set(-e/i,-n/i,r/i,a/i);return o.forEach((function(e){var n=ce(e.rect,s);n&&t.push(e)})),t},inViewerArtboards:function(){var t=[],e=this.sceneX,n=this.sceneY,i=this.scale,r=this.sceneWidth,a=this.sceneHeight,o=this.artboards;if(0===i||0===r||0===a)return t;var s=(new ee).set(-e/i,-n/i,r/i,a/i);return o.forEach((function(e){var n=ce(e.rect,s);n&&t.push(e)})),t},sections:function(){var t=[],e=this.renderDocuments;return ut(e)?(e.forEach((function(e){var n=e.maxRect.x-e.rect.x,i=e.maxRect.y-e.rect.y,r=e.sections;ut(r)&&r.forEach((function(e){var r,a=null!==(r=e.boundsInParentForList)&&void 0!==r?r:e.boundsInParent,o={rect:{x:Math.floor(a.x-n),y:Math.floor(a.y-i),width:Math.ceil(a.width),height:Math.ceil(a.height)},section:e};t.push(o)}))})),t):t},artboards:function(){var t=[],e=this.renderDocuments;if(!ut(e))return t;var n=this.isSupportWebp;return e.forEach((function(e){var i=e.maxRect.x-e.rect.x,r=e.maxRect.y-e.rect.y,a=e.arts;ut(a)&&a.forEach((function(e){var a,o=e.artboard;if(o){var s,c=null!==(a=o.boundsInParentForList)&&void 0!==a?a:o.boundsInParent;n&&(s=o.pathPreviewWebp),s||(s=o.pathPreview);var l=o.pathPreviewMini,u={rect:{x:Math.floor(c.x-i),y:Math.floor(c.y-r),width:Math.ceil(c.width),height:Math.ceil(c.height)},imgSrc:s,imgSize:{width:0,height:0},img:null,miniImgSrc:l,miniImgSize:{width:0,height:0},miniImg:null,miniLoaded:!1,loaded:!1,artboard:e};t.push(u)}}))})),t},selectArtboardChanged:function(){return this.$store.state.selectArtboardChanged}},watch:{mouseenterArtboard:function(t,e){if(!this.dragging&&this.artboardShowInteractionLine){var n=null===t||void 0===t?void 0:t.artboard.artboard.cid,i=null===e||void 0===e?void 0:e.artboard.artboard.cid;n!==i&&this.draw(null,!0)}},artboardShowInteractionLine:function(){this.draw(null,!0)},artboardInteractions:function(){this.artboardShowInteractionLine&&this.drawAllDelay()},selectArtboardChanged:function(t){var e=this;t&&0!==t.length&&(t.length>10?this.draw(null,!0):this.inViewerArtboards.forEach((function(n){var i=n.artboard.artboard.guid;t[i]&&e.draw(n)})))},dragging:function(){this.draggingTime=Date.now()},sections:function(){this.drawSection()},artboards:function(t,e){var n={},i={};null===e||void 0===e||e.forEach((function(t){var e,i=null===t||void 0===t||null===(e=t.artboard)||void 0===e||null===(e=e.artboard)||void 0===e?void 0:e.guid;i&&(n[i]=t)})),null===t||void 0===t||t.forEach((function(t){var e,n=null===t||void 0===t||null===(e=t.artboard)||void 0===e||null===(e=e.artboard)||void 0===e?void 0:e.guid;n&&(i[n]=t)}));var r=null===e||void 0===e?void 0:e.filter((function(t){var e,n=null===t||void 0===t||null===(e=t.artboard)||void 0===e||null===(e=e.artboard)||void 0===e?void 0:e.guid;return!i[n]})),a=null===t||void 0===t?void 0:t.filter((function(t){var e,i=null===t||void 0===t||null===(e=t.artboard)||void 0===e||null===(e=e.artboard)||void 0===e?void 0:e.guid,r=n[i];if(!r)return!0;var a=r.miniImg,o=r.miniLoaded,s=r.miniImgSrc,c=r.img,l=r.loaded,u=r.imgSrc,d=r.imgSize,h=r.miniImgSize,f=t.miniImgSrc,m=t.imgSrc;return!o||!l||s!==f||u!==m||(t.miniImg=a,t.miniLoaded=!0,t.miniImgSize=h,t.img=c,t.loaded=!0,t.imgSize=d,!1)}));this.attachImgs(r,!1),this.attachImgs(a,!0)},scale:function(){this.drawSection(),this.draw()},sceneX:function(){this.drawSection(),this.draw()},sceneY:function(){this.drawSection(),this.draw()},sceneWidth:function(){this.drawSection(),this.draw()},sceneHeight:function(){this.drawSection(),this.draw()},inArtboardMultDownMode:function(){this.draw()}},data:function(){return{handleDrawAllDelay:0,drawAllTime:0,drawAllTimeSection:0,canvasScale:kn(),mouseLoc:{x:-10,y:-10},drawInfo:{sceneX:0,sceneY:0,scale:0,sceneWidth:0,sceneHeight:0},sceneInfo:{sceneX:0,sceneY:0,scale:0,sceneWidth:0,sceneHeight:0,id:0},drawInfoSection:{sceneX:0,sceneY:0,scale:0,sceneWidth:0,sceneHeight:0},sceneInfoSection:{sceneX:0,sceneY:0,scale:0,sceneWidth:0,sceneHeight:0,id:0},sceneDelayTimes:{artboard:0,section:0},sceneDelayHandle:-1,sceneDelayHandleSection:-1,titleHeight:40,initScale:!1,handle:0,handleSection:-1,context:null,useOffscreen:!1,worker:null,workerInited:!1,tipHandle:0,draggingTime:0}},beforeDestroy:function(){clearTimeout(this.tipHandle),clearTimeout(this.sceneDelayHandleSection),cancelAnimationFrame(this.handleSection),clearTimeout(this.sceneDelayHandle),cancelAnimationFrame(this.handle),window.removeEventListener("keydown",this.quickKey),this.attachImgs(this.artboards,!1)},created:function(){window.addEventListener("keydown",this.quickKey),this.attachImgs(this.artboards,!0)},props:{scale:Number,sceneX:Number,sceneY:Number,sceneWidth:Number,sceneHeight:Number,dragging:Boolean,sceneScaleKeepX:Number,sceneScaleKeepY:Number,sceneOffsetX:Number,sceneOffsetY:Number}},fl=hl,ml=(n("0e4a"),Object(wo["a"])(fl,ul,dl,!1,null,"e165a89c",null)),pl=ml.exports,vl=function(){var t=this,e=t._self._c;return e("div",{staticClass:"canvas-box"},[e("canvas",{ref:"canvas",style:t.canvasStyle,attrs:{width:t.sceneWidth*t.canvasScale,height:t.sceneHeight*t.canvasScale}})])},bl=[],gl={methods:{draw:function(t,e){var n=this;if(t||e)requestAnimationFrame((function(){n._draw(t,e)}));else{var i=this.sceneInfo,r=this.sceneWidth,a=this.sceneHeight,o=i.sceneWidth!==r||i.sceneHeight!==a?1:0;if(o)return clearTimeout(this.sceneDelayHandle),cancelAnimationFrame(this.handle),void(this.handle=requestAnimationFrame((function(){n._draw(t)})));clearTimeout(this.sceneDelayHandle),this.sceneDelayHandle=setTimeout((function(){cancelAnimationFrame(n.handle),n.handle=requestAnimationFrame((function(){n._draw(t)}))}),33)}},_draw:function(t,e){var n=this;clearTimeout(this.sceneDelayHandle),cancelAnimationFrame(this.handle);var i=this.sceneX,r=this.sceneY,a=this.scale,o=this.sceneWidth,s=this.sceneHeight,c=this.sceneInfo;if(c.sceneX=i,c.sceneY=r,c.scale=a,c.sceneWidth=o,c.sceneHeight=s,0!==a&&0!==o&&0!==s){var l=this.drawInfo,u=!t,d=!(l.scale===a&&l.sceneX===i&&l.sceneY===r&&l.sceneWidth===o&&l.sceneHeight===s);if(!u||d||e){var h=this.$refs.canvas;if(h){l.scale=a,l.sceneX=i,l.sceneY=r,l.sceneWidth=o,l.sceneHeight=s;var f,m=h.getContext("2d"),p=!1;u||d?(m.clearRect(0,0,this.getCanvasDrawNum(o),this.getCanvasDrawNum(s)),f=this.inViewerArtboards,p=!0):f=[t];var v=(new ee).set(-i,-r,o,s),b=(new ee).set(v.x/a,v.y/a,v.width/a,v.height/a),g=Math.max(2,Math.min(6,Math.ceil(3*this.scale)));m.strokeStyle="#1886ff",m.lineWidth=this.getCanvasDrawNum(g),f.forEach((function(t){n._drawArtboard(m,v,b,a,t,p,g)}))}}}},_drawArtboardBackground:function(t,e,n,i,r){var a,o,s,c=i.name,l=Math.round(this.titleHeight*r);if(n||t.clearRect(this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(e.y-l),this.getCanvasDrawNum(e.width),this.getCanvasDrawNum(e.height+l)),i.fill&&i.fillEnabled){var d=i.fill.value;d&&(s=Ft(d).value)}var h=null!==(a=null===(o=i.mlConfig)||void 0===o?void 0:o.fileType)&&void 0!==a?a:i.fileType,f=h===u.FIGMA;s||f||(s="#fff"),s&&(t.fillStyle=s,t.fillRect(this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(e.y),this.getCanvasDrawNum(e.width),this.getCanvasDrawNum(e.height))),t.fillStyle="#a6a9b4",t.textAlign="left",t.textBaseline="bottom",t.font="".concat(this.getCanvasDrawNum(Math.min(Math.max(2,14*r),24)),"px Arial"),c&&t.fillText(c,this.getCanvasDrawNum(e.x),this.getCanvasDrawNum(Math.round(e.y-Math.min(l/2,8*r))),this.getCanvasDrawNum(e.width))},_drawArtboardText:function(t,e,n){t.textAlign="center",t.font="".concat(this.getCanvasDrawNum(Math.min(Math.max(6,Math.min(n.width,n.height)/15),36)),"px Arial"),t.fillText(e,this.getCanvasDrawNum(Math.floor(n.x+n.width/2)),this.getCanvasDrawNum(Math.ceil(n.y+n.height/2)),this.getCanvasDrawNum(n.width))},_drawArtboard:function(t,e,n,i,r,a){var o=ce(r.rect,n);if(o){var s=Object.assign({},r.rect);s.x=Math.round(s.x*i-e.x),s.y=Math.round(s.y*i-e.y),s.width=Math.round(s.width*i),s.height=Math.round(s.height*i),this._drawArtboardBackground(t,s,a,r.artboard.artboard,i);var c=r.miniImgSize,l=r.miniImg,u=r.img,d=this.isDrawMiniImg(r);if(d)t.drawImage(l,0,0,c.width,c.height,this.getCanvasDrawNum(s.x),this.getCanvasDrawNum(s.y),this.getCanvasDrawNum(s.width),this.getCanvasDrawNum(s.height));else if(r.loaded)if(u){var h=r.imgSize;t.drawImage(u,0,0,h.width,h.height,this.getCanvasDrawNum(s.x),this.getCanvasDrawNum(s.y),this.getCanvasDrawNum(s.width),this.getCanvasDrawNum(s.height))}else this._drawArtboardText(t,"预览图加载失败",s);else this._drawArtboardText(t,"画板预览图加载中...",s)}},getCanvasDrawNum:function(t){return Math.round(t*this.canvasScale)},isDrawMiniImg:function(t){return t.miniLoaded&&t.loaded&&t.miniImg&&t.img&&2*t.miniImgSize.width/3>this.scale*t.rect.width},imgLoaded:function(t,e){if(e.loaded=!0,e.img=t,t){var n=e.imgSize;n.width=t.width,n.height=t.height;var i=this.isDrawMiniImg(e);if(i&&!e.miniLoaded)return}this.draw(e)},miniImgLoaded:function(t,e){if(e.miniLoaded=!0,e.miniImg=t,t){var n=e.miniImgSize;n.width=t.width,n.height=t.height;var i=this.isDrawMiniImg(e);if(!i&&e.loaded&&e.img)return}this.draw(e)},attachImgs:function(t,e){var n=this;ut(t)&&(e?t.forEach((function(t){we.add(t.imgSrc,n.imgLoaded,t),we.add(t.miniImgSrc,n.miniImgLoaded,t)})):t.forEach((function(t){we.remove(t.imgSrc,n.imgLoaded,t),we.remove(t.miniImgSrc,n.miniImgLoaded,t),t.img=null,t.loaded=!1})))}},computed:{artboard:function(){return this.curArtboard.artboard},canvasStyle:function(){var t=this.sceneInfo;if(0!==t.scale){var e=this.sceneX,n=this.sceneY,i=this.scale,r=this.sceneWidth,a=this.sceneHeight,o=Math.round(e-t.sceneX),s=Math.round(n-t.sceneY),c=i/t.scale;if(0!==o||0!==s||1!==c||t.sceneWidth!==r||t.sceneHeight!==a){var l={transform:""};return 1!==c?(o=t.sceneX/t.scale*i-e,s=t.sceneY/t.scale*i-n,o=-Math.round(o),s=-Math.round(s),l.transform+="translate3d(".concat(o,"px, ").concat(s,"px, 0px) scale(").concat(c.toFixed(5),")")):0===o&&0===s||(l.transform+=" translate3d(".concat(o,"px, ").concat(s,"px, 0px)")),l}}},rect:function(){var t=this.titleHeight,e=this.artboard,n=e.boundsInArtboard;return(new ee).set(0,0-t,n.width,n.height+t)},isSupportWebp:function(){return this.$store.state.isSupportWebp===Oa.Support},inViewerArtboards:function(){var t=[],e=this.sceneX,n=this.sceneY,i=this.scale,r=this.sceneWidth,a=this.sceneHeight,o=this.artboards;if(0===i||0===r||0===a)return t;var s=(new ee).set(-e/i,-n/i,r/i,a/i);return o.forEach((function(e){var n=ce(e.rect,s);n&&t.push(e)})),t},artboards:function(){var t=[],e=this.isSupportWebp,n=this.curArtboard;return n?(function(n){var i=n.artboard;if(i){var r=i.boundsInArtboard;if(r){var a;e&&(a=i.pathPreviewWebp),a||(a=i.pathPreview);var o=i.pathPreviewMini,s={rect:{x:0,y:0,width:Math.ceil(r.width),height:Math.ceil(r.height)},imgSrc:a,imgSize:{width:0,height:0},img:null,miniImgSrc:o,miniImgSize:{width:0,height:0},miniImg:null,miniLoaded:!1,loaded:!1,artboard:n};t.push(s)}}}(n),t):t}},watch:{dragging:function(){this.draggingTime=Date.now()},artboards:function(t,e){this.attachImgs(e,!1),this.attachImgs(t,!0)},scale:function(){this.draw()},sceneX:function(){this.draw()},sceneY:function(){this.draw()},sceneWidth:function(){this.draw()},sceneHeight:function(){this.draw()}},data:function(){return{canvasScale:kn(),mouseLoc:{x:-10,y:-10},drawInfo:{sceneX:0,sceneY:0,scale:0,sceneWidth:0,sceneHeight:0},sceneInfo:{sceneX:0,sceneY:0,scale:0,sceneWidth:0,sceneHeight:0,id:0},sceneDelayHandle:-1,titleHeight:40,initScale:!1,handle:0,draggingTime:0}},beforeDestroy:function(){this.attachImgs(this.artboards,!1)},created:function(){this.attachImgs(this.artboards,!0)},props:{scale:Number,sceneX:Number,sceneY:Number,sceneWidth:Number,sceneHeight:Number,dragging:Boolean,sceneScaleKeepX:Number,sceneScaleKeepY:Number,sceneOffsetX:Number,sceneOffsetY:Number}},wl=gl,xl=(n("eee2"),Object(wo["a"])(wl,vl,bl,!1,null,"b1bf4320",null)),yl=xl.exports,kl={passive:!1},Cl={passive:!1,capture:!0},Sl={x:0,y:0,sceneX:0,sceneY:0},Tl={components:{ArtboardInfo:Vc,ArtboardList:ll,CanvasModeArtboardList:pl,CanvasModeArtboardInfo:yl,ViewerBox:Ss,DrawView:gs,CommentPoints:lc},created:function(){var t=this;window.addEventListener("wheel",this.mouseWheel,kl),window.addEventListener("resize",this.resizeNextTick,kl),this.$nextTick((function(){(t.type===O.ArtboardDetail||t.allArtboardLoadChecked)&&(t.resize(),t.resetSceneLocation())}))},beforeDestroy:function(){var t=document.documentElement;t.removeEventListener("mousemove",this.mouseMove,Cl),t.removeEventListener("mouseup",this.mouseUp,Cl),window.removeEventListener("wheel",this.mouseWheel,kl),window.removeEventListener("resize",this.resizeNextTick,kl),clearTimeout(this.scalingChangeHandle)},watch:{resetCenterWithRect:function(t){t&&(this.type===O.ArtboardList&&this.setRectToCenterAndScale(t),this.$store.commit("resetCenterWithRect",null))},resetCenterArtboard:function(t){t&&(this.type!==O.ArtboardList||this.artShowInListMode||this.setArtboardToCenterAndScale(t),this.$store.commit("resetCenterArtboard",null))},"imageViewer.resetScale":function(){this.inImageViewerMode&&this.resetSceneLocation()},scale:function(){this.changeInfoCanvasOffset(),this.setScaling()},sceneWidth:function(){this.changeInfoCanvasOffset()},sceneHeight:function(){this.changeInfoCanvasOffset()},artboardInComment:function(){this.resizeNextTick()},resetScaleSceneCenter:function(t){var e,n;t&&(e=Math.round(this.sceneOffsetX+this.sceneWidth/2),n=Math.round(this.sceneOffsetY+this.sceneHeight/2),this.resetScaleScene(e,n,t.oldScale,t.newScale))},curArtboard:function(t){null==t?this.type===O.ArtboardList&&this.resetSceneLocation():this.type===O.ArtboardDetail&&this.resetSceneLocation()},resetList:function(){this.type===O.ArtboardList&&this.resetSceneLocation()},resetArtboard:function(){this.type===O.ArtboardDetail&&this.resetSceneLocation()},filterDocumentGuid:function(){this.type===O.ArtboardList&&this.resetSceneLocation()},allArtboardLoadChecked:function(t){this.type===O.ArtboardList&&t&&this.resizeNextTick()}},computed:{imageViewer:function(){return this.$store.state.imageViewer},inImageViewerMode:function(){return this.type===O.ImageViewer},EnumScaleType:function(){return O},artRenderInCanvasMode:function(){return this.$store.state.artRenderInCanvasMode},resetScaleSceneCenter:function(){return this.$store.state.resetScaleSceneCenter},cloudArtListMode:function(){return this.type===O.ArtboardList&&this.useCanvasMode},cloudArtInfoMode:function(){return this.inArtboardInfoMode&&this.useCanvasMode},useCanvasMode:function(){return this.inCloudMode&&this.artRenderInCanvasMode},zoomBoxOffset:function(){return this.cloudArtListMode?null:{transform:"translate3d(".concat(this.sceneX,"px,").concat(this.sceneY,"px,1px)")}},allArtboardLoadChecked:function(){return this.$store.state.allArtboardLoadChecked},scale:function(){switch(this.type){case O.ArtboardList:return this.scaleList;case O.ArtboardDetail:return this.scaleArtboard;case O.ImageViewer:return this.scaleImageViewer;default:return 0}},resetList:function(){return this.$store.state.scale.resetList},resetCenterArtboard:function(){return this.$store.state.scale.resetCenterArtboard},resetCenterWithRect:function(){return this.$store.state.scale.resetCenterWithRect},resetArtboard:function(){return this.$store.state.scale.resetArtboard},inArtboardInfoMode:function(){return this.type===O.ArtboardDetail}},data:function(){return{infoCanvasOffset:{x:0,y:0},sceneX:0,sceneY:0,sceneWidth:0,sceneHeight:0,sceneOffsetX:0,sceneOffsetY:0,dragging:!1,scaling:!1,sceneScaleKeepX:0,sceneScaleKeepY:0,draggedNotclick:!1,scalingChangeHandle:0}},props:{type:Number},methods:{setScaling:function(){var t=this;clearTimeout(this.scalingChangeHandle),this.scaling=!0,this.scalingChangeHandle=setTimeout((function(){t.scaling=!1}),360)},changeInfoCanvasOffset:function(){var t=this.cloudArtInfoMode,e=this.infoCanvasOffset;if(t){var n=this.getInfoCanvasOffset();e.x=n.x,e.y=n.y}},getInfoCanvasOffset:function(){var t=this.scale,e=this.childRect(),n={};return e?(n.x=-(e.width/2+e.x/2)*t+this.sceneWidth/2,n.y=-(e.height/2+e.y/2)*t+this.sceneHeight/2):n.x=n.y=0,n},setConfig:function(t){if(ht(t)){var e=t.scale,n=t.sceneX,i=t.sceneY;"number"===typeof e&&this.setScale(e),"number"===typeof n&&(this.sceneX=n),"number"===typeof i&&(this.sceneY=i)}},resetSceneLocation:function(){if(this.resize(!0),this.sceneX=this.sceneY=0,this.cloudArtListMode){var t=this.getInfoCanvasOffset();this.sceneX=t.x,this.sceneY=t.y}else this.cloudArtInfoMode&&this.changeInfoCanvasOffset()},mouseMove:function(t){t.preventDefault();var e=t.clientX-Sl.x,n=t.clientY-Sl.y;this.sceneX=Math.round(Sl.sceneX+e),this.sceneY=Math.round(Sl.sceneY+n),!this.dragging&&(Math.abs(e)>=2||Math.abs(n)>=2)&&(this.dragging=!0,this.draggedNotclick=!0)},mouseUp:function(t){t.preventDefault(),this.dragging=!1;var e=document.documentElement;e.removeEventListener("mousemove",this.mouseMove,Cl),e.removeEventListener("mouseup",this.mouseUp,Cl)},mousedownZoomContainer:function(t){if(0===t.button){this.draggedNotclick=!1,this.dragging=!1,Sl.x=t.clientX,Sl.y=t.clientY,Sl.sceneX=this.sceneX,Sl.sceneY=this.sceneY;var e=document.documentElement;e.addEventListener("mousemove",this.mouseMove,Cl),e.addEventListener("mouseup",this.mouseUp,Cl)}},setScale:function(t){switch(t>.92&&t<1.08&&(t=1),this.type){case O.ArtboardList:this.setScaleList(t);break;case O.ArtboardDetail:this.setScaleArtboard(t);break;case O.ImageViewer:this.setScaleImageViewer(t);break}},clickZoomContainer:function(t){var e=this.$refs.$instance;if(e)if(this.draggedNotclick)this.draggedNotclick=!1;else{var n=e.clickZoomContainer;n&&n(t)}},inBox:function(t){var e=this.$refs.$info;if(!e)return!0;while(null!=t){if(t===e)return!0;t=t.parentNode}return!1},canEmitEvent:function(t,e){var n=t.target;e.target=n;var i=this.$refs.$instance;if(!i)return!1;var r=i.canEmitEvent;return!(r&&!r(e))&&(!!e.isScale||this.inBox(n))},childRect:function(){var t=this.$refs.$instance;if(t){var e=t.rect;return e?e.toJSON():null}},canEmitWindowEvent:function(){switch(this.type){case O.ArtboardList:if(this.inArtboardMode)return!1;break;case O.ArtboardDetail:if(!this.inArtboardMode)return!1;break;case O.ImageViewer:return!0}return!0},resizeNextTick:function(t){var e=this;this.$nextTick((function(){e.resize(t)}))},resize:function(t){if(this.canEmitWindowEvent()){var e=!0===t,n=this.$refs.$info.getBoundingClientRect();this.sceneWidth=n.width,this.sceneHeight=n.height,this.sceneOffsetX=n.left,this.sceneOffsetY=n.top;var i=this.$refs.$instance;if(i){var r=i.onSceneResize;r&&r(this.sceneWidth,this.sceneHeight,e)}}},setArtboardToCenterAndScale:function(t){var e=this;if(t){var n=t.docGuid,i=t.pageGuid,r=t.name,a=this.filterDocumentGuid;a&&n!==a&&i!==a&&this.$store.commit("setFilterDocumentGuid",null),this.$nextTick((function(){var n,i=e.renderDocuments;i.find((function(e){var i,r=e.maxRect.x-e.rect.x,a=e.maxRect.y-e.rect.y,o=null===(i=e.arts)||void 0===i?void 0:i.find((function(e){return e.artboard.cid===t.cid}));if(o){var s,c=o.artboard,l=null!==(s=c.boundsInParentForList)&&void 0!==s?s:c.boundsInParent;return n=(new ee).set(Math.floor(l.x-r),Math.floor(l.y-a),Math.ceil(l.width),Math.ceil(l.height)),!0}})),n?(e.setRectToCenterAndScale(n),e.showTextTip("已定位到画板[".concat(r,"]"))):e.showTextTip("无法定位到画板[".concat(r,"]"))}))}},setRectToCenterAndScale:function(t){if(t){var e=this.sceneWidth,n=this.sceneHeight,i=this.cloudArtListMode;if(0!==e&&0!==n){var r=t,a=r.x,o=r.y,s=r.width,c=r.height,l=40,u=s/e,d=(c+l)/n,h=Math.max(u,d);if(0!==h){h=.96/h,this.setScale(h),h=this.scale,t=this.childRect();var f=new di;f.x-=(s/2+a)*h,f.y-=(c/2+o)*h,i?(f.x+=e/2,f.y+=n/2+l/2):(f.x+=t.width/2*h,f.y+=t.height/2*h,f.x=-(s/2+a-t.width/2)*h,f.y=-(c/2+o-t.height/2+l/2)*h),this.sceneX=Math.round(f.x),this.sceneY=Math.round(f.y)}}}},getBoxLocation:function(t,e,n,i){var r=0,a=0,o=i.width,s=i.height,c=(new ee).set(this.sceneOffsetX+this.sceneX,this.sceneOffsetY+this.sceneY,this.sceneWidth,this.sceneHeight);if(this.cloudArtListMode)return t-=this.sceneOffsetX,e-=this.sceneOffsetY,r=this.sceneX,a=this.sceneY,t-=r,e-=a,o*=n,s*=n,{x:t/o,y:e/s};o*=n,s*=n,r=c.x,a=c.y,r+=c.width/2,a+=c.height/2,r-=o/2,a-=s/2;var l=(new ee).set(r,a,o,s);return 0!==l.width&&0!==l.height?(t-=l.x,e-=l.y,t/=l.width,e/=l.height,{x:t,y:e}):void 0},resetScaleScene:function(t,e,n,i){var r=this.$refs.$instance;if(r){var a=this.childRect(),o=this.getBoxLocation(t,e,n,a);if(o){var s=this.getBoxLocation(t,e,i,a);if(s){this.sceneScaleKeepX=t-this.sceneOffsetX,this.sceneScaleKeepY=e-this.sceneOffsetY;var c=s.x-o.x,l=s.y-o.y,u=c*a.width*i,d=l*a.height*i;this.sceneX+=Math.round(u),this.sceneY+=Math.round(d)}}}},mouseWheel:function(t){if(this.canEmitWindowEvent()){var e=t.ctrlKey||t.metaKey,n=t.shiftKey;if(this.inBox(t.target))if(this.canEmitEvent(t,{isScale:e,isMove:!e})){t.preventDefault();var i=t.deltaX,r=t.deltaY,a=t.deltaMode;if(0===a){var o=Math.abs(i),s=Math.abs(r),c=s>50&&r===Math.ceil(r),l=r>0?-1:1,u=t.altKey?5:1;if(e){var d,h=this.scale;d=h<.1?.01:h<=.2?.03:h<=.3?.05:.11,c||(d*=Math.min(1,s/10));var f=h+l*d*u,m=f-h;if(0===m)return;this.setScale(f),this.resetScaleScene(t.pageX,t.pageY,h,this.scale)}else if(c&&0===i)this[n?"sceneX":"sceneY"]+=Math.round(50*l*u);else{var p=i<0?1:0===i?0:-1,v=r<0?1:0===r?0:-1;p*=Math.min(2.5,o/10),v*=Math.min(2.5,s/10),0!==p&&(this.sceneX+=Math.round(10*p*u)),0!==v&&(this.sceneY+=Math.round(10*v*u))}}}else e&&t.preventDefault();else e&&t.preventDefault()}}}},Al=Tl,Il=(n("be79"),Object(wo["a"])(Al,Jo,Zo,!1,null,"b4a0d0be",null)),Fl=Il.exports,Ml={components:{ZoomContainer:Fl,ScaleControl:Qo},methods:{clickHide:function(){this.canClose&&this.$store.commit("setImageViewer",null)},clickPrev:function(){var t=this.currentIndex-1;t<0&&(t=0),this.imageViewer.currentIndex=t,this.imageViewer.resetScale=Date.now()},clickNext:function(){var t=this.currentIndex+1,e=this.imgList.length-1;t>=e&&(t=e),this.imageViewer.currentIndex=t,this.imageViewer.resetScale=Date.now()},onKeyup:function(t){var e=t.keyCode||t.which;27===e&&this.clickHide()}},computed:{EnumScaleType:function(){return O},visible:function(){return this.imageViewer.visible&&ut(this.imgList)},imgList:function(){return this.imageViewer.imgList},currentIndex:function(){return this.imageViewer.currentIndex},imageViewer:function(){return this.$store.state.imageViewer}},props:{canClose:{type:Boolean,default:!0}},beforeDestroy:function(){window.removeEventListener("keyup",this.onKeyup,!0)},created:function(){window.addEventListener("keyup",this.onKeyup,!0)}},Ol=Ml,_l=(n("45cf"),Object(wo["a"])(Ol,$o,Go,!1,null,"42f20b58",null)),Ll=_l.exports,Pl={components:{ImageViewer:Ll},methods:{initImage:function(){this.$store.commit("setImageViewer",{imgList:[this.fileViewUrl],currentIndex:0})}},computed:{},created:function(){this.initImage()}},El=Pl,Nl=(n("26fb"),Object(wo["a"])(El,Ho,Wo,!1,null,"aadf43a2",null)),Dl=Nl.exports,jl=function(){var t=this,e=t._self._c;return e("div",{staticClass:"netdiskfile-lottie"},[t.lottieError||t.lottieIniting?e("div",{staticClass:"error"},[e("NetworkLoading",{attrs:{loadText:"正在加载lottie文件...",errorText:"lottie文件加载失败,请刷新重试",isLoading:t.lottieIniting,isError:t.lottieError,reLoadText:"刷新"},on:{reload:function(e){return t.clickReload()}}})],1):t._e(),e("div",{ref:"lottiebox",staticClass:"lottie-box",class:{off:t.lottieError||t.lottieIniting},style:t.lottieBoxStyle})])},Rl=[],Vl=function(){var t=this,e=t._self._c;return t.isLoading?e("div",{staticClass:"n-loading",class:{"in-mobile":t.inMobile}},[e("div",{staticClass:"text"},[t._v(t._s(t.loadText))])]):t.isError?e("div",{staticClass:"n-error",class:{"in-mobile":t.inMobile}},[e("div",{staticClass:"text"},[t._v(t._s(t.errorText))]),t.reLoadText?e("div",[e("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:t.clickReload}},[t._v(t._s(t.reLoadText))])]):t._e(),t.showCustomService&&t.canShowContactUs?e("div",[e("a",{staticClass:"contactus",attrs:{href:"javascript:;"},on:{click:t.clickContactUS}},[t._v("联系我们")])]):t._e()]):t._e()},Bl=[],Ul={methods:{clickReload:function(){this.$emit("reload")},clickContactUS:function(){this.setContactUsVisible(!0)}},props:{isLoading:Boolean,loadText:{type:String,default:"数据加载中..."},isError:Boolean,errorText:{validator:function(){return!0}},reLoadText:{type:String,default:"重新加载"},showCustomService:{type:Boolean,default:!1}}},Hl=Ul,Wl=(n("7970"),Object(wo["a"])(Hl,Vl,Bl,!1,null,"6bfca491",null)),$l=Wl.exports,Gl=null,zl=Cn.Normal,Yl=[];function Xl(){return new Promise((function(t,e){var n=function(){try{t()}catch(e){}Yl.length>0&&(Yl.forEach((function(t){try{t.resolve()}catch(e){}})),Yl.splice(0,Yl.length))},i=function(t){try{e(t)}catch(n){}Yl.length>0&&(Yl.forEach((function(e){try{e.reject(t)}catch(n){}})),Yl.splice(0,Yl.length))};if(Gl)return n();if(zl!==Cn.Fetching)try{zl=Cn.Fetching;var r=document.createElement("script"),a=function(t){if(t){var e=t.parentNode;e&&e.removeChild(t)}};r.addEventListener("load",(function(t){var e=t.target;if(setTimeout((function(){a(e)}),100),zl===Cn.Fetching){var r=window.bodymovin;if(r){zl=Cn.Success,window.bodymovin=window.lottie=void 0;try{delete window.bodymovin,delete window.lottie}catch(o){}Gl=r,n()}else zl=Cn.Error,i("lottie library load but not find the variable")}})),r.addEventListener("error",(function(t){var e=t.target;setTimeout((function(){a(e)}),100),zl===Cn.Fetching&&(zl=Cn.Error,i("lottie library load failed"))})),r.src="".concat(Bn(),"lottie.min.js"),document.body.appendChild(r)}catch(o){zl=Cn.Error,i(o)}else Yl.push({resolve:t,reject:e})}))}var Kl=function(t,e,n,i,r){var a=0,o=0,s=e/n,c=i/r;s!==c&&(s>c?(a=Math.ceil((e-c*n)/2),e-=a):s<c&&(o=Math.ceil((n-e/c)/2),n-=o));for(var l=Math.floor(e/6),u=Math.floor(n/6),d=!0,h=a;h<e;h+=l)for(var f=o;f<n;f+=u){var m=Object(Z["a"])(t.getImageData(h,f,1,1).data,4),p=m[0],v=m[1],b=m[2],g=m[3];if(0!==p||255!==v||0!==b||255!==g){d=!1;break}}return d},ql={_data:{},clear:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this._data,n=Object.keys(e);t>0&&t>n.length||(n.forEach((function(t){try{var n=e[t];if(n&&n.lottie){try{n.lottie.pause()}catch(i){}try{n.lottie.destroy()}catch(i){}n.lottie=null}}catch(i){}})),delete this._data,this._data={})},_getId:function(t){var e,n,i,r=t.viewUrl,a=t.fileName;r&&(n=null!==(i=Rn(r))&&void 0!==i?i:r);return n=null!==(e=n)&&void 0!==e?e:a,"lottie-".concat(t.parentId,"-").concat(n)},unbind:function(t){var e=this._getId(t),n=this._data[e];if(n){var i=n.lottie;try{i.stop(),i.wrapper=null}catch(r){try{i.destroy()}catch(r){}delete this._data[e]}}},remove:function(t){var e=this._getId(t),n=this._data[e];if(n){var i=n.lottie;if(i){try{i.pause()}catch(r){}try{i.destroy()}catch(r){}}delete this._data[e]}},get:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas";return new Promise((function(r,a){try{var o=n._getId(e),s=n._data[o];if(s&&s.fetchState!==Cn.Error){var c=s.lottie;if(c.container){var l=!1;return c.wrapper!==t&&(c.wrapper=t,t.appendChild(c.container),c.resize(),l=!0),c.play(),r({lottie:c,resized:l})}}var u=e.viewUrl;Xl().then((function(){var s=Gl.loadAnimation({container:t,path:"".concat(u,"?type=res"),renderer:i,loop:!0,autoplay:!0,name:o,rendererSettings:{}});s.setSubframe(!1);var c=n._data[o]={lottie:s,fetchState:Cn.Fetching},l=function(){if(c){if(l&&(s.removeEventListener("drawnFrame",l),l=null),d&&(s.removeEventListener("data_failed",d),d=null),"canvas"===i){var u=t.querySelector("canvas");if(u){var h=u.width,f=u.height,m=u.getContext("2d",{willReadFrequently:!0}),p=s.animationData,v=Kl(m,h,f,p.w,p.h);if(v){try{s.pause()}catch(b){}try{s.destroy()}catch(g){}return s=null,void n.get(t,e,"svg").then(r).catch(a)}}}r({lottie:c.lottie,resized:!0}),c.fetchState=Cn.Success,c=o=null}},d=function(){c&&(l&&(s.removeEventListener("drawnFrame",l),l=null),d&&(s.removeEventListener("data_failed",d),d=null),c.fetchState=Cn.Error,delete n._data[o],a(new Error("lottie data failed")),c=o=null)};s.addEventListener("drawnFrame",l),s.addEventListener("data_failed",d)})).catch((function(t){a(t)}))}catch(d){a(d)}}))}};function Ql(){var t,e=ve;function n(){var t=document.createElement("div");return t.style.cssText="width:1px!important;height:1px!important;position:absolute!important;z-index: -1!important;top:0;left:0;overflow: hidden!important;pointer-events: none!important;",document.body.appendChild(t),t}function a(t){var e,n,i=null!==(e=null===(n=t.animationData)||void 0===n?void 0:n.fr)&&void 0!==e?e:30,r=t.totalFrames;if(0==r)return[];var a=Math.round(r/i*4);if(a<=1)return[0,r-1];var o=6;a>o&&(a=o);var s=Math.ceil(r/(a-1)),c=[],l=0;do{c.push(l),l+=s}while(l<r);return c.length<a&&c.push(r-1),c}function o(t,e,n,i,r,a,o,s,c,l){return new Promise((function(u,d){l&&(o=t);var h=function(){o.toBlob((function(t){u(t)}),"image/png")},f=function(){e.removeEventListener("drawnFrame",f),f=null;try{if(l){if(i<2){s||(s=o.getContext("2d",{willReadFrequently:!0}));var n=Math.floor(r/8),u=Math.floor(a/8);r-=n,a-=u;for(var m=!0,p=n;p<r;p+=n)for(var v=u;v<a;v+=u){var b=Object(Z["a"])(s.getImageData(p,v,1,1).data,4),g=b[0],w=b[1],x=b[2],y=b[3];if(0!==g||255!==w||0!==x||255!==y){m=!1;break}}m&&d("canvas not good")}h()}else{var k=function(){S&&URL.revokeObjectURL(S),S=void 0},C=new Blob([t.outerHTML],{type:"image/svg+xml;charset=utf-8"}),S=URL.createObjectURL(C);c.onload=function(t){s.clearRect(0,0,r,a),s.drawImage(t.target,0,0,r,a),k(),h()},c.onerror=function(){k(),d("load svg to image failed")},c.src=S}}catch(T){d(T)}};e.currentFrame!==n?(e.addEventListener("drawnFrame",f),e.goToAndStop(n,!0)):f()}))}return function(){var s=Object(r["a"])(Object(i["a"])().mark((function s(l){var u,d,h=arguments;return Object(i["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(u=h.length>1&&void 0!==h[1]?h[1]:"canvas",null!=l){s.next=3;break}throw"file missing";case 3:return d=document.createElement("div"),d.style.cssText="width: ".concat(e,"px;"),t||(t=n(e)),t.appendChild(d),s.next=9,Xl();case 9:return s.next=11,new Promise((function(n,s){var h="lottie-g-".concat(Me()),f=URL.createObjectURL(l),m=Gl.loadAnimation({container:d,path:f,renderer:u,loop:!1,autoplay:!1,name:h,rendererSettings:{id:h}});m.setSubframe(!1);var p="canvas"===u;function v(){b||(b=!0,f&&(URL.revokeObjectURL(f),f=null),m&&(m.destroy(),m=null),d&&(t.removeChild(d),d=null))}var b=!1;function g(t){return w.apply(this,arguments)}function w(){return w=Object(r["a"])(Object(i["a"])().mark((function t(e){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n(e);case 1:case"end":return t.stop()}}),t)}))),w.apply(this,arguments)}function x(){return y.apply(this,arguments)}function y(){return y=Object(r["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:s("failed");case 1:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}m.addEventListener("data_failed",(function(){b||(v(),x())})),m.addEventListener("DOMLoaded",Object(r["a"])(Object(i["a"])().mark((function t(){var r,u,h,f,w,y,k,C,S,T,A,I,F;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!b){t.next=2;break}return t.abrupt("return");case 2:t.prev=2,r=m.animationData,u=r.w,h=r.h,f=Math.ceil(h/u*e),d.style.height=f+"px",m.resize(),w=d.querySelector(p?"canvas":"svg"),y=a(m),p||(C=document.createElement("canvas"),C.width=e,C.height=f,S=C.getContext("2d",{willReadFrequently:!0}),T=new Image(e,f)),A=0;case 12:if(!(A<y.length)){t.next=21;break}return I=y[A],t.next=16,o(w,m,I,A,e,f,C,S,T,p);case 16:F=t.sent,k?k.size<F.size&&(k=F):k=F;case 18:A++,t.next=12;break;case 21:if(C=S=T=void 0,k){t.next=26;break}return x(),t.abrupt("return");case 26:return t.next=28,g(k);case 28:k=null,t.next=36;break;case 32:t.prev=32,t.t0=t["catch"](2),"canvas not good"===t.t0?c(l,"svg").then(n).catch(s):x();case 36:return t.prev=36,v(),t.finish(36);case 39:case"end":return t.stop()}}),t,null,[[2,32,36,39]])}))))}));case 11:return s.abrupt("return",s.sent);case 12:case"end":return s.stop()}}),s)})));function c(t){return s.apply(this,arguments)}return c}()}var Jl=Ql(),Zl={components:{NetworkLoading:$l},methods:{clickReload:function(){window.location.reload()},resize:function(){var t=this;this.$nextTick((function(){var e=t.lottie;null===e||void 0===e||e.resize()}))},initLottie:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.lottieIniting&&!t.lottie){e.next=2;break}return e.abrupt("return");case 2:return t.lottieLoadState=Cn.Fetching,t.lottie=null,e.prev=4,e.next=7,ql.get(t.$refs.lottiebox,t.curNetDiskFile);case 7:n=e.sent,r=n.lottie,t.lottie=r,t.lottieSize=t.getLottieSize(r),t.lottieLoadState=Cn.Success,e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](4),t.lottieSize=new yi,t.lottieLoadState=Cn.Error;case 18:case"end":return e.stop()}}),e,null,[[4,14]])})))()},getLottieSize:function(t){var e=new yi(0,0);if(!t)return e;var n=t.animationData;return n?(e.width=n.w,e.height=n.h,e):e}},computed:{lottieError:function(){return this.lottieLoadState===Cn.Error},lottieIniting:function(){return this.lottieLoadState===Cn.Fetching},lottieBoxStyle:function(){var t=this.lottieSize;return{width:t.width>0?t.width+"px":"100%",height:t.height>0?t.height+"px":"100%"}}},watch:{lottieSize:function(){this.resize()},webViewHidden:function(t){var e=this.lottie;e&&(t?e.pause():e.play())}},data:function(){return{lottie:null,lottieLoadState:Cn.Normal,lottieSize:new yi}},beforeDestroy:function(){window.removeEventListener("resize",this.resize),ql.unbind(this.curNetDiskFile),this.lottie=null},mounted:function(){this.initLottie()},created:function(){window.addEventListener("resize",this.resize)}},tu=Zl,eu=(n("5606"),Object(wo["a"])(tu,jl,Rl,!1,null,"b14e4bc0",null)),nu=eu.exports,iu={components:{ViewPdf:No,ViewMedia:Uo,ViewImage:Dl,ViewLottie:nu},computed:{EnumNetDiskFileType:function(){return V},fileType:function(){var t,e=this.curNetDiskFile;return null!==(t=null===e||void 0===e?void 0:e.fileType)&&void 0!==t?t:V.Other}},created:function(){}},ru=iu,au=(n("c761"),Object(wo["a"])(ru,Fo,Mo,!1,null,"10fb0bf1",null)),ou=au.exports,su=function(){var t=this,e=t._self._c;return e("div",{staticClass:"needlogin-tip",class:{"in-mobile":t.inMobile}},[e("div",{staticClass:"logo"}),e("div",{staticClass:"box"},[e("div",{staticClass:"container"},[e("div",{staticClass:"cloudname"},[t._v("您正在访问"),e("b",[t._v(t._s(t.title))])]),e("div",{staticClass:"text"},[t._v("请先登录验证权限")]),e("div",{staticClass:"btns"},[e("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:t.goCloudLogin}},[t._v("立即登录")])])])])])},cu=[],lu={computed:{title:function(){var t=this.cloudName;return t||"标记狮设计协作平台私有云服务"}}},uu=lu,du=(n("2041"),Object(wo["a"])(uu,su,cu,!1,null,"3052ed11",null)),hu=du.exports,fu=function(){var t=this,e=t._self._c;return t.artboardMenu.visible?e("div",{staticClass:"menu",style:t.menuStyle,on:{contextmenu:function(t){t.preventDefault()}}},[e("a",{attrs:{href:"javascript:;"},on:{click:t.clickGoArtboard}},[t._v("查看画板全部切图")]),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownPreview(1)}}},[t._v("下载画板预览图"+t._s(t.inCloudMode?"@2x":""))]),t.inCloudMode?e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownPreview(.5)}}},[t._v("下载画板预览图@1x")]):t._e(),t.inCloudMode&&t.cloudUserIsDesigner?e("a",{class:{off:t.fileReadOnly},attrs:{href:"javascript:;"},on:{click:t.clickRemoveItem}},[t._v("删除")]):t._e()]):t._e()},mu=[];function pu(t){return new Promise((function(e,n){var i=new FileReader;i.onload=function(t){var n=t.target.result;e(n)},i.onerror=function(){n("read error")},i.readAsText(t)}))}function vu(t,e){return bu.apply(this,arguments)}function bu(){return bu=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a,o,s,c,l,u,d,h,f,m,p;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pu(e);case 2:if(s=t.sent,c=new DOMParser,l=c.parseFromString(s,"image/svg+xml"),u=null!==(r=null===l||void 0===l?void 0:l.documentElement)&&void 0!==r?r:null===l||void 0===l?void 0:l.rootElement,d=null!==(a=null===u||void 0===u||null===(o=u.viewBox)||void 0===o?void 0:o.baseVal)&&void 0!==a?a:{},h=d.width,f=d.height,!("number"!==typeof h||"number"!==typeof f||h<=0||f<=0)){t.next=9;break}throw"error svg";case 9:if(m=+u.getAttribute("width"),p=+u.getAttribute("height"),!(m>0&&p>0)){t.next=13;break}return t.abrupt("return",e);case 13:return(isNaN(m)||m<=0)&&(m=n),(isNaN(p)||p<=0)&&(p=Math.round(m/h*f)),u.setAttribute("width",m),u.setAttribute("height",p),t.abrupt("return",new Blob([u.outerHTML],{type:"image/svg+xml"}));case 18:case"end":return t.stop()}}),t)}))),bu.apply(this,arguments)}function gu(t,e,n,i,r){return wu.apply(this,arguments)}function wu(){return wu=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a,o){var s,c,l,u,d,h,f,m,p,v,b,g;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!o){t.next=9;break}return t.prev=1,t.next=4,vu(e,n);case 4:e=t.sent,t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](1);case 9:return t.next=11,new Promise((function(t,i){var r=URL.createObjectURL(e),a=new Image;a.onerror=function(t){var e=t.target;e.onerror=e.onload=null,r&&URL.revokeObjectURL(r),i("img load error")},a.onload=function(e){var n=e.target;n.onerror=n.onload=null,r&&URL.revokeObjectURL(r),t(n)},a.width=n,a.src=r}));case 11:return l=t.sent,u=null!==(s=l.naturalWidth)&&void 0!==s?s:l.width,d=null!==(c=l.naturalHeight)&&void 0!==c?c:l.height,h=n/u,m="function"===typeof window.OffscreenCanvas,t.prev=16,f=m?new window.OffscreenCanvas(10,10):document.createElement("canvas"),m||(f.style.cssText="top:-10000px;left:0;width:1px;height:1px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;",document.body.appendChild(f)),p=f.getContext("2d"),t.next=22,Uu(l,f,p,m,h,r);case 22:if(v=t.sent,a){t.next=25;break}return t.abrupt("return",v);case 25:return t.next=27,new Promise((function(t,e){var n=new FileReader;n.addEventListener("load",(function(e){t(e.target.result)})),n.addEventListener("error",(function(){e("blob转换成base64失败")})),n.readAsDataURL(v)}));case 27:return v=t.sent,b=Math.max(Math.round(d*h),1),t.abrupt("return",new Blob(['<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'.concat(n,'" height="').concat(b,'" viewBox="0 0 ').concat(n," ").concat(b,'"><image width="').concat(n,'" height="').concat(b,'" xlink:href="').concat(v,'"/></svg>')],{type:"image/svg+xml"}));case 30:return t.prev=30,f&&(g=f.parentNode,g&&g.removeChild(f)),f=null,t.finish(30);case 34:case"end":return t.stop()}}),t,null,[[1,7],[16,,30,34]])}))),wu.apply(this,arguments)}var xu,yu=Cn.Normal,ku=[];function Cu(){return new Promise((function(t,e){var n=function(){try{t()}catch(e){}ku.length>0&&(ku.forEach((function(t){try{t.resolve()}catch(e){}})),ku.splice(0,ku.length))},i=function(t){try{e(t)}catch(n){}ku.length>0&&(ku.forEach((function(e){try{e.reject(t)}catch(n){}})),ku.splice(0,ku.length))};if(xu)return n();if(yu!==Cn.Fetching)try{yu=Cn.Fetching;var r=document.createElement("script"),a=function(t){if(t){var e=t.parentNode;e&&e.removeChild(t)}};r.addEventListener("load",(function(t){var e=t.target;if(setTimeout((function(){a(e)}),100),yu===Cn.Fetching){var r=window.zip;if(r){yu=Cn.Success,window.zip=void 0;try{delete window.zip}catch(o){}xu=r,n()}else yu=Cn.Error,i("lottie library load but not find the variable")}})),r.addEventListener("error",(function(t){var e=t.target;setTimeout((function(){a(e)}),100),yu===Cn.Fetching&&(yu=Cn.Error,i("lottie library load failed"))})),r.src="".concat(Bn(),"zip-full.min.js"),document.body.appendChild(r)}catch(o){yu=Cn.Error,i(o)}else ku.push({resolve:t,reject:e})}))}var Su=function(){function t(){Object(Bt["a"])(this,t)}return Object(Ut["a"])(t,null,[{key:"getSketchFileImgPreviewAsync",value:function(){var e=Object(r["a"])(Object(i["a"])().mark((function e(n,r){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.geZipFileImgPreviewAsync(n,r,["previews/preview.png"]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));function n(t,n){return e.apply(this,arguments)}return n}()},{key:"getXDFileImgPreviewAsync",value:function(){var e=Object(r["a"])(Object(i["a"])().mark((function e(n,r){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.geZipFileImgPreviewAsync(n,r,["preview.png","thumbnail.png"]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));function n(t,n){return e.apply(this,arguments)}return n}()},{key:"getFigmaFileImgPreviewAsync",value:function(){var e=Object(r["a"])(Object(i["a"])().mark((function e(n,r){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.geZipFileImgPreviewAsync(n,r,["thumbnail.png"]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));function n(t,n){return e.apply(this,arguments)}return n}()},{key:"geZipFileImgPreviewAsync",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r){var a,o,s,c,l,u,d,h,f;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n.file=null,t.next=4,Cu();case 4:return a=null,o=new xu.ZipReader(new xu.BlobReader(e)),s=!1,t.prev=7,t.next=10,o.getEntries();case 10:if(c=t.sent,!(c.length<1)){t.next=13;break}return t.abrupt("return",!1);case 13:l={},u={},r.forEach((function(t){u[t]=1})),c.forEach((function(t){var e,n=null===(e=t.filename)||void 0===e?void 0:e.toLowerCase();dt(n)&&u[n]&&(l[n]=t)})),h=0;case 18:if(!(h<r.length)){t.next=26;break}if(f=r[h],d=l[f],!d){t.next=23;break}return t.abrupt("break",26);case 23:h++,t.next=18;break;case 26:if(d){t.next=28;break}return t.abrupt("return",!1);case 28:return t.next=30,d.getData(new xu.BlobWriter);case 30:a=t.sent;case 31:return t.prev=31,s||o.close(),t.finish(31);case 34:if(null!=a){t.next=36;break}return t.abrupt("return",!1);case 36:return t.next=38,gu(a,ve,.6,!1,!1);case 38:return n.file=t.sent,t.abrupt("return",null!=n.file);case 42:return t.prev=42,t.t0=t["catch"](0),t.abrupt("return",!1);case 45:case"end":return t.stop()}}),t,null,[[0,42],[7,,31,34]])})));function e(e,n,i){return t.apply(this,arguments)}return e}()}]),t}(),Tu=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"files",[])}return Object(Ut["a"])(t,[{key:"init",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Cu();case 2:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"start",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a,o,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==this.files.length){t.next=2;break}throw"文件列表为空";case 2:return r=new xu.BlobWriter,a=new xu.ZipWriter(r),o=!1,t.prev=5,t.next=8,this.fetch(a,n);case 8:return t.next=10,a.close();case 10:return o=!0,t.next=13,r.getData();case 13:return s=t.sent,De(e,s),t.abrupt("return","success");case 18:throw t.prev=18,t.t0=t["catch"](5),o||a.close(),t.t0;case 22:case"end":return t.stop()}}),t,this,[[5,18]])})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"fetch",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=this.files.splice(0,1)[0],void 0!==r){t.next=3;break}return t.abrupt("return");case 3:if(!r.isPdf||!n){t.next=9;break}return t.next=6,n(r.resSrc,r.scale,r.isPdf);case 6:a=t.sent,t.next=19;break;case 9:return t.next=11,$e(r.resSrc,r.base64ResSrc);case 11:if(a=t.sent,"string"!==typeof a){t.next=15;break}t.next=19;break;case 15:if(!n){t.next=19;break}return t.next=18,n(a,r.scale,r.isPdf);case 18:a=t.sent;case 19:return t.next=21,e.add(r.filename,"string"===typeof a?new xu.Data64URIReader(a):new xu.BlobReader(a));case 21:return t.next=23,this.fetch(e,n);case 23:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"addFile",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.files.push({filename:t,resSrc:e,base64ResSrc:n,scale:i,isPdf:r})}}]),t}(),Au={ANDROID_MIPMAP:[{name:"mdpi",minname:"mdpi",scale:1,filepath:"mipmap-mdpi/{$name$}.png",resname:"{$name$}.png",errorField:"exportErrPng"},{name:"hdpi",minname:"hdpi",scale:1.5,filepath:"mipmap-hdpi/{$name$}.png",resname:"{$name$}@1.5x.png",errorField:"exportErrPng@1.5x"},{name:"xhdpi",minname:"xhdpi",scale:2,filepath:"mipmap-xhdpi/{$name$}.png",resname:"{$name$}@2x.png",errorField:"exportErrPng@2x"},{name:"xxhdpi",minname:"xxhdpi",scale:3,filepath:"mipmap-xxhdpi/{$name$}.png",resname:"{$name$}@3x.png",errorField:"exportErrPng@3x"},{name:"xxxhdpi",minname:"xxxhdpi",scale:4,filepath:"mipmap-xxxhdpi/{$name$}.png",resname:"{$name$}@4x.png",errorField:"exportErrPng@4x"}],ANDROID:[{name:"mdpi",minname:"mdpi",scale:1,filepath:"drawable-mdpi/{$name$}.png",resname:"{$name$}.png",errorField:"exportErrPng"},{name:"hdpi",minname:"hdpi",scale:1.5,filepath:"drawable-hdpi/{$name$}.png",resname:"{$name$}@1.5x.png",errorField:"exportErrPng@1.5x"},{name:"xhdpi",minname:"xhdpi",scale:2,filepath:"drawable-xhdpi/{$name$}.png",resname:"{$name$}@2x.png",errorField:"exportErrPng@2x"},{name:"xxhdpi",minname:"xxhdpi",scale:3,filepath:"drawable-xxhdpi/{$name$}.png",resname:"{$name$}@3x.png",errorField:"exportErrPng@3x"},{name:"xxxhdpi",minname:"xxxhdpi",scale:4,filepath:"drawable-xxxhdpi/{$name$}.png",resname:"{$name$}@4x.png",errorField:"exportErrPng@4x"}],IOS:[{name:"标准尺寸 @1x",scale:1,filepath:"{$name$}.png",errorField:"exportErrPng"},{name:"视网膜 @2x",scale:2,filepath:"{$name$}@2x.png",errorField:"exportErrPng@2x"},{name:"高清视网膜 @3x",scale:3,filepath:"{$name$}@3x.png",errorField:"exportErrPng@3x"}],WEB:[{name:"Web @1x",scale:1,filepath:"{$name$}.png",errorField:"exportErrPng"},{name:"Web @2x",scale:2,filepath:"{$name$}@2x.png",errorField:"exportErrPng@2x"},{name:"Web @3x",scale:3,filepath:"{$name$}@3x.png",errorField:"exportErrPng@3x"}]},Iu={name:"SVG",scale:1,filepath:"{$name$}.svg",errorField:"exportErrSvg"},Fu={name:"PDF",scale:1,filepath:"{$name$}.pdf",errorField:"exportErrPdf"},Mu=[{scale:1,ext:".png"},{scale:1,ext:".svg"},{scale:2,ext:"@2x.png"},{scale:3,ext:"@3x.png"},{scale:4,ext:"@4x.png"},{scale:1.5,ext:"@1.5x.png"}],Ou=function(t,e,n,i,r,a,o){if(i)return[{value:Iu,enabled:!0}];if(r)return[{value:Fu,enabled:!0}];var c;switch(e){case s.ANDROID:c=n?Au.ANDROID_MIPMAP:Au.ANDROID;break;case s.IOS:c=Au.IOS;break;default:c=Au.WEB;break}var l=t.artboard.mlConfig.scalesObj;return c.map((function(t){return{value:t,enabled:a&&1===t.scale||o&&1===t.scale||!a&&!o&&1===l[t.scale]}}))},_u=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a,o,s,c,l,u,d,h,f,m,p,v;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(We(n.artboard)){t.next=2;break}return t.abrupt("return");case 2:if(ut(e)&&0!==e.length){t.next=4;break}throw"至少需要选中一个节点才能激活下载";case 4:if(r=Ne(n.artboard),r){t.next=7;break}throw"设计狮没有为该画板导出[PDF]格式的切图";case 7:if(a=0,o={},s=[],e.forEach((function(t){if(ht(t)&&t.markedForExport){var e=Ke(t);if(dt(e)){var n=Je(e),i=Fu.filepath;i=i.replace("{$name$}",n);var r=o[i];if(r){var c=++r.index;i=Fu.filepath,i=i.replace("{$name$}","".concat(n,"(").concat(c,")"))}else o[i]={index:0};s.push({filepath:i,node:t,nodeName:e}),a+=1}}})),0!==s.length){t.next=15;break}throw"至少需要选中一个节点才能激活下载";case 15:if(1!==s.length){t.next=24;break}return c=s[0],l=c.node,u=c.nodeName,d=Qu(n.artboard,l),h=d.png,f=d.base64Png,m="".concat(u,".pdf"),t.next=21,Ue(m,h,f);case 21:return t.abrupt("return",t.sent);case 24:return p=new Tu,t.next=27,p.init();case 27:return s.forEach((function(t){var e=t.node,i=t.filepath,r=Qu(n.artboard,e),a=r.png,o=r.base64Png;p.addFile(i,a,o)})),v=1===a?s[0].nodeName:n.artboard.name,t.next=31,p.start("pdf_".concat(v,".zip"));case 31:return t.abrupt("return",t.sent);case 32:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Lu=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a,o,s,c,l,u,d,h,f,m,p,v;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(We(n.artboard)){t.next=2;break}return t.abrupt("return");case 2:if(ut(e)&&0!==e.length){t.next=4;break}throw"至少需要选中一个节点才能激活下载";case 4:if(r=Ee(n.artboard),r){t.next=7;break}throw"设计狮没有为该画板导出[SVG]格式的切图";case 7:if(a=0,o={},s=[],e.forEach((function(t){if(ht(t)&&t.markedForExport){var e=Ke(t);if(dt(e)){var n=Je(e),i=Iu.filepath;i=i.replace("{$name$}",n);var r=o[i];if(r){var c=++r.index;i=Iu.filepath,i=i.replace("{$name$}","".concat(n,"(").concat(c,")"))}else o[i]={index:0};s.push({filepath:i,node:t,nodeName:e}),a+=1}}})),0!==s.length){t.next=15;break}throw"至少需要选中一个节点才能激活下载";case 15:if(1!==s.length){t.next=24;break}return c=s[0],l=c.node,u=c.nodeName,d=qu(n.artboard,l),h=d.png,f=d.base64Png,m="".concat(u,".svg"),t.next=21,Ue(m,h,f);case 21:return t.abrupt("return",t.sent);case 24:return p=new Tu,t.next=27,p.init();case 27:return s.forEach((function(t){var e=t.node,i=t.filepath,r=qu(n.artboard,e),a=r.png,o=r.base64Png;p.addFile(i,a,o)})),v=1===a?s[0].nodeName:n.artboard.name,t.next=31,p.start("svg_".concat(v,".zip"));case 31:return t.abrupt("return",t.sent);case 32:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();function Pu(t){return Eu.apply(this,arguments)}function Eu(){return Eu=Object(r["a"])(Object(i["a"])().mark((function t(e){var n,r,a,o,s,c,l,u;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,n){var i=new Image;i.onerror=function(t){var e=t.target;e.onerror=e.onload=null,n("img load error")},i.onload=function(e){var n=e.target;n.onerror=n.onload=null,t(n)},i.src=e}));case 2:if(r=t.sent,a=null!==(n=r.naturalWidth)&&void 0!==n?n:r.width,o=ve/a,!(o>=1)){t.next=7;break}return t.abrupt("return",e);case 7:return c="function"===typeof window.OffscreenCanvas,t.prev=8,s=c?new window.OffscreenCanvas(10,10):document.createElement("canvas"),c||(s.style.cssText="top:-10000px;left:0;width:1px;height:1px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;",document.body.appendChild(s)),l=s.getContext("2d"),t.next=14,Vu(r,s,l,c,o);case 14:return t.abrupt("return",t.sent);case 15:return t.prev=15,s&&(u=s.parentNode,u&&u.removeChild(s)),s=null,t.finish(15);case 19:case"end":return t.stop()}}),t,null,[[8,,15,19]])}))),Eu.apply(this,arguments)}function Nu(t,e,n,i){return Du.apply(this,arguments)}function Du(){return Du=Object(r["a"])(Object(i["a"])().mark((function t(e,n,a,o){var s,c,l=arguments;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=l.length>4&&void 0!==l[4]?l[4]:1,We(o)){t.next=3;break}return t.abrupt("return");case 3:return ge.inCloudMode||(s=1),1!==s&&(c=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){var n,r,a,o;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="function"===typeof window.OffscreenCanvas,t.prev=1,n=r?new window.OffscreenCanvas(10,10):document.createElement("canvas"),r||(n.style.cssText="top:-10000px;left:0;width:1px;height:1px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;",document.body.appendChild(n)),a=n.getContext("2d"),t.next=7,Vu(e,n,a,r,s);case 7:return t.abrupt("return",t.sent);case 8:return t.prev=8,n&&(o=n.parentNode,o&&o.removeChild(n)),n=null,t.finish(8);case 12:case"end":return t.stop()}}),t,null,[[1,,8,12]])})));return function(e){return t.apply(this,arguments)}}()),t.abrupt("return",Ue(e,n,a,c));case 6:case"end":return t.stop()}}),t)}))),Du.apply(this,arguments)}function ju(t,e,n){return Ru.apply(this,arguments)}function Ru(){return Ru=Object(r["a"])(Object(i["a"])().mark((function t(e,n,a){var o,s,c,l,u,d,h,f,m,p,v,b;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(ut(n)&&0!==n.length){t.next=2;break}throw"至少需要选中一个画板才能激活下载";case 2:if(o=[],s={},n.forEach((function(t){if(We(t)){var e=Je(t.name),n=e,i=s[n],r=t.artboardPreviewPng,a=dt(r)&&/\.webp$/i.test(r)?".webp":".png",c=t.artboardPreviewJS;if(i){var l=++i.index;n="".concat(e,"(").concat(l,")")}else s[n]={index:0};n+=a,o.push({filename:n,pngurl:r,jsurl:c})}})),0!==o.length){t.next=9;break}throw"至少需要选中一个画板才能激活下载";case 9:if(1!==o.length){t.next=16;break}return c=o[0],l=c.filename,u=c.pngurl,d=c.jsurl,t.next=13,Ue(l,u,d);case 13:return t.abrupt("return",t.sent);case 16:return h=new Tu,t.next=19,h.init();case 19:return o.forEach((function(t){var e=t.filename,n=t.pngurl,i=t.jsurl;h.addFile(e,n,i)})),m="function"===typeof window.OffscreenCanvas,t.prev=21,1!==a&&(f=m?new window.OffscreenCanvas(10,10):document.createElement("canvas"),m||(f.style.cssText="top:-10000px;left:0;width:1px;height:1px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;",document.body.appendChild(f)),v=f.getContext("2d"),p=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Vu(e,f,v,m,a);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=25,h.start(e+".zip",p);case 25:return t.abrupt("return",t.sent);case 26:return t.prev=26,f&&(b=f.parentNode,b&&b.removeChild(f)),f=null,t.finish(26);case 30:case"end":return t.stop()}}),t,null,[[21,,26,30]])}))),Ru.apply(this,arguments)}function Vu(t,e,n,i,r){return Bu.apply(this,arguments)}function Bu(){return Bu=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a,o){var s,c,l,u,d,h,f=arguments;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=f.length>5&&void 0!==f[5]?f[5]:.7,1!==o){t.next=3;break}return t.abrupt("return",e);case 3:return t.next=5,pi(e);case 5:if(c=t.sent,l=c.naturalWidth||c.width,u=c.naturalHeight||c.height,d=Math.round(l*o),h=Math.round(u*o),n.width=d,n.height=h,r.drawImage(c,0,0,l,u,0,0,d,h),!a||!n.convertToBlob){t.next=17;break}return t.next=16,n.convertToBlob({type:"image/png",quality:s});case 16:return t.abrupt("return",t.sent);case 17:return t.next=19,Ni(n,"image/png",s);case 19:return t.abrupt("return",t.sent);case 20:case"end":return t.stop()}}),t)}))),Bu.apply(this,arguments)}function Uu(t,e,n,i,r){return Hu.apply(this,arguments)}function Hu(){return Hu=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a,o){var s,c,l,u,d,h,f=arguments;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=f.length>5&&void 0!==f[5]?f[5]:.7,t.next=3,pi(e);case 3:if(c=t.sent,l=c.naturalWidth||c.width,u=c.naturalHeight||c.height,d=Math.round(l*o),h=Math.round(u*o),n.width=d,n.height=h,r.drawImage(c,0,0,l,u,0,0,d,h),!a||!n.convertToBlob){t.next=15;break}return t.next=14,n.convertToBlob({type:"image/png",quality:s});case 14:return t.abrupt("return",t.sent);case 15:return t.next=17,Ni(n,"image/png",s);case 17:return t.abrupt("return",t.sent);case 18:case"end":return t.stop()}}),t)}))),Hu.apply(this,arguments)}function Wu(t,e,n,i,r){return $u.apply(this,arguments)}function $u(){return $u=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a,o){var s,c,l;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,pi(e);case 2:if(s=t.sent,c=s.naturalWidth||s.width,l=s.naturalHeight||s.height,n.width=c,n.height=l,r.fillStyle="#fff",r.fillRect(0,0,c,l),r.drawImage(s,0,0,c,l,0,0,c,l),!a||!n.convertToBlob){t.next=14;break}return t.next=13,n.convertToBlob({type:"image/jpeg",quality:o});case 13:return t.abrupt("return",t.sent);case 14:return t.next=16,Ni(n,"image/jpeg",o);case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}}),t)}))),$u.apply(this,arguments)}var Gu,zu,Yu=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n,a,o,c,u){var d,h,f,m,p,v,b,g,w,x,y,k,C,S,T,A,I,F,M,O,_,L,P,E,N,D;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(We(c.artboard)){t.next=2;break}return t.abrupt("return");case 2:if(ut(o)&&0!==o.length){t.next=4;break}throw"至少需要选中一个节点才能激活下载";case 4:if(ht(a)){t.next=6;break}throw"至少需要选中一个图片规格才能激活下载";case 6:if(!Le(c.artboard)){t.next=10;break}d=l.PNG,t.next=23;break;case 10:if(!Pe(c.artboard)){t.next=14;break}d=l.WEBP,t.next=23;break;case 14:if(!Ee(c.artboard)){t.next=18;break}d=l.SVG,t.next=23;break;case 18:if(!Ne(c.artboard)){t.next=22;break}d=l.PDF,t.next=23;break;case 22:throw"设计狮没有为该画板导出任何格式的切图";case 23:if(h=d===l.SVG,f=d===l.PDF,m=[],h||f?a[1]&&m.push(1):(p=c.artboard.mlConfig.scalesObj,Object.keys(a).forEach((function(t){p[t]&&a[t]&&m.push(t)}))),0!==m.length){t.next=29;break}throw"至少需要选中一个图片规格才能激活下载";case 29:if(v=Ou(c,e,n,!1,!1,h,f),b=[],g={},w={},m.forEach((function(t){var e=v.find((function(e){return e.enabled&&e.value.scale==t}));if(null==e)throw"意外的程序性异常,丢失downloadType";g[t]=e.value.filepath})),x=!h&&!f&&d===l.WEBP,y=0,o.forEach((function(t){if(ht(t)&&t.markedForExport){var e=Ke(t);if(dt(e)){var n=Je(e);m.forEach((function(i){var r=g[i];r=r.replace("{$name$}",n).replace(/\.(png|svg|pdf)$/i,".jpg");var a=w[r];if(a){var o=++a.index;r=g[i],r=r.replace("{$name$}","".concat(n,"(").concat(o,")")).replace(/\.(png|svg|pdf)$/i,".jpg")}else w[r]={index:0};b.push({filepath:r,node:t,scale:i,nodeName:e})})),y+=1}}})),0!==b.length){t.next=39;break}throw"至少需要选中一个节点才能激活下载";case 39:if(C="function"===typeof window.OffscreenCanvas,t.prev=40,k=C?new window.OffscreenCanvas(10,10):document.createElement("canvas"),C||(k.style.cssText="top:-10000px;left:0;width:1px;height:1px;opacity:0;pointer-events:none;position: absolute;overflow:hidden;z-index:-1;",document.body.appendChild(k)),S=k.getContext("2d"),1!==b.length){t.next=55;break}if(T=b[0],A=T.node,I=T.scale,F=T.nodeName,M=f?Qu(c.artboard,A):h?qu(c.artboard,A):Ku(c.artboard,A,I,x),O=M.png,_=M.base64Png,L=qe(I,F,l.JPG),!f){t.next=50;break}return t.abrupt("return",Ve(L,O,u,[I]));case 50:return t.next=52,je(L,O,_,function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Wu(e,k,S,C,u);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 52:return t.abrupt("return",t.sent);case 55:return P=new Tu,t.next=58,P.init();case 58:b.forEach((function(t){var e=t.node,n=t.scale,i=t.filepath,r=f?Qu(c.artboard,e):h?qu(c.artboard,e):Ku(c.artboard,e,n,x),a=r.png,o=r.base64Png;P.addFile(i,a,o,n,f)})),E=1===y?b[0].nodeName:c.artboard.name,t.t0=e,t.next=t.t0===s.ANDROID?63:t.t0===s.IOS?65:67;break;case 63:return N="android_",t.abrupt("break",69);case 65:return N="ios_",t.abrupt("break",69);case 67:return N="web_",t.abrupt("break",69);case 69:return t.next=71,P.start(N+E+".zip",function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=4;break}return t.next=3,Yt(e,u,[n]);case 3:return t.abrupt("return",t.sent[0]);case 4:return t.next=6,Wu(e,k,S,C,u);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}());case 71:return t.abrupt("return",t.sent);case 72:return t.prev=72,k&&(D=k.parentNode,D&&D.removeChild(k)),k=null,t.finish(72);case 76:case"end":return t.stop()}}),t,null,[[40,,72,76]])})));return function(e,n,i,r,a,o){return t.apply(this,arguments)}}(),Xu=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a,o,c){var u,d,h,f,m,p,v,b,g,w,x,y,k,C,S,T,A,I,F;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(We(o.artboard)){t.next=2;break}return t.abrupt("return");case 2:if(ut(a)&&0!==a.length){t.next=4;break}throw"至少需要选中一个节点才能激活下载";case 4:if(ht(r)){t.next=6;break}throw"至少需要选中一个图片规格才能激活下载";case 6:if(!c){t.next=12;break}if(u=Pe(o.artboard),u){t.next=10;break}throw"设计狮没有为该画板导出[WEBP]格式的切图";case 10:t.next=15;break;case 12:if(u=Le(o.artboard),u){t.next=15;break}throw"设计狮没有为该画板导出[PNG]格式的切图";case 15:if(d=[],h=o.artboard.mlConfig.scalesObj,Object.keys(r).forEach((function(t){h[t]&&r[t]&&d.push(t)})),0!==d.length){t.next=20;break}throw"至少需要选中一个图片规格才能激活下载";case 20:if(f=Ou(o,e,n,!1,!1,!1,!1),m=[],p={},v={},d.forEach((function(t){var e=f.find((function(e){return e.enabled&&e.value.scale==t}));if(null==e)throw"意外的程序性异常,丢失downloadType";p[t]=e.value.filepath})),b=0,a.forEach((function(t){if(ht(t)&&t.markedForExport){var e=Ke(t);if(dt(e)){var n=Je(e);d.forEach((function(i){var r=p[i];r=r.replace("{$name$}",n),c&&(r=r.replace(/\.png$/i,".webp"));var a=v[r];if(a){var o=++a.index;r=p[i],r=r.replace("{$name$}","".concat(n,"(").concat(o,")")),c&&(r=r.replace(/\.png$/i,".webp"))}else v[r]={index:0};m.push({filepath:r,node:t,scale:i,nodeName:e})})),b+=1}}})),0!==m.length){t.next=31;break}throw"至少需要选中一个节点才能激活下载";case 31:if(1!==m.length){t.next=40;break}return g=m[0],w=g.node,x=g.scale,y=g.nodeName,k=Ku(o.artboard,w,x,c),C=k.png,S=k.base64Png,T=qe(x,y,c?l.WEBP:l.PNG),t.next=37,Ue(T,C,S);case 37:return t.abrupt("return",t.sent);case 40:return A=new Tu,t.next=43,A.init();case 43:m.forEach((function(t){var e=t.node,n=t.scale,i=t.filepath,r=Ku(o.artboard,e,n,c),a=r.png,s=r.base64Png;A.addFile(i,a,s)})),I=1===b?m[0].nodeName:o.artboard.name,t.t0=e,t.next=t.t0===s.ANDROID?48:t.t0===s.IOS?50:52;break;case 48:return F="android_",t.abrupt("break",54);case 50:return F="ios_",t.abrupt("break",54);case 52:return F="web_",t.abrupt("break",54);case 54:return t.next=56,A.start(F+I+".zip");case 56:return t.abrupt("return",t.sent);case 57:case"end":return t.stop()}}),t)})));return function(e,n,i,r,a,o){return t.apply(this,arguments)}}(),Ku=function(t,e,n,i){if(!t||!e)return{};var r,a=t.artboardPath,o=e.exportPath,s=Ce(n),c=i?".webp":".png",l=_e(t,"".concat(a,"/png/"),"".concat(o).concat(s).concat(c));return r=i?l.replace(/\/png\/(.*)\.webp$/,"/base64/$1.webp.js"):l.replace(/\/png\/(.*)\.png$/,"/base64/$1.js"),{png:l,base64Png:r}},qu=function(t,e){if(!t||!e)return{};var n=t.artboardPath,i=e.exportPath,r=_e(t,"".concat(n,"/svg/"),"".concat(i,".svg")),a=r.replace(/\/svg\/(.*)\.svg$/,"/base64/$1@svg.js");return{png:r,base64Png:a}},Qu=function(t,e){if(!t||!e)return{};var n=t.artboardPath,i=e.exportPath,r=_e(t,"".concat(n,"/svg/"),"".concat(i,".pdf")),a=r.replace(/\/svg\/(.*)\.pdf$/,"/base64/$1@pdf.js");return{png:r,base64Png:a}},Ju={methods:{clickRemoveItem:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s,c,l,u,d;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.artboard,r=t.cloudNotSupportEdit,a=t.cloudVersion,o=t.fileReadOnly,s=t.cloudCurrentFolderId,c=t.cloudUserIsDesigner,n){e.next=3;break}return e.abrupt("return");case 3:if(!r){e.next=6;break}return t.showTextTip("无法在Web端使用本功能,私有云版本过低(".concat(a,"),请先升级私有云部署包")),e.abrupt("return");case 6:if(l=n.artboard,u=l.guid,d=l.name,!o&&c){e.next=10;break}return t.showTextTip("您没有权限删除画板[".concat(d,"]")),e.abrupt("return");case 10:return e.next=12,t.confirm({title:"删除确认",text:"是否确认将画板[".concat(d,"]从当前文件夹中删除?")});case 12:if(e.sent){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,t.removeCloudItem({parentId:s,artboardGuid:u});case 16:if(!e.sent){e.next=18;break}t.$store.commit("removeArtboard",u);case 18:case"end":return e.stop()}}),e)})))()},clickDownPreview:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.artboard,r){n.next=3;break}return n.abrupt("return");case 3:if(r=r.artboard,r){n.next=6;break}return n.abrupt("return");case 6:return e.setInOutput(!0),n.prev=7,n.next=10,Nu("".concat(r.name,"@").concat(2*t,"x.png"),r.artboardPreviewPng,r.artboardPreviewJS,r,t);case 10:n.next=16;break;case 12:n.prev=12,n.t0=n["catch"](7),console.error(n.t0),e.showTextTip(n.t0);case 16:return n.prev=16,e.setInOutput(!1),n.finish(16);case 19:case"end":return n.stop()}}),n,null,[[7,12,16,19]])})))()},clickGoArtboard:function(){this.$store.commit("setArtboardInComment",!1),this.setCurArtboard(this.artboard),this.inMultDownMode||this.setInMultDownMode(!0)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.$store.commit("setArtboardMenu",{visible:!1})}),120))}},watch:{"artboardMenu.x":function(){clearTimeout(this.handle)},"artboardMenu.y":function(){clearTimeout(this.handle)},"artboardMenu.artboard":function(t){null!=t&&clearTimeout(this.handle)},"artboardMenu.visible":function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},beforeDestroy:function(){clearTimeout(this.handle),window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0)},data:function(){return{needOpen:!1,handle:0}},computed:{canChangeFile:function(){var t=this.inCloudMode,e=this.cloudCurrentFolderId,n=this.userFolderSpecifyMemberAuthority;if(t&&e>0)switch(n){case X.Admin:case X.ParentOwner:case X.Owner:case X.ReadWrite:return!0}return!1},fileReadOnly:function(){return this.cloudNotSupportEdit||!this.canChangeFile},cloudNotSupportEdit:function(){return vt(this.cloudVersion)},artboard:function(){return this.artboardMenu.artboard},menuStyle:function(){return{top:this.artboardMenu.y+"px",left:this.artboardMenu.x+"px"}},artboardMenu:function(){return this.$store.state.artboardMenu}}},Zu=Ju,td=(n("a6d6"),Object(wo["a"])(Zu,fu,mu,!1,null,"06df60db",null)),ed=td.exports,nd=function(){var t=this,e=t._self._c;return t.tipVisible?e("div",{staticClass:"pop-tip-text"},[e("p",[t._v(t._s(t.tipText)),e("a",{staticClass:"btn-close",attrs:{href:"javascript:;"},on:{click:function(e){return t.hideTextTip()}}},[t._v("我知道了")])])]):t._e()},id=[],rd={computed:{tipText:function(){return this.$store.state.textTip.text},tipVisible:function(){return this.$store.state.textTip.visible}}},ad=rd,od=(n("dc1f"),Object(wo["a"])(ad,nd,id,!1,null,"4da29f10",null)),sd=od.exports,cd=function(){var t=this,e=t._self._c;return t.visible&&t.useMiniList?e("folder-nav-mini",{attrs:{isSupportNetDiskFile:t.isSupportNetDiskFile,miniFoldersOpen:t.miniFoldersOpen},on:{clickMiniFoldersOpen:t.clickMiniFoldersOpen}}):t.visible?e("folder-nav-max",{attrs:{isSupportNetDiskFile:t.isSupportNetDiskFile,subFilesOpen:t.subFilesOpen&&!t.inArtboardMultDownMode,subFoldersOpen:t.subFoldersOpen&&!t.inArtboardMultDownMode,subArtboardsOpen:t.subArtboardsOpen||t.inArtboardMultDownMode},on:{clickSubFoldersOpen:t.clickSubFoldersOpen,clickSubFilesOpen:t.clickSubFilesOpen,clickSubArtboardsOpen:t.clickSubArtboardsOpen}}):t._e()},ld=[],ud=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cloud-folders",class:{allfolders:t.allFoldersBoxVisible}},[e("div",{staticClass:"header"},[e("div",{staticClass:"name"}),e("div",{staticClass:"m"},[e("FolderNavSortMenu"),e("div",{staticClass:"search"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],ref:"searchInput",attrs:{type:"text",placeholder:"搜索当前文件夹",maxlength:"50",spellcheck:"false"},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),t.searchText?e("a",{staticClass:"btn-clear",attrs:{href:"javascript:;"},on:{click:t.clickClearSearchText}}):t._e()])],1)]),e("div",{ref:"$list",staticClass:"list",class:{usetab:t.needShowFile},on:{scroll:t.onListScroll}},[t.needShowFile?e("div",{staticClass:"list-tab",class:{on:t.subFoldersOpen}},[e("span",{on:{click:t.clickSubFoldersOpen}},[t._v("文件夹("+t._s(t.renderCloudSubFolders.length)+")")])]):t._e(),t.hasSubFolders?e("div",{ref:"$folders",staticClass:"list-item",class:{off:!t.folderListVisible},style:{height:t.renderFolderHeight+"px"}},[e("div",{staticClass:"list-box",class:{scrolling:t.scrolling},style:{"padding-top":t.renderFolderLazyList.paddingTop}},t._l(t.renderFolderLazyList.items,(function(n){return e("FoldNavFolderItem",{key:n.id,attrs:{isSupportNetDiskFile:t.isSupportNetDiskFile,folder:n},on:{contextMenuFolder:t.contextMenuFolder}})})),1)]):t._e(),t.needShowFile&&!t.hasSubFolders?e("div",{directives:[{name:"show",rawName:"v-show",value:t.subFoldersOpen,expression:"subFoldersOpen"}],staticClass:"empty"},[t._v(t._s(t.hasSearchText?"未找到包含 “".concat(t.searchText,"” 的文件夹"):"没有文件夹"))]):t._e(),t.artShowInListMode&&t.needShowFile&&t.documentArtboards.length>0?[e("div",{staticClass:"list-tab",class:{on:t.subArtboardsOpen}},[e("span",{on:{click:t.clickSubArtboardsOpen}},[t._v("画板("+t._s(t.renderCloudSubArtboards.length)+")")])]),t.hasSubArtboards?e("div",{ref:"$artboards",staticClass:"list-item",class:{off:!t.subArtboardsOpen},style:{height:t.renderArtboardHeight+"px"}},[e("div",{staticClass:"list-box",class:{scrolling:t.scrolling},style:{"padding-top":t.renderArtboardLazyList.paddingTop}},t._l(t.renderArtboardLazyList.items,(function(n){return e("FoldNavArtboardItem",{key:n.artboard.cid,attrs:{item:n,lightArtboardId:t.lightArtboardId}})})),1)]):e("div",{directives:[{name:"show",rawName:"v-show",value:t.subArtboardsOpen,expression:"subArtboardsOpen"}],staticClass:"empty"},[t._v(t._s(t.hasSearchText?"未找到包含 “".concat(t.searchText,"” 的画板"):"当前文件夹不存在画板"))])]:t._e(),t.needShowFile?e("div",{staticClass:"list-tab",class:{on:t.subFilesOpen}},[e("span",{on:{click:t.clickSubFilesOpen}},[t._v("文件("+t._s(t.renderCloudSubFiles.length)+")")])]):t._e(),t.needShowFile&&t.hasSubFiles?e("div",{ref:"$files",staticClass:"list-item",class:{off:!t.subFilesOpen},style:{height:t.renderFileHeight+"px"}},[e("div",{staticClass:"list-box",class:{scrolling:t.scrolling},style:{"padding-top":t.renderFileLazyList.paddingTop}},t._l(t.renderFileLazyList.items,(function(n){return e("FoldNavFileItem",{key:n.viewUrl,attrs:{file:n},on:{contextMenuFile:t.contextMenuFile}})})),1)]):t.needShowFile?e("div",{directives:[{name:"show",rawName:"v-show",value:t.subFilesOpen,expression:"subFilesOpen"}],staticClass:"empty"},[t._v(t._s(t.hasSearchText?"未找到包含 ".concat(t.searchText," 的文件"):"没有文件"))]):t._e()],2),e("FileItemContextMenu",{attrs:{fileContextMenuData:t.fileContextMenuData}}),e("FolderItemContextMenu",{attrs:{folderContextMenuData:t.folderContextMenuData}}),t.artShowInListMode?e("MultArtboardDownload"):t._e()],1)},dd=[],hd=function(){var t=this,e=t._self._c;return t.inArtboardMultDownMode&&t.exportNodeCount?e("section",{staticClass:"mult-download"},[e("div",{staticClass:"text"},[0!==t.exportNodeCount?e("Radio",{attrs:{text:"全选",selected:t.allSelected},on:{click:t.clickAllSelectBtn}}):t._e(),e("div",{staticClass:"info"},[t._v("已选中"+t._s(t.selectNodeCount)+"/"+t._s(t.exportNodeCount)+"个画板")])],1),e("div",{staticClass:"btns"},[t.inCloudMode?e("Select",{attrs:{options:t.previewScaleSelectOptions},on:{changed:t.onPreviewScaleSelectChanged}}):t._e(),e("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownSelectAll()}}},[t._v("下载")]),e("a",{staticClass:"btn-close",attrs:{href:"javascript:;"},on:{click:function(e){return t.setInArtboardMultDownMode(!1)}}})],1)]):t._e()},fd=[],md=function(){var t=this,e=t._self._c;return e("dl",{staticClass:"select",class:{expandUp:t.expandUp||t.showDDInTop}},[e("dt",{class:{on:t.visible},attrs:{title:t.title},on:{click:function(e){e.stopPropagation(),t.visible=!t.visible}}},[t._v(t._s(t.selectName))]),t.visible?e("dd",[e("ul",{ref:"ul"},t._l(t.options,(function(n,i){return e("li",{key:i,class:{on:t.selected===n,disabled:n.disabled},on:{click:function(e){return t.clickOption(n)}}},[t._v(t._s(n.name))])})),0)]):t._e()])},pd=[],vd={methods:{checkRect:function(){var t=this,e=this.visible,n=this.expandUp;e&&(n||(this.showDDInTop=!1,this.$nextTick((function(){var e=t.$refs.ul;if(e){var n=e.getBoundingClientRect(),i=window.innerHeight-t.checkShowUpFixedHeight,r=n.bottom;r>i&&(t.showDDInTop=!0)}}))))},clickOption:function(t){if(ht(t)){var e=this.selected;e!==t&&(null!=e&&(e.selected=!1),t.selected=!0,this.visible=!1,this.$emit("changed",t))}},onVisibleClick:function(){var t=this;requestAnimationFrame((function(){t.visible=!1}))}},watch:{visible:function(t){t?(this.checkRect(),window.addEventListener("click",this.onVisibleClick,!0)):window.removeEventListener("click",this.onVisibleClick,!0)}},computed:{title:function(){var t=this.selected;return t&&t.title||""},selectName:function(){var t=this.selected;return t?t.name:""},selected:function(){var t=this.options,e=t.find((function(t){return ht(t)&&t.selected}));return null==e&&(e=t[0]),e}},beforeDestroy:function(){window.removeEventListener("click",this.onVisibleClick,!0)},data:function(){return{visible:!1,showDDInTop:!1}},props:{options:Array,expandUp:{default:!1,type:Boolean},checkShowUpFixedHeight:{default:0,type:Number}}},bd=vd,gd=(n("266f"),Object(wo["a"])(bd,md,pd,!1,null,"72f48646",null)),wd=gd.exports,xd=function(){var t=this,e=t._self._c;return e("label",{staticClass:"radio",class:{on:t.selected},on:{click:t.click}},[t.text?e("i",[t._v(t._s(t.text))]):t._e()])},yd=[],kd={props:{text:String,selected:Boolean},methods:{click:function(){this.$emit("click",!this.selected)}}},Cd=kd,Sd=Object(wo["a"])(Cd,xd,yd,!1,null,null,null),Td=Sd.exports,Ad={components:{Radio:Td,Select:wd},methods:{onPreviewScaleSelectChanged:function(t){ht(t)&&(this.exportScale=t.value,rn("artboard.previews.scale",this.exportScale))},clickAllSelectBtn:function(t){t=!this.allSelected&&(this.exportNodeCount,!0);var e={length:0};this.renderDocumentArtboards.forEach((function(n){n.mlUserSelectDown!==t&&(n.mlUserSelectDown=t,e[n.artboard.guid]=1,e.length++)})),this.$store.commit("selectArtboardChanged",e)},clickDownSelectAll:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.exportNodeCount){e.next=3;break}return t.showTextTip("当前文件夹不存在画板"),e.abrupt("return");case 3:return t.setInOutput(!0),e.prev=4,e.next=7,ju(t.documentName,t.selectArtboards,t.exportScale);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](4),t.showTextTip(e.t0);case 12:return e.prev=12,t.setInOutput(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[4,9,12,15]])})))()}},computed:{previewScaleSelectOptions:function(){var t=this.exportScale,e=[{value:1,name:"2x",selected:1===t,disabled:!1}];return this.inCloudMode&&e.push({value:.5,name:"1x",selected:.5===t,disabled:!1}),e},allSelected:function(){return 0!==this.exportNodeCount&&this.exportNodeCount===this.selectNodeCount},selectNodeCount:function(){var t=0;return this.renderDocumentArtboards.forEach((function(e){e.mlUserSelectDown&&(t+=1)})),t},selectArtboards:function(){var t=this.renderDocumentArtboards,e=[];return t.forEach((function(t){t.mlUserSelectDown&&e.push(t.artboard)})),e},exportNodeCount:function(){return this.renderDocumentArtboards.length}},data:function(){return{exportScale:1}},created:function(){this.exportScale=this.inCloudMode&&"0.5"===nn("artboard.previews.scale",!1)?.5:1}},Id=Ad,Fd=(n("436f"),Object(wo["a"])(Id,hd,fd,!1,null,"00497fc4",null)),Md=Fd.exports,Od=function(){var t=this,e=t._self._c;return t.visible?e("div",{ref:"menu",staticClass:"fileitem-contextmenu",style:t.menuStyle,on:{contextmenu:function(t){t.preventDefault()}}},[t.canOnlineView?e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickNetDiskFile(t.file)}}},[t._v("在线查看")]):t._e(),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.copyViewUrl(t.file)}}},[t._v("复制链接")]),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownloadNetDiskFile(t.file)}}},[t._v("下载文件")]),t.isUrlFile?e("a",{class:{off:t.fileReadOnly},attrs:{href:"javascript:;"},on:{click:t.clickEditNetDiskLink}},[t._v("编辑链接")]):t._e(),e("a",{class:{off:t.fileReadOnly},attrs:{href:"javascript:;"},on:{click:t.clickFileReName}},[t._v("重命名")]),e("a",{class:{off:t.fileReadOnly},attrs:{href:"javascript:;"},on:{click:t.clickRemoveItem}},[t._v("删除")])]):t._e()},_d=[],Ld={methods:{clickEditNetDiskLink:function(){var t,e=this.linkbox,n=this.file,i=this.cloudNotSupportEdit,r=this.cloudVersion,a=this.userCanEdit,o=this.fileReadOnly;n&&(i?this.showTextTip("无法在Web端使用本功能,私有云版本过低(".concat(r,"),请先升级私有云部署包")):a?o?this.showTextTip("您没有权限编辑当前文件夹中的链接"):(e.data={id:n.id,link:null!==(t=n.webLoc)&&void 0!==t?t:"",name:n.fileName,parentId:n.parentId,secId:Rn(n.viewUrl)},e.visible=!0):this.showTextTip("您无法编辑其他成员提交的网盘链接"))},clickRemoveItem:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s,c,l;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.file,r=t.cloudNotSupportEdit,a=t.userCanEdit,o=t.cloudVersion,s=t.fileReadOnly,n){e.next=3;break}return e.abrupt("return");case 3:if(!r){e.next=6;break}return t.showTextTip("无法在Web端使用本功能,私有云版本过低(".concat(o,"),请先升级私有云部署包")),e.abrupt("return");case 6:if(a){e.next=9;break}return t.showTextTip("您没有权限删除其他成员提交的文件"),e.abrupt("return");case 9:if(!s){e.next=12;break}return t.showTextTip("您没有权限删除文件[".concat(n.name,"]")),e.abrupt("return");case 12:return e.next=14,t.confirm({title:"删除确认",text:"是否确认将文件[".concat(n.name,"]从当前文件夹中删除?")});case 14:if(e.sent){e.next=16;break}return e.abrupt("return");case 16:return e.next=18,t.removeCloudItem({parentId:t.cloudCurrentFolderId,fileSecId:Rn(n.viewUrl)});case 18:if(!e.sent){e.next=22;break}c=t.cloudSubFiles,l=c.findIndex((function(t){return t.viewUrl===n.viewUrl})),-1!==l&&c.splice(l,1);case 22:case"end":return e.stop()}}),e)})))()},clickFileReName:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s,c,l,u;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.file,r=t.cloudNotSupportEdit,a=t.userCanEdit,o=t.cloudVersion,s=t.fileReadOnly,n){e.next=3;break}return e.abrupt("return");case 3:if(!r){e.next=6;break}return t.showTextTip("无法在Web端使用本功能,私有云版本过低(".concat(o,"),请先升级私有云部署包")),e.abrupt("return");case 6:if(a){e.next=9;break}return t.showTextTip("您没有权限重命名其他成员提交的文件"),e.abrupt("return");case 9:if(!s){e.next=12;break}return t.showTextTip("您没有权限重命名当前文件夹中的文件"),e.abrupt("return");case 12:return e.prev=12,e.next=15,t.prompt({title:"重命名文件",text:n.fileName,placeholder:"请输入新的文件名",beforeYes:function(e){return!!dt(e.trim())&&(!/[\\/:*?"<>|]/.test(e)||(t.showTextTip("文件名含有非法字符,请修正文件名"),!1))},maxLength:256,noText:"取消",yesText:"确认"});case 15:c=e.sent.trim(),e.next=21;break;case 18:return e.prev=18,e.t0=e["catch"](12),e.abrupt("return");case 21:if(e.prev=21,dt(c)){e.next=24;break}throw new Error("请输入新的文件名");case 24:if(c!==n.fileName){e.next=26;break}throw"文件名无变更";case 26:return l=new FormData,l.append("secId",Rn(n.viewUrl)),l.append("fileName",c),e.next=31,t.fetchPostCloudApi("netdiskfilerenamebyweb",{timeout:1e4,body:l});case 31:if(u=e.sent,ht(u)){e.next=34;break}throw new Error("返回值异常,无法解析数据:".concat(u));case 34:if(u.success){e.next=36;break}throw new Error(u.errMsg);case 36:t.showTextTip("文件[".concat(c,"]重命名成功")),u=u.data,t.$store.commit("setFolderSubFile",{files:[u.data],folderUpdateTimes:u.folderUpdateTimes}),e.next=44;break;case 41:e.prev=41,e.t1=e["catch"](21),t.showTextTip(e.t1);case 44:case"end":return e.stop()}}),e,null,[[12,18],[21,41]])})))()},checkLocaltionLater:function(t){if(this.visible&&(!this.locFixing||t)){var e=this.x,n=this.y,i=this.fileContextMenuData,r=this.boxSize,a=window.innerWidth,o=window.innerHeight,s=3,c=3,l=a-r.width-3,u=o-r.height-3;e>l?(this.locFixing=!0,i.x=l):e<s&&(this.locFixing=!0,i.x=s),n>u&&(this.locFixing=!0,i.y=u),n<c&&(this.locFixing=!0,i.y=c)}},copyViewUrl:function(t){var e=t.viewUrl;0===e.indexOf("/")&&(e=location.origin+e),dn(e)?this.showTextTip("链接已复制到剪切板"):this.showTextTip("链接复制到剪切板失败")},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.fileContextMenuData.visible=!1}),120))},resetBoxSize:function(){var t=this;this.visible&&this.$nextTick((function(){var e=t.$refs.menu,n=t.boxSize;if(e){var i=e.getBoundingClientRect();n.width=i.width,n.height=i.height}}))}},watch:{"boxSize.height":function(){this.checkLocaltionLater(!0)},canOnlineView:function(){this.resetBoxSize()},x:function(){clearTimeout(this.handle),this.checkLocaltionLater()},y:function(){clearTimeout(this.handle),this.checkLocaltionLater()},file:function(t){null!=t&&clearTimeout(this.handle)},visible:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0),this.resetBoxSize()):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))},locFixing:function(t){var e=this;clearTimeout(this.locFixingHandle),t&&(this.locFixingHandle=setTimeout((function(){e.locFixing=!1}),50))}},beforeDestroy:function(){clearTimeout(this.handle),clearTimeout(this.locFixingHandle),window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0)},mounted:function(){this.visible&&(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)),this.resetBoxSize(),this.checkLocaltionLater()},props:{fileContextMenuData:Object},data:function(){return{handle:0,locFixing:!1,locFixingHandle:0,boxSize:{width:0,height:0}}},computed:{canChangeFile:function(){var t=this.inCloudMode,e=this.cloudCurrentFolderId,n=this.userFolderSpecifyMemberAuthority;if(t&&e>0)switch(n){case X.Admin:case X.ParentOwner:case X.Owner:case X.ReadWrite:return!0}return!1},netdiskUploader:function(){return this.$store.state.netdiskUploader},linkbox:function(){return this.netdiskUploader.linkbox},isUrlFile:function(){return this.file.fileType===V.Url},canOnlineView:function(){var t;return V.isSupportOnlineViewType(null===(t=this.file)||void 0===t?void 0:t.fileType)},visible:function(){return this.fileContextMenuData.visible&&this.file},file:function(){return this.fileContextMenuData.file},x:function(){return this.fileContextMenuData.x},y:function(){return this.fileContextMenuData.y},fileReadOnly:function(){return!this.userCanEdit||this.cloudNotSupportEdit||!this.canChangeFile},userCanEdit:function(){return this.cloudUserIsDesigner||this.file.updaterId===this.cloudUserId},cloudNotSupportEdit:function(){return vt(this.cloudVersion)},menuStyle:function(){return{top:this.y+"px",left:this.x+"px"}}}},Pd=Ld,Ed=(n("dffd"),Object(wo["a"])(Pd,Od,_d,!1,null,"4ff239a4",null)),Nd=Ed.exports,Dd=function(){var t=this,e=t._self._c;return t.visible?e("div",{ref:"menu",staticClass:"folderitem-contextmenu",style:t.menuStyle,on:{contextmenu:function(t){t.preventDefault()}}},[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickGoFolder(t.folder)}}},[t._v("打开文件夹")]),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.copyViewUrl(t.folder)}}},[t._v("复制链接")])]):t._e()},jd=[],Rd={methods:{checkLocaltionLater:function(t){if(this.visible&&(!this.locFixing||t)){var e=this.x,n=this.y,i=this.folderContextMenuData,r=this.boxSize,a=window.innerWidth,o=window.innerHeight,s=3,c=3,l=a-r.width-3,u=o-r.height-3;e>l?(this.locFixing=!0,i.x=l):e<s&&(this.locFixing=!0,i.x=s),n>u&&(this.locFixing=!0,i.y=u),n<c&&(this.locFixing=!0,i.y=c)}},clickGoFolder:function(t){tn(t.id)},copyViewUrl:function(t){var e=Ze(t.id,!0);dn(e)?this.showTextTip("链接已复制到剪切板"):this.showTextTip("链接复制到剪切板失败")},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.folderContextMenuData.visible=!1}),120))},resetBoxSize:function(){var t=this;this.visible&&this.$nextTick((function(){var e=t.$refs.menu,n=t.boxSize;if(e){var i=e.getBoundingClientRect();n.width=i.width,n.height=i.height}}))}},watch:{"boxSize.height":function(){this.checkLocaltionLater(!0)},x:function(){clearTimeout(this.handle),this.checkLocaltionLater()},y:function(){clearTimeout(this.handle),this.checkLocaltionLater()},file:function(t){null!=t&&clearTimeout(this.handle)},visible:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0),this.resetBoxSize()):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))},locFixing:function(t){var e=this;clearTimeout(this.locFixingHandle),t&&(this.locFixingHandle=setTimeout((function(){e.locFixing=!1}),50))}},beforeDestroy:function(){clearTimeout(this.handle),clearTimeout(this.locFixingHandle),window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0)},mounted:function(){this.visible&&(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)),this.resetBoxSize(),this.checkLocaltionLater()},props:{folderContextMenuData:Object},data:function(){return{handle:0,locFixing:!1,locFixingHandle:0,boxSize:{width:0,height:0}}},computed:{visible:function(){return this.folderContextMenuData.visible&&this.folder},folder:function(){return this.folderContextMenuData.folder},x:function(){return this.folderContextMenuData.x},y:function(){return this.folderContextMenuData.y},menuStyle:function(){return{top:this.y+"px",left:this.x+"px"}}}},Vd=Rd,Bd=(n("ceea"),Object(wo["a"])(Vd,Dd,jd,!1,null,"a7710ce2",null)),Ud=Bd.exports,Hd=function(){var t=this,e=t._self._c;return e("div",{staticClass:"item max",class:t.itemClass,attrs:{title:t.title},on:{contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)},click:function(e){return t.clickGoFolder(t.folder)}}},[t.hasMultPreview?e("div",{staticClass:"imgs"},t._l(t.folder.pathPreviews,(function(t,n){return e("FolderItemIcon",{key:n,attrs:{pathPreview:t,mini:!0}})})),1):t.hasPreview?e("div",{staticClass:"img"},[e("FolderItemIcon",{attrs:{pathPreview:t.folder.pathPreviews[0],mini:!1}})],1):t._e(),e("div",{staticClass:"text"},[e("div",{staticClass:"name"},[e("span",[t._v(t._s(t.folder.name))]),t.isFolderSharePrivateCode?e("div",{staticClass:"lock-max"}):t._e(),t.isFolderShareSpecifyMembers?e("div",{staticClass:"share-sm-max"}):t._e()]),e("div",{staticClass:"info"},[t._v(t._s(t.info))])])])},Wd=[],$d=function(){var t=this,e=t._self._c;return t.isNetDiskIcon?e("div",{staticClass:"preview folder-fileicon",class:{max:!t.mini}},[e("div",{staticClass:"img icon-netdiskfile",class:t.iconCls})]):e("ArtboardPreviewImg",{attrs:{pathPreview:t.pathPreview,imgHeight:0}})},Gd=[],zd=function(){var t=this,e=t._self._c;return e("div",{staticClass:"preview",style:t.imgStyle},[t.imgSrc?e("img",{directives:[{name:"show",rawName:"v-show",value:!t.errored,expression:"!errored"}],staticClass:"img",attrs:{src:t.imgSrc},on:{error:t.onError,load:t.onLoad}}):t._e()])},Yd=[],Xd={methods:{onLoad:function(t){var e=t.target;this.width=e.naturalWidth,this.height=e.naturalHeight,this.$emit("resize",this.width,this.height)},onError:function(){this.errored||(this.errored=!0)}},watch:{pathPreview:function(){this.errored=!1}},computed:{imgStyle:function(){var t=this.imgHeight;return t>0?"height:".concat(t,"px;"):null},imgSrc:function(){var t=this.pathPreview;return t}},data:function(){return{errored:!1,width:0,height:0}},props:{pathPreview:String,imgHeight:Number}},Kd=Xd,qd=(n("145a"),Object(wo["a"])(Kd,zd,Yd,!1,null,"1bd115e0",null)),Qd=qd.exports,Jd={components:{ArtboardPreviewImg:Qd},computed:{iconCls:function(){return V.getName(this.netdiskFileType,this.mini?R.Normal:R.Big)},netdiskFileType:function(){var t=this.pathPreview;if(!dt(t))return null;var e=/^netdisk:\/\/(\d+)\//.exec(t);return e?+e[1]:null},isNetDiskIcon:function(){return"number"===typeof this.netdiskFileType}},props:{pathPreview:String,mini:Boolean}},Zd=Jd,th=(n("5c3c"),Object(wo["a"])(Zd,$d,Gd,!1,null,"4628005e",null)),eh=th.exports,nh={components:{FolderItemIcon:eh},methods:{onContextmenu:function(t){this.$emit("contextMenuFolder",t,this.folder)},clickGoFolder:function(t){tn(t.id)}},computed:{useTimeSort:function(){return this.$store.state.cloudListSort.sortType===D.Date},info:function(){var t=this.folder.updateTimes,e=this.folder,n=this.useTimeSort;return n?kt(t):"共".concat(da(e),"项")},isFolderSharePrivateCode:function(){return this.folder.shareMode===Y.PrivateCode},isFolderShareSpecifyMembers:function(){return this.folder.shareMode===Y.SpecifyMembers},itemClass:function(){var t=this.folder,e=this.isFolderSharePrivateCode,n=this.isFolderShareSpecifyMembers,i={};if(e?i.private=1:n&&(i["share-sm"]=1),null!=t.color){var r=H.getName(t.color);r&&(i[r]=1)}return i},title:function(){return ua(this.folder)},hasPreview:function(){var t=this.folder;return ut(t.pathPreviews)&&t.pathPreviews.length>0},hasMultPreview:function(){var t=this.folder;return this.hasPreview&&0===t.previewArtboardId&&t.pathPreviews.length>1}},props:{folder:Object,isSupportNetDiskFile:Boolean}},ih=nh,rh=(n("59c8"),Object(wo["a"])(ih,Hd,Wd,!1,null,"3db17532",null)),ah=rh.exports,oh=function(){var t=this,e=t._self._c;return e("div",{staticClass:"item max",class:{"non-mask":t.isLottieFile},attrs:{title:t.itemTitle},on:{contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)},mouseenter:function(e){t.mouseenter=!0},mouseleave:t.onMouseOutImg}},[e("div",{ref:"img",staticClass:"img",class:{mini:t.isMiniImage,lottie:t.isLottieFile,mouseenter:t.mouseenter,lottieloading:t.lottieLoading},on:{click:function(e){return t.clickNetDiskFile(t.file)}}},[0===t.imgSize.width&&0===t.imgSize.height?e("div",{staticClass:"icon-netdiskfile",class:t.iconCls}):t._e(),t.imgVisible?e("ArtboardPreviewImg",{attrs:{imgHeight:0,pathPreview:t.file.previewImage},on:{resize:t.onPreviewImgResize}}):t._e(),t.isLottieFile?e("div",{ref:"lottiebox",staticClass:"lottie-box"}):t._e()],1),t.imgVisible&&t.thumbImgVisible?e("div",{directives:[{name:"show",rawName:"v-show",value:t.mouseenter,expression:"mouseenter"}],staticClass:"thumbimg",style:t.thumbImgStyle,on:{mouseenter:function(e){t.mouseInThumb=!0},mouseleave:function(e){t.mouseInThumb=!1},mousemove:t.onMouseMoveImg}},[e("ArtboardPreviewImg",{attrs:{imgHeight:0,pathPreview:t.file.previewImage}})],1):t._e(),e("div",{staticClass:"text"},[e("div",{staticClass:"name"},[e("span",{staticClass:"pre"},[e("span",[t._v(t._s(t.file.fileName))])]),e("span",{staticClass:"ext"},[t._v(t._s(t.fileExt))])]),e("div",{staticClass:"info"},[t._v(t._s(t.info))])])])},sh=[],ch={components:{ArtboardPreviewImg:Qd},methods:{onPreviewImgResize:function(t,e){var n=this.imgSize;n.width=t,n.height=e},onMouseOutImg:function(){this.imgScrollTop=0,this.mouseenter=!1},onMouseMoveImg:function(t){var e=this.file;if(e&&this.viewHeight>0&&this.viewHeight<this.viewRealHeight){var n=t.layerY,i=n/this.thumbViewHeight,r=.2,a=.2;i=i<=r?0:i>=1-a?1:(i-r)/(1-a-r);var o=this.viewRealHeight-this.viewHeight,s=Math.round(i*o);this.imgScrollTop=s}},onContextmenu:function(t){this.$emit("contextMenuFile",t,this.file)},initLottie:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isLottieFile){e.next=2;break}return e.abrupt("return");case 2:if(!t.lottieLoading&&!t.lottie){e.next=4;break}return e.abrupt("return");case 4:return t.lottieLoadState=Cn.Fetching,e.prev=5,e.next=8,ql.get(t.$refs.lottiebox,t.file);case 8:n=e.sent,r=n.lottie,t.lottie=r,t.lottieLoadState=Cn.Success,e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](5),t.lottieLoadState=Cn.Error;case 17:case"end":return e.stop()}}),e,null,[[5,14]])})))()}},watch:{"file.updateTimeTimes":function(t){if(t){ql.remove(this.file);var e=this.lottie;e&&(e.destroy(),this.lottie=null),this.lottieLoadState=Cn.Normal,this.mouseenter&&this.initLottie()}},mouseenter:function(t){var e=this.lottie;t?e?e.play():this.initLottie():null===e||void 0===e||e.stop()},imgScrollTop:function(t){var e=this.$refs.img;e&&e.scrollTo({top:t,behavior:0===t?"smooth":"instant"})}},computed:{info:function(){return ma(this.file)},lottieLoading:function(){return this.lottieLoadState===Cn.Fetching},lottieLoadSuccess:function(){return this.lottieLoadState===Cn.Success},isLottieFile:function(){var t=this.file,e=t.fileType;return e===V.Lottie},imgVisible:function(){var t=this.fileRect,e=this.viewRect;return!!window||!(!t||!e)&&t.isOverlap(e)},fileExt:function(){var t,e,n=this.file;if(!n)return null;var i=null!==(t=null===(e=n.fileExt)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"";return"."===i[0]&&(i=i.substr(1)),i},iconCls:function(){var t=this.file;return t?V.getName(t.fileType,R.Big):null},isMiniPreviewFile:function(){var t=this.file,e=t.fileType;switch(e){case V.XD:case V.Sketch:case V.Figma:case V.PhotoShop:return!0}return!1},isMiniImage:function(){var t=this.imgSize,e=this.boxWidth,n=this.boxHeight,i=this.isLottieFile,r=this.isMiniPreviewFile;if(i)return!0;if(r)return!0;if(0===t.width)return!0;if(t.width<=e)return!0;if(t.height<=n)return!0;var a=e/t.width*t.height;return a<=n},viewWidth:function(){var t=this.imgSize.width,e=this.boxWidth;return this.isMiniImage?Math.min(e,t):e},viewHeight:function(){if(this.isMiniImage)return this.imgSize.height;var t=1,e=this.viewWidth,n=this.viewRealHeight,i=Math.round(e/t);return Math.min(i,n)},viewRealHeight:function(){var t=this.viewWidth,e=this.imgSize;return 0==e.width||0==e.height?0:Math.round(t/e.width*e.height)},thumbViewHeight:function(){var t=this.viewRealHeight;if(0==t)return 0;var e=375/812,n=this.viewWidth/t;n=Math.max(e,n);var i=this.thumbViewWidth,r=Math.round(i/n);return r},thumbImgStyle:function(){return{width:this.thumbViewWidth+"px",height:this.thumbViewHeight+"px"}},thumbImgVisible:function(){if(!this.imgVisible)return!1;if(this.isMiniImage)return!1;var t=this.file;if(!t)return!1;var e=this.viewHeight,n=this.boxHeight;return e>0&&e<this.imgSize.height&&n<this.viewRealHeight},itemTitle:function(){return ha(this.file)}},beforeDestroy:function(){this.isLottieFile&&(ql.unbind(this.file),this.lottie=null)},data:function(){return{mouseenter:!1,imgScrollTop:0,mouseInThumb:!1,imgSize:{width:0,height:0},thumbViewWidth:36,boxWidth:185,boxHeight:185,lottie:null,lottieLoadState:Cn.Normal}},props:{file:Object}},lh=ch,uh=(n("6bd8"),Object(wo["a"])(lh,oh,sh,!1,null,"5141738b",null)),dh=uh.exports,hh=function(){var t=this,e=t._self._c;return e("div",{staticClass:"item",class:t.itemClass,attrs:{title:t.itemTitle},on:{click:t.clickSelect,contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)},mouseenter:function(e){t.mouseenter=!0},mouseleave:t.onMouseOutImg}},[t.fetching?e("div",{staticClass:"loading"},[t._v(t._s(t.loadingText))]):t._e(),t.artboard.flowStart?e("div",{staticClass:"interaction-home",attrs:{title:t.interactionHomeTitle}}):t._e(),e("div",{ref:"img",staticClass:"img",style:{height:t.artboard.boundsInParent.viewHeight+"px"}},[t.imageSrc?e("ArtboardPreviewImg",{attrs:{imgHeight:t.imgRealHeight,pathPreview:t.imageSrc}}):t._e()],1),t.tipVisible?e("div",{staticClass:"count-tip"},[t.commentReplyCount>0?e("div",{staticClass:"comment-count",attrs:{title:t.commentReplyTitle}}):t._e()]):t._e(),t.thumbImgVisible?e("div",{directives:[{name:"show",rawName:"v-show",value:t.mouseenter,expression:"mouseenter"}],staticClass:"thumbimg",style:t.thumbImgStyle,on:{mouseenter:function(e){t.mouseInThumb=!0},mouseleave:function(e){t.mouseInThumb=!1},mousemove:t.onMouseMoveImg}},[t.imageSrc?e("ArtboardPreviewImg",{attrs:{imgHeight:0,pathPreview:t.imageSrc}}):t._e()],1):t._e(),e("div",{staticClass:"text"},[e("div",{staticClass:"name"},[t._v(t._s(t.artboard.name))]),e("div",{staticClass:"info"},[t._v(t._s(t.info))])])])},fh=[],mh={components:{ArtboardPreviewImg:Qd},methods:{dblClickItem:function(){var t=this.artboard;t&&(this.multipleMode||this.setArtboardDetail(t))},onMouseOutImg:function(){this.imgScrollTop=0,this.mouseenter=!1},onMouseMoveImg:function(t){if(this.viewModeMax){var e=this.artboard;if(e){var n=e.boundsInParent;if(n.viewHeight>0&&n.viewHeight<n.viewRealHeight){var i=t.layerY,r=i/n.thumbViewHeight,a=.2,o=.2;r=r<=a?0:r>=1-o?1:(r-a)/(1-o-a);var s=n.viewRealHeight-n.viewHeight,c=Math.round(r*s);this.imgScrollTop=c}}}},onContextmenu:function(t){var e=this,n=t.pageX,i=t.pageY,r=this.item;requestAnimationFrame((function(){e.$store.commit("setArtboardMenu",{visible:!0,x:n,y:i,artboard:r})}))},clickSelect:function(){this.inArtboardMultDownMode?this.item.mlUserSelectDown=!this.item.mlUserSelectDown:(this.hideTextTip(),this.setCurArtboard(this.item))},checkImage:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.pathPreviewMini,r=t.pathPreview,a=t.artboard,!n){e.next=4;break}return t.imageSrc=n,e.abrupt("return");case 4:if(e.prev=4,s=a.pathPreviewBlob,s){e.next=15;break}return e.next=9,Pu(r);case 9:if(s=e.sent,"string"!==typeof s){e.next=14;break}return a.pathPreviewMini=s,t.imageSrc=s,e.abrupt("return");case 14:a.pathPreviewBlob=s;case 15:o=URL.createObjectURL(s),t.imageSrc=o,e.next=25;break;case 19:return e.prev=19,e.t0=e["catch"](4),a.pathPreviewMini=r,t.imageSrc=r,e.abrupt("return");case 25:return e.prev=25,o&&t.$nextTick((function(){setTimeout((function(){try{URL.revokeObjectURL(o)}catch(t){}}),600)})),e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[4,19,25,28]])})))()}},watch:{pathPreviewWebp:function(t){var e=this;t&&!this.pathPreviewMini&&this.$nextTick((function(){e.checkImage()}))},pathPreview:function(t){var e=this;t&&!this.pathPreviewMini&&this.$nextTick((function(){e.checkImage()}))},pathPreviewMini:function(){var t=this;this.$nextTick((function(){t.checkImage()}))},imgScrollTop:function(t){var e=this.$refs.img;e&&e.scrollTo({top:t,behavior:0===t?"smooth":"instant"})}},computed:{light:function(){var t=this.lightArtboardId,e=this.artboard;return t>0&&(null===e||void 0===e?void 0:e.cid)===t},selected:function(){return this.inArtboardMultDownMode&&this.item.mlUserSelectDown},tipVisible:function(){return this.commentReplyCount>0},interactionHomeTitle:function(){return vr(this.artboard)},commentReplyCount:function(){var t,e,n=this.artboard;return n&&null!==(t=null!==(e=n.comments)&&void 0!==e?e:0+n.replies)&&void 0!==t?t:0},itemTitle:function(){return this.mouseInThumb?null:fa(this.artboard)},commentReplyTitle:function(){var t=this.commentReplyCount;return 0==t?null:"".concat(t," 条评论")},thumbImgVisible:function(){if(!this.viewModeMax)return!1;var t=this.artboard;if(!t)return!1;var e=t.boundsInParent;return e.viewHeight>0&&e.viewHeight<e.viewRealHeight},thumbImgStyle:function(){var t=this.artboard;if(t){var e=t.boundsInParent;return{width:e.thumbViewWidth+"px",height:e.thumbViewHeight+"px"}}},itemClass:function(){var t={},e=this.viewModeMax,n=this.selected,i=this.light;return t[e?"max":"min"]=1,n&&(t.selected=1),i&&(t.light=1),t},isSupportWebp:function(){return this.$store.state.isSupportWebp===Oa.Support},pathPreview:function(){var t=this.artboard,e=this.isSupportWebp,n=this.pathPreviewMini;return t?n||(e?t.pathPreviewWebp:null)||t.pathPreview:null},pathPreviewMini:function(){return this.artboard?this.artboard.pathPreviewMini:null},imgRealHeight:function(){if(!this.viewModeMax)return 0;var t=this.artboard;if(!t)return 0;var e=t.boundsInParent;return e.viewHeight>0&&e.viewHeight<e.viewRealHeight?e.viewRealHeight:0},imgStyle:function(){var t=this.artboard;if(t){var e=t.boundsInParent;return"width:".concat(e.viewWidth,"px;height:").concat(e.viewHeight,"px;")}},info:function(){return ma(this.artboard)},artboard:function(){return this.item.artboard}},data:function(){return{loadingText:"",fetching:!1,imgScrollTop:0,mouseenter:!1,mouseInThumb:!1,viewModeMax:!0,imageSrc:null}},mounted:function(){this.checkImage()},props:{item:Object,multipleMode:Boolean,lightArtboardId:Number}},ph=mh,vh=(n("6efe"),Object(wo["a"])(ph,hh,fh,!1,null,"c13c3872",null)),bh=vh.exports,gh=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cloud-list-sort-menu",class:{mini:t.mini}},[e("div",{staticClass:"sort-mode"},[t.mini?t._e():e("span",{staticClass:"name"},[t._v("按"+t._s(t.sortType===t.EnumCloudListSortType.Name?"名称":t.sortType===t.EnumCloudListSortType.Date?"时间":"坐标")+"排序")]),e("div",{staticClass:"options"},[e("div",{class:{on:t.sortType===t.EnumCloudListSortType.Name},on:{click:function(e){return t.clickSortType(t.EnumCloudListSortType.Name)}}},[t._v("按名称排序")]),e("div",{class:{on:t.sortType===t.EnumCloudListSortType.Date},on:{click:function(e){return t.clickSortType(t.EnumCloudListSortType.Date)}}},[t._v("按时间排序")]),e("div",{class:{on:t.sortType===t.EnumCloudListSortType.ArtboardRect},attrs:{title:"1.画板列表按画板在文档中的坐标从上到下,从左到右排序\n2.文件夹和文件按名称排序"},on:{click:function(e){return t.clickSortType(t.EnumCloudListSortType.ArtboardRect)}}},[t._v("按坐标排序")])])]),e("div",{staticClass:"btn sort-order",class:{desc:!t.orderDesc},attrs:{title:t.orderDesc?"切换为升序":"切换为降序"},on:{click:function(e){return t.clickOrderDesc(!t.orderDesc)}}})])},wh=[],xh={methods:{clickSortType:function(t){this.$store.commit("setCloudListSortConfig",{sortType:t})},clickOrderDesc:function(t){this.$store.commit("setCloudListSortConfig",{orderDesc:t})}},computed:{EnumCloudListSortType:function(){return D},cloudListSort:function(){return this.$store.state.cloudListSort},sortType:function(){return this.cloudListSort.sortType},orderDesc:function(){return this.cloudListSort.orderDesc}},data:function(){return{optionsVisible:!1}},props:{mini:{type:Boolean,default:!1}}},yh=xh,kh=(n("b146"),Object(wo["a"])(yh,gh,wh,!1,null,"632dedba",null)),Ch=kh.exports,Sh=200,Th={folderMax:{margin:{top:20,right:20,bottom:20,left:2},width:192,height:198},fileMax:{margin:{top:20,right:23,bottom:20,left:6},width:185,height:233},artboardMax:{margin:{top:20,right:23,bottom:20,left:6},width:185,height:0,textHeight:48}},Ah={components:{FoldNavFolderItem:ah,FoldNavFileItem:dh,FoldNavArtboardItem:bh,FileItemContextMenu:Nd,MultArtboardDownload:Md,FolderNavSortMenu:Ch,FolderItemContextMenu:Ud},methods:{onListScroll:function(t){this.scrollY=t.target.scrollTop},getRenderLazyList:function(t,e,n,i,r){var a={items:[],rects:[],startIndex:-1,paddingTop:"0px"};if(!i||!t)return a;if(e.length!==n.length)return a;for(var o=-1,s=0,c=n.length;s<c;s++){var l=e[s],u=t.isOverlap(l);if(-1===a.startIndex&&u)a.startIndex=s;else if(r&&-1!==a.startIndex&&!u)break;u&&(o=s)}var d=e[a.startIndex];if(d&&a.startIndex>0)for(var h=a.startIndex-1;h>=0;h--){var f=e[h];if(d.y!=f.y)break;a.startIndex=h}var m=Th.folderMax;if(-1!=a.startIndex){a.items=n.slice(a.startIndex,o+1),a.rects=e.slice(a.startIndex,o+1);var p=a.rects[0];a.paddingTop=p.y-m.margin.top+"px"}return a},onResize:function(){this.resetArtboardsBoundingClientRect("onResize")},resetArtboardsBoundingClientRectDelay:function(t){var e=this;cancelAnimationFrame(this.handle_resetArtboardsBoundingClientRect),this.handle_resetArtboardsBoundingClientRect=requestAnimationFrame((function(){e.resetArtboardsBoundingClientRect(t+".delay")}))},resetArtboardsBoundingClientRect:function(t){var e=this;cancelAnimationFrame(this.handle_resetArtboardsBoundingClientRect);var n=this.viewRect;n.width=window.innerWidth,n.height=window.innerHeight,this.$nextTick((function(){var t=e.$refs.$list,n=e.$refs.$files,i=e.$refs.$artboards,r=e.$refs.$folders;if(t){var a=t.getBoundingClientRect(),o=e.listBoundingClientRect;o.x=a.x,o.y=a.y,o.width=a.width,o.height=a.height;var s=o.y;if(r){var c=r.getBoundingClientRect();if(0!==c.height||0!==c.width){var l=e.foldersBoundingClientRect;l.x=c.x,l.y=c.y,l.width=c.width,l.height=c.height,l.marginTop=c.y-s}}if(n){var u=n.getBoundingClientRect();if(0!==u.height||0!==u.width){var d=e.filesBoundingClientRect;d.x=u.x,d.y=u.y,d.width=u.width,d.height=u.height,d.marginTop=u.y-s}}if(i){var h=i.getBoundingClientRect();if(0!==h.height||0!==h.width){var f=e.artboardsBoundingClientRect;f.x=h.x,f.y=h.y,f.width=h.width,f.height=h.height,f.marginTop=h.y-s}}}}))},clickClearSearchText:function(){this.searchText=""},contextMenuFolder:function(t,e){var n=t.pageX,i=t.pageY,r=this.folderContextMenuData;requestAnimationFrame((function(){r.x=n,r.y=i,r.folder=e,r.visible=!0}))},contextMenuFile:function(t,e){var n=t.pageX,i=t.pageY,r=this.fileContextMenuData;requestAnimationFrame((function(){r.x=n,r.y=i,r.file=e,r.visible=!0}))},clickSubFoldersOpen:function(){this.$emit("clickSubFoldersOpen")},clickSubFilesOpen:function(){this.$emit("clickSubFilesOpen")},clickSubArtboardsOpen:function(){this.$emit("clickSubArtboardsOpen")},getArtboardViewRect:function(t){if(!t)return null;var e=this.renderArtboardRects,n=this.renderArtboardsWithCurrentPage;return e[n.findIndex((function(e){var n;return(null===e||void 0===e||null===(n=e.artboard)||void 0===n?void 0:n.cid)===t}))]},cleanLightArtboardId:function(){this.lightArtboardId=0},setArtboardToCenterAndLight:function(t){var e=this,n=t.docGuid,i=t.pageGuid,r=t.name,a=this.filterDocumentGuid;a&&n!==a&&i!==a&&this.$store.commit("setFilterDocumentGuid",null),this.subArtboardsOpen||this.clickSubArtboardsOpen(),this.$nextTick((function(){var n=e.getArtboardViewRect(t.cid);if(!n)return e.showTextTip("无法定位到画板[".concat(r,"]"));var i=n.y,a=n.height,o=e.scrollY,s=e.artboardsBoundingClientRect,c=s.marginTop+o,l=e.listBoundingClientRect.height,u=i+c+a/2-l/2;e.lightArtboardId=t.cid;var d=e.$refs.$list;d&&(d.scrollTop=u),e.showTextTip("已定位到画板[".concat(r,"]"))}))}},watch:{lightArtboardId:function(t){var e=this;t>0?requestAnimationFrame((function(){window.addEventListener("mousedown",e.cleanLightArtboardId,!0)})):window.removeEventListener("mousedown",this.cleanLightArtboardId,!0)},resetCenterArtboard:function(t){this.artShowInListMode&&t&&(this.setArtboardToCenterAndLight(t),this.$store.commit("resetCenterArtboard",null))},renderArtboardViewRect:function(){var t=this.artboardsBoundingClientRect.height;0==t&&this.resetArtboardsBoundingClientRectDelay("renderArtboardViewRect")},renderFolderHeight:function(){this.resetArtboardsBoundingClientRectDelay("renderFolderHeight")},renderArtboardHeight:function(){this.resetArtboardsBoundingClientRectDelay("renderArtboardHeight")},subFoldersOpen:function(){this.resetArtboardsBoundingClientRect("subFoldersOpen")},subFilesOpen:function(){this.resetArtboardsBoundingClientRect("subFilesOpen")},subArtboardsOpen:function(){this.resetArtboardsBoundingClientRect("subArtboardsOpen")},allFoldersBoxVisible:function(){this.resetArtboardsBoundingClientRect("allFoldersBoxVisible")},"renderCloudSubFolders.length":function(){this.resetArtboardsBoundingClientRectDelay("renderCloudSubFolders.length")},"renderCloudSubFiles.length":function(){this.resetArtboardsBoundingClientRectDelay("'renderCloudSubFiles.length")},"renderCloudSubArtboards.length":function(){this.resetArtboardsBoundingClientRectDelay("'renderCloudSubArtboards.length")},renderFolderViewRect:function(){var t=this.foldersBoundingClientRect.height;0==t&&this.resetArtboardsBoundingClientRectDelay("renderFolderViewRect")},renderFileViewRect:function(){var t=this.filesBoundingClientRect.height;0==t&&this.resetArtboardsBoundingClientRectDelay("renderFileViewRect")},scrollY:function(){var t=this;this.resetArtboardsBoundingClientRectDelay("scrollY"),clearTimeout(this.scrollingHandle),this.scrolling=!0,this.scrollingHandle=setTimeout((function(){t.scrolling=!1}),100)}},computed:{folderListVisible:function(){var t=this.subFoldersOpen,e=this.needShowFile;return t||!e},resetCenterArtboard:function(){return this.$store.state.scale.resetCenterArtboard},renderArtboardsWithCurrentPage:function(){var t=this.renderCloudSubArtboards,e=this.filterDocumentGuid;return dt(e)?t.filter((function(t){var n=t.artboard;return n.pageGuid===e||n.docGuid===e})):t},renderArtboardHeight:function(){var t=this.renderArtboardRects,e=t.length;if(0==e)return 0;for(var n=t[e-1],i=n.y,r=n.bottom,a=e-2;a>=0;a--){var o=t[a];if(o.y!==i)break;r=Math.max(r,o.bottom)}var s=Th.artboardMax;return r+s.margin.bottom},renderFileHeight:function(){var t=this.renderFileRects,e=t.length;if(0==e)return 0;for(var n=t[e-1],i=n.y,r=n.bottom,a=e-2;a>=0;a--){var o=t[a];if(o.y!==i)break;r=Math.max(r,o.bottom)}var s=Th.fileMax;return r+s.margin.bottom},renderFolderHeight:function(){var t=this.renderFolderRects,e=t.length;if(0==e)return 0;for(var n=t[e-1],i=n.y,r=n.bottom,a=e-2;a>=0;a--){var o=t[a];if(o.y!==i)break;r=Math.max(r,o.bottom)}var s=Th.folderMax;return r+s.margin.bottom},renderFolderViewRect:function(){var t=this.viewRect,e=this.foldersBoundingClientRect,n=le(t,e);return n&&(n.x=0,e.y>0?n.y-=e.y:n.y-=e.marginTop),n},renderFileViewRect:function(){var t=this.viewRect,e=this.filesBoundingClientRect,n=le(t,e);return n&&(n.x=0,e.y>0?n.y-=e.y:n.y-=e.marginTop),n},renderArtboardViewRect:function(){var t=this.viewRect,e=this.artboardsBoundingClientRect,n=le(t,e);return n&&(n.x=0,e.y>0?n.y-=e.y:n.y-=e.marginTop),n},renderFolderLazyList:function(){var t=this.renderFolderViewRect,e=this.renderFolderRects,n=this.renderCloudSubFolders,i=this.folderListVisible;return this.getRenderLazyList(t,e,n,i,!0)},renderFileLazyList:function(){var t=this.renderFileViewRect,e=this.renderFileRects,n=this.renderCloudSubFiles,i=this.subFilesOpen;return this.getRenderLazyList(t,e,n,i,!0)},renderArtboardLazyList:function(){var t=this.renderArtboardViewRect,e=this.renderArtboardRects,n=this.renderArtboardsWithCurrentPage,i=this.subArtboardsOpen;return this.getRenderLazyList(t,e,n,i,!1)},renderFolderRects:function(){var t=this.renderCloudSubFolders,e=this.foldersBoundingClientRect;if(0===e.width)return[];var n={x:0,y:0,width:e.width,height:e.height},i=[],r=Th.folderMax,a=r.margin.left,o=a,s=r.margin.top,c=Math.floor(n.width/Sh);return t.forEach((function(t,e){var n=new ee;n.set(o,s,r.width,r.height),i.push((new ee).set(n.x,n.y,n.width,n.height)),n.x=n.right+r.margin.left+r.margin.right,1===c||e>0&&(e+1)%c===0?(s+=r.height,s+=r.margin.top+r.margin.bottom,o=a):o=n.x})),i},renderFileRects:function(){var t=this.renderCloudSubFiles,e=this.filesBoundingClientRect;if(0===e.width)return[];var n={x:0,y:0,width:e.width,height:e.height},i=[],r=Th.fileMax,a=r.margin.left,o=a,s=r.margin.top,c=Math.floor(n.width/Sh);return t.forEach((function(t,e){var n=new ee;n.set(o,s,r.width,r.height),i.push((new ee).set(n.x,n.y,n.width,n.height)),n.x=n.right+r.margin.left+r.margin.right,1===c||e>0&&(e+1)%c===0?(s+=r.height,s+=r.margin.top+r.margin.bottom,o=a):o=n.x})),i},renderArtboardRects:function(){var t=this.renderArtboardsWithCurrentPage,e=this.artboardsBoundingClientRect;if(0===e.width)return[];var n={x:0,y:0,width:e.width,height:e.height},i=[],r=Th.artboardMax,a=r.margin.left,o=a,s=r.margin.top,c=Math.floor(n.width/Sh),l=0;return t.forEach((function(t,e){var n=new ee;if(0===r.height){var u=t.artboard.boundsInParent.viewHeight;void 0===u&&(de(t.artboard),u=t.artboard.boundsInParent.viewHeight);var d=r.textHeight+u;isNaN(d)&&(d=r.textHeight),n.set(o,s,r.width,d),l=Math.max(l,n.height)}else n.set(o,s,r.width,r.height);i.push((new ee).set(n.x,n.y,n.width,n.height)),n.x=n.right+r.margin.left+r.margin.right,1===c||e>0&&(e+1)%c===0?(0===r.height?(s+=l,l=0):s+=r.height,s+=r.margin.top+r.margin.bottom,o=a):o=n.x})),i},hasSearchText:function(){return dt(this.searchText)},needShowFile:function(){return this.inCloudMode&&this.cloudCurrentFolderId>0},renderCloudSubFolders:function(){var t=this.cloudSubFolders,e=this.hasSearchText,n=this.searchText;return t&&0!==t.length?e?(n=n.toLowerCase(),t.filter((function(t){var e,i,r=null!==(e=null===(i=t.name)||void 0===i?void 0:i.toLowerCase())&&void 0!==e?e:"";return-1!==r.indexOf(n)}))):t:[]},renderCloudSubFiles:function(){var t=this.cloudSubFiles,e=this.hasSearchText,n=this.searchText;return t&&0!==t.length?e?(n=n.toLowerCase(),t.filter((function(t){var e,i,r=null!==(e=null===(i=t.name)||void 0===i?void 0:i.toLowerCase())&&void 0!==e?e:"";return-1!==r.indexOf(n)}))):t:[]},cloudListSort:function(){return this.$store.state.cloudListSort},sortRenderDocumentArtboards:function(){var t=this.renderDocumentArtboards,e=this.cloudListSort;return t=Object(Gn["a"])(t),Zr(t,"updateTimeTimes",N.Artboard,e),t},renderCloudSubArtboards:function(){var t=this.sortRenderDocumentArtboards,e=this.hasSearchText,n=this.searchText;return t&&0!==t.length?e?(n=n.toLowerCase(),t.filter((function(t){var e,i,r=null!==(e=null===(i=t.artboard)||void 0===i||null===(i=i.name)||void 0===i?void 0:i.toLowerCase())&&void 0!==e?e:"";return-1!==r.indexOf(n)}))):t:[]},hasSubFolders:function(){return this.renderCloudSubFolders.length>0},hasSubFiles:function(){return this.renderCloudSubFiles.length>0},hasSubArtboards:function(){return this.renderCloudSubArtboards.length>0}},data:function(){return{lightArtboardId:0,scrollY:0,scrolling:!1,scrollingHandle:0,handle_resetArtboardsBoundingClientRect:0,viewRect:{x:0,y:0,width:0,height:0},listBoundingClientRect:{x:0,y:0,width:0,height:0},foldersBoundingClientRect:{x:0,y:0,width:0,height:0,marginTop:0},filesBoundingClientRect:{x:0,y:0,width:0,height:0,marginTop:0},artboardsBoundingClientRect:{x:0,y:0,width:0,height:0,marginTop:0},fileContextMenuData:{visible:!1,x:0,y:0,file:null},folderContextMenuData:{visible:!1,x:0,y:0,file:null},searchText:""}},props:{subFoldersOpen:Boolean,subFilesOpen:Boolean,subArtboardsOpen:Boolean,isSupportNetDiskFile:Boolean},created:function(){window.addEventListener("resize",this.onResize)},mounted:function(){this.resetArtboardsBoundingClientRect("mounted")},beforeDestroy:function(){cancelAnimationFrame(this.handle_resetArtboardsBoundingClientRect),clearTimeout(this.scrollingHandle),window.removeEventListener("resize",this.onResize)}},Ih=Ah,Fh=(n("c02b"),Object(wo["a"])(Ih,ud,dd,!1,null,"23cf6ec0",null)),Mh=Fh.exports,Oh=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-nav",class:{on:t.miniFoldersOpen,allfolders:t.allFoldersBoxVisible}},[e("dl",{staticClass:"subfolders",class:{on:t.miniFoldersOpen}},[e("dt",{on:{click:function(e){return e.target!==e.currentTarget?null:t.clickMiniFoldersOpen.apply(null,arguments)}}},[e("div",{staticClass:"title",on:{click:t.clickMiniFoldersOpen}},[t._v("文件夹/文件"),e("span",{staticClass:"count"},[t._v(t._s(t.totalCount))])]),t.miniFoldersOpen?e("div",{staticClass:"c"},[e("div",{staticClass:"search",class:{on:t.inSearchMode}},[e("div",{staticClass:"btn-search",attrs:{title:"搜索当前文件夹"},on:{click:t.showSearch}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],ref:"searchInput",attrs:{type:"text",maxlength:"50",spellcheck:"false"},domProps:{value:t.searchText},on:{blur:t.onSearchInputBlur,input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),t.hasSearchText?e("div",{staticClass:"btn-clear",on:{click:t.clickClearSearchText}}):t._e()]),e("FolderNavSortMenu",{attrs:{mini:!0}})],1):t._e()]),e("dd",{ref:"box",on:{scroll:t.onScroll,mousewheel:t.onMouseWheel}},[t.hasSearchText&&0===t.miniRenderList.length?e("div",{staticClass:"empty"},[t._v("未找到包含 “"+t._s(t.searchText)+"” 的子文件夹或文件")]):t._e(),e("div",{staticClass:"brace",class:{off:t.miniListOpt.mousewheelTimes>0},style:{height:t.miniBoxRealHeight}},[e("div",{staticClass:"front",style:{paddingTop:t.miniFrontMarginTop}},[t._l(t.lazyMiniRenderList,(function(n){return[n.isFolder?e("FolderNavSubFolderItem",{key:n.key,attrs:{folder:n.item,isSupportNetDiskFile:t.isSupportNetDiskFile},on:{contextMenuFolder:t.contextMenuFolder}}):t._e(),n.isFile?e("FolderNavSubFileItem",{key:n.key,attrs:{file:n.item},on:{contextMenuFile:t.contextMenuFile}}):t._e()]}))],2)])])]),e("FileItemContextMenu",{attrs:{fileContextMenuData:t.fileContextMenuData}}),e("FolderItemContextMenu",{attrs:{folderContextMenuData:t.folderContextMenuData}})],1)},_h=[],Lh=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-item",class:t.itemClass,attrs:{title:t.title},on:{contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)},click:function(e){return t.clickGoFolder()}}},[e("div",{staticClass:"icon"}),e("div",{staticClass:"info"},[e("div",{staticClass:"name"},[t._v(t._s(t.folder.name))]),e("div",{staticClass:"art-count"},[t._v(t._s(t.info))])])])},Ph=[],Eh={methods:{onContextmenu:function(t){this.$emit("contextMenuFolder",t,this.folder)},clickGoFolder:function(){tn(this.folder.id)}},computed:{useTimeSort:function(){return this.$store.state.cloudListSort.sortType===D.Date},info:function(){var t=this.folder.updateTimes,e=this.folder,n=this.useTimeSort;return n?kt(t):"共".concat(da(e),"项")},itemClass:function(){var t=this.folder,e={};if(t.shareMode===Y.PrivateCode?e.private=1:t.shareMode===Y.SpecifyMembers&&(e["share-sm"]=1),null!=t.color){var n=H.getName(t.color);n&&(e[n]=1)}return e},countText:function(){var t,e=this.folder;return e.artboardCount+(null!==(t=e.fileCount)&&void 0!==t?t:0)+e.folderCount},title:function(){return ua(this.folder)}},props:{folder:Object,isSupportNetDiskFile:Boolean}},Nh=Eh,Dh=(n("fec7"),Object(wo["a"])(Nh,Lh,Ph,!1,null,"4c3e1b98",null)),jh=Dh.exports,Rh=function(){var t=this,e=t._self._c;return e("div",{staticClass:"file-item",attrs:{title:t.title},on:{click:function(e){return t.clickNetDiskFile(t.file)},contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)}}},[e("div",{ref:"img",staticClass:"img"},[0===t.imgSize.width&&0===t.imgSize.height?e("div",{staticClass:"icon-netdiskfile",class:t.iconCls}):t._e(),e("ArtboardPreviewImg",{attrs:{imgHeight:0,pathPreview:t.file.previewImage},on:{resize:t.onPreviewImgResize}})],1),e("div",{staticClass:"text"},[e("div",{staticClass:"name"},[e("span",{staticClass:"pre"},[e("span",[t._v(t._s(t.file.fileName)+".")])]),e("span",{staticClass:"ext"},[t._v(t._s(t.fileExt))])]),e("div",{staticClass:"info"},[t._v(t._s(t.info))])])])},Vh=[],Bh={components:{ArtboardPreviewImg:Qd},methods:{onPreviewImgResize:function(t,e){var n=this.imgSize;n.width=t,n.height=e},onContextmenu:function(t){this.$emit("contextMenuFile",t,this.file)}},computed:{info:function(){return ma(this.file)},fileExt:function(){var t,e,n=this.file;if(!n)return null;var i=null!==(t=null===(e=n.fileExt)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"";return"."===i[0]&&(i=i.substring(1)),i},iconCls:function(){var t=this.file;return t?V.getName(t.fileType,R.Normal):null},title:function(){return ha(this.file)}},props:{file:Object},data:function(){return{imgSize:{width:0,height:0}}}},Uh=Bh,Hh=(n("f437"),Object(wo["a"])(Uh,Rh,Vh,!1,null,"502e3b68",null)),Wh=Hh.exports,$h={components:{FileItemContextMenu:Nd,FolderItemContextMenu:Ud,FolderNavSubFolderItem:jh,FolderNavSubFileItem:Wh,FolderNavSortMenu:Ch},methods:{contextMenuFolder:function(t,e){var n=t.pageX,i=t.pageY,r=this.folderContextMenuData;requestAnimationFrame((function(){r.x=n,r.y=i,r.folder=e,r.visible=!0}))},contextMenuFile:function(t,e){var n=t.pageX,i=t.pageY,r=this.fileContextMenuData;requestAnimationFrame((function(){r.x=n,r.y=i,r.file=e,r.visible=!0}))},onMouseWheel:function(t){var e;this.miniListOpt.mousewheelTimes=null!==(e=t.timeStamp)&&void 0!==e?e:Date.now()},onScroll:function(t){this.miniListOpt.scrollTop=t.target.scrollTop},resize:function(){if(this.useMiniList){var t=this.$refs.box;if(t){var e=this.miniListOpt;e.boxHeight=t.offsetHeight}}},onSearchInputBlur:function(){var t=this;clearTimeout(this.searchHandle),this.searchHandle=setTimeout((function(){t.searchInputfocus=!1}),100)},clickClearSearchText:function(){this.searchText="",this.showSearch()},showSearch:function(){var t=this;clearTimeout(this.searchHandle),this.searchInputfocus=!0,this.$nextTick((function(){var e;null===(e=t.$refs.searchInput)||void 0===e||e.focus()}))},clickMiniFoldersOpen:function(){this.$emit("clickMiniFoldersOpen",!this.miniFoldersOpen)}},computed:{totalCount:function(){var t,e,n,i,r=null!==(t=null===(e=this.cloudSubFolders)||void 0===e?void 0:e.length)&&void 0!==t?t:0,a=null!==(n=null===(i=this.cloudSubFiles)||void 0===i?void 0:i.length)&&void 0!==n?n:0;return"(".concat(r+a,")")},lazyMiniRenderList:function(){var t=this.miniRenderList,e=this.lazyMiniStartIndex,n=this.lazyMiniLength;return t.slice(e,e+n)},lazyMiniStartIndex:function(){var t=this.miniRenderList,e=this.miniListOpt,n=e.scrollTop,i=e.itemHeight,r=e.boxHeight,a=t.length-Math.floor(r/i);return Math.max(0,Math.min(a,Math.floor(n/i)-1))},lazyMiniLength:function(){var t=this.miniRenderList,e=this.lazyMiniStartIndex,n=this.miniListOpt,i=n.boxHeight,r=n.itemHeight;return Math.min(t.length-e,Math.ceil(i/r)+2)},miniFrontMarginTop:function(){return this.lazyMiniStartIndex*this.miniListOpt.itemHeight+"px"},miniBoxRealHeight:function(){return this.miniListOpt.itemHeight*this.miniRenderList.length+"px"},useMiniList:function(){return 0!==this.renderDocumentArtboards.length},miniRenderList:function(){var t=this.cloudSubFolders,e=this.cloudSubFiles,n=this.hasSearchText,i=this.searchText,r=[];return i=n?i.toLowerCase():null,t&&t.forEach((function(t){var e,a;n&&-1==(null!==(e=null===(a=t.name)||void 0===a?void 0:a.toLowerCase())&&void 0!==e?e:"").indexOf(i)||r.push({isFolder:!0,item:t,key:"ml_folder_".concat(t.id)})})),e&&e.forEach((function(t){var e,a,o;n&&-1==(null!==(e=null===(a=t.name)||void 0===a?void 0:a.toLowerCase())&&void 0!==e?e:"").indexOf(i)||r.push({isFile:!0,item:t,key:"ml_file_".concat(null!==(o=t.id)&&void 0!==o?o:t.viewUrl)})})),r},inSearchMode:function(){return this.searchInputfocus||this.hasSearchText},hasSearchText:function(){return dt(this.searchText)}},watch:{"miniListOpt.mousewheelTimes":function(t){var e=this;clearTimeout(this.miniListOpt.mousewheelHandle),t&&(this.miniListOpt.mousewheelHandle=setTimeout((function(){e.miniListOpt.mousewheelTimes=!1}),200))},miniFoldersOpen:function(t){var e=this;t||(this.searchText=""),this.$nextTick((function(){e.resize()}))}},props:{isSupportNetDiskFile:Boolean,miniFoldersOpen:Boolean},data:function(){return{searchHandle:0,folderContextMenuData:{visible:!1,x:0,y:0,file:null},fileContextMenuData:{visible:!1,x:0,y:0,file:null},searchText:"",searchInputfocus:!1,miniListOpt:{scrollTop:0,boxHeight:0,mousewheelTimes:0,mousewheelHandle:0,itemHeight:68}}},beforeDestroy:function(){clearTimeout(this.searchHandle),clearTimeout(this.miniListOpt.mousewheelHandle),window.removeEventListener("resize",this.resize)},created:function(){window.addEventListener("resize",this.resize)},mounted:function(){var t=this;this.$nextTick((function(){t.resize()}))}},Gh=$h,zh=(n("180c"),Object(wo["a"])(Gh,Oh,_h,!1,null,"30b034fe",null)),Yh=zh.exports,Xh={components:{FolderNavMini:Yh,FolderNavMax:Mh},methods:{clickSubFoldersOpen:function(){this.inArtboardMultDownMode||(this.subFoldersOpen=!this.subFoldersOpen,rn("subfolderopen",this.subFoldersOpen?"1":"0"))},clickSubFilesOpen:function(){this.inArtboardMultDownMode||(this.subFilesOpen=!this.subFilesOpen,rn("subFilesOpen",this.subFilesOpen?"1":"0"))},clickSubArtboardsOpen:function(){this.inArtboardMultDownMode&&this.subArtboardsOpen||(this.subArtboardsOpen=!this.subArtboardsOpen,rn("subartboardsopen",this.subArtboardsOpen?"1":"0"))},clickMiniFoldersOpen:function(t){this.miniFoldersOpen=t}},computed:{useMiniList:function(){return!this.artShowInListMode&&0!==this.renderDocumentArtboards.length},isSupportNetDiskFile:function(){return this.inCloudMode&&!pt(this.cloudVersion)},visible:function(){return this.inCloudMode&&!this.inArtboardMode&&!this.cloudFolderNotFound&&(this.hasSubFolders||this.hasSubFiles||this.artShowInListMode&&this.hasSubArtboards)},hasSubFolders:function(){var t=this.cloudSubFolders;return t&&t.length>0},hasSubFiles:function(){var t=this.cloudSubFiles;return t&&t.length>0},hasSubArtboards:function(){return this.renderDocumentArtboards.length>0},cloudListSort:function(){return this.$store.state.cloudListSort}},watch:{visible:function(t){t||(this.miniFoldersOpen=!1)}},data:function(){var t="0"!==nn("subfolderopen",!1),e="0"!==nn("subFilesOpen",!1),n="0"!==nn("subartboardsopen",!1),i=!1;return{subFoldersOpen:t,subFilesOpen:e,subArtboardsOpen:n,miniFoldersOpen:i}}},Kh=Xh,qh=(n("f245"),Object(wo["a"])(Kh,cd,ld,!1,null,"78f2186e",null)),Qh=qh.exports,Jh=function(){var t=this,e=t._self._c;return t.tipVisible?e("div",{staticClass:"pop-tip-text"},[e("p",[e("span",{staticClass:"loading"}),t._v(" "+t._s(t.tipText)+" ")])]):t._e()},Zh=[],tf={computed:{tipText:function(){return"正在导出切图资源中,请稍后..."},tipVisible:function(){return this.$store.state.inOutput}}},ef=tf,nf=(n("597f"),Object(wo["a"])(ef,Jh,Zh,!1,null,"960b11d8",null)),rf=nf.exports,af=function(){var t=this,e=t._self._c;return e("header",[e("PathNav"),t.inArtboardMode?e("div",{staticClass:"view-mode"},[e("div",{staticClass:"view-mode-comment",class:{on:t.artboardInComment},domProps:{textContent:t._s("评论(".concat(t.curArtboardCommentCount,")"))},on:{click:function(e){return t.clickSetArtboardInComment(!0)}}}),e("div",{staticClass:"view-mode-mark",class:{on:!t.artboardInComment},on:{click:function(e){return t.clickSetArtboardInComment(!1)}}},[t._v("标注")])]):e("div"),e("div",{staticClass:"set",class:{zoom:t.propertyVisible}},[t.setVisible?[t.inArtboardMode||!t.artShowInListMode?[e("BtnContainerColor"),e("ScaleControl",{attrs:{type:t.inArtboardMode?1:0}}),e("div",{staticClass:"line"})]:t._e(),t.inArtboardMode?t._e():e("a",{staticClass:"btn-download",class:{on:t.inArtboardMultDownMode},attrs:{href:"javascript:;",title:"批量下载画板预览图"},on:{click:function(e){return t.setInArtboardMultDownMode(!t.inArtboardMultDownMode)}}}),t.canShowUpload?e("BtnUpload"):t._e(),t.inCloudMode&&!t.inArtboardMode?e("BtnArtRenderMode"):t._e(),t.inCloudMode&&!t.inArtboardMode||t.canShowUpload?e("div",{staticClass:"line line-left"}):t._e(),e("div",{staticClass:"helper",class:{on:t.helperVisible,inright:!t.inCloudMode},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickHelper(!t.helperVisible)}}},[e("Helper")],1),t.inCloudMode?e("BtnGoInteraction"):t._e()]:t.inCloudMode&&!t.cloudFolderNotFound&&t.permission&&t.canShowUpload?[e("BtnUpload"),e("div",{staticClass:"line line-left"})]:t._e(),t.curNetDiskFile&&t.fileDownloadUrl?e("a",{staticClass:"btn-download",attrs:{href:"javascript:;",title:"下载文件"},on:{click:function(e){return t.clickDownloadNetDiskFile(t.curNetDiskFile)}}}):t._e(),t.canShowLog?e("CloudFolderLogs"):t._e(),t.inCloudMode&&t.cloudIsLogin?e("UserNotifyButton"):t._e(),t.inCloudMode?e("UserInfo",{attrs:{setVisible:t.setVisible}}):t._e()],2),t.inCloudMode?e("UserNotify"):t._e()],1)},of=[],sf=function(){var t=this,e=t._self._c;return e("div",{staticClass:"btn-container-color"},[e("a",{staticClass:"btn-color",style:{backgroundColor:t.backgroundColor},attrs:{href:"javascript:;",title:"设置预览场景背景色"},on:{click:function(e){t.boxVisible=!t.boxVisible}}}),t.boxVisible?e("div",{staticClass:"box"},[e("h5",{attrs:{"data-unhide":"1"}},[t._v("场景背景色")]),e("div",{staticClass:"list",attrs:{"data-unhide":"1"}},[e("div",{staticClass:"item item-color-picker",class:{on:t.usedColorPicker},attrs:{"data-unhide":"1"},on:{click:function(e){return t.clickColorPicker()}}},[e("input",{ref:"colorPicker",attrs:{title:"自定义背景色","data-unhide":"1",type:"color"},on:{input:t.onColorPickerChange}})]),e("div",{staticClass:"line",attrs:{"data-unhide":"1"}}),t._l(t.recommendedColors,(function(n,i){return e("div",{key:i,staticClass:"item",class:{on:t.backgroundColor===n},style:{"background-color":n},attrs:{"data-unhide":"1"},on:{click:function(e){return t.clickRecommendColor(n)}}})}))],2)]):t._e()])},cf=[],lf={methods:{onColorPickerChange:function(t){var e,n=null===(e=t.target)||void 0===e?void 0:e.value;n&&this.clickRecommendColor(n)},clickColorPicker:function(){var t=this.$refs.colorPicker;t&&(t.value=this.backgroundColor)},clickRecommendColor:function(t){this.$store.commit("setInteractionBackground",t)},hideContextmenu:function(t){var e,n=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),"1"!==(null===(e=t.target)||void 0===e?void 0:e.getAttribute("data-unhide"))&&(this.handle=setTimeout((function(){n.boxVisible=!1}),100)))}},watch:{boxVisible:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},computed:{recommendedColors:function(){return["#000000","#282828","#ffffff","#eeeeee","#f5f5f5"]},usedColorPicker:function(){var t=this.recommendedColors,e=this.backgroundColor;return!t.find((function(t){return t===e}))},backgroundColor:function(){return this.interactionSet.backgroundColor},interactionSet:function(){return this.$store.state.artboardDetail.interactionSet}},data:function(){return{handle:0,boxVisible:!1}},beforeDestroy:function(){window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0),clearTimeout(this.handle)}},uf=lf,df=(n("c050"),Object(wo["a"])(uf,sf,cf,!1,null,"7392e1d8",null)),hf=df.exports,ff=function(){var t=this,e=t._self._c;return e("div",{staticClass:"netdisk-upload"},[e("div",{staticClass:"btn-netdisk-upload",class:{off:t.cannotUseNetDisk},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickOpenNetDiskUploadBox.apply(null,arguments)}}},[e("ul",[e("li",{staticClass:"btn-upload-file",on:{click:t.clickOpenNetDiskUploadBox}},[t._v("上传文件")]),e("li",{staticClass:"btn-upload-link",on:{click:t.clickAddNetDiskLink}},[t._v("添加链接")])])]),t.linkbox.visible?e("LinkEdit",{attrs:{link:t.linkbox},on:{onFileChanged:t.onFileChanged}}):t._e(),e("FileUpload",{attrs:{filebox:t.filebox},on:{onFileChanged:t.onFileChanged}})],1)},mf=[],pf=(n("21b8"),function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"pop-box cloudfile-linkedit",on:{mousedown:function(t){t.stopPropagation()}}},[e("div",{staticClass:"box"},[e("a",{staticClass:"sys-close",attrs:{href:"javascript:;",title:"取消操作"},on:{click:t.clickCloseBox}}),e("h5",[t._v(t._s(t.isAdd?"添加":"编辑")+"链接")]),e("h6",[t._v(t._s(t.isAdd?"添加一个":"编辑")+"链接以便从标记狮访问它")]),e("div",{staticClass:"form"},[e("div",{staticClass:"title"},[t._v("链接名称")]),e("UserInput",{ref:"name",attrs:{defaultBorder:!0,placeholder:"请输入链接名称",target:"inp-name",initValue:t.linkData.name,maxLength:100},on:{change:t.onNameChange}}),e("div",{staticClass:"title"},[t._v("链接地址")]),e("UserInput",{ref:"link",attrs:{defaultBorder:!0,placeholder:"请输入链接地址,以https://、http:// 或 ftp:// 开头",target:"inp-link",initValue:t.linkData.link,maxLength:8192},on:{change:t.onLinkChange}})],1),e("div",{staticClass:"btns"},[e("a",{staticClass:"btn-cancel",attrs:{href:"javascript:;"},on:{click:t.clickCloseBox}},[t._v("取消")]),e("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:t.clickSave}},[t._v(t._s(t.submitFetching?"提交中...":"确定"))])])])]):t._e()}),vf=[],bf=function(){var t=this,e=t._self._c;return e("div",{staticClass:"input",class:t.cls},["checkbox"===t.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"input",attrs:{maxlength:t.maxLength,placeholder:t.placeholder,autocomplete:t.autocomplete,spellcheck:"false",type:"checkbox"},domProps:{checked:Array.isArray(t.value)?t._i(t.value,null)>-1:t.value},on:{blur:t.blur,focus:t.focus,change:function(e){var n=t.value,i=e.target,r=!!i.checked;if(Array.isArray(n)){var a=null,o=t._i(n,a);i.checked?o<0&&(t.value=n.concat([a])):o>-1&&(t.value=n.slice(0,o).concat(n.slice(o+1)))}else t.value=r}}}):"radio"===t.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"input",attrs:{maxlength:t.maxLength,placeholder:t.placeholder,autocomplete:t.autocomplete,spellcheck:"false",type:"radio"},domProps:{checked:t._q(t.value,null)},on:{blur:t.blur,focus:t.focus,change:function(e){t.value=null}}}):e("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"input",attrs:{maxlength:t.maxLength,placeholder:t.placeholder,autocomplete:t.autocomplete,spellcheck:"false",type:t.type},domProps:{value:t.value},on:{blur:t.blur,focus:t.focus,input:function(e){e.target.composing||(t.value=e.target.value)}}}),t.showVerify?e("img",{staticClass:"verifycode",attrs:{src:t.verifySrc,title:"点击刷新验证码"},on:{click:function(e){return t.clickVerifyCode()}}}):t.showPwd?e("span",{staticClass:"pwd-mode",class:{"in-text":t.pwdModeInText},on:{click:function(e){t.pwdModeInText=!t.pwdModeInText}}}):t.showPhoneCode?e("a",{staticClass:"button btn-phoneCodeSend",class:{off:!t.phoneCodeBtnEnable,light:t.phoneCodeBtnEnable},attrs:{href:"javascript:;"},on:{click:t.sendPhoneCode}},[t._v(t._s(t.phoneCodeBtnText))]):t._e()])},gf=[],wf={methods:{sendPhoneCode:function(){this.$emit("sendPhoneCode")},setFocus:function(){var t=this.$refs.input;t&&t.focus()},setValue:function(t){"string"===typeof t&&(this.value=t)},clearAndFocus:function(){this.value="",this.setFocus()},refreshCode:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.ticks=Date.now(),t.value="";case 2:case"end":return e.stop()}}),e)})))()},clickVerifyCode:function(t){var e=this.ticks,n=Date.now(),i=n-e;i<500&&i>=0||(this.ticks=n,this.value="",!0!==t&&this.setFocus())},focus:function(){this.focused=!0},blur:function(){this.focused=!1}},watch:{showVerify:function(t){t&&this.refreshCode()},value:function(t){this.$emit("change",t)}},props:{target:String,initValue:String,placeholder:String,maxLength:Number,defaultBorder:Boolean,phoneCodeBtnText:String,phoneCodeBtnEnable:Boolean},computed:{autocomplete:function(){return"password"===this.type?"new-password":"off"},type:function(){return"pwd2"===this.target||"pwd3"===this.target?"password":this.showPwd?this.pwdModeInText?"text":"password":"text"},verifySrc:function(){return"".concat(he,"router/verifycode.ashx?r=").concat(this.ticks)},showPwd:function(){return"pwd"===this.target},showVerify:function(){return"verify"===this.target},showPhoneCode:function(){return"phoneCode"===this.target},cls:function(){var t=[],e=this.target;return e&&t.push(e),this.focused&&t.push("focused"),this.defaultBorder&&t.push("default-bor"),t}},created:function(){this.value=this.initValue,this.showVerify&&this.refreshCode()},data:function(){return{pwdModeInText:!1,focused:!1,value:"",ticks:Date.now()}}},xf=wf,yf=(n("023f"),Object(wo["a"])(xf,bf,gf,!1,null,"474237c6",null)),kf=yf.exports,Cf={components:{UserInput:kf},methods:{clickSave:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s,c,l;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.submitFetching){e.next=2;break}return e.abrupt("return");case 2:if(n=t.linkData,n.name=n.name.trim(),n.link=n.link.trim(),r=t.isAdd,dt(n.name)){e.next=11;break}return t.showTextTip("链接名称不能为空,请输入链接名称"),a=t.$refs.name,a&&a.setFocus(),e.abrupt("return");case 11:if(dt(n.link)){e.next=16;break}return t.showTextTip("链接地址不能为空,请输入链接地址"),o=t.$refs.link,o&&o.setFocus(),e.abrupt("return");case 16:if(/^(?:ftp|http|https):\/\/.+$/.test(n.link)){e.next=21;break}return t.showTextTip("请输入合法的链接地址,以https://、http:// 或 ftp:// 开头"),s=t.$refs.link,s&&(null===s||void 0===s||s.setFocus()),e.abrupt("return");case 21:if(r){e.next=27;break}if(c=t.link.data||{},c.name!==n.name||c.link!==n.link){e.next=27;break}return t.showTextTip("链接信息未发生变更"),t.clickCloseBox(),e.abrupt("return");case 27:return t.submitFetching=!0,e.prev=28,e.next=31,t.fetchPostCloudApi("setnetdisklinkbyweb",{timeout:1e4,body:n});case 31:if(l=e.sent,ht(l)){e.next=34;break}return e.abrupt("return");case 34:if(l.success){e.next=37;break}return t.showTextTip(l.errMsg),e.abrupt("return");case 37:l=l.data,t.$emit("onFileChanged",{files:[l.data],folderUpdateTimes:l.folderUpdateTimes,isAdd:r}),t.clickCloseBox(),t.showTextTip("".concat(r?"添加":"编辑","链接成功")),e.next=46;break;case 43:e.prev=43,e.t0=e["catch"](28),t.showTextTip("".concat(r?"添加":"编辑","链接失败:").concat(e.t0));case 46:return e.prev=46,t.submitFetching=!1,e.finish(46);case 49:case"end":return e.stop()}}),e,null,[[28,43,46,49]])})))()},onNameChange:function(t){this.linkData.name=t},onLinkChange:function(t){this.linkData.link=t},clickCloseBox:function(){var t=this.link;t.data=null,t.visible=!1}},computed:{isAdd:function(){return 0==this.linkData.id&&!dt(this.linkData.secId)},visible:function(){return this.link.visible}},data:function(){return{submitFetching:!1,linkData:null}},props:{link:Object},created:function(){this.linkData=Object.assign({},this.link.data||{id:0,name:"",link:"",parentId:0,secId:""})}},Sf=Cf,Tf=(n("5ccb"),Object(wo["a"])(Sf,pf,vf,!1,null,"4ab12b2e",null)),Af=Tf.exports,If=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"pop-box cloudfile-upload",on:{mousedown:function(t){t.stopPropagation()},drop:function(t){t.preventDefault()}}},[e("div",{staticClass:"box"},[e("a",{staticClass:"sys-close",attrs:{href:"javascript:;",title:"取消操作"},on:{click:t.clickCloseBox}}),e("div",{staticClass:"drag-box",class:{dragging:t.dropTip.dragging}},[t._m(0),e("h4",[t._v(t._s(t.dragTitle))]),e("h5",[t._v("支持图片/SVG/PDF/Axure HTML演示文件以及其他任意格式文件")])]),t.hasFile?e("div",{ref:"files",staticClass:"files",on:{scroll:t.onBoxScroll}},[e("div",{staticClass:"height",class:{scrolling:t.scrolling},style:{height:t.boxRealHeight+"px"}},[e("div",{style:{"padding-top":t.renderListCssPaddingTop+"px"}},t._l(t.renderList,(function(t){return e("FileUploadItem",{key:t.id,attrs:{item:t}})})),1)])]):t._e(),e("div",{staticClass:"footer",class:{empty:!t.hasFile}},[t.hasFile?e("div",{staticClass:"other"},[e("div",{staticClass:"btn-clean btn-clean-all",on:{click:t.clickRemoveAll}},[t._v("清空全部")]),e("div",{staticClass:"btn-clean",on:{click:t.clickRemoveCompleted}},[t._v("清理已完成文件")])]):t._e(),e("div",{staticClass:"button light",on:{click:t.clickAddFiles}},[t._v("添加文件"),e("input",{attrs:{type:"file",value:"",size:"30",multiple:""},on:{change:t.onInputFileChange}})])])])]):t._e()},Ff=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"icon"},[e("div",{staticClass:"l"}),e("div",{staticClass:"r"})])}],Mf=(n("366d"),n("1587"),!1),Of=[],_f={};function Lf(){clearTimeout(zu),zu=setTimeout((function(){if(Gu){try{_f={},Gu.terminate()}catch(t){}Gu=null}}),12e4)}function Pf(){return new Promise((function(t,e){if(Gu)return t(Gu);if(Mf)Of.push({resolve:t,reject:e});else{Mf=!0;var n=function(t,e,n){var i=Of;Of=[],i.forEach((function(i){var r=i.resolve,a=i.reject;e?r(t):a(n)}))},i=new Worker(Bn()+"marklion_cloud_web_worker.js");i.addEventListener("message",(function(r){Lf();var a=r.data;if(a&&!0===a.__mcww){delete a.__mcww;var o=a.command;switch(delete a.command,o){case"inited":var s;Mf=!1,_f={};try{if(a.success)Gu=i,t(i);else{try{i.terminate()}catch(l){}s=a.errMsg||"error",e(s)}}catch(l){}n(i,a.success,s);break;default:var c=_f[o];c&&(delete _f[o],c(a));break}}})),i.addEventListener("error",(function(t){Lf(),console.error(t)}))}}))}function Ef(t,e){_f[t]=e}function Nf(t){return Df.apply(this,arguments)}function Df(){return Df=Object(r["a"])(Object(i["a"])().mark((function t(e){var n,r,a,o,s,c,l,u,d=arguments;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(n=ge.cloudKey,r=ge.userKey,a="".concat(e,"-").concat(Math.random().toString(16).substring(2)),o=d.length,s=new Array(o>1?o-1:0),c=1;c<o;c++)s[c-1]=d[c];return l={__mcww:!0,command:e,arg_len:s.length+1,arg0:"".concat(n,"-").concat(r||"null"),key:a},s.forEach((function(t,e){l["arg".concat(e+1)]=t})),t.next=7,Pf();case 7:return u=t.sent,t.next=10,new Promise((function(t,e){Ef(a,(function(n){n&&(n.success?t(n.data):e(n.errMsg))})),u.postMessage(l)}));case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)}))),Df.apply(this,arguments)}var jf=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"key",null),Object(Ht["a"])(this,"worker",null),Object(Ht["a"])(this,"msg",null)}return Object(Ut["a"])(t,[{key:"startAsync",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a=this;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Pf();case 2:return r=t.sent,this.worker=r,t.next=6,new Promise((function(t){n||(n={});var i=a.key=Math.random().toString(16).substring(2),r="filemd5.".concat(i,"."),o=r+"completed",s=r+"progress",c=a.msg=function(e){var i=e.data;if(i&&"object"===Object(J["a"])(i)&&!0===i.__filemd5){var r=i.command;switch(r){case o:delete i.__filemd5,delete i.command;try{var l=a.worker;l&&(l.removeEventListener("message",c),a.worker=a.key=a.msg=c=n=null)}catch(u){}t(i);break;case s:delete i.__filemd5,delete i.command,n&&n.onprogress&&n.onprogress(i);break}}},l=a.worker;l.addEventListener("message",c),l.postMessage({__filemd5:!0,command:"filemd5.start",key:i,file:e,needHash:n.needHash,needQuickHash:n.needQuickHash})}));case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"cancelAsync",value:function(){var t=this.key,e=this.worker,n=this.msg;t&&e&&(this.key=this.worker=null,n&&(e.removeEventListener("message",n),this.msg=null),e.postMessage({__filemd5:!0,command:"filemd5.cancel",key:t}))}}]),t}(),Rf=81920;function Vf(){return Rf*Oe(38,65)}var Bf=function(){function t(e){var n=this;Object(Bt["a"])(this,t),Object(Ht["a"])(this,"hasExist",!1),Object(Ht["a"])(this,"uploadGuid",void 0),Object(Ht["a"])(this,"file",void 0),Object(Ht["a"])(this,"sliceLength",0),Object(Ht["a"])(this,"mainFileSliceCurrent",0),Object(Ht["a"])(this,"lineViewPackSliceCurrent",0),Object(Ht["a"])(this,"previewImageSliceCurrent",0),Object(Ht["a"])(this,"lineViewVer",0),Object(Ht["a"])(this,"supportPreviewFileExt",!1),Object(Ht["a"])(this,"supportXSPFilePreview",!1),Object.keys(e).forEach((function(t){switch(t){case"needLineViewPack":case"needPreViewImage":return}n[t]=e[t]}))}return Object(Ut["a"])(t,[{key:"needLineViewPack",get:function(){return this.lineViewPackSliceCurrent>-1}},{key:"needPreViewImage",get:function(){return this.previewImageSliceCurrent>-1}}]),t}(),Uf={MainFile:0,LineViewPack:1,PreviewImage:2},Hf=Object(Ut["a"])((function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"type",Uf.MainFile),Object(Ht["a"])(this,"uploadGuid",null),Object(Ht["a"])(this,"current",0),Object(Ht["a"])(this,"byteLength",0),Object(Ht["a"])(this,"rndLength",0)})),Wf=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"folderId",0),Object(Ht["a"])(this,"guid",null),Object(Ht["a"])(this,"fileType",V.Other),Object(Ht["a"])(this,"urlLink",null),Object(Ht["a"])(this,"lastWriteTime",0),Object(Ht["a"])(this,"fileName",null),Object(Ht["a"])(this,"previewFileExt",null),Object(Ht["a"])(this,"fileExt",null),Object(Ht["a"])(this,"sliceLength",0),Object(Ht["a"])(this,"mainFile",null),Object(Ht["a"])(this,"lineViewPack",null),Object(Ht["a"])(this,"previewImage",null)}return Object(Ut["a"])(t,[{key:"lineViewVer",get:function(){return 1}}]),t}(),$f=function(){function t(e,n,i,r){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"size",0),Object(Ht["a"])(this,"hash",null),Object(Ht["a"])(this,"quickHash",null),Object(Ht["a"])(this,"sliceCount",0),this.hash=e,this.quickHash=n,this.size=i,this.updateSliceCount(r)}return Object(Ut["a"])(t,[{key:"updateSliceCount",value:function(t){this.sliceCount=Math.ceil(this.size/t)}}]),t}(),Gf=Object(Ut["a"])((function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"lineViewVer",0),Object(Ht["a"])(this,"supportPreviewFileExt",!1),Object(Ht["a"])(this,"supportXSPFilePreview",!1)})),zf=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"mainFile",null),Object(Ht["a"])(this,"lineViewPack",null),Object(Ht["a"])(this,"previewImage",null),Object(Ht["a"])(this,"previewImageWithExt",null)}return Object(Ut["a"])(t,[{key:"setPreviewImage",value:function(t,e){e?this.previewImageWithExt=t:this.previewImage=t}},{key:"getPreviewImage",value:function(t){return t?this.previewImageWithExt:this.previewImage}}]),t}(),Yf=function(){function t(){var e=this;Object(Bt["a"])(this,t),Object(Ht["a"])(this,"id",0),Object(Ht["a"])(this,"folderId",0),Object(Ht["a"])(this,"guid",null),Object(Ht["a"])(this,"fileType",void 0),Object(Ht["a"])(this,"currentPosition",0),Object(Ht["a"])(this,"currentSize",0),Object(Ht["a"])(this,"status",tm.Fetching),Object(Ht["a"])(this,"_fileName",null),Object(Ht["a"])(this,"_size",0),Object(Ht["a"])(this,"_lastWriteTime",0),Object(Ht["a"])(this,"file",null),Object(Ht["a"])(this,"hash",null),Object(Ht["a"])(this,"quickHash",null),Object(Ht["a"])(this,"ext",null),Object(Ht["a"])(this,"lineViewPack",null),Object(Ht["a"])(this,"previewImage",null),Object.keys(this).filter((function(t){return"_"===t[0]})).forEach((function(t){Object.defineProperty(e,t,{enumerable:!1})}))}return Object(Ut["a"])(t,[{key:"needLineViewPack",get:function(){switch(this.fileType){case V.Word:case V.Excel:case V.PPT:return!0;default:return!1}}},{key:"isJsonFile",get:function(){var t=this.fileName;return t&&/\.json$/gi.test(t)}},{key:"isIconFile",get:function(){var t=this.fileType,e=this.fileName;return t==V.Image&&(!!dt(e)&&/\.(icon|ico|icns)$/gi.test(e))}},{key:"isSvgFile",get:function(){var t=this.fileType,e=this.fileName;return t==V.Image&&/\.(svg)$/gi.test(e)}},{key:"needPreviewImage",get:function(){switch(this.fileType){case V.Image:return!0;case V.Lottie:return!0;case V.XD:case V.Sketch:case V.Figma:return!0;default:return!1}}},{key:"currentPercentage",get:function(){var t=this.currentSize;if(0==t)return 0;var e=this.currentPosition;return e<1?0:e>t?100:Math.round(1e4*e/t)/100}},{key:"fileName",get:function(){var t,e=this._fileName;if(e)return e;var n=this.file;return e=this._fileName=null!==(t=null===n||void 0===n?void 0:n.name)&&void 0!==t?t:null,e}},{key:"fileExt",get:function(){var t=this.fileName;if(!t)return null;var e=t.lastIndexOf(".");return-1===e?"":t.substring(e)}},{key:"size",get:function(){var t,e=this._size;if(e>0)return e;var n=this.file;return e=this._size=null!==(t=null===n||void 0===n?void 0:n.size)&&void 0!==t?t:0,e}},{key:"lastWriteTime",get:function(){var t,e=this._lastWriteTime;if(e>0)return e;var n=this.file;return e=this._lastWriteTime=null!==(t=null===n||void 0===n?void 0:n.lastModified)&&void 0!==t?t:0,e}},{key:"needResetHash",value:function(){return!dt(this.hash)||!dt(this.quickHash)}}]),t}(),Xf=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"size",0),Object(Ht["a"])(this,"lastWriteTime",0),Object(Ht["a"])(this,"file",null),Object(Ht["a"])(this,"previewFileExt",null),Object(Ht["a"])(this,"hash",null),Object(Ht["a"])(this,"quickHash",null)}return Object(Ut["a"])(t,[{key:"needResetHash",value:function(){return!dt(this.hash)||(!dt(this.quickHash)||null==this.file)}}]),t}(),Kf={TextTip:Symbol("TextTip"),UploadUpdate:Symbol("UploadUpdate"),UploadRemove:Symbol("UploadRemove"),CloudFileUpdate:Symbol("CloudFileUpdate"),WebUserNotLogin:Symbol("WebUserNotLogin"),WebFileChanged:Symbol("WebFileChanged")},qf=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"inlineEvents",{}),Object(Ht["a"])(this,"cloudNetDiskFileUploaderInfoCache",null),Object(Ht["a"])(this,"uploadList",[]),Object(Ht["a"])(this,"_sql_auto_id",1)}return Object(Ut["a"])(t,[{key:"on",value:function(t,e){if(!t)return!1;if("function"!==typeof e)return!1;var n=this.inlineEvents,i=n[t];if(i){var r=i.find((function(t){return t===e}));r||i.push(e)}else i=n[t]=[e];return!0}},{key:"off",value:function(t,e){if(!t)return!1;var n=this.inlineEvents,i=n[t];if(!i||0===i.length)return!0;if(void 0===e)n[t]=[];else{var r=i.findIndex((function(t){return t===e}));-1!==r&&i.splice(r,1)}return!0}},{key:"emit",value:function(t,e){if(t){var n=this.inlineEvents,i=n[t];i&&0!==i.length&&i.forEach((function(t){t(e)}))}}},{key:"runTask",value:function(t){if(t)switch(t.type){case em.Remove_All:case em.Remove_Completed:case em.Remove_Select:this.removeTask(t);break;case em.Resume:case em.Pause:case em.ReStart:this.updateTask(t);break;case em.Add:this.addTask(t);break}}},{key:"addTask",value:function(t){var e=this;if(null!=t.files&&0!=t.files.length){var n={},i=[];if(t.files.forEach((function(t){try{var e=t.name;if(!dt(e))return;n["".concat(e,"-").concat(t.size)]=t}catch(i){}})),0!=Object.keys(n).length){var r=0,a=!1,o=this.uploadList;o.forEach((function(e){var i="".concat(e.fileName,"-").concat(e.size);if(e.folderId==t.folderId&&n[i])switch(e.status){case tm.PreLoadFileMsg:delete n[i],a=!0;break;case tm.Waitting:delete n[i],a=!0;break;case tm.Fetching:delete n[i],a=!0;break;case tm.Paused:case tm.Errored:case tm.Completed:case tm.RemovedMark:return e.quickHash="",e.hash="",e.status=tm.Waitting,delete n[i],void r++}})),Object.keys(n).forEach((function(e){var r=n[e],a=new Yf;a.id=0,a.status=tm.PreLoadFileMsg,a.fileType=V.Other,a.ext="文件等待上传中",a.file=r,a.folderId=t.folderId,a.guid=null,a.hash=null,a.currentPosition=0,a.currentSize=0,a.quickHash=null,i.push(a),o.push(a)})),r=this.updateToSql(i),r>0?(r<i.length&&(i=i.filter((function(t){return t.id>0}))),this.sendStateToWeb(i),this.showTextTip("共计".concat(r,"个文件被添加到上传列表")),this.updatePreLoadFileMsgs(i)):a&&this.showTextTip("文件已经在上传列表中,请不要重复添加"),requestAnimationFrame((function(){e.startUploadTask()}))}}}},{key:"showTextTip",value:function(t){this.emit(Kf.TextTip,t)}},{key:"getUploadTask",value:function(){var t=this,e=this.uploadList,n=e.find((function(t){return t.status===tm.Fetching}));return null!=n?null:(n=e.find((function(e){return e.status==tm.Waitting&&(!e.needResetHash()||(e.status=tm.PreLoadFileMsg,e.ext="文件等待上传中",t.sendStateToWeb(e),t.updatePreLoadFileMsg(e),!1))})),null==n?null:(n.status=tm.Fetching,n.ext="",this.sendStateToWeb(n),n))}},{key:"enpostdata",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Nf("upload_assist","string"===typeof e?e:JSON.stringify(e),n>0?n:0);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"getUrlLink",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.fileType==V.Url){t.next=2;break}return t.abrupt("return");case 2:n.urlLink="";case 3:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"getUploadPreInfo",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){var n,r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=this,t.next=3,this.enpostdata(e);case 3:return t.t1=t.sent,t.t2={body:t.t1,timeout:1e4},t.next=7,t.t0.fetchPostCloudApi.call(t.t0,"netdiskfilepreuploadbyweb",t.t2);case 7:if(r=t.sent,r.success){t.next=10;break}throw null!==(n=r.errMsg)&&void 0!==n?n:"数据传输异常[".concat(r.code,"](NetDiskFilePreUpload)");case 10:if(r.data){t.next=12;break}throw"数据传输异常,data is null(NetDiskFilePreUpload)";case 12:return t.abrupt("return",new Bf(r.data));case 13:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"startUploadTask",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(){var e,n,a,o,s,c,l,u,d,h,f,m,p,v,b,g,w,x=this;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.getUploadTask(),null!=e){t.next=3;break}return t.abrupt("return");case 3:if(n=function(){return e.status==tm.Fetching},a=function(t){t()},t.prev=5,0!=e.size){t.next=8;break}throw"不能上传文件大小为0的文件";case 8:return l=Vf(),u=new Wf,u.fileName=e.fileName,u.fileType=e.fileType,u.folderId=e.folderId,u.guid=e.guid,u.mainFile=new $f(e.hash,e.quickHash,e.size,l),u.lastWriteTime=e.lastWriteTime,u.fileExt=null!==(o=e.fileExt)&&void 0!==o?o:"",u.sliceLength=l,t.next=20,this.getUrlLink(e,u);case 20:return e.needLineViewPack&&null!=e.lineViewPack&&(u.lineViewPack=new $f(e.lineViewPack.hash,e.lineViewPack.quickHash,e.lineViewPack.size,l)),e.needPreviewImage&&null!=e.previewImage&&(u.previewImage=new $f(e.previewImage.hash,e.previewImage.quickHash,e.previewImage.size,l),u.previewFileExt=e.isSvgFile?e.previewImage.previewFileExt:null),t.next=24,this.getUploadPreInfo(u);case 24:if(d=t.sent,h=new Gf,h.lineViewVer=d.lineViewVer,h.supportPreviewFileExt=d.supportPreviewFileExt,h.supportXSPFilePreview=d.supportXSPFilePreview,this.setCloudNetDiskFileUploaderInfo(h),!d.hasExist){t.next=33;break}return a((function(){e.status=tm.Completed,e.ext="文件已存在,无需更新",e.currentSize=e.currentPosition=e.size,x.updateToSql([e]),x.sendStateToWeb(e),d.webFile&&x.sendFileItemToWeb({data:d.webFile})})),t.abrupt("return");case 33:return a((function(){e.guid=d.uploadGuid,x.updateToSql([e])})),u.sliceLength=d.sliceLength,u.mainFile.updateSliceCount(u.sliceLength),null===(s=u.lineViewPack)||void 0===s||s.updateSliceCount(u.sliceLength),null===(c=u.previewImage)||void 0===c||c.updateSliceCount(u.sliceLength),f=new Hf,f.uploadGuid=d.uploadGuid,f.current=d.mainFileSliceCurrent,f.type=Uf.MainFile,m=u.mainFile.size,p=0,v=e.needLineViewPack&&null!=e.lineViewPack&&d.needLineViewPack,b=e.needPreviewImage&&null!=e.previewImage&&d.needPreViewImage,v&&(m+=u.lineViewPack.size),b&&(m+=u.previewImage.size),e.currentSize=m,g=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(r,o,s){var c,l,h;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(f.current<r.sliceCount)){t.next=23;break}c={position:0,length:r.size,file:o};case 3:if(!(c.position<c.length)){t.next=20;break}return f.current++,l=Math.min((f.current-1)*u.sliceLength,r.size),f.byteLength=Math.min(u.sliceLength,r.size-l),f.rndLength=Oe(10,128),t.next=10,x.uploadSlice(c,f,l,(function(t){var i=n();return i&&a((function(){e.currentPosition=p+t,x.sendStateToWeb(e)})),i}));case 10:if(h=t.sent,null!=h){t.next=13;break}return t.abrupt("return",!1);case 13:if(h.success){t.next=17;break}if(!s){t.next=16;break}throw h.errMsg;case 16:return t.abrupt("return",!1);case 17:c.position=l+f.byteLength,t.next=3;break;case 20:if(n()){t.next=22;break}return t.abrupt("return",!1);case 22:a((function(){e.currentPosition=p+Math.min(f.current*d.sliceLength,r.size),x.sendStateToWeb(e)}));case 23:return t.abrupt("return",!0);case 24:return t.prev=24,p+=r.size,t.finish(24);case 27:case"end":return t.stop()}}),t,null,[[0,,24,27]])})));return function(e,n,i){return t.apply(this,arguments)}}(),t.next=52,g(u.mainFile,e.file,!0);case 52:if(!e.needLineViewPack||null==e.lineViewPack||!d.needLineViewPack){t.next=59;break}return f.type=Uf.LineViewPack,f.current=d.lineViewPackSliceCurrent,t.next=57,g(u.lineViewPack,e.lineViewPack.file,!1);case 57:if(t.sent){t.next=59;break}return t.abrupt("return");case 59:if(!e.needPreviewImage||null==e.previewImage||!d.needPreViewImage){t.next=66;break}return f.type=Uf.PreviewImage,f.current=d.previewImageSliceCurrent,t.next=64,g(u.previewImage,e.previewImage.file,!1);case 64:if(t.sent){t.next=66;break}return t.abrupt("return");case 66:if(n()){t.next=68;break}return t.abrupt("return");case 68:return t.next=70,this.uploadCompleted(f);case 70:if(w=t.sent,null!=w){t.next=73;break}return t.abrupt("return");case 73:a((function(){e.status=tm.Completed,e.ext="文件上传成功",e.currentPosition=e.currentSize=e.size,x.updateToSql([e]),x.sendStateToWeb(e),x.sendFileItemToWeb(w)})),t.next=82;break;case 76:if(t.prev=76,t.t0=t["catch"](5),n()){t.next=81;break}return t.abrupt("return");case 81:a((function(){e.status=tm.Errored,e.ext=t.t0.toString(),x.updateToSql([e]),x.sendStateToWeb(e)}));case 82:return t.prev=82,requestAnimationFrame((function(){x.startUploadTask()})),t.finish(82);case 85:case"end":return t.stop()}}),t,this,[[5,76,82,85]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"sendFileItemToWeb",value:function(t){null!=t&&this.emit(Kf.WebFileChanged,t)}},{key:"uploadCompleted",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){var n,r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.byteLength=0,e.rndLength=0,e.current=0,t.prev=3,t.t0=this,t.next=7,this.enpostdata(e);case 7:return t.t1=t.sent,t.t2={body:t.t1,timeout:1e4},t.next=11,t.t0.fetchPostCloudApi.call(t.t0,"netdiskfilesavebyweb",t.t2);case 11:if(n=t.sent,n.success){t.next=14;break}throw null!==(r=n.errMsg)&&void 0!==r?r:"数据传输异常[".concat(n.Code,"](UploadCompleted)");case 14:if(n.data){t.next=16;break}throw"数据传输异常,data is null(UploadCompleted)";case 16:return t.abrupt("return",n.data);case 19:throw t.prev=19,t.t3=t["catch"](3),"".concat(t.t3.toString(),"(UploadCompleted)");case 22:case"end":return t.stop()}}),t,this,[[3,19]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"uploadSlice",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a){var o,s,c,l,u,d;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=2,c=null,e.position!=r&&(e.position=r);case 3:if(!(s>0)){t.next=25;break}if(a(r)){t.next=6;break}return t.abrupt("return",null);case 6:return t.next=8,this.enpostdata(n,n.rndLength);case 8:return l=t.sent,u=e.file.slice(r,n.byteLength+r),d=new Blob([l,u],{type:"application/stream"}),t.prev=11,t.next=14,this.fetchPostCloudApi("netdiskfilesliceuploadbyweb",{body:d,timeout:3e4});case 14:return t.abrupt("return",t.sent);case 17:t.prev=17,t.t0=t["catch"](11),c=t.t0.toString();case 20:return s-=1,t.next=23,be(20);case 23:t.next=3;break;case 25:throw"".concat(null!==(o=c)&&void 0!==o?o:"私有云数据传输异常","(UploadSlice)");case 26:case"end":return t.stop()}}),t,this,[[11,17]])})));function e(e,n,i,r){return t.apply(this,arguments)}return e}()},{key:"sendStateToWeb",value:function(t){this.emit(Kf.UploadUpdate,t)}},{key:"updatePreLoadFileMsgs",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){var n,r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<e.length)){t.next=8;break}return r=e[n],t.next=5,this.updatePreLoadFileMsg(r);case 5:n++,t.next=1;break;case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"updatePreLoadFileMsg",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){var n,r,a,o=this;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,n=function(){return e.status==tm.PreLoadFileMsg},e.currentPosition=0,0!=e.size){t.next=5;break}throw"不能上传文件大小为0的文件";case 5:return e.currentSize=e.size,t.next=8,this.getTaskFileType(e);case 8:if(!e.needLineViewPack&&!e.needPreviewImage){t.next=14;break}return t.next=11,this.getCloudNetDiskFileUploaderInfoAsync();case 11:t.t0=t.sent,t.next=15;break;case 14:t.t0=null;case 15:if(r=t.t0,a=this.getHashCache(e),null!=a){t.next=28;break}return a=new zf,a.mainFile=new Xf,a.mainFile.file=e.file,a.mainFile.lastWriteTime=e.lastWriteTime,a.mainFile.size=e.size,t.next=25,this.setTaskHashAsync(e,a.mainFile,"文件",n);case 25:if(t.sent){t.next=27;break}return t.abrupt("return");case 27:this.setHashCache(e,a);case 28:return this.setNetDiskFileCache(a.mainFile),t.next=31,this.makeTaskLineViewPack(e);case 31:return t.next=33,this.makeTaskPreViewImage(e,a,r,n);case 33:this.setTaskHash(e,a),t.next=39;break;case 36:t.prev=36,t.t1=t["catch"](0),this.updateTaskDataError(e,t.t1.toString());case 39:return t.prev=39,requestAnimationFrame((function(){o.startUploadTask()})),t.finish(39);case 42:case"end":return t.stop()}}),t,this,[[0,36,39,42]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"setNetDiskFileCache",value:function(){return!0}},{key:"setHashCache",value:function(){return!0}},{key:"makeTaskPreViewImage",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a){var o,s,c,l,u,d,h,f,m,p,v,b,g;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a()){t.next=2;break}return t.abrupt("return");case 2:if(e.needPreviewImage){t.next=4;break}return t.abrupt("return");case 4:if(e.fileType!=V.Lottie||null==e.previewImage){t.next=14;break}return u=e.previewImage,u.lastWriteTime=null!==(c=null===(l=u.file)||void 0===l?void 0:l.lastModified)&&void 0!==c?c:Date.now(),t.next=9,this.setTaskHashAsync(e,u,"文件缩略图",a);case 9:if(t.sent){t.next=11;break}return t.abrupt("return");case 11:return n.setPreviewImage(u,!1),this.setHashCache(e,n),t.abrupt("return");case 14:if(e.previewImage=null,d=e.isSvgFile&&null!==(o=null===r||void 0===r?void 0:r.supportPreviewFileExt)&&void 0!==o&&o,h=null!==(s=null===r||void 0===r?void 0:r.supportXSPFilePreview)&&void 0!==s&&s,f=n.getPreviewImage(d),null!=f&&!f.needResetHash()){t.next=84;break}if(e.ext="正在生成图片缩略图",this.sendStateToWeb(e),m=new Xf,!h||e.fileType!=V.XD){t.next=29;break}return t.next=25,Su.getXDFileImgPreviewAsync(e.file,m);case 25:if(t.sent){t.next=27;break}return t.abrupt("return");case 27:t.next=72;break;case 29:if(!h||e.fileType!=V.Sketch){t.next=36;break}return t.next=32,Su.getSketchFileImgPreviewAsync(e.file,m);case 32:if(t.sent){t.next=34;break}return t.abrupt("return");case 34:t.next=72;break;case 36:if(!h||e.fileType!=V.Figma){t.next=43;break}return t.next=39,Su.getFigmaFileImgPreviewAsync(e.file,m);case 39:if(t.sent){t.next=41;break}return t.abrupt("return");case 41:t.next=72;break;case 43:if(!(e.isSvgFile&&e.size>51200)){t.next=58;break}return t.prev=44,m.previewFileExt=null!==r&&void 0!==r&&r.supportPreviewFileExt?"png":null,t.next=48,gu(e.file,ve,.6,!(null!==r&&void 0!==r&&r.supportPreviewFileExt),!0);case 48:m.file=t.sent,t.next=56;break;case 51:return t.prev=51,t.t0=t["catch"](44),m.file=null,m.previewFileExt=null,t.abrupt("return");case 56:t.next=72;break;case 58:if(!e.isSvgFile&&!e.isIconFile){t.next=62;break}m.file=e.file,t.next=72;break;case 62:return t.prev=62,t.next=65,gu(e.file,ve,.6,!1);case 65:m.file=t.sent,t.next=72;break;case 68:return t.prev=68,t.t1=t["catch"](62),m.file=null,t.abrupt("return");case 72:return e.fileType==V.Image&&(null==m.file||null!=m.file&&m.file.size>e.size)&&(m.previewFileExt=null,m.file=e.file),m.size=null!==(p=null===(v=m.file)||void 0===v?void 0:v.size)&&void 0!==p?p:0,m.lastWriteTime=null!==(b=null===(g=m.file)||void 0===g?void 0:g.lastWriteTime)&&void 0!==b?b:Date.now(),t.next=77,this.setTaskHashAsync(e,m,"文件缩略图",a);case 77:if(t.sent){t.next=79;break}return t.abrupt("return");case 79:n.setPreviewImage(m,d),e.previewImage=m,this.setHashCache(e,n),t.next=85;break;case 84:e.previewImage=f;case 85:case"end":return t.stop()}}),t,this,[[44,51],[62,68]])})));function e(e,n,i,r){return t.apply(this,arguments)}return e}()},{key:"setTaskHashAsync",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n,r,a){var o,s,c=this;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=new jf,t.next=3,o.startAsync(n.file,{needHash:!0,needQuickHash:!0,onprogress:function(t){var n,i=t.index,s=t.length,l=a();l?(e.currentPosition=i,e.currentSize=s,e.ext="计算".concat(r,"hash(").concat(e.currentPercentage,"%)"),c.sendStateToWeb(e)):null===(n=o)||void 0===n||n.cancelAsync()}});case 3:if(s=t.sent,o=null,null!=s){t.next=7;break}return t.abrupt("return",!1);case 7:if(!s.canceled){t.next=9;break}return t.abrupt("return",!1);case 9:if(s.success){t.next=11;break}throw s.errMsg;case 11:return n.quickHash=s.data.quickHash,n.hash=s.data.hash,t.abrupt("return",!0);case 14:case"end":return t.stop()}}),t)})));function e(e,n,i,r){return t.apply(this,arguments)}return e}()},{key:"setTaskHash",value:function(t,e){t.hash!=e.mainFile.hash&&t.quickHash!=e.mainFile.quickHash&&(t.hash=e.mainFile.hash,t.quickHash=e.mainFile.quickHash,t.currentPosition=0,t.guid=null),t.status==tm.PreLoadFileMsg&&(t.ext="文件等待上传中",t.status=tm.Waitting)}},{key:"makeTaskLineViewPack",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.lineViewPack=null;case 1:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"updateTaskDataError",value:function(t,e){t.status=tm.Errored,t.ext=e,this.sendStateToWeb(t)}},{key:"getHashCache",value:function(){return null}},{key:"getCloudNetDiskFileUploaderInfoAsync",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(){var e,n,r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.getCloudNetDiskFileUploaderInfoFromCache(),!((null===e||void 0===e?void 0:e.lineViewVer)>0)){t.next=3;break}return t.abrupt("return",e);case 3:return n=new Gf,n.lineViewVer=-1,this.setCloudNetDiskFileUploaderInfo(n),t.next=8,this.fetchPostCloudApi("netdiskfileuploaderinfobyweb",{body:"",timeout:1e4});case 8:if(r=t.sent,!r.success||null==r.data){t.next=12;break}return this.setCloudNetDiskFileUploaderInfo(r.data),t.abrupt("return",r.data);case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"fetchPostCloudApi",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Wi(e,n);case 2:if(r=t.sent,!ht(r)){t.next=10;break}t.t0=r.code,t.next=t.t0===_.WebUser_NotLogin?7:9;break;case 7:return this.$store.commit("setUserLogout"),t.abrupt("break",9);case 9:return t.abrupt("return",r);case 10:throw null!==r&&void 0!==r?r:"返回值无法解析";case 11:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"setCloudNetDiskFileUploaderInfo",value:function(t){this.cloudNetDiskFileUploaderInfoCache={item1:t,item2:Date.now()}}},{key:"getCloudNetDiskFileUploaderInfoFromCache",value:function(){var t=this.cloudNetDiskFileUploaderInfoCache;if(null!=t){var e=Date.now();if(Math.abs(1e3*(e-t.item2)*60)<5)return t.item1}return null}},{key:"getTaskFileType",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){var n,r,a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=null!==(n=null===(r=e.fileExt)||void 0===r?void 0:r.toLowerCase())&&void 0!==n?n:null,t.t0=a,t.next=".zip"===t.t0?4:".json"===t.t0?6:".js"===t.t0||".css"===t.t0||".txt"===t.t0||".xml"===t.t0||".ini"===t.t0||".config"===t.t0||".md"===t.t0?15:".html"===t.t0||".htm"===t.t0||".mht"===t.t0||".mhtml"===t.t0?17:".ai"===t.t0?19:".aep"===t.t0||".aepx"===t.t0||".aet"===t.t0?21:".eot"===t.t0||".otf"===t.t0||".fon"===t.t0||".font"===t.t0||".ttf"===t.t0||".ttc"===t.t0||".woff"===t.t0?23:".exe"===t.t0||".msi"===t.t0?25:".apk"===t.t0?27:".pkg"===t.t0?29:".dmg"===t.t0?31:".fig"===t.t0?33:".jsd"===t.t0?35:".xlsx"===t.t0||".xls"===t.t0?37:".png"===t.t0||".webp"===t.t0||".jpeg"===t.t0||".jpg"===t.t0||".gif"===t.t0||".bmp"===t.t0||".ico"===t.t0||".icns"===t.t0||".icon"===t.t0||".svg"===t.t0?39:".pdf"===t.t0?41:".psd"===t.t0||".psb"===t.t0?43:".ppt"===t.t0||".pptx"===t.t0?45:".sketch"===t.t0?47:".sketchplugin"===t.t0?49:".url"===t.t0||".webloc"===t.t0?51:".docx"===t.t0||".doc"===t.t0?53:".xd"===t.t0?55:".xdx"===t.t0?57:".rar"===t.t0||".gz"===t.t0||".bz2"===t.t0||".7z"===t.t0||".xz"===t.t0?59:".mp3"===t.t0||".mp4"===t.t0||".avi"===t.t0||".rm"===t.t0||".rmvb"===t.t0||".aac"===t.t0||".wma"===t.t0||".flac"===t.t0||".wav"===t.t0||".m4a"===t.t0||".3gp"===t.t0||".m4v"===t.t0||".mkv"===t.t0||".mov"===t.t0||".webm"===t.t0||".weba"===t.t0?61:".rp"===t.t0?63:65;break;case 4:return e.fileType=V.Zip,t.abrupt("break",67);case 6:return t.next=8,this.isLottieFileAsync(e);case 8:if(!t.sent){t.next=12;break}t.t1=V.Lottie,t.next=13;break;case 12:t.t1=V.Txt;case 13:return e.fileType=t.t1,t.abrupt("break",67);case 15:return e.fileType=V.Txt,t.abrupt("break",67);case 17:return e.fileType=V.Html,t.abrupt("break",67);case 19:return e.fileType=V.AdobeIllustrator,t.abrupt("break",67);case 21:return e.fileType=V.AfterEffects,t.abrupt("break",67);case 23:return e.fileType=V.Font,t.abrupt("break",67);case 25:return e.fileType=V.App,t.abrupt("break",67);case 27:return e.fileType=V.AndroidApp,t.abrupt("break",67);case 29:return e.fileType=V.Package,t.abrupt("break",67);case 31:return e.fileType=V.Dmg,t.abrupt("break",67);case 33:return e.fileType=V.Figma,t.abrupt("break",67);case 35:return e.fileType=V.JsDesign,t.abrupt("break",67);case 37:return e.fileType=V.Excel,t.abrupt("break",67);case 39:return e.fileType=V.Image,t.abrupt("break",67);case 41:return e.fileType=V.Pdf,t.abrupt("break",67);case 43:return e.fileType=V.PhotoShop,t.abrupt("break",67);case 45:return e.fileType=V.PPT,t.abrupt("break",67);case 47:return e.fileType=V.Sketch,t.abrupt("break",67);case 49:return e.fileType=V.SketchPlugin,t.abrupt("break",67);case 51:return e.fileType=V.Url,t.abrupt("break",67);case 53:return e.fileType=V.Word,t.abrupt("break",67);case 55:return e.fileType=V.XD,t.abrupt("break",67);case 57:return e.fileType=V.XDPlugin,t.abrupt("break",67);case 59:return e.fileType=V.Zip,t.abrupt("break",67);case 61:return e.fileType=V.Media,t.abrupt("break",67);case 63:return e.fileType=V.AxureSourceFile,t.abrupt("break",67);case 65:return e.fileType=V.Other,t.abrupt("break",67);case 67:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"isLottieFileAsync",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){var n,r,a,o;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Jf(e);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",!1);case 4:if(n=e.previewImage,!(null!=n&&n.size>0&&n.file)){t.next=7;break}return t.abrupt("return",!0);case 7:return e.previewImage=null,t.prev=8,e.ext="正在检测是否是Lottie文件",this.sendStateToWeb(e),t.next=13,Jl(e.file);case 13:return a=t.sent,o=new Xf,o.file=a,o.size=a.size,o.lastWriteTime=null!==(r=a.lastModified)&&void 0!==r?r:Date.now(),e.previewImage=o,t.abrupt("return",null!=e.previewImage);case 22:return t.prev=22,t.t0=t["catch"](8),e.previewImage=null,t.abrupt("return",!1);case 26:case"end":return t.stop()}}),t,this,[[8,22]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"updateToSql",value:function(t){var e=this;if(null==t||0==t.length)return 0;var n=0;return t.forEach((function(t){t.id>0||(t.id=e._sql_auto_id++,n++)})),n}},{key:"updateTask",value:function(t){var e=this;if(null!=t.ids){var n=this.uploadList,i={};t.ids.forEach((function(t){i[t]=1}));var r=n.filter((function(t){return i[t.id]})),a=r.length;if(0!=a){var o;switch(t.ids=r.map((function(t){return t.id})),i={},t.ids.forEach((function(t){i[t]=1})),t.type){case em.Pause:o=tm.Paused;break;case em.ReStart:case em.Resume:o=tm.Waitting;break;default:return}this.updateStatusToSql(t.ids,o),r.forEach((function(t){t.status=o})),this.sendStateToWeb(r),o==tm.Waitting&&requestAnimationFrame((function(){e.startUploadTask()}))}}}},{key:"updateStatusToSql",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",0);case 1:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"removeTask",value:function(t){var e=this.uploadList;switch(t.type){case em.Remove_Select:if(null==t.ids)return;var n={};t.ids.forEach((function(t){n[t]=1})),t.ids=e.filter((function(t){return n[t.id]})).map((function(t){return t.id}));break;case em.Remove_Completed:t.ids=e.filter((function(t){return t.status==tm.Completed})).map((function(t){return t.id}));break;case em.Remove_All:t.ids=e.map((function(t){return t.id}));break}if(null!=t.ids&&0!=t.ids.length){var i={};t.ids.forEach((function(t){t<1||i[t]||(i[t]=!0)}));for(var r=[],a=[],o=e.length-1;o>=0;o--){var s=e[o];if(i[s.id]){switch(s.status){case tm.Fetching:case tm.Paused:case tm.Errored:s.guid&&r.push(s.guid);break}s.status=tm.RemovedMark,e.splice(o,1),a.push(s.id)}}a.length>0&&this.emit(Kf.UploadRemove,a),r.length>0&&this.sendCancelGuidToCloud(r)}}},{key:"hasRunningTask",value:function(){return null!=this.uploadList.find((function(t){switch(t.status){case tm.Fetching:case tm.Paused:case tm.Errored:case tm.Waitting:case tm.PreLoadFileMsg:return!0}return!1}))}},{key:"sendCancelGuidToCloud",value:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=this,t.next=4,this.enpostdata({guids:e});case 4:return t.t1=t.sent,t.t2={body:t.t1,timeout:1e4},t.next=8,t.t0.fetchPostCloudApi.call(t.t0,"netdiskfilecancelbyweb",t.t2);case 8:t.next=12;break;case 10:t.prev=10,t.t3=t["catch"](0);case 12:case"end":return t.stop()}}),t,this,[[0,10]])})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),Qf=new qf;function Jf(t){return Zf.apply(this,arguments)}function Zf(){return Zf=Object(r["a"])(Object(i["a"])().mark((function t(e){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!=e&&e.isJsonFile){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,Nf("maybeIsLottieFileAsync",e.file);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)}))),Zf.apply(this,arguments)}var tm={Fetching:0,Paused:1,Completed:2,Errored:3,Waitting:4,RemovedMark:5,PreLoadFileMsg:6,CompletedWithExist:7},em={Remove_Select:1,Remove_Completed:2,Remove_All:3,Resume:11,Pause:12,ReStart:13,Add:14},nm=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"ids",void 0),Object(Ht["a"])(this,"folderId",void 0),Object(Ht["a"])(this,"files",void 0),Object(Ht["a"])(this,"type",void 0)}return Object(Ut["a"])(t,null,[{key:"send",value:function(){var e=Object(r["a"])(Object(i["a"])().mark((function e(n){var r,a,o,s,c;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=n.type,a=n.folderId,o=n.ids,s=n.files,c=new t,c.type=r,c.folderId=null!==a&&void 0!==a?a:0,c.ids=null!==o&&void 0!==o?o:null,c.files=null!==s&&void 0!==s?s:null,Qf.runTask(c),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()}]),t}(),im=function(){function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"uploading",!1),Object(Ht["a"])(this,"uploadItems",[]),Object(Ht["a"])(this,"_uploadItemsObj",{})}return Object(Ut["a"])(t,[{key:"length",get:function(){return this.uploadItems.length}},{key:"clear",value:function(){this.uploadItems.splice(0),delete this._uploadItemsObj,this._uploadItemsObj={}}},{key:"add",value:function(t){if(ht(t)&&t.id>0){var e=new rm;Object.keys(e).forEach((function(n){e[n]=t[n]})),this.uploadItems.push(e),this._uploadItemsObj[t.id]=e,this._sort()}}},{key:"update",value:function(t){if(ht(t)&&t.id>0){var e=this._uploadItemsObj[t.id];if(!e)return this.add(t);var n=t.status!==e.status;Object.keys(e).forEach((function(n){e[n]=t[n]})),n&&this._sort()}}},{key:"remove",value:function(t){var e=this._uploadItemsObj[t];if(e){delete this._uploadItemsObj[t];var n=this.uploadItems.findIndex((function(e){return e.id===t}));-1!==n&&this.uploadItems.splice(n,1)}}},{key:"removeCompletedItems",value:function(){var t=this,e=[];this.uploadItems.forEach((function(t,n){switch(t.status){case tm.CompletedWithExist:case tm.Completed:case tm.RemovedMark:e.unshift(n);break}})),e.length>0&&e.forEach((function(e){var n=t.uploadItems.splice(e,1)[0];n&&delete t._uploadItemsObj[n.id]}))}},{key:"_sort",value:function(){var t=function(t,e){var n=t.id-e.id;return 0===n?0:n>0?1:-1};this.uploadItems.sort((function(e,n){return t(e,n)}))}}]),t}(),rm=Object(Ut["a"])((function t(){Object(Bt["a"])(this,t),Object(Ht["a"])(this,"id",0),Object(Ht["a"])(this,"status",tm.Waitting),Object(Ht["a"])(this,"fileName",null),Object(Ht["a"])(this,"fileType",V.Other),Object(Ht["a"])(this,"ext",null),Object(Ht["a"])(this,"currentPercentage",0),Object(Ht["a"])(this,"size",0),Object(Ht["a"])(this,"folderId",0),Object(Ht["a"])(this,"quickHash",""),Object(Ht["a"])(this,"hash","")})),am=function(){var t=this,e=t._self._c;return e("div",{staticClass:"item"},[e("div",{staticClass:"icon-netdiskfile",class:t.fileTypeCls}),e("div",{staticClass:"summary"},[e("div",{staticClass:"item-name"},[e("a",{attrs:{href:"javascript:;",title:t.fileName}},[t._v(t._s(t.fileName))])]),e("div",{staticClass:"item-info"},[e("div",{staticClass:"item-progress"},[t._v(t._s(t.progressStr))]),e("div",{staticClass:"item-state",class:t.statusCss,attrs:{title:t.statusText}},[t.percentageVisible?e("div",{staticClass:"percentage"},[e("p",{style:{width:t.uploadPercentageCssWidth}})]):e("div",{staticClass:"state"},[t._v(t._s(t.statusText))])]),e("div",{staticClass:"btns"},[t.item.status===t.EnumNetDiskFileUploadStatus.Fetching||t.item.status===t.EnumNetDiskFileUploadStatus.PreLoadFileMsg?e("div",{staticClass:"fetching",attrs:{title:"点击暂停"},on:{click:function(e){return t.clickChangeStatus(t.EnumNetDiskFileUploadStatus.Paused)}}}):t.item.status===t.EnumNetDiskFileUploadStatus.Waitting?e("div",{staticClass:"waitting",attrs:{title:"点击暂停"},on:{click:function(e){return t.clickChangeStatus(t.EnumNetDiskFileUploadStatus.Paused)}}}):t.item.status===t.EnumNetDiskFileUploadStatus.Paused?e("div",{staticClass:"paused",attrs:{title:"点击继续上传"},on:{click:function(e){return t.clickChangeStatus(t.EnumNetDiskFileUploadStatus.Waitting)}}}):t.item.status===t.EnumNetDiskFileUploadStatus.Errored?e("div",{staticClass:"download-repeat",attrs:{title:"重新上传"},on:{click:t.clickUploadFile}}):t._e(),e("div",{staticClass:"remove",attrs:{title:"删除该任务"},on:{click:t.clickTaskRemove}})])])])])},om=[],sm={methods:{clickUploadFile:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.item,n){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,nm.send({type:em.ReStart,ids:[n.id]});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](3),t.showTextTip(e.t0);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})))()},clickTaskRemove:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.item,n){e.next=3;break}return e.abrupt("return");case 3:e.t0=n.status,e.next=e.t0===tm.Fetching?6:e.t0===tm.Paused||e.t0===tm.Waitting?8:11;break;case 6:return r="任务[".concat(n.id,"](").concat(t.fileName,")正在上传中,是否确认取消并删除该任务?"),e.abrupt("break",11);case 8:return a=t.uploadPercentage,a>0&&(r="任务[".concat(n.id,"](").concat(t.fileName,")已上传").concat(t.uploadPercentageCssWidth,",是否确认取消并删除该任务?")),e.abrupt("break",11);case 11:if(!r){e.next=16;break}return e.next=14,t.confirm({title:"删除确认",text:r,noText:"我再想想"});case 14:if(e.sent){e.next=16;break}return e.abrupt("return");case 16:return e.prev=16,e.next=19,nm.send({type:em.Remove_Select,ids:[n.id]});case 19:e.next=24;break;case 21:e.prev=21,e.t1=e["catch"](16),t.showTextTip(e.t1);case 24:case"end":return e.stop()}}),e,null,[[16,21]])})))()},clickChangeStatus:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.item,r){n.next=3;break}return n.abrupt("return");case 3:n.t0=t,n.next=n.t0===tm.Waitting?6:n.t0===tm.Paused?15:24;break;case 6:return n.prev=6,n.next=9,nm.send({type:em.Resume,ids:[r.id]});case 9:n.next=14;break;case 11:n.prev=11,n.t1=n["catch"](6),e.showTextTip(n.t1);case 14:return n.abrupt("break",24);case 15:return n.prev=15,n.next=18,nm.send({type:em.Pause,ids:[r.id]});case 18:n.next=23;break;case 20:n.prev=20,n.t2=n["catch"](15),e.showTextTip(n.t2);case 23:return n.abrupt("break",24);case 24:case"end":return n.stop()}}),n,null,[[6,11],[15,20]])})))()}},computed:{percentageVisible:function(){var t=this.item;return t.status===tm.Paused||t.status===tm.Fetching},fileTypeCls:function(){return V.getName(this.item.fileType,R.Normal)},fileName:function(){var t=this.item.fileName;return null!==t&&void 0!==t?t:""},progressStr:function(){return this.sizeStr},sizeStr:function(){return Sn(this.item.size)},statusCss:function(){var t=[],e=this.status;return e===tm.Errored&&t.push("error"),e!==tm.Completed&&e!==tm.CompletedWithExist||t.push("completed"),t},statusTitle:function(){return this.item.status===tm.Errored?this.statusText:null},statusText:function(){var t=this.item;if(!t)return"";switch(t.status){case tm.Errored:var e;return null!==(e=t.ext)&&void 0!==e?e:"文件上传失败了";case tm.PreLoadFileMsg:return t.ext;case tm.Fetching:return"文件上传中(".concat(this.uploadPercentageCssWidth,")");case tm.Paused:return"已暂停上传(".concat(this.uploadPercentageCssWidth,")");case tm.CompletedWithExist:var n;return null!==(n=t.ext)&&void 0!==n?n:"文件已存在,无需更新";case tm.Completed:var i;return null!==(i=t.ext)&&void 0!==i?i:"文件上传成功";case tm.Waitting:return"文件等待上传中"}return""},uploadPercentageCssWidth:function(){return this.uploadPercentage.toFixed(2)+"%"},uploadPercentage:function(){var t=this.item;return t?t.currentPercentage:0},status:function(){var t,e;return null!==(t=null===(e=this.item)||void 0===e?void 0:e.status)&&void 0!==t?t:tm.RemovedMark}},props:{item:Object},data:function(){return{EnumNetDiskFileUploadStatus:tm}}},cm=sm,lm=(n("5b47"),Object(wo["a"])(cm,am,om,!1,null,"49c96503",null)),um=lm.exports,dm={components:{FileUploadItem:um},methods:{onNetDiskFileUploadInit:function(t){if(ut(t)){var e=this.uploadData;e.clear(),t.forEach((function(t){!ht(t)||t.id<1||e.update(t)}))}},onNetDiskFileUploadRemove:function(t){var e,n=this;e=ut(t)?t:[t],e.forEach((function(t){if(t>0){var e=n.uploadData;e&&e.remove(t)}}))},onNetDiskFileUploadUpdate:function(t){var e,n=this;e=ut(t)?t:[t],e.forEach((function(t){if(ht(t)&&!(t.id<1)){var e=n.uploadData;e.update(t)}})),this.onNetDiskFileUploadUpdate2(t)},onNetDiskFileUploadUpdate2:function(t){if(ht(t)){var e=this.maxShowLength,n=this.uploadItems;if(!(n.length<=e)){var i=n.find((function(t){return t.status===tm.Fetching}));if(i&&i.id!==t.id);else{var r=n.findIndex((function(e){return e.id===t.id}));if(-1===r)return;var a=(r-1)*this.itemHeight;this.scrollTo(a)}}}},sendImportData:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c,l,u,d,h;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.cloudSubFiles,a={},o={},t.forEach((function(t){var e=t.name;a[e.toLowerCase()]=1})),r.forEach((function(t){if(t){var e=t.fileName+t.fileExt,n=e.toLowerCase();a[n]&&(delete a[n],o[e]=1)}})),n.prev=5,s=Object.keys(a),!(s.length>0)){n.next=12;break}return n.next=10,e.fetchPostCloudApi("netdiskfilecheckexistsbyweb",{timeout:1e4,body:{folderId:e.cloudCurrentFolderId,fileNames:s}});case 10:c=n.sent,c.success&&(c=c.data,ut(c)&&c.forEach((function(t){o[t.fileName+t.fileExt]=1})));case 12:if(o=Object.keys(o),l={},o.forEach((function(t){l[t.toLowerCase()]=1})),u=o.length,!(u>0)){n.next=29;break}return d=8,h=u>d,h&&o.splice(d),n.next=22,e.confirm({title:"覆盖提示",text:"当前目录已存在[".concat(o.join("、")).concat(h?"、...]等".concat(u,"个"):"]","同名文件,是否").concat(u>1?"全部":"","覆盖?"),noText:1===u?"跳过":"跳过重复文件",yesText:"覆盖",showCancel:!0});case 22:n.t0=n.sent,n.next=!0===n.t0?25:!1===n.t0?26:"cancel"===n.t0?28:29;break;case 25:return n.abrupt("break",29);case 26:return t=t.filter((function(t){var e;return!l[null===(e=t.name)||void 0===e?void 0:e.toLowerCase()]})),n.abrupt("break",29);case 28:return n.abrupt("return");case 29:return n.next=31,nm.send({files:t,folderId:e.cloudCurrentFolderId,type:em.Add});case 31:n.next=37;break;case 33:n.prev=33,n.t1=n["catch"](5),e.showTextTip(n.t1);case 37:case"end":return n.stop()}}),n,null,[[5,33]])})))()},showOpenFileDialog:function(){return Object(r["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},clickAddFiles:function(t){var e;null===(e=t.target)||void 0===e||null===(e=e.querySelector("input[type=file]"))||void 0===e||e.click()},onInputFileChange:function(t){var e=t.target,n=e.files;if(0!==n.length){n=Object(Gn["a"])(n);try{e.value=""}catch(i){}this.sendImportData(n)}},clickRemoveCompleted:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nm.send({type:em.Remove_Completed});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),t.showTextTip(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()},clickRemoveAll:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.uploadItemsLength){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.confirm({title:"删除确认",text:"将删除列表中所有的上传任务",noText:"我再想想"});case 4:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,e.next=9,nm.send({type:em.Remove_All});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](6),t.showTextTip(e.t0);case 14:case"end":return e.stop()}}),e,null,[[6,11]])})))()},clickCloseBox:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!Qf.hasRunningTask()){e.next=8;break}return e.next=3,t.confirm({text:"文件正在上传中，关闭上传对话框将清理所有待上传的文件,是否确认？"});case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:Qf.runTask({type:em.Remove_All}),e.next=9;break;case 8:Qf.runTask({type:em.Remove_Completed});case 9:n=t.filebox,n.visible=!1;case 11:case"end":return e.stop()}}),e)})))()},onBoxScroll:function(t){this.scrollTop=t.target.scrollTop},resetBox:function(){if(this.visible){var t=this.$refs.files;t&&this.onBoxScroll({target:t})}},add:function(t){var e;null===(e=this.uploadData)||void 0===e||e.add(t),this.scrollToBottom()},scrollToTop:function(){this.scrollTo(0)},scrollToBottom:function(){this.scrollTo(1e5)},scrollTo:function(t){var e=this;this.$nextTick((function(){var n=e.$refs.files;n&&(n.scrollTop=t)}))},bingDragEvent:function(t){var e=this,n=document.documentElement;t?(n.addEventListener("dragover",this.dragover),n.addEventListener("drop",this.dragdrop),Qf.on(Kf.TextTip,(function(t){e.showTextTip(t)})),Qf.on(Kf.UploadUpdate,(function(t){e.onNetDiskFileUploadUpdate(t)})),Qf.on(Kf.UploadRemove,(function(t){e.onNetDiskFileUploadRemove(t)})),Qf.on(Kf.WebUserNotLogin,(function(){e.$store.commit("setUserLogout")})),Qf.on(Kf.WebFileChanged,(function(t){e.$emit("onFileChanged",{files:[t.data],folderUpdateTimes:t.folderUpdateTimes})})),window.addEventListener("beforeunload",this.onBeforeunload)):(n.removeEventListener("dragover",this.dragover),n.removeEventListener("drop",this.dragdrop),Qf.off(Kf.TextTip),Qf.off(Kf.UploadUpdate),Qf.off(Kf.UploadRemove),Qf.off(Kf.WebUserNotLogin),Qf.off(Kf.WebFileChanged),window.removeEventListener("beforeunload",this.onBeforeunload))},onBeforeunload:function(t){if(Qf.hasRunningTask()){t.preventDefault();var e="文件正在上传中，您确定要离开当前页面？";return t.returnValue=e,e}},dragover:function(t){t.preventDefault(),t.dataTransfer.dropEffect="copy";var e=this.dropTip;e.dragging||(e.dragging=!0,e.visible=!0,cancelAnimationFrame(e.handler)),clearTimeout(e.handler2),e.handler2=setTimeout((function(){e.dragging=!1,e.visible=!1}),200)},dragdrop:function(t){t.preventDefault();var e=this.dropTip;e.dragging=!1,cancelAnimationFrame(e.handler),clearTimeout(e.handler2),e.handler=requestAnimationFrame((function(){e.visible=!1})),this.onDrag(t)},onDrag:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c,l,u;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.dataTransfer.items,r&&!(r.length<1)){n.next=3;break}return n.abrupt("return");case 3:a=[],o=[],s=0;case 6:if(!(s<r.length)){n.next=19;break}return c=r[s],n.next=10,e.isDropItemFile(c);case 10:if(!n.sent){n.next=14;break}a.push(c.getAsFile()),n.next=16;break;case 14:u=null===(l=c.getAsFile())||void 0===l?void 0:l.name,u&&o.push(u);case 16:s++,n.next=6;break;case 19:if(!(o.length>0)){n.next=22;break}return n.next=22,e.alert({text:"不能直接上传文件夹[".concat(o.join("、"),"],如需上传请先打包,")});case 22:if(!(a.length<1)){n.next=24;break}return n.abrupt("return");case 24:e.sendImportData(a);case 25:case"end":return n.stop()}}),n)})))()},isDropItemFile:function(t){return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("file"===t.kind){e.next=2;break}return e.abrupt("return",!1);case 2:if(!dt(t.type)){e.next=4;break}return e.abrupt("return",!0);case 4:if("function"!==typeof t.webkitGetAsEntry){e.next=7;break}return n=t.webkitGetAsEntry(),e.abrupt("return",n.isFile);case 7:if(e.prev=7,r=t.getAsFile(),r){e.next=11;break}return e.abrupt("return",!1);case 11:if(a=r.size,0!==a){e.next=14;break}return e.abrupt("return",!1);case 14:return e.next=16,new Promise((function(t){var e=new FileReader;e.addEventListener("load",(function(){t(!0)}),!1),e.addEventListener("error",(function(){t(!1)}),!1),e.readAsDataURL(r.slice(0,Math.min(5,a)))}));case 16:return e.abrupt("return",e.sent);case 19:return e.prev=19,e.t0=e["catch"](7),e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e,null,[[7,19]])})))()}},computed:{uploading:function(){return this.uploadingCount>0},uploadingCount:function(){return this.uploadItems.filter((function(t){switch(t.status){case tm.PreLoadFileMsg:case tm.Fetching:case tm.Waitting:return!0;default:return!1}})).length},dragTitle:function(){var t=this.uploadItems;if(!t)return"-";if(this.uploading)return"".concat(this.uploadingCount,"个文件上传中，拖拽文件到此处可继续添加");var e=t.length;return e>0?"已添加".concat(e,"个文件，拖拽文件到此处可继续添加"):"拖拽文件到此处上传到当前文件夹"},visible:function(){return this.filebox.visible&&null!=this.uploadData},hasFile:function(){var t=this.uploadItems;return!!t&&t.length>0},uploadData:function(){var t=this.cloudKey;if(!t)return null;var e=this.uploadDatas[t];return e||(e=new im,this.$set(this.uploadDatas,t,e)),e},uploadItems:function(){var t=this.uploadData;return t?t.uploadItems:[]},renderList:function(){var t=this.uploadItems,e=this.renderListStart;return t.slice(e,e+this.renderListCount)},renderListCssPaddingTop:function(){return this.renderListStart*this.itemHeight},renderListStart:function(){var t=Math.floor(this.scrollTop/this.itemHeight);return t},renderListCount:function(){var t=Math.ceil((this.boxHeight+this.scrollTop%this.itemHeight)/this.itemHeight);return t=Math.min(t,this.uploadItems.length-this.renderListStart),t},boxHeight:function(){var t=this.maxShowLength,e=this.uploadItems,n=this.itemHeight,i=e.length;return i>t&&(i=t),n*i},boxRealHeight:function(){var t=this.uploadItems,e=this.itemHeight;return t.length*e},uploadDatas:function(){return this.$store.state.netdiskFileUploadDatas},uploadItemsLength:function(){return this.uploadItems.length}},watch:{uploadItemsLength:function(t,e){t>e&&this.scrollToBottom()},hasFile:function(){var t=this;this.$nextTick((function(){t.resetBox()}))},visible:function(t){var e,n=this;(this.bingDragEvent(t),t)&&(null===(e=this.uploadData)||void 0===e||e.removeCompletedItems());this.$nextTick((function(){n.resetBox()}))},scrollTop:function(){var t=this;this.scrolling=!0,clearTimeout(this.handle_scrolling),this.handle_scrolling=setTimeout((function(){t.scrolling=!1}),120)}},data:function(){return{itemHeight:50,maxShowLength:3,scrollTop:0,handle_scrolling:0,scrolling:!1,dropTip:{visible:!1,handler:null,handler2:null,dragging:!1}}},props:{filebox:Object},beforeDestroy:function(){clearTimeout(this.handle_scrolling),this.bingDragEvent(!1)},created:function(){this.bingDragEvent(this.visible),this.onNetDiskFileUploadInit(Qf.uploadList)}},hm=dm,fm=(n("c192"),Object(wo["a"])(hm,If,Ff,!1,null,"f2b4b072",null)),mm=fm.exports,pm={components:{LinkEdit:Af,FileUpload:mm},methods:{onFileChanged:function(t){this.$store.commit("setFolderSubFile",t)},clickBeforeCheck:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.cloudVersion,a=e.cloudCurrentFolderId,o=e.cloudIsLogin,s=e.userFolderSpecifyMemberAuthority,!vt(r)){n.next=4;break}return e.showTextTip("无法在Web端使用本功能,私有云版本过低(".concat(r,"),请先升级私有云部署包")),n.abrupt("return");case 4:if(a>0){n.next=7;break}return e.showTextTip("不能".concat(t,"到根目录,请进入子文件夹操作")),n.abrupt("return");case 7:if(o){n.next=13;break}return n.next=10,e.confirm({text:"需要登录才能".concat(t),yesText:"前往登录"});case 10:if(!n.sent){n.next=12;break}e.goCloudLogin();case 12:return n.abrupt("return");case 13:n.t0=s,n.next=n.t0===X.Admin||n.t0===X.ParentOwner||n.t0===X.Owner||n.t0===X.ReadWrite?16:17;break;case 16:return n.abrupt("return",!0);case 17:return e.showTextTip("您没有在当前文件夹下".concat(t,"的权限")),n.abrupt("return",!1);case 19:case"end":return n.stop()}}),n)})))()},clickOpenNetDiskUploadBox:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.clickBeforeCheck("上传文件");case 2:if(e.sent){e.next=4;break}return e.abrupt("return");case 4:n=t.filebox,r=t.cloudCurrentFolderId,n.parentId=r,n.visible=!0;case 7:case"end":return e.stop()}}),e)})))()},clickAddNetDiskLink:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.clickBeforeCheck("添加链接");case 2:if(e.sent){e.next=4;break}return e.abrupt("return");case 4:n=t.linkbox,r=t.cloudCurrentFolderId,n.data={id:0,link:"",name:"",parentId:r},n.visible=!0;case 7:case"end":return e.stop()}}),e)})))()}},computed:{cannotUseNetDisk:function(){var t=this.cloudVersion,e=this.cloudCurrentFolderId;return!!vt(t)||!(e>0)},netdiskUploader:function(){return this.$store.state.netdiskUploader},linkbox:function(){return this.netdiskUploader.linkbox},filebox:function(){return this.netdiskUploader.filebox}}},vm=pm,bm=(n("f7cf"),Object(wo["a"])(vm,ff,mf,!1,null,"26518ea2",null)),gm=bm.exports,wm=function(){var t=this,e=t._self._c;return t.supportInteraction?e("div",{staticClass:"go-interaction-viewer"},[t.inCloudViewerMode?e("div",{staticClass:"btn-go-interaction",attrs:{title:"在新窗口预览原型"},on:{click:t.clickGoWebInteraction}}):t._e(),e("div",{staticClass:"btn-go-interaction-mobile",class:{on:t.menuVisible},attrs:{title:"在手机上预览原型"},on:{click:t.clickShowMenu}}),t.menuVisible?e("div",{staticClass:"box",class:{"fix-right":t.fixRight}},[e("div",{staticClass:"img"},[e("div",{staticClass:"bor-top"}),e("div",{staticClass:"bor-bottom"}),t.qrcodeImage?e("img",{attrs:{src:t.qrcodeImage}}):t._e()]),e("div",{staticClass:"text"},[t._v(" 使用"),e("a",{attrs:{href:"https://www.marklion.cn/mobileapp.shtml?invoke=MarkLion.Output&ver=".concat(t.cloudVersion),target:"_blank"}},[t._v("标记狮APP")]),t._v("扫描二维码预览 "),e("div",{staticClass:"btn-question",attrs:{title:"了解更多"},on:{click:t.clickInteractionViewLink}})])]):t._e()]):t._e()},xm=[],ym=function(){function t(t){this.mode=n.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,i=this.data.length;e<i;e++){var r=[],a=this.data.charCodeAt(e);a>65536?(r[0]=240|(1835008&a)>>>18,r[1]=128|(258048&a)>>>12,r[2]=128|(4032&a)>>>6,r[3]=128|63&a):a>2048?(r[0]=224|(61440&a)>>>12,r[1]=128|(4032&a)>>>6,r[2]=128|63&a):a>128?(r[0]=192|(1984&a)>>>6,r[1]=128|63&a):r[0]=a,this.parsedData.push(r)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function e(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}t.prototype={getLength:function(){return this.parsedData.length},write:function(t){for(var e=0,n=this.parsedData.length;e<n;e++)t.put(this.parsedData[e],8)}},e.prototype={addData:function(e){var n=new t(e);this.dataList.push(n),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++)this.modules[i][r]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,n),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(this.modules[t+n][e+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},getBestMaskPattern:function(){for(var t=0,e=0,n=0;n<8;n++){this.makeImpl(!0,n);var i=a.getLostPoint(this);(0==n||t>i)&&(t=i,e=n)}return e},createMovieClip:function(t,e,n){var i=t.createEmptyMovieClip(e,n),r=1;this.make();for(var a=0;a<this.modules.length;a++)for(var o=a*r,s=0;s<this.modules[a].length;s++){var c=s*r,l=this.modules[a][s];l&&(i.beginFill(0,100),i.moveTo(c,o),i.lineTo(c+r,o),i.lineTo(c+r,o+r),i.lineTo(c,o+r),i.endFill())}return i},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=a.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var i=t[e],r=t[n];if(null==this.modules[i][r])for(var o=-2;o<=2;o++)for(var s=-2;s<=2;s++)this.modules[i+o][r+s]=-2==o||2==o||-2==s||2==s||0==o&&0==s}},setupTypeNumber:function(t){for(var e=a.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var i=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(var r=0;r<18;r++){var o=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o}},setupTypeInfo:function(t,e){for(var n=this.errorCorrectLevel<<3|e,i=a.getBCHTypeInfo(n),r=0;r<15;r++){var o=!t&&1==(i>>r&1);r<6?this.modules[r][8]=o:r<8?this.modules[r+1][8]=o:this.modules[this.moduleCount-15+r][8]=o}for(var s=0;s<15;s++){var c=!t&&1==(i>>s&1);s<8?this.modules[8][this.moduleCount-s-1]=c:s<9?this.modules[8][15-s-1+1]=c:this.modules[8][15-s-1]=c}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var n=-1,i=this.moduleCount-1,r=7,o=0,s=this.moduleCount-1;s>0;s-=2){6==s&&s--;while(1){for(var c=0;c<2;c++)if(null==this.modules[i][s-c]){var l=!1;o<t.length&&(l=1==(t[o]>>>r&1));var u=a.getMask(e,i,s-c);u&&(l=!l),this.modules[i][s-c]=l,r--,-1==r&&(o++,r=7)}if(i+=n,i<0||this.moduleCount<=i){i-=n,n=-n;break}}}}},e.PAD0=236,e.PAD1=17,e.createData=function(t,n,i){for(var r=d.getRSBlocks(t,n),o=new h,s=0;s<i.length;s++){var c=i[s];o.put(c.mode,4),o.put(c.getLength(),a.getLengthInBits(c.mode,t)),c.write(o)}for(var l=0,u=0;u<r.length;u++)l+=r[u].dataCount;if(o.getLengthInBits()>8*l)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+8*l+")");o.getLengthInBits()+4<=8*l&&o.put(0,4);while(o.getLengthInBits()%8!=0)o.putBit(!1);while(1){if(o.getLengthInBits()>=8*l)break;if(o.put(e.PAD0,8),o.getLengthInBits()>=8*l)break;o.put(e.PAD1,8)}return e.createBytes(o,r)},e.createBytes=function(t,e){for(var n=0,i=0,r=0,o=new Array(e.length),s=new Array(e.length),c=0;c<e.length;c++){var l=e[c].dataCount,d=e[c].totalCount-l;i=Math.max(i,l),r=Math.max(r,d),o[c]=new Array(l);for(var h=0;h<o[c].length;h++)o[c][h]=255&t.buffer[h+n];n+=l;var f=a.getErrorCorrectPolynomial(d),m=new u(o[c],f.getLength()-1),p=m.mod(f);s[c]=new Array(f.getLength()-1);for(var v=0;v<s[c].length;v++){var b=v+p.getLength()-s[c].length;s[c][v]=b>=0?p.get(b):0}}for(var g=0,w=0;w<e.length;w++)g+=e[w].totalCount;for(var x=new Array(g),y=0,k=0;k<i;k++)for(var C=0;C<e.length;C++)k<o[C].length&&(x[y++]=o[C][k]);for(var S=0;S<r;S++)for(var T=0;T<e.length;T++)S<s[T].length&&(x[y++]=s[T][S]);return x};for(var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},i={L:1,M:0,Q:3,H:2},r={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},a={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){var e=t<<10;while(a.getBCHDigit(e)-a.getBCHDigit(a.G15)>=0)e^=a.G15<<a.getBCHDigit(e)-a.getBCHDigit(a.G15);return(t<<10|e)^a.G15_MASK},getBCHTypeNumber:function(t){var e=t<<12;while(a.getBCHDigit(e)-a.getBCHDigit(a.G18)>=0)e^=a.G18<<a.getBCHDigit(e)-a.getBCHDigit(a.G18);return t<<12|e},getBCHDigit:function(t){var e=0;while(0!=t)e++,t>>>=1;return e},getPatternPosition:function(t){return a.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case r.PATTERN000:return(e+n)%2==0;case r.PATTERN001:return e%2==0;case r.PATTERN010:return n%3==0;case r.PATTERN011:return(e+n)%3==0;case r.PATTERN100:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case r.PATTERN101:return e*n%2+e*n%3==0;case r.PATTERN110:return(e*n%2+e*n%3)%2==0;case r.PATTERN111:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new u([1],0),n=0;n<t;n++)e=e.multiply(new u([1,o.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:return 8;case n.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,i=0;i<e;i++)for(var r=0;r<e;r++){for(var a=0,o=t.isDark(i,r),s=-1;s<=1;s++)if(!(i+s<0||e<=i+s))for(var c=-1;c<=1;c++)r+c<0||e<=r+c||0==s&&0==c||o==t.isDark(i+s,r+c)&&a++;a>5&&(n+=3+a-5)}for(var l=0;l<e-1;l++)for(var u=0;u<e-1;u++){var d=0;t.isDark(l,u)&&d++,t.isDark(l+1,u)&&d++,t.isDark(l,u+1)&&d++,t.isDark(l+1,u+1)&&d++,0!=d&&4!=d||(n+=3)}for(var h=0;h<e;h++)for(var f=0;f<e-6;f++)t.isDark(h,f)&&!t.isDark(h,f+1)&&t.isDark(h,f+2)&&t.isDark(h,f+3)&&t.isDark(h,f+4)&&!t.isDark(h,f+5)&&t.isDark(h,f+6)&&(n+=40);for(var m=0;m<e;m++)for(var p=0;p<e-6;p++)t.isDark(p,m)&&!t.isDark(p+1,m)&&t.isDark(p+2,m)&&t.isDark(p+3,m)&&t.isDark(p+4,m)&&!t.isDark(p+5,m)&&t.isDark(p+6,m)&&(n+=40);for(var v=0,b=0;b<e;b++)for(var g=0;g<e;g++)t.isDark(g,b)&&v++;var w=Math.abs(100*v/e/e-50)/5;return n+=10*w,n}},o={glog:function(t){if(t<1)throw new Error("glog("+t+")");return o.LOG_TABLE[t]},gexp:function(t){while(t<0)t+=255;while(t>=256)t-=255;return o.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},s=0;s<8;s++)o.EXP_TABLE[s]=1<<s;for(var c=8;c<256;c++)o.EXP_TABLE[c]=o.EXP_TABLE[c-4]^o.EXP_TABLE[c-5]^o.EXP_TABLE[c-6]^o.EXP_TABLE[c-8];for(var l=0;l<255;l++)o.LOG_TABLE[o.EXP_TABLE[l]]=l;function u(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);var n=0;while(n<t.length&&0==t[n])n++;this.num=new Array(t.length-n+e);for(var i=0;i<t.length-n;i++)this.num[i]=t[i+n]}function d(t,e){this.totalCount=t,this.dataCount=e}function h(){this.buffer=[],this.length=0}u.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var i=0;i<t.getLength();i++)e[n+i]^=o.gexp(o.glog(this.get(n))+o.glog(t.get(i)));return new u(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=o.glog(this.get(0))-o.glog(t.get(0)),n=new Array(this.getLength()),i=0;i<this.getLength();i++)n[i]=this.get(i);for(var r=0;r<t.getLength();r++)n[r]^=o.gexp(o.glog(t.get(r))+e);return new u(n,0).mod(t)}},d.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],d.getRSBlocks=function(t,e){var n=d.getRsBlockTable(t,e);if(void 0==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var i=n.length/3,r=[],a=0;a<i;a++)for(var o=n[3*a+0],s=n[3*a+1],c=n[3*a+2],l=0;l<o;l++)r.push(new d(s,c));return r},d.getRsBlockTable=function(t,e){switch(e){case i.L:return d.RS_BLOCK_TABLE[4*(t-1)+0];case i.M:return d.RS_BLOCK_TABLE[4*(t-1)+1];case i.Q:return d.RS_BLOCK_TABLE[4*(t-1)+2];case i.H:return d.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},h.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var f=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function m(){var t=!1,e=navigator.userAgent;if(/android/i.test(e)){t=!0;var n=e.toString().match(/android ([0-9](?:\.[0-9])?)/i);n&&n[1]&&(t=parseFloat(n[1]))}return t}var p=function(){function t(){return this._elCanvas.toDataURL("image/png")}if(this._android&&this._android<=2.1){var e=1/window.devicePixelRatio,n=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(t,i,r,a,o,s,c,l){if("nodeName"in t&&/img/i.test(t.nodeName))for(var u=arguments.length-1;u>=1;u--)arguments[u]=arguments[u]*e;else"undefined"==typeof l&&(arguments[1]*=e,arguments[2]*=e,arguments[3]*=e,arguments[4]*=e);n.apply(this,arguments)}}var i=function(t){this._bIsPainted=!1,this._android=m(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._bSupportDataURI=null};return i.prototype.draw=function(t){var e=this._oContext,n=this._htOption,i=3,r=t.getModuleCount(),a=(n.width-2*i)/r,o=(n.height-2*i)/r,s=Math.round(a),c=Math.round(o);this.clear(),e.fillStyle=n.colorLight,e.fillRect(0,0,n.width,i),e.fillRect(0,n.height-i,n.width,i),e.fillRect(0,0,i,n.height),e.fillRect(n.width-i,0,i,n.height);for(var l=0;l<r;l++)for(var u=0;u<r;u++){var d=t.isDark(l,u),h=u*a+i,f=l*o+i;e.strokeStyle=d?n.colorDark:n.colorLight,e.lineWidth=1,e.fillStyle=d?n.colorDark:n.colorLight,e.fillRect(h,f,a,o),e.strokeRect(Math.floor(h)+.5,Math.floor(f)+.5,s,c),e.strokeRect(Math.ceil(h)-.5,Math.ceil(f)-.5,s,c)}var m=n.icon;if(m&&m.complete){var p=m.naturalWidth||m.width,v=p,b=.1578*n.width,g=b;e.drawImage(m,0,0,p,v,(n.width-b)/2,(n.height-g)/2,b,g)}this._bIsPainted=!0},i.prototype.makeImage=function(){if(this._bIsPainted)return t.call(this)},i.prototype.isPainted=function(){return this._bIsPainted},i.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},i.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},i}.call(window);function v(t,e){for(var n=1,r=b(t),a=0,o=f.length;a<=o;a++){var s=0;switch(e){case i.L:s=f[a][0];break;case i.M:s=f[a][1];break;case i.Q:s=f[a][2];break;case i.H:s=f[a][3];break}if(r<=s)break;n++}if(n>f.length)throw new Error("Too long data");return n}function b(t){var e=encodeURI(t).toString().replace(/%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)}var g=function(t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:i.H,icon:null},"string"===typeof t&&(t={text:t}),t)for(var e in t)this._htOption[e]=t[e];this._android=m(),this._oQRCode=null,this._oDrawing=new p(this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)};return g.prototype.makeCode=function(t){this._oQRCode=new e(v(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._oDrawing.draw(this._oQRCode);var n=this.makeImage();return this._oDrawing.clear(),n},g.prototype.makeImage=function(){if("function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3))return this._oDrawing.makeImage()},g.prototype.clear=function(){this._oDrawing.clear()},g.CorrectLevel=i,g}(),km=new ym({width:332,height:332,colorDark:"#000000",colorLight:"#ffffff",correctLevel:ym.CorrectLevel.Q}),Cm=function(t){try{return km.makeCode(t)}catch(e){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAMFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABaPxwLAAAAD3RSTlMAu0R3Ee4iZjPdmcxViKrphPWWAAARlUlEQVR42u2dZ4gzRRjHx9ya5M6cd2svaNa1F0y82FtiBRW7WEDJ2kAseFYQ0Yv9g6gnCoIIsQsiREVB8ENEsYLeiVhRFAvipzN3xpic+nd2Zqdsibcppyj5w5tstsz+duaZ2WfmmbmXjDTSSCONNNJII43Uu0rk39Lr/Ou6Zyok/TSJq8T95iZDAqg9YLlfRbQz9T9CRw25EQAAvh8SQBnstlk8mAKc0JNi1XRVbog96f3ZF2CRoSgNLPIEZynEo3znuPlRwZU5n4AnmTlj+NEZJsAkmiX2pG1CcljmO6fg6WcJsEI8TdDtfgDStq2VrG0Lqx9Hiz9Xy91e6QZAD8sLkO8HYAPoUpffh3n3ayP3a+x0JwiQvHo3fvUy8XQlzbJhAtQwyznoYxklUc52ZQyrNNfcZ2V8CqBIs2mIAEa54XG8YHJtLoq6Q5Sm8LPYrOOMYQKk6KNlLGJASdpGJEASyEuAhG3bVj9GmJRGOI5pskHj+jEoCdv4lZ+6k/uZw/OyFvpFrx9Ic7Dovf44Bg3T3BoNVQRFzIsbViiAvM/40ACUCdTwTdHN4jH3QxX1ogfQZjiPCuLhAmxMTSCJ5tFlCaCK2vEAVhiAqA9Vz1rBvrcdFKBGr59EawIBALrdEBstdl5e/GyWhvguoAVcBTB/XwhgXFT8MbaRFbe7mGbIEAEMr0rWQwBzmHYri+MB1GEJ03hwmABkCVSNSTRkLajneVF7aBTgF3a7kvfqwuxQAW78aDfaFI3hEUjl9drukAmWLYDImAYZKgDVcbSGzb0eALhPNkobuABpNHmR7YPfhg5QpI+ZSWDZtvdwP3Z10zXqLP0iA6BtYEI++FH5YQMY5Y7rj/iNcAIKwLXGFAW4oEKkhusR/RoGqKEsAYJNXqJhbkO9NeAJ6rKZpw8MkEM+BGAAC2GAvAcAXSsDl0C1WYrIgT+mBMDUOgNsTJMIAyy8JAE22L7AVFwfAGMJp+16eNZKyIZoW/c+4xUBIDUlWqDkAfZuwghte2ZAgIvBpD+WC5AkEQDW8GuBMLFGEICEAe5bH4AUXP1JAVYKhX3cj4NnowFy6wOQxP0fzVh+I/QAZmy7BrLjoTZVYYYCrE9D9Jr7EQnARIrC2BdABgG48GrbVk/A/OkdeWHHBSgOBpBDSLoHuuO/CpB+P9vQAXQjLO14tU31xgxZWieAC954zH1AHcBSANpNsuyFfEkY4AKnbwDp+FCAAFgYAAygCKyamltedRuOAYzQAFPz20gAXWkBEFZ+UKe08aVD1gTYGH+sCwB1Mme8/k9BiDkeJ+sAk08cVkVrXQAufk50P34OlFnB0VsJqjNYfS3Y9F2odAFtJQdqEQ2iAXRXDW5/YD218d8DLACbkHXVpPm3ndwNt9+fjDTSSCONNNL/Q3eSf1lfY5U6IfvGDTEUrq5EOTGW7Fu3Oz0Pyf1Okk+p+Oitu+gJ2ztpP7gn9hrFIAFdd6YEwK89A/xMr4Klfvu0rHrNjxExPLnRQ/649mX4UwH83AdAEni+C8Av8v415EVnJBcYB5qg+dI3QM69ooiW+h3dXTXqOFsAZPGK3wRY2Cxrmt8VDnKd+Q/NrVd6AzgGHfW7YUrVtee5A6slDpBgW1TasYaLpalHgImO4/vt/yEDI7McYCOcEY5y5PsAUOG/pEPWBCBb7+sVQRGhqlinxnKNbTvcBhIxxuqmTDq866rIemD7mOZpfwdQoONCbFgAq7Zd7tAR9ELBl4+NSo9GOIWglv8OABHy1QPLbY0UwAXxw7ZhAF2xAFR38VRzc9eGy8DQAZpmQOUIAKk4ACLpSXbnhL3X/pEAv8nBkICyA+fAzyoI6Em1A0pbGWsAeGV/e482oAAyQYCAGb8tABJE6ciSBpBQRaXSjQ+QYG3Gvl0BfrA4gN9qSBjgWH+6F8UFMFyAZHP/LgBptK04ANOu8bxgchsws9SmYwAo+8oA30cD3A04kQAfmpLxu0KRAyjFBUjbr5HsKmvLZyVAx5GjPTvuA/6asncTyJE1YKoPAFnPa3B/NdSUnIA8Z2dNgAtt29LGHPePC8BeLSfjt64t1GxMgB6lABYwS//Ny1r9FHzahKwXwM+sGXye5vmjtBgW1aFbC1SH2q4s/QrVQpWjAY4wpaZjAfAo8IZ43iijEp5Jmb7a6vb2iAaYCnty3TWOeQ5A//2S8re0uRdMHjrFuWonBdVUGhiAXuIBjKG1AVr+Y7+JCVJdm49ogGl1VnyANP7M4ZQokwKs9QM4mZ28kTsZqYqsqGtOFIATH+BFm2nPGAA5fMMuybOuSFv2Sk5lLfmpKgJS9RJ73dEBjrQHtYEF5AUAbftaEqBrJAt+NUIA6d4AigpgApgeAsBB9POBAtNBMQCWYIm5EmOA5SuCul4E9ZgAKcz2ZIRllPYuHMamhdwBag9cjiiesBECetIKIOEBzOHBWADKz2BNW7NE0mXgd1rr9WDIa6FqGA1gmOUGB9gUeHLKyzlz87UBJtEhGTDru4NzJB7Vpu2VYgIkgBXRzenENUI1PbSMTsXNgDPLNO9Sf4rm9QSaVkwAaj6/Cici3xPAnNvB3fZLes/r0KwsYIXmiTf/x6jh17UAkh7ABPA8Tw6tnlpCowovx08CzmYe2bh47suA/N8D3Gof4gGM0wt5cs3XegFQNS9VRrviVsrOErVEV0eVPZLuADlZDU/m5pIp06fQADZaEyAnjCgLvMSKnYo5RfeUgUfXAJiQAxALHuwdmFUAJaO4JsDnWOaPC3RKfJCHZXxyc23WfoLuigTIAM1FPsjopZNqEQUwF8cIb5gWxpjnls+qIquTbSsKwCgUJIDR+E7M5hS+ZIXlKwfYKM7EXsNzwSZOEwOmPFPT5WaeKADlKWoz2pUM5TNrACmgGTt4nCyJu2X5ze6+lkiAQmE25JCYWxGllJttSreYiwyrvc0/FVSdoNn2r2pD2pz9q3rXtMhII4000v9cSStyr0P+KaVx/yba2E1FOHSrZD10OwkLmNdd6T/lWrDha8efWpEAed3h+F5Odx2ujF0PrwPtSABLB7B0gIzYfwSNF0rtE/sNafBlljsWPtzWNwswsRsv8Nc4gGZw9/kBrtwiOv4UFyCBoH7zD2FyAL0T7geo4dtBAAKRzgZdVPtEHIAEzG3p2fVpdxRvMIA5cNWxIpYahgHaYQCu6Y1kAHdKrxU9AJxPbedQuxKMEEzw9RPm86oXnC5FABRpn2oAACUOEFamwAOlhcO3hpYDSdtxbcDepdysrC/AGIRYw5cqvJ7DTGFRGOFGtDP7jwE01M9pAVBE3g9w4YztrBfAH2GABDrED3AlYPUIcKTtSACDRseDNnC1XeLzFVbCABfjJR2Afa72WgQ5rLU+yFAAyZ1cIzyyclPh9R2xbNebr9tvFL7yAawMBeByr024dS/2rH8IADW9XlPDB7A8FAC1U4RVE1heJ4ALCzM2VZHmqDslYiYMkHEBUgEAOn6b5fGjchhg8FqgAMQC3zEdoKTW54eM8NehAFxgOwZQ4jZA7+0HOGqRtdaUKwLg52E1RBlZxzcOALxRXvQyYF0BJvC7HqGhq3y9G3ntwEnUMsIA9w0PYEPMy62fGYUKKz/PxvQet11dU9ABcpjuCeBI29IBEjTBQuFTFS8wvJE/CZA+BGh+wobyhBqDAOQQoRXPxh2S2sYLbQmA98TynVQ5GqCI/JAADNf9r6PEExUAc563ZdTQMPmC/+y6AHhWP4e8iJ2M4xQ+Ll1z094d1BGpNUshI8zC6gngFubMHyBbQmYDM15Y2fug+eCoIOuLbkN0ItyB8XInVAsMYFgOSc6t5Sm3rUmiTQTA5AqhAKkqVh2Swa8hgBRWhwWQbYq/RDGGjgQYs+jGTlngSRZyDgGMY4WewzpzgwDIN+DhZVg00d85gGyK53AWszfWF3tW9pgoQJHmytyfDrFtZ0CAE3DGkftw52eBmV9OA0jRW9CS4erIt+r+buxrOgMedxoMwFjCq2IiThWL7PiiBOBRzJqqMwobVqYMbDEwwHFw1X7mCnQmAIfHdxUA05ubut1g/OabV/sHi4A18wMAKGd4UxpPbM/O0WeMBCjx2OfPvgx4ySUDGs6gRUDTYEELK8UTJUUdQGkjrSqkqzx0kay7PdYBjbB2niOiOLzzVYUVBXClFtDZjzZPIpJJ62mPmvMDfFCSAcyWu5j+IMCJAigqr2QHoF0RiWGVbsZWcjeSqFKAsMbKwCxfi99mZ5Lk1zqAURZc5FIAm4nCKIM2FT2o2iXUnKEHWp5N0m+v8otnu+Zq+yA5VneV13mTGYfFnvKf6pSIaIyYxlYVkdQlbRgrpzUD17ndZ0uvkM1KT3Gn0NJNke7Znik+IFF/942iPOjF7gKV/3h6YTwJs218FnXAeIEb494HSqt/2FF+s2ZrXzf9C0SeqvQCkJjZJeYfBxx7iyjh1E3VspLAApU0GWmkkUYaaaT/sozXyL+qC7Oh9ZKT73gbl5dIbyo2zV4fJxkxYj0FLIr0YngaGmWuj1lGtXBU+GTh4i1pEYI0HdjQaAw6Yibc8uZ2quMQdnZ3i4hP+zob0vENP0dVCyMnEJIlTj9D5V0YAFQvmEr1gE++gXCBlRbwi5y4Fgtgeg0AvwIAKSBohUUvxYweQjQQUskrscEACB5wQlOw87w2+EwK7YJPVYi7DggwE+46eVYx7uVN9Oq7bEwANxbpqOCC+BtEYwiuJ6wCeTZ2fyya7nooh9rn6QWqg7cZCCAy1MgAwsrro5mWDNU0dIDbuwAcZxacoQCcrEysDq6ODrDEJpceZgUA6OcfQ8kBFZgnaXhaEQCZEqFUefb40zoAjzP0BJC07V04h9ihbMWmAmgl+MPd2kMCpKp5kRH1pjMgAImeniPToADH8EowJgEm6Y4Efk/RFwXN764AF+zVE0CjK0CRL4LYWAIY1Qa9YL7uYvzmASRmdqIAR+4oAJi6AhihwaSJ7gBGmS962EDZwAKsDfBo8U+KcQoF0G0pHsAJoYEMmno3gEm0iR+Abj4/hdfGGUY/AEYdrfgAObS8U5YFQBKthSbN/+mT8Vo0gBte7Q6QUdPoFUDb5No8HwBI1+eDAOTrdq1D6+DyXJMIALNQxAOHbavXgmQ3AHc4q1EKjBdJBQHI8bOGFQA4hs08yq0uUYx+qqFRA14K7JWyggBGsuaOpY1LAJbh8/ReFKMvAJaA3w6vjADw5I5YttgOBUBrRp75Js/3CUDm4B9RywmnC6gEAShu2w9AjYCdVsdsvwAplgVh5ycNBAuFOQavBQCyyLOrSH8AIgvCzk9CAKh3AbvRvA7ATjtjoBwIWUGZuZ08t4NG6Bp9i+2QABuAza/o3waoavpqkIz6y+yNCIAJtEs+gByWKOg4sNw/wAZ8kQ0Vv4O3EQmQdluHnAZQb5xMs6zYXGr0D2DUF/U+UIcIrBAAVbXj6AApLE+4S5ZXroTTNwC5S68EYicNgkYBfOEQHeAYTCexPIkz3JWzw3BIkmXMi6NhAC4dwI2fvJzPIZ/CGX6Am/sD2BjIixbx97UBEq4Z7GRU28RAywdwQ6M/gDm5aCiH5bUBjmM+2oR7am1VBzgH/QGkyzLjFxSAbIhUY+kB1Nz84p7am/t6AJ4j3+4L4Dh98e/PwaY4DLBfu0SpWa4dLathmkW9t+wNQMWaHNEkxwEwvmXL9c7Ve0Y7AGymTT8Ad6uQVBo4pRtAVgL4h2SykPm/b1/VMFX26sBtV9sf08KIMsJjCbnXO5QM+s9leBGw9iztYu+iAdjXxwFIZoGO1ktbFCYlACreIQ8z4QO4iFzBETPs/gQ+LccB2BnSQ82CyvHXOs9DqnuHFIDypJrMkGgAMR7AyUEHfD90tNRaJBJgQR5S70sv572lD/uSmAC5IEC6LHJ9I5qYJcPiJity77+5GQcaVhiA9ZxPI0rA/abQ1jEByBuyg3gqXQ4drY1PfcIRU34P8Jlgc1OHKDlE19HRU+l2I0PUrWSkkUYaaaSRRhpppJFi6C8fDRp5d6pE1AAAAABJRU5ErkJggg=="}},Sm={methods:{clickInteractionViewLink:function(){var t=window.open("https://ui.marklion.cn/article/tools/marklion-interaction-mobile-view-intro.shtml");t.opener=null},clickGoWebInteraction:function(){var t=window.open(this.interactionUrl);t.opener=null},clickShowMenu:function(){var t=this,e=!this.menuVisible;e&&(this.url=this.interactionUrl),setTimeout((function(){t.menuVisible=e}),0)},hideMenu:function(){var t=this;clearTimeout(this.menuHandler),this.menuHandler=setTimeout((function(){t.menuVisible=!1}),50)}},watch:{url:function(t){t&&(this.qrcodeImage=Cm(t))},menuVisible:function(t){t?window.addEventListener("click",this.hideMenu,!1):window.removeEventListener("click",this.hideMenu,!1)}},computed:{supportInteraction:function(){return!bt(this.cloudVersion)},interactionUrl:function(){return this.getCurrentInteractionUrl()}},data:function(){return{qrcodeImage:null,url:"",menuVisible:!1,menuHandler:0}},beforeDestroy:function(){clearTimeout(this.menuHandler),window.removeEventListener("click",this.hideMenu,!1)},created:function(){0},props:{fixRight:{type:Boolean,default:!1}}},Tm=Sm,Am=(n("523a"),Object(wo["a"])(Tm,wm,xm,!1,null,"096de284",null)),Im=Am.exports,Fm=function(){var t=this,e=t._self._c;return e("div",{staticClass:"btn-go-artrendermode",class:{on:t.artShowInListMode},attrs:{title:t.title},on:{click:t.clickArtShowInListMode}})},Mm=[],Om={methods:{clickArtShowInListMode:function(){this.$store.commit("artShowInListMode",!this.artShowInListMode)}},computed:{title:function(){var t=this.artShowInListMode;return"".concat(t?"宫格视图":"画布视图","\n点击将画板列表切换为").concat(t?"画布视图":"宫格视图")},visible:function(){return!0}}},_m=Om,Lm=(n("3230"),Object(wo["a"])(_m,Fm,Mm,!1,null,"acff9ab0",null)),Pm=Lm.exports,Em=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-log"},[e("a",{staticClass:"btn-folder-log",class:{on:t.logVisible},attrs:{href:"javascript:;",title:"文件夹日志"},on:{click:function(e){t.logVisible=!t.logVisible}}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.logVisible,expression:"logVisible"}],staticClass:"box",on:{click:function(e){t.notClickClose=!0}}},[e("div",{staticClass:"header"},[e("nav",[t.isRootFolder?t._e():e("a",{class:{on:t.showType===t.EnumLogShowType.ALL},attrs:{href:"javascript:;"},on:{click:function(e){return t.clickShowType(t.EnumLogShowType.ALL)}}},[t._v("全部")]),e("a",{class:{on:t.showType===t.EnumLogShowType.Folder||t.isRootFolder},attrs:{href:"javascript:;"},on:{click:function(e){return t.clickShowType(t.EnumLogShowType.Folder)}}},[t._v("文件夹")]),t.isRootFolder?t._e():e("a",{class:{on:t.showType===t.EnumLogShowType.Artboard},attrs:{href:"javascript:;"},on:{click:function(e){return t.clickShowType(t.EnumLogShowType.Artboard)}}},[t._v("画板")]),t.isRootFolder?t._e():e("a",{class:{on:t.showType===t.EnumLogShowType.File},attrs:{href:"javascript:;"},on:{click:function(e){return t.clickShowType(t.EnumLogShowType.File)}}},[t._v("文件")])]),e("menu",[e("a",{staticClass:"btn-refresh",attrs:{href:"javascript:;",title:"刷新日志列表"},on:{click:function(e){return t.clickReload(!0)}}})])]),e("div",{ref:"list",staticClass:"list",class:t.listCls,on:{scroll:t.onListScroll}},[t.listFetchState===t.FetchState.Fetching||t.listFetchState===t.FetchState.Error?e("NetworkLoading",{attrs:{loadText:"正在获取消息列表...",errorText:t.errorText,isLoading:t.listFetchState===t.FetchState.Fetching,isError:t.listFetchState===t.FetchState.Error,reLoadText:"刷新"},on:{reload:function(e){return t.clickReload(!0)}}}):0===t.showList.length?e("div",{staticClass:"empty"},[t._v("没有找到"+t._s(t.showType===t.EnumLogShowType.Folder?"文件夹相关":t.showType===t.EnumLogShowType.Artboard?"画板相关":t.showType===t.EnumLogShowType.File?"文件相关":"")+"日志")]):e("ul",t._l(t.list,(function(n){return e("CloudFolderLogItem",{key:"folderlog-".concat(n.id),attrs:{item:n,showType:t.showType,listViewRect:t.listViewRect,allShowListItemSelect:t.allShowListItemSelect},on:{clickFolder:t.clickFolder,clickArtboard:t.clickArtboard,clickFile:t.clickFile,resetShowListItemsOffsetTop:t.resetShowListItemsOffsetTop}})})),1)],1)])])},Nm=[],Dm=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-log-item",class:t.itemCls,style:t.style},[t.itemInView?e("div",{ref:"item",staticClass:"item-content"},[e("UserFace2",{attrs:{self:t.isSelf,tourist:t.isTourist,title:t.userFaceTitle,text:t.userFaceText}}),e("div",{staticClass:"summary"},[e("div",{staticClass:"info"},[e("div",{staticClass:"nickname"},[t._v(t._s(t.userNickName))]),t.item.type===t.EnumLoggerType.Artboard_Upload?e("ArtboardUpload",{attrs:{item:t.item},on:{clickFolder:t.clickFolder,clickArtboard:t.clickArtboard,clickFile:t.clickFile}}):t.item.type===t.EnumLoggerType.NetDisk_FileUploadCompleted?e("NetdiskFileUpload",{attrs:{item:t.item},on:{clickFolder:t.clickFolder,clickArtboard:t.clickArtboard,clickFile:t.clickFile}}):t.item.type===t.EnumLoggerType.Remove?e("ItemRemove",{attrs:{item:t.item,showType:t.showType},on:{clickFolder:t.clickFolder,clickArtboard:t.clickArtboard,clickFile:t.clickFile}}):t.item.type===t.EnumLoggerType.MoveTo?e("ItemMoveTo",{attrs:{item:t.item,showType:t.showType},on:{clickFolder:t.clickFolder,clickArtboard:t.clickArtboard,clickFile:t.clickFile}}):t.item.type===t.EnumLoggerType.Folder_Edit?e("FolderEdit",{attrs:{item:t.item},on:{clickFolder:t.clickFolder,clickArtboard:t.clickArtboard,clickFile:t.clickFile}}):t.item.type===t.EnumLoggerType.Folder_Add||t.item.type===t.EnumLoggerType.Folder_SetPreview||t.item.type===t.EnumLoggerType.Folder_CancelPreview?e("FolderSet",{attrs:{item:t.item},on:{clickFolder:t.clickFolder,clickArtboard:t.clickArtboard,clickFile:t.clickFile}}):t.item.type===t.EnumLoggerType.NetDisk_LinkAdd||t.item.type===t.EnumLoggerType.NetDisk_LinkEdit?e("NetdiskFileLinkChange",{attrs:{item:t.item},on:{clickFolder:t.clickFolder,clickArtboard:t.clickArtboard,clickFile:t.clickFile}}):t.item.type===t.EnumLoggerType.NetDisk_FileReName?e("NetdiskFileRename",{attrs:{item:t.item},on:{clickFolder:t.clickFolder,clickArtboard:t.clickArtboard,clickFile:t.clickFile}}):t._e()],1),e("div",{staticClass:"date"},[t._v(t._s(t.item.dateStr))])])],1):t._e()])},jm=[],Rm=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-log-item-info"},[t._v("上传了"),e("ArrayItems",{attrs:{showMore:t.showMoreArtboard,list:t.artboards,canClick:!0,listName:"画板"},on:{clickItem:t.clickArtboard,clickShowMore:t.clickShowMoreArtboard}})],1)},Vm=[],Bm=function(){var t=this,e=t._self._c;return e("div",{staticClass:"array-items",class:{nomore:!t.moreList}},[e("span",{staticClass:"name",on:{click:t.clickMore}},[t._v(t._s(t.list.length>t.startMaxCount?"".concat(t.list.length,"个"):"")+t._s(t.listName))]),t._l(t.startList,(function(n,i){return e("span",{key:i,class:{art:1,first:0===i}},[e("ArrayItem",{attrs:{canClick:t.canClick,light:t.light,dead:t.dead,item:n},on:{clickItem:t.clickItem}})],1)})),t.moreList?[t.showMore?e("span",{staticClass:"more-list"},t._l(t.moreList,(function(n,i){return e("span",{key:t.startMaxCount+i,class:{art:1}},[e("ArrayItem",{attrs:{canClick:t.canClick,light:t.light,dead:t.dead,item:n},on:{clickItem:t.clickItem}})],1)})),0):t._e(),t.showMore?t._e():e("span",{staticClass:"more-text",on:{click:t.clickMore}},[t._v("等")]),e("span",{staticClass:"btn-more-visible",class:{on:t.showMore},on:{click:t.clickMore}})]:t._e()],2)},Um=[],Hm=function(){var t=this,e=t._self._c;return t.canClick?e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickItem(t.item)}}},[t._v(t._s(t.name))]):e("span",{class:{light:t.light,dead:t.dead}},[t._v(t._s(t.name))])},Wm=[],$m={methods:{clickItem:function(t){this.$emit("clickItem",t)}},computed:{name:function(){var t=this.item,e=t.name,n=t.fileName,i=t.fileExt;return e||n+i}},props:{item:Object,canClick:Boolean,light:{type:Boolean,default:!0},dead:{type:Boolean,default:!1}}},Gm=$m,zm=Object(wo["a"])(Gm,Hm,Wm,!1,null,null,null),Ym=zm.exports,Xm={components:{ArrayItem:Ym},methods:{clickMore:function(){this.moreList&&this.$emit("clickShowMore",!this.showMore)},clickItem:function(t){this.$emit("clickItem",t)}},computed:{startMaxCount:function(){return 5},startList:function(){var t=this.list,e=this.startMaxCount;return t.length<=e?t:t.slice(0,5)},moreList:function(){var t=this.list,e=this.startMaxCount;return t.length<=e?null:t.slice(5)}},props:{list:Array,canClick:Boolean,listName:String,light:{type:Boolean,default:!0},dead:{type:Boolean,default:!1},showMore:{type:Boolean,default:!1}}},Km=Xm,qm=(n("c956"),Object(wo["a"])(Km,Bm,Um,!1,null,"101c0c6a",null)),Qm=qm.exports,Jm={components:{ArrayItems:Qm},methods:{clickArtboard:function(t){this.$emit("clickArtboard",t)},clickShowMoreArtboard:function(t){this.item.showMore[z.Artboard]=t}},computed:{showMoreArtboard:function(){return this.item.showMore[z.Artboard]},EnumLogShowType:function(){return z},artboards:function(){var t,e;return null!==(t=null===(e=this.item.data)||void 0===e?void 0:e.artboards)&&void 0!==t?t:[]}},props:{item:Object}},Zm=Jm,tp=Object(wo["a"])(Zm,Rm,Vm,!1,null,null,null),ep=tp.exports,np=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-log-item-info"},t._l(t.texts,(function(n,i){return e("ArrayItem",{key:i,attrs:{canClick:!!n.canClick,light:!!n.light,item:n},on:{clickItem:t.clickFolder}})})),1)},ip=[],rp={components:{ArrayItem:Ym},methods:{clickFolder:function(t){this.$emit("clickFolder",t)}},computed:{isRootFolder:function(){return 0===this.cloudCurrentFolderId},canClickFolder:function(){return this.cloudCurrentFolderId===this.itemData.parentId},texts:function(){var t=this.canClickFolder,e=this.itemData,n=this.isRootFolder,i=n?"":"子",r=[];switch(this.item.type){case W.Folder_Add:t?(r.push({name:"新建了".concat(i,"文件夹")}),r.push({name:e.name,light:!0,canClick:!0,id:e.id})):(r.push({name:"新建了当前文件夹"}),r.push({name:e.name,light:!0}));break;case W.Folder_SetPreview:t?(r.push({name:"设置了".concat(i,"文件夹")}),r.push({name:e.name,light:!0,canClick:!0,id:e.id})):(r.push({name:"设置了当前文件夹"}),r.push({name:e.name,light:!0})),r.push({name:"的封面"});break;case W.Folder_CancelPreview:t?(r.push({name:"取消了".concat(i,"文件夹")}),r.push({name:e.name,light:!0,canClick:!0,id:e.id})):(r.push({name:"取消了当前文件夹"}),r.push({name:e.name,light:!0})),r.push({name:"的封面"});break}return r},itemData:function(){var t;return null!==(t=this.item.data)&&void 0!==t?t:{}}},props:{item:Object}},ap=rp,op=Object(wo["a"])(ap,np,ip,!1,null,null,null),sp=op.exports,cp=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-log-item-info"},t._l(t.texts,(function(n,i){return e("ArrayItem",{key:i,attrs:{canClick:!!n.canClick,light:!!n.light,item:n},on:{clickItem:t.clickFolder}})})),1)},lp=[],up={components:{ArrayItem:Ym},methods:{clickFolder:function(t){this.$emit("clickFolder",t)}},computed:{isRootFolder:function(){return 0===this.cloudCurrentFolderId},texts:function(){var t=this.itemData,e=t.folder,n=t.oldFolder;if(!e)return[];var i=this.cloudCurrentFolderId===e.parentId,r=this.isRootFolder?"":"子";if(!n)return[{name:"编辑了".concat(i?r:"","文件夹")},{name:e.name,light:!0,canClick:i,id:e.id},{name:"的配置信息"}];var a=e.name,o=e.shareMode,s=n.name,c=n.shareMode,l=a!=s,u=o!=c;if(!l&&!u)return[{name:"编辑了".concat(i?r:"","文件夹")},{name:e.name,light:!0,canClick:i,id:e.id},{name:"的配置信息"}];var d=[];return l&&(i?(d.push({name:"重命名了".concat(r,"文件夹")}),d.push({name:s,light:!0})):d.push({name:"重命名了当前文件夹"}),d.push({name:"为"}),d.push({name:a,light:!0,id:e.id,canClick:i})),u&&(l?(d.push({name:"并修改了访问模式为"}),d.push({name:Y.getName(o),light:!0})):(i?(d.push({name:"修改了".concat(r,"文件夹")}),d.push({name:a,light:!0,id:e.id,canClick:!0})):d.push({name:"修改了当前文件夹"}),d.push({name:"的访问模式为"}),d.push({name:Y.getName(o),light:!0}))),d},itemData:function(){var t;return null!==(t=this.item.data)&&void 0!==t?t:{}}},props:{item:Object}},dp=up,hp=Object(wo["a"])(dp,cp,lp,!1,null,null,null),fp=hp.exports,mp=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-log-item-info"},[!t.isMoveOutMode&&t.oldParent?[t._v("从"),e("ArrayItem",{attrs:{canClick:!0,item:t.oldParent},on:{clickItem:t.clickFolder}})]:t._e(),t._v(t._s(t.moveModeText)+"了"),t.hasFolder?e("ArrayItems",{attrs:{list:t.folders,showMore:t.showMoreFolder,canClick:!0,listName:"文件夹"},on:{clickItem:t.clickFolder,clickShowMore:t.clickShowMoreFolder}}):t._e(),t._v(t._s(t.hasFolder&&t.hasFile?",":"")),t.hasFile?e("ArrayItems",{attrs:{list:t.files,showMore:t.showMoreFile,canClick:!0,listName:"文件"},on:{clickItem:t.clickFile,clickShowMore:t.clickShowMoreFile}}):t._e(),t._v(t._s(t.hasFile&&t.hasArtboard?",":"")),t.hasArtboard?e("ArrayItems",{attrs:{list:t.artboards,showMore:t.showMoreArtboard,canClick:!0,listName:"画板"},on:{clickItem:t.clickArtboard,clickShowMore:t.clickShowMoreArtboard}}):t._e(),t.isMoveOutMode&&t.newParent?[t._v("到"),e("ArrayItem",{attrs:{canClick:!0,item:t.newParent},on:{clickItem:t.clickFolder}})]:t._e()],2)},pp=[],vp={components:{ArrayItems:Qm,ArrayItem:Ym},methods:{clickArtboard:function(t){this.$emit("clickArtboard",t)},clickFolder:function(t){this.$emit("clickFolder",t)},clickFile:function(t){this.$emit("clickFile",t)},clickShowMoreFolder:function(t){this.item.showMore[z.Folder]=t},clickShowMoreFile:function(t){this.item.showMore[z.File]=t},clickShowMoreArtboard:function(t){this.item.showMore[z.Artboard]=t}},computed:{showMoreFolder:function(){return this.item.showMore[z.Folder]},showMoreFile:function(){return this.item.showMore[z.File]},showMoreArtboard:function(){return this.item.showMore[z.Artboard]},isRootFolder:function(){return 0===this.cloudCurrentFolderId},moveModeText:function(){return this.isMoveOutMode?"移动":"移入"},oldParent:function(){var t,e;return null!==(t=null===(e=this.item.data)||void 0===e?void 0:e.parent)&&void 0!==t?t:null},newParent:function(){var t,e;return null!==(t=null===(e=this.item.data)||void 0===e?void 0:e.newParent)&&void 0!==t?t:null},isMoveOutMode:function(){var t;return(null===(t=this.oldParent)||void 0===t?void 0:t.id)===this.cloudCurrentFolderId},hasFolder:function(){var t=this.showType,e=this.folders,n=this.isRootFolder;return(n||t===z.ALL||t===z.Folder)&&e.length>0},hasFile:function(){var t=this.showType,e=this.files,n=this.isRootFolder;return!n&&(t===z.ALL||t===z.File)&&e.length>0},hasArtboard:function(){var t=this.showType,e=this.artboards,n=this.isRootFolder;return!n&&(t===z.ALL||t===z.Artboard)&&e.length>0},folders:function(){var t,e;return null!==(t=null===(e=this.item.data)||void 0===e?void 0:e.folders)&&void 0!==t?t:[]},files:function(){var t,e;return null!==(t=null===(e=this.item.data)||void 0===e?void 0:e.files)&&void 0!==t?t:[]},artboards:function(){var t,e;return null!==(t=null===(e=this.item.data)||void 0===e?void 0:e.artboards)&&void 0!==t?t:[]}},props:{item:Object,showType:Number}},bp=vp,gp=Object(wo["a"])(bp,mp,pp,!1,null,null,null),wp=gp.exports,xp=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-log-item-info"},[t._v("删除了"),t.hasFolder?e("ArrayItems",{attrs:{list:t.folders,showMore:t.showMoreFolder,canClick:!1,light:!1,dead:!0,listName:"文件夹"},on:{clickItem:t.clickFolder,clickShowMore:t.clickShowMoreFolder}}):t._e(),t._v(t._s(t.hasFolder&&t.hasFile?",":"")),t.hasFile?e("ArrayItems",{attrs:{list:t.files,showMore:t.showMoreFile,canClick:!1,light:!1,dead:!0,listName:"文件"},on:{clickItem:t.clickFile,clickShowMore:t.clickShowMoreFile}}):t._e(),t._v(t._s(t.hasFile&&t.hasArtboard?",":"")),t.hasArtboard?e("ArrayItems",{attrs:{list:t.artboards,showMore:t.showMoreArtboard,canClick:!1,dead:!0,light:!1,listName:"画板"},on:{clickItem:t.clickArtboard,clickShowMore:t.clickShowMoreArtboard}}):t._e()],1)},yp=[],kp={components:{ArrayItems:Qm},methods:{clickArtboard:function(t){this.$emit("clickArtboard",t)},clickFolder:function(t){this.$emit("clickFolder",t)},clickFile:function(t){this.$emit("clickFile",t)},clickShowMoreFolder:function(t){this.item.showMore[z.Folder]=t},clickShowMoreFile:function(t){this.item.showMore[z.File]=t},clickShowMoreArtboard:function(t){this.item.showMore[z.Artboard]=t}},computed:{showMoreFolder:function(){return this.item.showMore[z.Folder]},showMoreFile:function(){return this.item.showMore[z.File]},showMoreArtboard:function(){return this.item.showMore[z.Artboard]},isRootFolder:function(){return 0===this.cloudCurrentFolderId},hasFolder:function(){var t=this.showType,e=this.folders,n=this.isRootFolder;return(n||t===z.ALL||t===z.Folder)&&e.length>0},hasFile:function(){var t=this.showType,e=this.files,n=this.isRootFolder;return!n&&(t===z.ALL||t===z.File)&&e.length>0},hasArtboard:function(){var t=this.showType,e=this.artboards,n=this.isRootFolder;return!n&&(t===z.ALL||t===z.Artboard)&&e.length>0},folders:function(){var t,e;return null!==(t=null===(e=this.item.data)||void 0===e?void 0:e.folders)&&void 0!==t?t:[]},files:function(){var t,e;return null!==(t=null===(e=this.item.data)||void 0===e?void 0:e.files)&&void 0!==t?t:[]},artboards:function(){var t,e;return null!==(t=null===(e=this.item.data)||void 0===e?void 0:e.artboards)&&void 0!==t?t:[]}},props:{item:Object,showType:Number}},Cp=kp,Sp=Object(wo["a"])(Cp,xp,yp,!1,null,null,null),Tp=Sp.exports,Ap=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-log-item-info"},[t._v(t._s(t.modeText)+"了链接文件"),e("ArrayItem",{attrs:{item:t.file,canClick:!0},on:{clickItem:t.clickFile}})],1)},Ip=[],Fp={components:{ArrayItem:Ym},methods:{clickFile:function(t){this.$emit("clickFile",t)}},computed:{isLinkAdd:function(){return this.item.type===W.NetDisk_LinkAdd},file:function(){return this.item.data},modeText:function(){return this.isLinkAdd?"添加":"编辑"}},props:{item:Object}},Mp=Fp,Op=Object(wo["a"])(Mp,Ap,Ip,!1,null,null,null),_p=Op.exports,Lp=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-log-item-info"},[t._v("重命名了文件"),t.oldFileName?e("span",{staticClass:"dead"},[t._v(t._s(t.oldFileName+t.fileExt))]):t._e(),t._v("为"),e("ArrayItem",{attrs:{item:t.file,canClick:!0},on:{clickItem:t.clickFile}})],1)},Pp=[],Ep={components:{ArrayItem:Ym},methods:{clickFile:function(t){this.$emit("clickFile",t)}},computed:{oldFileName:function(){var t,e;return null!==(t=null===(e=this.item.data)||void 0===e?void 0:e.oldFileName)&&void 0!==t?t:""},file:function(){var t;return null===(t=this.item.data)||void 0===t?void 0:t.file},fileExt:function(){var t,e;return null!==(t=null===(e=this.file)||void 0===e?void 0:e.fileExt)&&void 0!==t?t:""}},props:{item:Object}},Np=Ep,Dp=Object(wo["a"])(Np,Lp,Pp,!1,null,null,null),jp=Dp.exports,Rp=function(){var t=this,e=t._self._c;return e("div",{staticClass:"folder-log-item-info"},[t._v("上传了"),e("ArrayItems",{attrs:{list:t.files,showMore:t.showMoreFile,canClick:!0,listName:"文件"},on:{clickItem:t.clickFile,clickShowMore:t.clickShowMoreFile}})],1)},Vp=[],Bp={components:{ArrayItems:Qm},methods:{clickFile:function(t){this.$emit("clickFile",t)},clickShowMoreFile:function(t){this.item.showMore[z.File]=t}},computed:{showMoreFile:function(){return this.item.showMore[z.File]},files:function(){var t=this.item.data;return ut(t)||(t=[t]),t}},props:{item:Object}},Up=Bp,Hp=Object(wo["a"])(Up,Rp,Vp,!1,null,null,null),Wp=Hp.exports,$p={components:{UserFace2:Hs,ArtboardUpload:ep,FolderSet:sp,FolderEdit:fp,ItemMoveTo:wp,ItemRemove:Tp,NetdiskFileLinkChange:_p,NetdiskFileRename:jp,NetdiskFileUpload:Wp},methods:{clickArtboard:function(t){this.$emit("clickArtboard",t)},clickFolder:function(t){this.$emit("clickFolder",t)},clickFile:function(t){this.$emit("clickFile",t)},resetBoxHeight:function(t){var e,n,i=this.visible,r=this.item;i&&(!t&&r.offsetHeight>0||(r.offsetHeight=null!==(e=null===(n=this.$refs.item)||void 0===n?void 0:n.offsetHeight)&&void 0!==e?e:0,r.offsetHeight>0&&this.$emit("resetShowListItemsOffsetTop")))}},computed:{itemInView:function(){var t=this.listViewRect,e=this.itemRect;return 0===e.offsetHeight||ce(t,e)},itemRect:function(){var t=this.item,e=t.offsetHeight,n=t.offsetTop;return{x:0,width:100,y:n,height:e}},isRootFolder:function(){return 0===this.cloudCurrentFolderId},visible:function(){var t=this.item,e=t.visibleInFolder,n=t.visibleInFile,i=t.visibleInArtboard,r=this.isRootFolder,a=this.showType;if(r)return e;switch(a){case z.Artboard:return i;case z.File:return n;case z.Folder:return e;default:return!0}},itemCls:function(){var t=this.item,e=t.visibleInFolder,n=t.visibleInFile,i=t.visibleInArtboard;if(!e&&!n&&!i)return null;var r={};return e&&(r["visible-folder"]=1),n&&(r["visible-file"]=1),i&&(r["visible-artboard"]=1),r},style:function(){var t,e=null!==(t=this.item.offsetHeight)&&void 0!==t?t:0;return e>0?{height:"".concat(e,"px")}:null},EnumLoggerType:function(){return W},userNickName:function(){var t=this.user;if(!t)return"-";var e=t.nickName;return e||"-"},userFaceText:function(){var t=this.userNickName;return t[t.length-1]},userFaceTitle:function(){var t=this.user;return t?"".concat(t.nickName,"(").concat(t.email,")"):null},isSelf:function(){var t;return(null===(t=this.user)||void 0===t?void 0:t.userKey)===this.cloudUserKey},user:function(){return this.item.user},isTourist:function(){var t;switch(null===(t=this.user)||void 0===t?void 0:t.authority){case K.Admin:case K.Designer:return!1}return!0},showMoreFolder:function(){return this.item.showMore[z.Folder]},showMoreFile:function(){return this.item.showMore[z.File]},showMoreArtboard:function(){return this.item.showMore[z.Artboard]}},watch:{showMoreFolder:function(){var t=this;this.$nextTick((function(){t.resetBoxHeight(!0)}))},showMoreFile:function(){var t=this;this.$nextTick((function(){t.resetBoxHeight(!0)}))},showMoreArtboard:function(){var t=this;this.$nextTick((function(){t.resetBoxHeight(!0)}))},visible:function(){var t=this;this.$nextTick((function(){t.resetBoxHeight()}))},itemInView:function(){var t=this;this.$nextTick((function(){t.resetBoxHeight()}))}},props:{item:Object,showType:Number,listViewRect:Object,allShowListItemSelect:Boolean},mounted:function(){var t=this;this.$nextTick((function(){t.resetBoxHeight()}))}},Gp=$p,zp=(n("b322"),Object(wo["a"])(Gp,Dm,jm,!1,null,"075b8e27",null)),Yp=zp.exports,Xp="folderlog-show",Kp=Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])({},W.Remove,1),W.MoveTo,1),W.Folder_Add,1),W.Folder_Edit,1),W.Folder_SetPreview,1),W.Folder_CancelPreview,1),qp=Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])({},W.Remove,1),W.MoveTo,1),W.NetDisk_LinkAdd,1),W.NetDisk_LinkEdit,1),W.NetDisk_FileReName,1),W.NetDisk_FileUploadCompleted,1),Qp=Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])({},W.Remove,1),W.MoveTo,1),W.Artboard_Upload,1),Jp={components:{NetworkLoading:$l,CloudFolderLogItem:Yp},methods:{clickArtboard:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return");case 2:if(r=t.guid,a=t.id,o=t.name,null!=r||null!=a){n.next=5;break}return n.abrupt("return");case 5:if(s=e.documentArtboards,c=s.find((function(t){if(t){var e=t.artboard;if(e){var n=e.cid,i=e.guid;return!!(a>0&&n===a||r&&r===i)||void 0}}})),c){n.next=22;break}if(!(a>0)){n.next=20;break}return n.prev=9,n.next=12,e.checkCloudItem(a,$.Artboard);case 12:c=n.sent,e.goCloudPath({folderId:c.parentId,artboardGuid:c.guid,newWindow:!0}),n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](9),e.showTextTip(o?n.t0.toString().replace("[".concat(a,"]"),"[".concat(o,"]")):n.t0);case 19:return n.abrupt("return");case 20:return e.showTextTip("画板[".concat(o,"]已不在当前文件夹,可能已经被删除或移动")),n.abrupt("return");case 22:if(!e.inCloudViewerMode){n.next=33;break}if(!e.inArtboardMode){n.next=30;break}if(c.artboard.cid!==e.curArtboardId){n.next=27;break}return e.showTextTip("当前画板就是[".concat(c.artboard.name,"]")),n.abrupt("return");case 27:e.setCurArtboard(c),n.next=31;break;case 30:e.$store.commit("resetCenterArtboard",c.artboard);case 31:n.next=34;break;case 33:e.goCloudPath({folderId:e.cloudCurrentFolderId,artboardGuid:c.artboard.guid,newWindow:!1});case 34:case"end":return n.stop()}}),n,null,[[9,16]])})))()},clickFolder:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t){n.next=3;break}return n.abrupt("return");case 3:if(a=t.id,o=t.name,null!=a){n.next=6;break}return n.abrupt("return");case 6:if(s=null===(r=e.cloudSubFolders)||void 0===r?void 0:r.find((function(t){return t.id===a})),!s){n.next=10;break}return e.goCloudPath({folderId:a,newWindow:!0}),n.abrupt("return");case 10:return n.prev=10,n.next=13,e.checkCloudItem(a,$.Folder);case 13:e.goCloudPath({folderId:a,newWindow:!0}),n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](10),e.showTextTip(o?n.t0.toString().replace("[".concat(a,"]"),"[".concat(o,"]")):n.t0);case 19:case"end":return n.stop()}}),n,null,[[10,16]])})))()},clickFile:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c,l,u;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return");case 2:if(a=t.secId,o=t.name,s=t.fileName,c=t.fileExt,a){n.next=5;break}return n.abrupt("return");case 5:if(l=null===(r=e.cloudSubFiles)||void 0===r?void 0:r.find((function(t){var e;return-1!==(null===(e=t.viewUrl)||void 0===e?void 0:e.indexOf(a))})),!l){n.next=9;break}return e.clickNetDiskFile(l),n.abrupt("return");case 9:return n.prev=9,n.next=12,e.checkCloudItem(a,$.File);case 12:u=n.sent,e.clickNetDiskFile(u),n.next=20;break;case 16:n.prev=16,n.t0=n["catch"](9),o||(o=s?s+c:""),e.showTextTip(o?n.t0.toString().replace("[".concat(a,"]"),"[".concat(o,"]")):n.t0);case 20:case"end":return n.stop()}}),n,null,[[9,16]])})))()},clickShowType:function(t){this.isRootFolder||(this.showType=t,t===z.ALL?an(Xp):rn(Xp,t))},clickReload:function(t){var e=this;setTimeout((function(){e._clickReload(t)}),10)},_clickReload:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.listFetchState!==Cn.Fetching){n.next=2;break}return n.abrupt("return");case 2:if(e.errorText="",e.listFetchState=Cn.Fetching,n.prev=4,r=e.pageIndex,a=e.list,t&&(r=0),0===r&&(a.splice(0),e.finish=!1),!e.isNotSupportCloudVersion){n.next=10;break}throw"-";case 10:return n.next=12,e.getFolderLogsAsync(r);case 12:0===e.pageIndex&&(e.updateTime=e.folderUpdateTimes),e.listFetchState=Cn.Success,n.next=20;break;case 16:n.prev=16,n.t0=n["catch"](4),e.listFetchState=Cn.Error,e.isNotSupportCloudVersion?e.errorText="私有云版本过低(".concat(e.cloudVersion,"),请先升级私有云部署包"):e.errorText=n.t0;case 20:case"end":return n.stop()}}),n,null,[[4,16]])})))()},getFolderLogsAsync:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c,l,u,d,h,f,m,p,v,b,g,w,x,y,k,C,S,T;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.inCloudMode){n.next=2;break}return n.abrupt("return",null);case 2:return r=new FormData,r.append("folderId",e.cloudCurrentFolderId),r.append("pageIndex",t>=0?t:0),a="getfolderlogsbyweb",n.next=8,e.fetchPostCloudApi(a,{timeout:1e4,abortKey:a,body:r});case 8:if(o=n.sent,ht(o)){n.next=11;break}throw new Error("返回值异常,无法解析数据:".concat(o));case 11:if(o.success){n.next=13;break}throw new Error(o.errMsg);case 13:s=o.data,c=s.list,l=s.users,u=s.finish,d=e.list,h={},d.forEach((function(t){h[t.id]=1})),t=o.data.pageIndex,l||(l={}),f=[],m=Date.now(),c.forEach((function(t){if(ht(t)&&!h[t.id]&&W.defined(t.type)){t.user=l[t.userid];try{t.data=JSON.parse(t.data)}catch(n){return}e.resetTimeFormatItem(t,m),t.offsetHeight=0,t.offsetTop=0,t.showMore=Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])({},z.Folder,!1),z.File,!1),z.Artboard,!1),f.push(t),h[t.id]=1}})),p=3e5,v={},b=0,g=f.length;case 25:if(!(b<g)){n.next=50;break}if(w=f[b],x=new Date(w.date),w.type===W.NetDisk_FileUploadCompleted){n.next=30;break}return n.abrupt("continue",47);case 30:y=w.userid,k=[],C=b+1;case 33:if(!(C<g)){n.next=46;break}if(S=f[C],S.type===W.NetDisk_FileUploadCompleted&&S.userid===y){n.next=37;break}return n.abrupt("break",46);case 37:if(T=Math.abs(x-new Date(S.date)),!(T>p)){n.next=40;break}return n.abrupt("break",46);case 40:k.push(S.data),v[S.id]=1,b++;case 43:C++,n.next=33;break;case 46:k.length>0&&(k.unshift(w.data),w.data=k);case 47:b++,n.next=25;break;case 50:return f.forEach((function(t){if(!v[t.id]){switch(t.type){case W.Artboard_Upload:case W.MoveTo:case W.Remove:var n,i=null!==(n=t.data)&&void 0!==n?n:{},r=i.artboards,a=i.files,o=i.folders,s=[r,a,o];s.forEach((function(t){ut(t)&&t.sort((function(t,e){return ke(null===t||void 0===t?void 0:t.name,null===e||void 0===e?void 0:e.name)}))}));break;case W.NetDisk_FileUploadCompleted:ut(t.data)&&t.data.sort((function(t,e){var n=null!==t&&void 0!==t?t:{},i=n.name,r=n.fileName,a=n.fileExt,o=null!==e&&void 0!==e?e:{},s=o.name,c=o.fileName,l=o.fileExt;return i||(i=r?r+a:""),s||(s=c?c+l:""),ke(i,s)}));break}t.visibleInFolder=e.isFolderItem(t),t.visibleInFile=e.isFileItem(t),t.visibleInArtboard=e.isArtboardItem(t),d.push(t)}})),e.finish=u,e.pageIndex=t,n.abrupt("return",c);case 54:case"end":return n.stop()}}),n)})))()},closeSelf:function(){var t=this;clearTimeout(this.closeHandle),this.closeHandle=setTimeout((function(){t.notClickClose?t.notClickClose=!1:t.logVisible=!1}),50)},needReloadOnOpen:function(){var t=this.updateTime,e=this.folderUpdateTimes;return e!=t},resetTimeFormatItem:function(t,e){try{var n,i=null!==(n=t._lastFormatTime)&&void 0!==n?n:0;if(Math.abs(e-i)<=1e4)return;t.dateStr=kt(t.date)}catch(r){t.dateStr=t.date}t._lastFormatTime=e},resetTimeFormat:function(t){var e=this,n=Date.now();(null!==t&&void 0!==t?t:this.showList).forEach((function(t){e.resetTimeFormatItem(t,n)}))},onListScroll:function(t){this.scrollTop=t.target.scrollTop},getBoxHeight:function(){if(this.logVisible){var t=this.$refs.list;t&&(this.boxHeight=t.offsetHeight)}},isFolderItem:function(t){if(Kp[t.type]){if(t.type===W.Remove||t.type===W.MoveTo){var e,n=null===(e=t.data)||void 0===e?void 0:e.folders;if(!n||0===n.length)return!1}return!0}return!1},isFileItem:function(t){if(qp[t.type]){if(t.type===W.Remove||t.type===W.MoveTo){var e,n=null===(e=t.data)||void 0===e?void 0:e.files;if(!n||0===n.length)return!1}return!0}return!1},isArtboardItem:function(t){if(Qp[t.type]){if(t.type===W.Remove||t.type===W.MoveTo){var e,n=null===(e=t.data)||void 0===e?void 0:e.artboards;if(!n||0===n.length)return!1}return!0}return!1},resetShowListItemsOffsetTop:function(){var t=this.showList,e=this.allShowListItemSelect;if(e){var n=0;t.forEach((function(t){t.offsetTop=n,n+=t.offsetHeight}))}}},computed:{allShowListItemSelect:function(){var t=this.showList;return!t.find((function(t){return 0===t.offsetHeight}))},listViewRect:function(){return{x:0,y:this.scrollTop,height:this.boxHeight,width:1e3}},listCls:function(){var t=this.showType,e=this.isRootFolder,n={};if(e)n["in-folder"]=1;else switch(t){case z.Artboard:n["in-artboard"]=1;break;case z.File:n["in-file"]=1;break;case z.Folder:n["in-folder"]=1;break;default:n["in-artboard"]=1,n["in-file"]=1,n["in-folder"]=1;break}return n},isRootFolder:function(){return 0===this.cloudCurrentFolderId},showArtboardLogNow:function(){return this.$store.state.folderPrecis.showArtboardLogNow},FetchState:function(){return Cn},EnumLogShowType:function(){return z},folderUpdateTimes:function(){return this.$store.state.cloud.folderUpdateTimes},isNotSupportCloudVersion:function(){var t=this.cloudVersion;return t&&xt(t)},artboardLogList:function(){var t=this.list;return t.filter((function(t){return t.visibleInArtboard}))},folderLogList:function(){var t=this.list;return t.filter((function(t){return t.visibleInFolder}))},fileLogList:function(){var t=this.list;return t.filter((function(t){return t.visibleInFile}))},showList:function(){if(this.isRootFolder)return this.folderLogList;switch(this.showType){case z.Artboard:return this.artboardLogList;case z.File:return this.fileLogList;case z.Folder:return this.folderLogList;default:return this.list}}},watch:{allShowListItemSelect:function(){this.resetShowListItemsOffsetTop()},showArtboardLogNow:function(t){t>0&&(this.notClickClose=!0,this.clickShowType(z.Artboard),this.logVisible=!0)},showType:function(){var t=this;this.resetShowListItemsOffsetTop(),this.$nextTick((function(){var e=t.$refs.list;e&&(e.scrollTop=0)}))},logVisible:function(t){var e=this;t?(this.$nextTick((function(){e.getBoxHeight()})),window.addEventListener("click",this.closeSelf,!0),this.needReloadOnOpen()?this.clickReload(!0):this.resetTimeFormat()):(this.notClickClose=!1,clearTimeout(this.closeHandle),window.removeEventListener("click",this.closeSelf,!0))}},data:function(){return{finish:!1,scrollTop:0,boxHeight:0,lineHeight:65,listFetchState:Cn.Normal,logVisible:!1,closeHandle:0,notClickClose:!1,updateTime:0,showType:z.ALL,errorText:"",pageIndex:0,list:[]}},mounted:function(){var t=nn(Xp,!0);switch(t){case z.Artboard:case z.File:case z.Folder:this.showType=t;break}this.getBoxHeight()},beforeDestroy:function(){window.removeEventListener("click",this.closeSelf,!0),clearTimeout(this.closeHandle)}},Zp=Jp,tv=(n("b330"),Object(wo["a"])(Zp,Em,Nm,!1,null,"0bc632c3",null)),ev=tv.exports,nv=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"pop-helper",on:{click:function(e){t.notClickClose=!0}}},[e("div",{staticClass:"box"},[t.inInteractionMode?e("div",{staticClass:"scene"},[e("h5",[t._v("原型预览快捷键")]),t._m(0),t._m(1),t._m(2),e("dl",{staticClass:"text"},[e("dt",[t._v("切换到上1个画板")]),e("dd",[e("span",{staticClass:"key"},[t._v(t._s(t.commandKey))]),e("span",[t._v("+")]),e("span",{staticClass:"key"},[t._v("↑")])])]),e("dl",{staticClass:"text"},[e("dt",[t._v("切换到下1个画板")]),e("dd",[e("span",{staticClass:"key"},[t._v(t._s(t.commandKey))]),e("span",[t._v("+")]),e("span",{staticClass:"key"},[t._v("↓")])])])]):e("div",{staticClass:"scene"},[e("h5",[t._v("场景快捷键")]),t._m(3),t._m(4),e("dl",{staticClass:"text"},[e("dt",[t._v("缩放视图")]),e("dd",[e("span",{staticClass:"key"},[t._v("鼠标滚轮")]),e("span",[t._v("+")]),e("span",{staticClass:"key"},[t._v(t._s(t.commandKey))])])]),t._m(5),e("h5",[t._v("画板详情快捷键")]),t._m(6),t._m(7),t._m(8),e("dl",{staticClass:"text"},[e("dt",[t._v("切换到上1个画板")]),e("dd",[e("span",{staticClass:"key"},[t._v(t._s(t.commandKey))]),e("span",[t._v("+")]),e("span",{staticClass:"key"},[t._v("↑")])])]),e("dl",{staticClass:"text"},[e("dt",[t._v("切换到下1个画板")]),e("dd",[e("span",{staticClass:"key"},[t._v(t._s(t.commandKey))]),e("span",[t._v("+")]),e("span",{staticClass:"key"},[t._v("↓")])])]),e("h5",[t._v("获取指定2个节点坐标关系")]),e("div",{staticClass:"text"},[t._v("1.左键单击选择1个节点.")]),t._m(9),e("div",{staticClass:"text"},[t._v("*多次单击可穿透选中下方被遮挡节点")])]),e("div",{staticClass:"home"},[e("b",[t._v("@标记狮")]),t._v(" "),e("a",{attrs:{href:t.homepage,target:"_blank"}},[t._v("www.marklion.cn")])])])]):t._e()},iv=[function(){var t=this,e=t._self._c;return e("dl",{staticClass:"text"},[e("dt",[t._v("屏幕全屏切换")]),e("dd",[e("span",{staticClass:"key"},[t._v("F1")])])])},function(){var t=this,e=t._self._c;return e("dl",{staticClass:"text"},[e("dt",[t._v("网页全屏切换")]),e("dd",[e("span",{staticClass:"key"},[t._v("F2")])])])},function(){var t=this,e=t._self._c;return e("dl",{staticClass:"text"},[e("dt",[t._v("显隐左侧边栏")]),e("dd",[e("span",{staticClass:"key"},[t._v("F3")])])])},function(){var t=this,e=t._self._c;return e("dl",{staticClass:"text"},[e("dt",[t._v("上下视图平移")]),e("dd",[e("span",{staticClass:"key"},[t._v("鼠标滚轮")])])])},function(){var t=this,e=t._self._c;return e("dl",{staticClass:"text"},[e("dt",[t._v("左右视图平移")]),e("dd",[e("span",{staticClass:"key"},[t._v("鼠标滚轮")]),e("span",[t._v("+")]),e("span",{staticClass:"key"},[t._v("shift")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text"},[e("span",[t._v("缩放/平移视图时同时按下")]),e("span",{staticClass:"key"},[t._v("alt")]),e("span",[t._v("键可加速操作")])])},function(){var t=this,e=t._self._c;return e("dl",{staticClass:"text"},[e("dt",[t._v("切换到画板列表")]),e("dd",[e("span",{staticClass:"key"},[t._v("F1")])])])},function(){var t=this,e=t._self._c;return e("dl",{staticClass:"text"},[e("dt",[t._v("切换到图层列表")]),e("dd",[e("span",{staticClass:"key"},[t._v("F2")])])])},function(){var t=this,e=t._self._c;return e("dl",{staticClass:"text"},[e("dt",[t._v("显隐左侧边栏")]),e("dd",[e("span",{staticClass:"key"},[t._v("F3")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"text"},[e("span",[t._v("2.按住")]),e("span",{staticClass:"key"},[t._v("shift")]),e("span",[t._v(",左键单击需要比对的节点.")])])}],rv={methods:{clickHelper:function(t){this.$store.commit("setHelperVisible",t)},closeSelf:function(){var t=this;clearTimeout(this.closeHandle),this.closeHandle=setTimeout((function(){t.notClickClose?t.notClickClose=!1:t.clickHelper(!1)}),50)}},computed:{homepage:function(){var t;return this.curArtboard&&(t=this.curArtboard.artboard.mlConfig.softVersion),t||(t=this.$store.state.config.softVer),"https://www.marklion.cn/?invoke=MarkLion.Output".concat(dt(t)?"&ver=".concat(t):"")},commandKey:function(){return this.inMacOS?"command":"ctrl"},visible:function(){return this.$store.state.helper.visible}},data:function(){return{closeHandle:0,notClickClose:!1}},watch:{visible:function(t){t?window.addEventListener("click",this.closeSelf,!0):(this.notClickClose=!1,clearTimeout(this.closeHandle),window.removeEventListener("click",this.closeSelf,!0))}},beforeDestroy:function(){window.removeEventListener("click",this.closeSelf,!0),clearTimeout(this.closeHandle)}},av=rv,ov=(n("13c2"),Object(wo["a"])(av,nv,iv,!1,null,"0e8e3626",null)),sv=ov.exports,cv=function(){var t=this,e=t._self._c;return e("div",{staticClass:"path-nav"},[t.inCloudMode?e("CloudFolders"):t._e(),e("div",{staticClass:"navs"},t._l(t.navs,(function(n,i){return e("div",{key:i,staticClass:"nav-item",class:{"no-link":!n.link}},[e("div",{staticClass:"name",attrs:{title:n.name},on:{click:function(e){return t.clickNav(n)}}},[t._v(t._s(n.name))]),t.showArtboardPages&&n.selectPages?e("PathNavArtboardPages"):t._e()],1)})),0)],1)},lv=[],uv=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cloud-folders"},[e("div",{staticClass:"nav-home"},[e("div",{staticClass:"btn-home",on:{click:function(e){return t.clickGoHome()}}}),e("div",{staticClass:"line"}),e("div",{staticClass:"btn-cloud-folders",class:{on:t.allFoldersBoxVisible},on:{click:function(e){return t.setAllFoldersBoxVisible(!t.allFoldersBoxVisible,!0)}}})]),e("CloudFoldersBox",{on:{hideBox:t.hideBox}})],1)},dv=[],hv=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.allFoldersBoxVisible,expression:"allFoldersBoxVisible"}],staticClass:"cloud-folders-box",class:{"search-tip":!t.isSupportWebItemSearch},on:{click:function(e){t.notAutoHideThisTime=!0}}},[e("div",{staticClass:"head"},[t.isSupportWebItemSearch?t._e():e("div",{staticClass:"update-tip"},[e("a",{attrs:{target:"_blank",href:t.cloudPageUrl}},[t._v("升级私有云部署包")]),t._v("可全局搜索画板、文件")]),e("div",{staticClass:"filters"},[e("div",{staticClass:"search"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],attrs:{autocomplete:"off",type:"text",placeholder:t.searchInputDefaultText,maxlength:"20",spellcheck:"false"},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),t.inSearchMode?e("a",{staticClass:"btn-clear",attrs:{href:"javascript:;"},on:{click:t.cleanSearchText}}):t._e()]),t.inCloudMode&&!t.inSearchMode?e("FolderNavSortMenu",{attrs:{mini:!0}}):t._e()],1)]),e("div",{ref:"box",staticClass:"box",on:{scroll:t.onBoxScroll}},[e("div",{staticClass:"real-height",class:{"in-search":t.inSearchMode},style:{height:t.boxRealHeight}},[t.fetchState===t.FetchState.Fetching||t.fetchState===t.FetchState.Error?e("div",{staticClass:"error"},[e("NetworkLoading",{attrs:{loadText:"正在获取文件夹信息...",errorText:t.errorText,isLoading:t.fetchState===t.FetchState.Fetching,isError:t.fetchState===t.FetchState.Error,reLoadText:"刷新"},on:{reload:function(e){return t.clickReload()}}})],1):t.isSupportWebItemSearch&&t.inSearchMode&&(t.searchState===t.FetchState.Fetching||t.searchState===t.FetchState.Error)?e("div",{staticClass:"error"},[e("NetworkLoading",{attrs:{loadText:"正在搜索关键词 ".concat(t.searchText),errorText:t.searchErrorText,isLoading:t.searchState===t.FetchState.Fetching,isError:t.searchState===t.FetchState.Error,reLoadText:"刷新"},on:{reload:function(e){return t.goSearch()}}})],1):0===t.showList.length?e("div",{staticClass:"empty",domProps:{textContent:t._s(t.emptyText)}}):e("div",{staticClass:"front",style:t.frontStyle},[t._l(t.showList,(function(n){return[n.isArtboard?e("CloudArtboardItem",{key:n.key,attrs:{artboard:n.folder,searchText:t.searchText,inSearchMode:t.inSearchMode},on:{hideBoxNotClean:t.hideBoxNotClean,cleanSearchText:t.cleanSearchText,onContextMenu:t.onContextMenu,clickGoParentFolder:t.clickGoParentFolder}}):n.isFile?e("CloudFileItem",{key:n.key,attrs:{file:n.folder,searchText:t.searchText,inSearchMode:t.inSearchMode},on:{hideBoxNotClean:t.hideBoxNotClean,cleanSearchText:t.cleanSearchText,onContextMenu:t.onContextMenu,clickGoParentFolder:t.clickGoParentFolder}}):e("CloudFolderItem",{key:n.key,attrs:{folder:n.folder,inSearchMode:t.inSearchMode,searchText:t.searchText,isSupportNetDiskFile:t.isSupportNetDiskFile},on:{hideBoxNotClean:t.hideBoxNotClean,cleanSearchText:t.cleanSearchText,onContextMenu:t.onContextMenu,clickGoParentFolder:t.clickGoParentFolder}})]}))],2)])]),t.contextMenu.visible?e("CloudItemMenu",{attrs:{x:t.contextMenu.x,y:t.contextMenu.y,item:t.contextMenu.item},on:{close:t.hideContextMenu,cleanSearchText:t.cleanSearchText,clickGoParentFolder:t.clickGoParentFolder}}):t._e()],1)},fv=[],mv=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cloud-item cloud-folder-item",class:t.itemClass,attrs:{title:t.title},on:{contextmenu:function(e){return e.preventDefault(),t.onContextMenu.apply(null,arguments)}}},[e("div",{staticClass:"info",on:{click:function(e){return e.target!==e.currentTarget?null:t.clickGoFold.apply(null,arguments)}}},[e("div",{staticClass:"triangle",class:{on:!t.inSearchMode&&t.hasChild},style:t.style,attrs:{title:"展开/收起"},on:{click:t.clickChildVisible}}),e("div",{staticClass:"icon",class:{private:t.isFolderSharePrivateCode,"share-sm":t.isFolderShareSpecifyMembers},on:{click:t.clickChildVisible}}),e("div",{staticClass:"name",on:{click:t.clickGoFold}},[t._l(t.texts,(function(n,i){return e("span",{key:i,class:{light:n.light}},[t._v(t._s(n.text))])})),e("span",{staticClass:"art-count"},[t._v(t._s(t.countText))])],2)]),t.inSearchMode?e("ItemFolderParents",{attrs:{item:t.folder},on:{clickItem:t.clickGoFold,clickGoParentFolder:t.clickGoParentFolder}}):t._e()],1)},pv=[],vv=function(){var t=this,e=t._self._c;return t.showAllParents||t.showOnlyParent?e("div",{staticClass:"parents",on:{click:function(e){return e.target!==e.currentTarget?null:t.clickItem(t.item)}}},[t.showAllParents?t._l(t.item.parents,(function(n,i){return e("div",{key:i},[e("span",{on:{click:function(e){return e.target!==e.currentTarget?null:t.clickGoParentFolder({parentId:n.id})}}},[t._v(t._s(n.name))])])})):t.showOnlyParent?[t.item.parentId>0?e("span",[t._v("...")]):t._e(),e("div",[e("span",{on:{click:function(e){return t.clickGoParentFolder(t.item)}}},[t._v(t._s(t.item.parent.name))])])]:t._e()],2):t._e()},bv=[],gv={methods:{clickItem:function(t){this.$emit("clickItem",t)},clickGoParentFolder:function(t){this.$emit("clickGoParentFolder",t)}},computed:{showAllParents:function(){return!!this.item.parents},showOnlyParent:function(){return!this.showAllParents&&!!this.item.parent}},props:{item:Object}},wv=gv,xv=(n("813d"),Object(wo["a"])(wv,vv,bv,!1,null,"4e0cf502",null)),yv=xv.exports,kv={components:{ItemFolderParents:yv},methods:{clickGoParentFolder:function(t){this.$emit("clickGoParentFolder",t)},onContextMenu:function(t){this.inSearchMode&&this.$emit("onContextMenu",t,{item:this.folder,isFolder:!0})},clickChildVisible:function(){var t,e,n=this.folder,i=this.inSearchMode,r=this.hasChild;if(!i&&r){var a=!n.childsVisible;if(n.childsVisible=a,0!==(null!==(t=null===(e=n.childs)||void 0===e?void 0:e.length)&&void 0!==t?t:0)&&0!==n.id){var o=on(P,!0);ht(o)||(o={});var s=n.id;a?o[s]=1:delete o[s],sn(P,o)}}},clickGoFold:function(){var t=this.folder.id,e=this.inArtboardMode,n=this.cloudCurrentFolderId;if(n===t)return e&&this.setCurArtboard(null),void this.$emit("cleanSearchText");tn(t)}},computed:{useTimeSort:function(){return this.$store.state.cloudListSort.sortType===D.Date},isFolderSharePrivateCode:function(){return this.folder.shareMode===Y.PrivateCode},isFolderShareSpecifyMembers:function(){return this.folder.shareMode===Y.SpecifyMembers},userSpecifyMemberAuthority:function(){var t;return null!==(t=this.folder.userSpecifyMemberAuthority)&&void 0!==t?t:X.ReadWrite},itemClass:function(){var t=this.folder,e=this.currentSelect,n=this.hasChild,i=this.inSearchMode,r={on:e,open:t.childsVisible&&n,max:i};if(null!=t.color){var a=H.getName(t.color);a&&(r[a]=1)}return r},texts:function(){var t=this.folder.name;return this.inSearchMode?Ln(t,this.searchText):[{light:!1,text:t}]},countText:function(){var t,e=this.folder,n=this.useTimeSort,i=this.inSearchMode;return"(".concat(n&&!i?kt(e.updateTimes):e.artboardCount+(null!==(t=e.fileCount)&&void 0!==t?t:0)+e.folderCount,")")},title:function(){return ua(this.folder)},hasChild:function(){var t,e=this.folder.childs;return(null!==(t=null===e||void 0===e?void 0:e.length)&&void 0!==t?t:0)>0},style:function(){var t=this.folder.deepCount;return null==t&&(t=0),this.inSearchMode&&(t=0),{"padding-left":t*this.deepPadding+"px"}},currentSelect:function(){var t=this.cloudCurrentFolderId,e=this.folder;return t===e.id}},data:function(){return{deepPadding:16}},props:{folder:Object,inSearchMode:Boolean,searchText:String,isSupportNetDiskFile:Boolean}},Cv=kv,Sv=(n("ed29"),Object(wo["a"])(Cv,mv,pv,!1,null,"4b91d816",null)),Tv=Sv.exports,Av=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cloud-item cloud-artboard-item",class:{on:t.currentSelect,max:t.inSearchMode},attrs:{title:t.title},on:{contextmenu:function(e){return e.preventDefault(),t.onContextMenu.apply(null,arguments)}}},[e("div",{staticClass:"info",on:{click:t.clickGoArtboard}},[e("div",{staticClass:"icon"}),e("div",{staticClass:"name"},t._l(t.texts,(function(n,i){return e("span",{key:i,class:{light:n.light}},[t._v(t._s(n.text))])})),0)]),t.inSearchMode?e("ItemFolderParents",{attrs:{item:t.artboard},on:{clickItem:t.clickGoArtboard,clickGoParentFolder:t.clickGoParentFolder}}):t._e()],1)},Iv=[],Fv={components:{ItemFolderParents:yv},methods:{clickGoParentFolder:function(t){this.$emit("clickGoParentFolder",t)},onContextMenu:function(t){this.inSearchMode&&this.$emit("onContextMenu",t,{item:this.artboard,isArtboard:!0})},clickGoArtboard:function(){var t=this.artboard,e=t.parentId,n=t.guid,i=t.viewUrl,r=this.cloudCurrentFolderId,a=this.curArtboardGuid;if(r!==e)location.href=i;else if(a!=n){var o=this.documentArtboards.find((function(t){var e;return(null===(e=t.artboard)||void 0===e?void 0:e.guid)===n}));if(o)return this.setCurArtboard(o),void this.$emit("cleanSearchText");location.href=i}}},computed:{texts:function(){return Ln(this.artboard.name,this.searchText)},title:function(){return fa(this.artboard)},currentSelect:function(){var t=this.cloudCurrentFolderId,e=this.artboard,n=this.curArtboardGuid;return t===e.parentId&&n===e.guid}},props:{artboard:Object,inSearchMode:Boolean,searchText:String}},Mv=Fv,Ov=(n("45b3"),Object(wo["a"])(Mv,Av,Iv,!1,null,"36123570",null)),_v=Ov.exports,Lv=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cloud-item cloud-file-item",class:{max:t.inSearchMode,on:t.currentSelect},attrs:{title:t.title},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickGoFile.apply(null,arguments)},contextmenu:function(e){return e.preventDefault(),t.onContextMenu.apply(null,arguments)}}},[e("div",{staticClass:"info",on:{click:t.clickGoFile}},[e("span",{staticClass:"icon-netdiskfile",class:t.iconCls}),e("div",{staticClass:"name"},t._l(t.texts,(function(n,i){return e("span",{key:i,class:{light:n.light}},[t._v(t._s(n.text))])})),0)]),t.inSearchMode?e("ItemFolderParents",{attrs:{item:t.file},on:{clickItem:t.clickGoFile,clickGoParentFolder:t.clickGoParentFolder}}):t._e()],1)},Pv=[],Ev={components:{ItemFolderParents:yv},methods:{clickGoParentFolder:function(t){this.$emit("clickGoParentFolder",t)},onContextMenu:function(t){this.inSearchMode&&this.$emit("onContextMenu",t,{item:this.file,isFile:!0})},clickGoFile:function(){this.clickNetDiskFile(this.file)}},computed:{texts:function(){return Ln(this.file.name,this.searchText)},iconCls:function(){var t=this.file;return t?V.getName(t.fileType,R.Small):null},title:function(){return ha(this.file)},currentSelect:function(){var t=this.cloudCurrentFolderId,e=this.file,n=this.curNetDiskFile;return t===e.parentId&&(null===n||void 0===n?void 0:n.viewUrl)===e.viewUrl}},props:{file:Object,inSearchMode:Boolean,searchText:String}},Nv=Ev,Dv=(n("2655"),Object(wo["a"])(Nv,Lv,Pv,!1,null,"097f4af8",null)),jv=Dv.exports,Rv=function(){var t=this,e=t._self._c;return t.item?e("div",{staticClass:"cloud-item-menu",style:t.menuStyle,on:{contextmenu:function(t){t.preventDefault()}}},[t.item.isFile?[t.canOnlineView?e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickNetDiskFile(t.item.item)}}},[t._v("在线查看")]):t._e(),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.copyViewUrl(t.item.item)}}},[t._v("复制链接")]),e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownloadNetDiskFile(t.item.item)}}},[t._v("下载文件")])]:t._e(),t.item.isArtboard?e("a",{attrs:{href:"javascript:;"},on:{click:t.clickGoArtboard}},[t._v("查看画板")]):t._e(),e("a",{attrs:{href:"javascript:;"},on:{click:t.clickGoParentFolder}},[t._v("前往所在文件夹")])],2):t._e()},Vv=[],Bv={methods:{close:function(){this.$emit("close")},copyViewUrl:function(t){var e=t.viewUrl;0===e.indexOf("/")&&(e=location.origin+e),dn(e)?this.showTextTip("链接已复制到剪切板"):this.showTextTip("链接复制到剪切板失败")},clickGoArtboard:function(){var t=this.item.item,e=t.parentId,n=t.guid,i=t.viewUrl,r=this.cloudCurrentFolderId,a=this.curArtboardGuid;if(r!==e)location.href=i;else if(a!=n){var o=this.documentArtboards.find((function(t){var e;return(null===(e=t.artboard)||void 0===e?void 0:e.guid)===n}));if(o)return this.setCurArtboard(o),void this.$emit("cleanSearchText");location.href=i}},clickGoParentFolder:function(){this.$emit("clickGoParentFolder",this.item.item)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.close()}),150))},initEvent:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},computed:{canOnlineView:function(){var t,e=this.item;return!!e&&(!!e.isFile&&V.isSupportOnlineViewType(null===(t=e.item)||void 0===t?void 0:t.fileType))},menuStyle:function(){return{top:this.y+"px",left:this.x+"px"}}},watch:{item:function(t){this.initEvent(!!t)}},data:function(){return{handle:0}},props:{item:Object,x:Number,y:Number},beforeDestroy:function(){this.initEvent(!1)},created:function(){this.initEvent(!!this.item)}},Uv=Bv,Hv=(n("0085"),Object(wo["a"])(Uv,Rv,Vv,!1,null,"359f511d",null)),Wv=Hv.exports,$v={components:{CloudFolderItem:Tv,NetworkLoading:$l,CloudArtboardItem:_v,CloudFileItem:jv,CloudItemMenu:Wv,FolderNavSortMenu:Ch},methods:{clickGoParentFolder:function(t){var e=t.parentId,n=this.inArtboardMode,i=this.cloudCurrentFolderId,r=this.inCloudViewerMode;if(r&&i===e)return n&&this.setCurArtboard(null),void this.cleanSearchText();tn(e)},hideContextMenu:function(){this.contextMenu.visible=!1},onContextMenu:function(t,e){if(e){var n=this.contextMenu,i=t.pageX,r=t.pageY;n.x=i,n.y=r,n.visible=!0,n.item=e}},cleanSearchText:function(){this.searchText=""},clickReload:function(){mt(this.cloudVersion)?document.location.reload():this.getFoldersData()},hideBoxNotClean:function(){this.$emit("hideBox")},getFoldersData:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.allFoldersBoxVisible){e.next=2;break}return e.abrupt("return");case 2:if(t.fetchState!==Cn.Fetching){e.next=4;break}return e.abrupt("return");case 4:return t.fetchState=Cn.Fetching,t.errorText=null,e.prev=6,e.next=9,t.getAllFolders(!1,!0);case 9:n=e.sent,t.fetchState=Cn.Success,t.folderData=n,t.scrollToCurrentFolder(),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](6),t.fetchState=Cn.Error,t.errorText=e.t0;case 19:case"end":return e.stop()}}),e,null,[[6,15]])})))()},scrollToCurrentFolder:function(){var t=this.cloudCurrentFolderId,e=this.renderList,n=this.lineHeight,i=this.boxHeight,r=this.boxScrollTop,a=this.folderData,o=this.inSearchMode,s=e.findIndex((function(e){return e.id===t}));if(-1===s&&!o){var c=a.folders.find((function(e){return e.id===t}));if(null!=c){var l={};while(c&&!l[c.id])l[c.id]=1,c.id>0&&0!==c.childs.length&&(c.childsVisible=!0),c=c.parent;s=this.renderList.findIndex((function(e){return e.id===t}))}}if(-1!==s){var u=Math.round(s*n-i/2);u!==r&&this.setScrollTop(u)}},setScrollTop:function(t){var e=this;this.$nextTick((function(){var n=e.$refs.box;n&&(n.scrollTop=t)}))},getFolderVisible:function(t){if(!t)return!1;if(!(t.id>=0))return!1;if(t.id>0&&!t.parent)return!1;while(null!=(t=t.parent))if(!t.childsVisible)return!1;return!0},resetBoxData:function(){var t=this;this.allFoldersBoxVisible&&this.$nextTick((function(){var e=t.$refs.box;e&&(t.boxHeight=e.offsetHeight,t.boxScrollTop=e.scrollTop)}))},onResize:function(){this.resetBoxData()},onBoxScroll:function(){var t=this.$refs.box;t&&(this.boxScrollTop=t.scrollTop)},goSearch:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isSupportWebItemSearch){e.next=2;break}return e.abrupt("return");case 2:if(n=t.searchText,dt(n)){e.next=5;break}return e.abrupt("return");case 5:return r=t.searchStatus=Me(),t.searchState=Cn.Fetching,e.prev=7,e.next=10,t.searchWebItem(n);case 10:if(a=e.sent,r==t.searchStatus){e.next=13;break}return e.abrupt("return");case 13:if(ut(a)){e.next=15;break}throw new Error("返回值格式异常");case 15:t.searchState=Cn.Success,t.searchData=a,e.next=25;break;case 19:if(e.prev=19,e.t0=e["catch"](7),r==t.searchStatus){e.next=23;break}return e.abrupt("return");case 23:t.searchErrorText=e.t0,t.searchState=Cn.Error;case 25:case"end":return e.stop()}}),e,null,[[7,19]])})))()}},computed:{cloudPageUrl:function(){return"https://www.marklion.cn/cloud.shtml?invoke=MarkLion.WebSearch&ver=".concat(this.cloudVersion,"&deploy=1")},searchInputDefaultText:function(){return this.isSupportWebItemSearch?"搜索文件夹、文件和画板":"搜索文件夹"},isSupportWebItemSearch:function(){return this.inCloudMode&&!gt(this.cloudVersion)},isSupportNetDiskFile:function(){return this.inCloudMode&&!pt(this.cloudVersion)},emptyText:function(){return this.isSupportWebItemSearch?this.inSearchMode?'未找到包含 "'.concat(this.searchText,'" 的文件夹、文件或画板'):"没有找到文件夹、文件或画板":this.inSearchMode?'未找到文件夹名包含 "'.concat(this.searchText,'" 的文件夹'):"没有找到文件夹"},boxRealHeight:function(){return this.renderList.length*this.lineHeight+2+"px"},inSearchMode:function(){return this.searchText.length>0},frontStyle:function(){var t=this.showList,e=this.lineHeight,n=0;if(t.length>0){var i=t[0].index;n=i*e}return{"margin-top":n+"px"}},showList:function(){var t=this.renderList,e=this.preloadCount,n=this.lineHeight,i=this.boxScrollTop,r=this.boxHeight,a=e*n,o=new ee,s=(new ee).set(0,i-a,100,r+2*a),c=[];return t.forEach((function(t,e){var i;(o.set(0,e*n,100,n),ce(o,s))&&c.push({folder:t,index:e,key:null!==(i=t.id)&&void 0!==i?i:t.url,isArtboard:t.localSearchType===B.Artboard,isFile:t.localSearchType===B.File})})),c},renderList:function(){var t,e=this,n=this.fetchState,i=this.inSearchMode,r=this.cloudListSort,a=this.folderData;if(n!==Cn.Success)return[];if(i){if(this.isSupportWebItemSearch){var o=this.searchState,s=this.searchData;return o==Cn.Success?s:[]}var c=this.searchText;c=c.toLowerCase(),t=a.folders.filter((function(t){return-1!==t.nameLower.indexOf(c)}))}else t=a.sortBy(r).filter((function(t){return e.getFolderVisible(t)}));return t},lineHeight:function(){return this.inSearchMode?46:32},cloudListSort:function(){return this.$store.state.cloudListSort},cloudListSortKey:function(){var t=this.cloudListSort;return"".concat(t.sortType,":").concat(t.orderDesc)}},watch:{cloudListSortKey:function(){this.scrollToCurrentFolder()},searchText:function(t){t&&this.setScrollTop(0),this.goSearch()},allFoldersBoxVisible:function(){this.resetBoxData(),this.getFoldersData()}},data:function(){return{notAutoHideThisTime:!1,FetchState:Cn,folderData:null,fetchState:Cn.Normal,errorText:null,searchText:"",boxHeight:0,boxScrollTop:0,preloadCount:1,searchState:Cn.Normal,searchErrorText:null,searchData:null,searchHandle:0,searchStatus:null,contextMenu:{visible:!1,x:0,y:0,item:null}}},created:function(){window.addEventListener("resize",this.onResize)},beforeDestroy:function(){clearTimeout(this.autoHideHandle),window.removeEventListener("resize",this.onResize)},mounted:function(){this.resetBoxData(),this.getFoldersData()}},Gv=$v,zv=(n("c5ca"),Object(wo["a"])(Gv,hv,fv,!1,null,"7d0e6606",null)),Yv=zv.exports,Xv={components:{CloudFoldersBox:Yv},methods:{clickGoHome:function(){tn(0)},hideBox:function(){this.setAllFoldersBoxVisible(!1,!1)},setAllFoldersBoxVisible:function(t,e){this.$store.commit("setAllFoldersBoxVisible",t),e&&cn(P)}},computed:{allFoldersBoxVisible:function(){return this.$store.state.cloud.allFoldersBoxVisible}},watch:{inArtboardMode:function(){this.hideBox()}}},Kv=Xv,qv=(n("1845"),Object(wo["a"])(Kv,uv,dv,!1,null,"6f4b835f",null)),Qv=qv.exports,Jv=function(){var t=this,e=t._self._c;return e("div",{staticClass:"select-artboard-page",attrs:{title:"点击切换显示的页面"}},[e("div",{staticClass:"page-current",on:{click:function(e){t.visible=!t.visible}}},[t._v(t._s(t.currentPageName))]),t.visible?e("ul",{staticClass:"page-list"},[e("li",{class:{on:!t.filterDocumentGuid},on:{click:function(e){return t.clickItem(null)}}},[t._v(" "+t._s(t.allPageName)),e("span",{staticClass:"art-count"},[t._v("("+t._s(t.documentArtboards.length)+")")])]),t._l(t.sortDocumentsWithSketchDocument,(function(n){return[n.docSeparator?e("li",{key:n.guid+"_sep",staticClass:"sep"}):t._e(),e("li",{key:n.guid,class:{on:t.filterDocumentGuid===n.guid},on:{click:function(e){return t.clickItem(n)}}},[t._v(" "+t._s(n.docFullName)),e("span",{staticClass:"art-count"},[t._v("("+t._s(n.arts.length)+")")])])]}))],2):t._e()])},Zv=[],tb={methods:{clickItem:function(t){var e,n=null!==(e=null===t||void 0===t?void 0:t.guid)&&void 0!==e?e:null;this.$store.commit("setFilterDocumentGuid",n)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.visible=!1}),100))}},computed:{sortDocumentsWithSketchDocument:function(){return this.$store.state.sortDocumentsWithSketchDocument},currentPageName:function(){var t,e,n,i=this.filterDocumentGuid;return i&&(n=this.sortDocumentsWithSketchDocument.find((function(t){return t.guid===i}))),null!==(t=null===(e=n)||void 0===e?void 0:e.name)&&void 0!==t?t:this.allPageName}},watch:{visible:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},data:function(){return{allPageName:"全部页面",visible:!1,handle:0}},beforeDestroy:function(){clearTimeout(this.handle),window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0)}},eb=tb,nb=(n("8747"),Object(wo["a"])(eb,Jv,Zv,!1,null,"4004b23c",null)),ib=nb.exports,rb={components:{CloudFolders:Qv,PathNavArtboardPages:ib},methods:{clickNav:function(t){t.link&&setTimeout((function(){t.link()}),100)}},computed:{showArtboardPages:function(){return!this.inNetDiskFileMode&&this.documents.length>1},navs:function(){var t=this,e=[],n=this.inCloudMode,i=this.inArtboardMode,r=this.curArtboard,a=this.cloudCurrentFolderId,o=this.curNetDiskFile,s=this.inNetDiskFileMode;if(n){var c=this.cloudName,l=this.cloudParentFolder;i||(0===a?e.push({name:c||"私有云根目录",link:null}):l&&e.push({name:0===l.id&&c||l.name,id:l.id,link:function(){tn(this.id)}}))}if(n&&this.cloudFolderNotFound?e.push({name:this.cloudFolderInSpecify?"没有访问权限":"链接已失效",link:null}):n&&0==a||e.push({name:this.documentName,selectPages:!0,link:i?function(){t.setCurArtboard(null)}:s?function(){tn(a)}:null}),i){var u,d,h=null!==(u=null===r||void 0===r||null===(d=r.artboard)||void 0===d?void 0:d.name)&&void 0!==u?u:"";h&&e.push({name:h,link:null})}else if(s){var f,m=null!==(f=null===o||void 0===o?void 0:o.name)&&void 0!==f?f:"";m&&e.push({name:m,link:null})}return e}}},ab=rb,ob=(n("a1ca"),Object(wo["a"])(ab,cv,lv,!1,null,"30707106",null)),sb=ob.exports,cb=function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-info"},[e("div",{staticClass:"nickname",class:{on:t.menuVisible},attrs:{title:t.showTitle},on:{click:t.clickShowMenu}},[e("UserFace",{attrs:{canClick:!1}})],1),t.menuVisible?e("menu",{on:{click:t.clickMenu}},[t.cloudIsLogin?[e("div",{staticClass:"u-info",attrs:{title:t.showTitle}},[e("div",{staticClass:"name"},[t._v(t._s(t.showName))]),e("div",{staticClass:"email"},[t._v(t._s(t.showEmail))])]),e("div",{staticClass:"line"}),e("a",{staticClass:"item btn-nickname",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickSetNickName()}}},[t._v("修改昵称")])]:t._e(),t.inCloudViewerMode?[e("div",{staticClass:"item",attrs:{title:"在[画布视图]模式中开启极速渲染模式,画板再多也不卡顿更流畅"},on:{click:t.clickArtRenderInCanvasMode}},[t._v(" 极速模式 "),e("Checkbox2",{attrs:{text:"",selected:t.artRenderInCanvasMode},on:{click:t.clickEmpty}})],1),t.inArtboardMode?t._e():e("div",{staticClass:"item",attrs:{title:"在列表页的[画布视图]模式中, 展示从XD/Sketch/Figma导出的原型连线"},on:{click:t.clickArtboardShowInteractionLine}},[t._v(" 显示原型连线 "),e("Checkbox2",{attrs:{text:"",selected:t.artboardShowInteractionLine},on:{click:t.clickEmpty}})],1),t.inArtboardMode?e("div",{staticClass:"item",attrs:{title:"启用后, 带评注的评论将在[标注]模式下通过浮层展示"},on:{click:t.clickPointCommentShowAlways}},[t._v(" 标注显示评注 "),e("Checkbox2",{attrs:{text:"",selected:t.pointCommentShowAlways},on:{click:t.clickEmpty}})],1):t._e()]:t._e(),t.inInteractionMode?[e("div",{staticClass:"item",attrs:{title:"开启后,热区将一直显示在原型所在节点上"},on:{click:t.clickInteractionRectAlwaysVisible}},[t._v(" 原型热区常显 "),e("Checkbox2",{attrs:{text:"",selected:t.interactionRectAlwaysVisible},on:{click:t.clickEmpty}})],1)]:t._e(),t.inNetDiskFileMode?t._e():e("div",{staticClass:"line"}),t.cloudIsLogin?e("a",{staticClass:"item btn-logout",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickLogout()}}},[t._v("退出登录")]):e("a",{staticClass:"button light login",attrs:{href:"javascript:;"},on:{click:t.clickLogin}},[t._v("登录")])],2):t._e()])},lb=[],ub=function(){var t=this,e=t._self._c;return e("div",{staticClass:"userface",class:{on:t.canClick},attrs:{title:t.title},on:{click:function(e){return e.stopPropagation(),t.clickUserFace.apply(null,arguments)}}},[t.showIcon?e("div",{staticClass:"icon"}):e("div",{staticClass:"user",class:{tourist:!t.cloudUserIsDesigner}},[t._v(t._s(t.iconText))])])},db=[],hb={methods:{clickUserFace:function(){this.$emit("click")}},computed:{showIcon:function(){return!this.cloudIsLogin},iconText:function(){if(!this.cloudIsLogin)return"";var t=this.cloudNickName;return dt(t)||(t=this.cloudUserEmail),t[t.length-1]}},props:{title:String,canClick:Boolean}},fb=hb,mb=(n("e5e8"),Object(wo["a"])(fb,ub,db,!1,null,"791fdf67",null)),pb=mb.exports,vb=function(){var t=this,e=t._self._c;return e("label",{staticClass:"checkbox2",class:{on:t.selected},on:{click:t.click}},[t.text?e("i",{staticClass:"text"},[t._v(t._s(t.text))]):t._e(),t._m(0)])},bb=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"rect-icon"},[e("i")])}],gb={props:{text:String,selected:Boolean},methods:{click:function(){this.$emit("click",!this.selected)}}},wb=gb,xb=Object(wo["a"])(wb,vb,bb,!1,null,null,null),yb=xb.exports,kb={components:{UserFace:pb,Checkbox2:yb},methods:{clickEmpty:function(){},clickInteractionRectAlwaysVisible:function(){this.$store.commit("setInteractionRectAlwaysVisible",!this.interactionRectAlwaysVisible)},clickPointCommentShowAlways:function(){this.$store.commit("pointCommentShowAlways",!this.pointCommentShowAlways)},clickArtboardShowInteractionLine:function(){var t=this.cloudVersion,e=this.artboardShowInteractionLine;bt(t)&&this.showTextTip("当前私有云版本(".concat(t,")过低,不支持交互原型相关功能,请先升级部署包")),this.$store.commit("artboardShowInteractionLine",!e)},clickMenu:function(t){var e=t.target;"A"!==(null===e||void 0===e?void 0:e.tagName)&&(this.ignoreThisClick=!0)},clickArtRenderInCanvasMode:function(){this.$store.commit("artRenderInCanvasMode",!this.artRenderInCanvasMode)},clickSetNickName:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.prompt({title:"修改昵称",text:t.cloudNickName,placeholder:"昵称;方便其他成员认识你",beforeYes:function(e){if(e=e.trim(),!Te(e))return t.showTextTip("请输入正确的昵称,由5-20个字符组成,其中1个中文=2个字符."),!1}});case 3:n=e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e["catch"](0),e.abrupt("return");case 9:if(n=n.trim(),n!==t.cloudNickName){e.next=12;break}return e.abrupt("return");case 12:return t.nickSetting=!0,e.prev=13,e.next=16,t.cryptoMarklionWeb2("setusernickname",{nickName:n},1e4);case 16:r=e.sent,t.$store.commit("setCloudNickName",r.data),t.showTextTip("昵称已修改"),e.next=24;break;case 21:e.prev=21,e.t1=e["catch"](13),t.showTextTip(e.t1);case 24:case"end":return e.stop()}}),e,null,[[0,6],[13,21]])})))()},clickLogout:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.logoutting){e.next=2;break}return e.abrupt("return");case 2:return t.logoutting=!0,e.prev=3,e.next=6,t.goCloudLogout();case 6:return e.prev=6,t.logoutting=!1,e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[3,,6,9]])})))()},clickLogin:function(){this.goCloudLogin()},clickShowMenu:function(){var t=this;setTimeout((function(){var e=!t.menuVisible;t.menuVisible=e,e&&(t.ignoreThisClick=!1)}),0)},hideMenu:function(){var t=this;clearTimeout(this.menuHandler),this.ignoreThisClick?this.ignoreThisClick=!1:this.menuHandler=setTimeout((function(){t.menuVisible=!1}),50)}},computed:{interactionRectAlwaysVisible:function(){return this.$store.state.artboardDetail.interactionSet.rectAlwaysVisible},pointCommentShowAlways:function(){return this.$store.state.pointCommentShowAlways},artboardShowInteractionLine:function(){return this.$store.state.artboardShowInteractionLine},artRenderInCanvasMode:function(){return this.$store.state.artRenderInCanvasMode},showTitle:function(){return this.cloudIsLogin?"".concat(this.cloudNickName,"(").concat(this.cloudUserEmail,")"):"点击登录"},showName:function(){return this.cloudIsLogin?this.cloudNickName:"未登录"},showEmail:function(){return this.cloudIsLogin?this.cloudUserEmail:""}},watch:{menuVisible:function(t){t?window.addEventListener("click",this.hideMenu,!1):window.removeEventListener("click",this.hideMenu,!1)}},beforeDestroy:function(){clearTimeout(this.menuHandler),window.removeEventListener("click",this.hideMenu,!1)},data:function(){return{menuVisible:!1,menuHandler:0,logoutting:!1,nickSetting:!1,ignoreThisClick:!1}},props:{setVisible:Boolean}},Cb=kb,Sb=(n("247b"),Object(wo["a"])(Cb,cb,lb,!1,null,"1e0d6b61",null)),Tb=Sb.exports,Ab=function(){var t=this,e=t._self._c;return e("div",{ref:"btn",staticClass:"btn-user-notify",class:{news:t.hasNotReadNotify,on:t.notifyListVisible},attrs:{title:"消息"},on:{click:t.clickNotify}},[e("i")])},Ib=[],Fb={methods:{clickNotify:function(){var t=this;setTimeout((function(){var e=t.userNotify;if(e.visible=!e.visible,e.visible){var n=t.$refs.btn;if(!n)return;var i=n.getBoundingClientRect(),r=e.location;r.top=i.bottom,r.right=window.innerWidth-i.right}}),0)}},computed:{userNotify:function(){return this.$store.state.userNotify},notifyListVisible:function(){return this.userNotify.visible},hasNotReadNotify:function(){return-1!==this.notifyList.findIndex((function(t){return!t.readed}))},notifyList:function(){var t,e;return null!==(t=null===(e=this.userNotify.cloudList[this.cloudKey])||void 0===e?void 0:e.list)&&void 0!==t?t:[]}}},Mb=Fb,Ob=(n("c332"),Object(wo["a"])(Mb,Ab,Ib,!1,null,"27c0517c",null)),_b=Ob.exports,Lb=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"user-notify",style:t.styleLocation,on:{mousedown:function(t){t.stopPropagation()},click:function(e){t.notClickClose=!0}}},[e("div",{staticClass:"header"},[e("nav",[e("a",{class:{on:t.showType===t.EnumNotifyShowType.ALL},attrs:{href:"javascript:;"},on:{click:function(e){t.showType=t.EnumNotifyShowType.ALL}}},[t._v("全部("+t._s(t.list.length)+")")]),e("a",{class:{on:t.showType===t.EnumNotifyShowType.NotRead},attrs:{href:"javascript:;"},on:{click:function(e){t.showType=t.EnumNotifyShowType.NotRead}}},[t._v("未读("+t._s(t.notReadList.length)+")")]),e("a",{class:{on:t.showType===t.EnumNotifyShowType.Readed},attrs:{href:"javascript:;"},on:{click:function(e){t.showType=t.EnumNotifyShowType.Readed}}},[t._v("已读("+t._s(t.readedList.length)+")")])]),e("menu",[t.showType===t.EnumNotifyShowType.NotRead||t.showType===t.EnumNotifyShowType.ALL&&t.notReadList.length>0?e("a",{staticClass:"btn-setread",attrs:{href:"javascript:;"},on:{click:t.clickSetAllNotifyReaded}},[t._v(t._s(t.btnFetching?"请求处理中":"全部标记为已读"))]):t.showType===t.EnumNotifyShowType.Readed||t.showType===t.EnumNotifyShowType.ALL&&t.readedList.length>0?e("a",{staticClass:"btn-setread",attrs:{href:"javascript:;"},on:{click:t.clickAllReadedNotify}},[t._v(t._s(t.btnFetching?"请求处理中":"清空已读消息"))]):t._e(),e("a",{staticClass:"btn-refresh",attrs:{href:"javascript:;",title:"刷新消息列表"},on:{click:function(e){return t.clickReload(!0)}}})])]),e("div",{ref:"list",staticClass:"list",on:{scroll:t.onListScroll}},[t.listFetchState===t.FetchState.Fetching||t.listFetchState===t.FetchState.Error?e("NetworkLoading",{attrs:{loadText:"正在获取消息列表...",errorText:t.errorText,isLoading:t.listFetchState===t.FetchState.Fetching,isError:t.listFetchState===t.FetchState.Error,reLoadText:"刷新"},on:{reload:function(e){return t.clickReload(!0)}}}):0===t.showList.length?e("div",{staticClass:"empty"},[t._v("暂无消息")]):e("div",{staticClass:"pad",style:{height:t.styleListRealHeight}},[e("ul",{style:{top:t.styleListOffsetTop}},t._l(t.renderList,(function(t){return e("UserNotifyItem",{key:"notify-".concat(t.id),attrs:{item:t}})})),1)])],1)])},Pb=[],Eb=function(){var t=this,e=t._self._c;return t.visible&&t.unknowNotifyType?e("li",{staticClass:"unknow"},[t._v("不支持的消息类型(id:"+t._s(t.item.id)+",type:"+t._s(t.item.type)+"),请升级客户端后查看")]):t.visible?e("li",{staticClass:"item",class:{notread:!t.item.readed},on:{click:t.clickNotify}},[e("div",{staticClass:"info"},[e("div",{staticClass:"title",attrs:{title:t.title}},[t._v(t._s(t.title))]),e("div",{staticClass:"date"},[t._v(t._s(t.item.dateStr))])]),e("div",{staticClass:"text"},[e("a",{attrs:{href:"javascript:;",title:t.commentSummary},on:{click:t.clickSummary}},[t._v(t._s(t.commentSummary))])])]):t._e()},Nb=[],Db={methods:{clickSummary:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.item,e.prev=1,r=n.msg,e.next=5,t.goCloudPath({folderId:r.folderId,artboardId:r.artboardId,artboardGuid:r.artboardGuid,commentId:r.commentId,isReply:n.type===L.Artboard_Reply||n.type===L.Artboard_Reply_At});case 5:t.$store.commit("setAllFoldersBoxVisible",!1),t.$store.state.userNotify.visible=!1,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),t.showTextTip(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},clickNotify:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.item,n){e.next=3;break}return e.abrupt("return");case 3:if(n.readed){e.next=26;break}if(t.fetchState!==Cn.Fetching){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,t.fetchState=Cn.Fetching,r=new FormData,r.append("id",n.id),e.next=12,t.fetchPostCloudApi("setnotifyreadedbyweb",{body:r});case 12:if(a=e.sent,ht(a)){e.next=15;break}throw new Error("返回值异常,无法设置消息为已读");case 15:if(a.success){e.next=17;break}throw new Error(a.errMsg);case 17:n.readed=!0,e.next=23;break;case 20:e.prev=20,e.t0=e["catch"](6),t.showTextTip(e.t0);case 23:return e.prev=23,t.fetchState=Cn.Success,e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[6,20,23,26]])})))()}},computed:{visible:function(){return!!this.item},commentSummary:function(){var t,e=null===(t=this.item)||void 0===t?void 0:t.msg;if(!e)return"";var n=e.commentAttachCount,i=e.commentSummary;return n>0&&(i=new Array(n).fill("[图片]").join("")+" "+i),i},title:function(){var t,e,n,i=this.item;if(!i)return"";var r=i.msg;switch(i.type){case L.Artboard_Comment:return"".concat(null===(t=r.commentUser)||void 0===t?void 0:t.nickName," 评论了您的画板“").concat(r.artboardName,"” :");case L.Artboard_Reply:return"".concat(null===(e=r.commentUser)||void 0===e?void 0:e.nickName," 回复了您在画板“").concat(r.artboardName,"”的评论 :");case L.Artboard_Comment_At:case L.Artboard_Reply_At:return"".concat(null===(n=r.commentUser)||void 0===n?void 0:n.nickName," 在画板“").concat(r.artboardName,"”@了您:");default:return null}},unknowNotifyType:function(){var t=this.item;if(!t)return!0;switch(t.type){case L.Artboard_Comment:case L.Artboard_Reply:case L.Artboard_Comment_At:case L.Artboard_Reply_At:return!1;default:return!0}}},props:{item:Object},data:function(){return{fetchState:Cn.Normal}}},jb=Db,Rb=(n("5668"),Object(wo["a"])(jb,Eb,Nb,!1,null,"d1483966",null)),Vb=Rb.exports,Bb={ALL:-1,NotRead:0,Readed:1},Ub={components:{UserNotifyItem:Vb,NetworkLoading:$l},methods:{clickSetAllNotifyReaded:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.notReadList,0!==n.length){e.next=4;break}return t.showTextTip("没有需要标记为已读的消息"),e.abrupt("return");case 4:if(t.btnFetchState!==Cn.Fetching){e.next=6;break}return e.abrupt("return");case 6:return t.btnFetchState=Cn.Fetching,e.prev=7,r=n[0].id,a=new FormData,a.append("minNotifyId",r),e.next=13,t.fetchPostCloudApi("setnotifyreadedbyweb",{body:a});case 13:if(o=e.sent,ht(o)){e.next=16;break}throw new Error("返回值异常,无法设置消息为已读");case 16:if(o.success){e.next=18;break}throw new Error(o.errMsg);case 18:t.list.forEach((function(t){!t.readed&&t.id<=r&&(t.readed=!0)})),t.showTextTip("已将所有未读消息标记为已读"),e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](7),t.showTextTip(e.t0);case 25:return e.prev=25,t.btnFetchState=Cn.Success,e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[7,22,25,28]])})))()},clickAllReadedNotify:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s,c;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.readedList,0!==n.length){e.next=4;break}return t.showTextTip("没有需要清理的已读消息"),e.abrupt("return");case 4:if(t.btnFetchState!==Cn.Fetching){e.next=6;break}return e.abrupt("return");case 6:return t.awaitConfirm=!0,e.next=9,t.confirm({text:"即将清空所有已读消息"});case 9:if(e.sent){e.next=12;break}return t.awaitConfirm=!1,e.abrupt("return");case 12:return t.awaitConfirm=!1,t.btnFetchState=Cn.Fetching,e.prev=14,r=n[0].id,a=new FormData,a.append("minNotifyId",r),e.next=20,t.fetchPostCloudApi("removenotifiesbyweb",{body:a});case 20:if(o=e.sent,ht(o)){e.next=23;break}throw new Error("返回值异常,消息未被清理");case 23:if(o.success){e.next=25;break}throw new Error(o.errMsg);case 25:s=[],c=t.list,c.forEach((function(t,e){t.readed&&t.id<=r&&s.unshift(e)})),s.length===c.length?c.splice(0):s.forEach((function(t){c.splice(t,1)})),t.showTextTip("已清空已读的消息"),e.next=35;break;case 32:e.prev=32,e.t0=e["catch"](14),t.showTextTip(e.t0);case 35:return e.prev=35,t.btnFetchState=Cn.Success,e.finish(35);case 38:case"end":return e.stop()}}),e,null,[[14,32,35,38]])})))()},clickReload:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.listFetchState!==Cn.Fetching){n.next=2;break}return n.abrupt("return");case 2:return e.errorText="",e.listFetchState=Cn.Fetching,n.prev=4,a=e.list,o=0,!t&&a.length>0&&(o=a[0].id),s=null!==(r=e.curArtboardId)&&void 0!==r?r:0,n.next=11,e.getCloudNotifies(o,s);case 11:e.listFetchState=Cn.Success,n.next=18;break;case 14:n.prev=14,n.t0=n["catch"](4),e.listFetchState=Cn.Error,e.isNotSupportCloudVersion?e.errorText="私有云版本过低(".concat(e.cloudVersion,"),请先升级私有云部署包"):e.errorText=n.t0;case 18:case"end":return n.stop()}}),n,null,[[4,14]])})))()},onListScroll:function(t){this.scrollTop=t.target.scrollTop},getBoxHeight:function(){if(this.visible){var t=this.$refs.list;t&&(this.boxHeight=t.offsetHeight)}},resetTimeFormat:function(){this.showList.forEach((function(t){try{t.dateStr=kt(t.date)}catch(e){t.dateStr=t.date}}))},closeSelf:function(){var t=this;clearTimeout(this.closeHandle),this.closeHandle=setTimeout((function(){t.awaitConfirm||(t.notClickClose?t.notClickClose=!1:t.userNotify.visible=!1)}),50)},needReloadOnOpen:function(){var t=this.currentCloudNotify;if(!t)return!0;var e=t.updateTime;return Math.abs(Date.now()-e)>5e3}},computed:{isNotSupportCloudVersion:function(){var t=this.cloudVersion;return t&&ft(t)},FetchState:function(){return Cn},btnFetching:function(){return this.btnFetchState===Cn.Fetching},styleLocation:function(){var t=this.userNotify.location,e={top:13,right:-20};return"top:".concat(t.top+e.top,"px;right:").concat(t.right+e.right,"px;")},EnumNotifyShowType:function(){return Bb},userNotify:function(){return this.$store.state.userNotify},visible:function(){return this.userNotify.visible},currentCloudNotify:function(){return this.userNotify.cloudList[this.cloudKey]},list:function(){var t;return(null===(t=this.currentCloudNotify)||void 0===t?void 0:t.list)||[]},readedList:function(){var t=this.list,e=[];return t.forEach((function(t){t.readed&&e.push(t)})),e},notReadList:function(){var t=this.list,e=[];return t.forEach((function(t){t.readed||e.push(t)})),e},showList:function(){switch(this.showType){case Bb.Readed:return this.readedList;case Bb.NotRead:return this.notReadList;default:return this.list}},renderStartIndex:function(){var t=this.scrollTop,e=this.lineHeight;return Math.max(Math.floor(t/e)-2,0)},renderLength:function(){var t=this.showList,e=this.boxHeight,n=this.lineHeight,i=this.scrollTop;return Math.min(t.length,Math.floor(i/n)+Math.ceil(e/n)+2)},renderList:function(){var t=this.showList;return t.slice(this.renderStartIndex,this.renderLength)},styleListRealHeight:function(){return this.showList.length*this.lineHeight+"px"},styleListOffsetTop:function(){return this.renderStartIndex*this.lineHeight+"px"}},watch:{showType:function(){var t=this;this.$nextTick((function(){var e=t.$refs.list;e&&(e.scrollTop=0),t.resetTimeFormat()}))},visible:function(t){var e=this;t?(this.$nextTick((function(){e.getBoxHeight()})),window.addEventListener("click",this.closeSelf,!0),this.needReloadOnOpen()?this.clickReload():this.resetTimeFormat()):(this.notClickClose=!1,clearTimeout(this.closeHandle),window.removeEventListener("click",this.closeSelf,!0))}},data:function(){return{scrollTop:0,boxHeight:0,lineHeight:65,showType:Bb.ALL,closeHandle:0,notClickClose:!1,listFetchState:Cn.Normal,btnFetchState:Cn.Normal,errorText:"",awaitConfirm:!1}},beforeDestroy:function(){window.removeEventListener("click",this.closeSelf,!0),clearTimeout(this.closeHandle)},mounted:function(){this.getBoxHeight()}},Hb=Ub,Wb=(n("c0eb"),Object(wo["a"])(Hb,Lb,Pb,!1,null,"496858fd",null)),$b=Wb.exports,Gb={components:{BtnArtRenderMode:Pm,BtnGoInteraction:Im,PathNav:sb,UserNotifyButton:_b,UserNotify:$b,ScaleControl:Qo,Helper:sv,UserInfo:Tb,CloudFolderLogs:ev,BtnUpload:gm,BtnContainerColor:hf},methods:{clickSetArtboardInComment:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t||!e.inCommentDrawing){n.next=5;break}return n.next=3,e.confirm({text:"正在编辑画板截图,是否清理截图信息并切换到标注?"});case 3:if(n.sent){n.next=5;break}return n.abrupt("return");case 5:e.$store.commit("setArtboardInComment",t);case 6:case"end":return n.stop()}}),n)})))()},clickMultDownArtboard:function(){this.setInArtboardMultDownMode(!0)},clickGoParentFolder:function(){var t=this;setTimeout((function(){tn(t.cloudParentFolder.id)}),100)},clickGoHome:function(){var t=this;setTimeout((function(){t.setCurArtboard(null)}),100)},clickHelper:function(t){this.$store.commit("setHelperVisible",t)}},computed:{canShowUpload:function(){var t=this.inCloudViewerMode,e=this.inArtboardMode,n=this.cloudCurrentFolderId,i=this.userFolderSpecifyMemberAuthority;if(t&&!e&&n>0)switch(i){case X.Admin:case X.ParentOwner:case X.Owner:case X.ReadWrite:case X.Read:case X.OnlyChildFolderVisit:return!0}return!1},canShowLog:function(){var t=this.inCloudMode,e=this.permission,n=this.curNetDiskFile,i=this.cloudFolderNotFound,r=this.userFolderSpecifyMemberAuthority;if(t&&!i&&e&&!n)switch(r){case X.Admin:case X.ParentOwner:case X.Owner:case X.ReadWrite:case X.Read:return!0}return!1},curArtboardCommentCount:function(){var t,e=null===(t=this.curArtboard)||void 0===t?void 0:t.artboard;if(!e)return 0;var n=e.comments+e.replies;return isNaN(n)?0:n},helperVisible:function(){return this.$store.state.helper.visible},cloudParentFolderName:function(){var t=this.cloudParentFolder;if(!t)return null;if(0!==t.id)return t.name;var e=this.cloudName;return e||t.name},setVisible:function(){var t=!this.cloudFolderNotFound&&this.permission&&this.documentArtboards.length>0;return t}}},zb=Gb,Yb=(n("6168"),Object(wo["a"])(zb,af,of,!1,null,"793212ee",null)),Xb=Yb.exports,Kb=function(){var t=this,e=t._self._c;return e("div",{staticClass:"authority",class:{"in-mobile":t.inMobile,include:t.include}},[e("div",{staticClass:"box"},[e("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[e("div",{staticClass:"container"},[e("div",{staticClass:"cloudname"},[t._v(t._s(t.documentName))]),e("div",{staticClass:"text"},[t._v("分享已加密，请输入分享码后访问")]),e("div",{staticClass:"input",class:{focused:t.inputFocused}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],ref:"input",attrs:{type:"text",placeholder:"请输入分享码",maxlength:"6",spellcheck:"false"},domProps:{value:t.code},on:{focus:function(e){t.inputFocused=!0},blur:function(e){t.inputFocused=!1},input:function(e){e.target.composing||(t.code=e.target.value)}}})]),e("div",{staticClass:"btns"},[e("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:t.onSubmit}},[t._v(" 确定 "),e("input",{attrs:{type:"submit"}})])])])])])])},qb=[],Qb={methods:{onSubmit:function(){var t=this,e=this.code.trim();if(!/^[a-zA-Z\d]{1,6}$/.test(e))return this.showTextTip("分享码不正确,分享码由1-6位的数字或字母组合而成"),void this.$refs.input.focus();var n="".concat(me,"/api/previewer");fetch(n,{method:"post",body:"code=".concat(e,"&folderid=").concat(this.cloudCurrentFolderId),cache:"reload",credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded"}}).then((function(e){e.text().then((function(n){if(200!=e.status)throw n;if(n=JSON.parse(n),ht(n))return n.success?(t.cleanFoldersCache(),void(t.inInteractionMode?t.goCloudFolderInteractionUrl(t.cloudCurrentFolderId,t.curArtboardGuid):window.location.reload())):void t.showTextTip(n.errMsg);t.showTextTip("返回值格式异常")})).catch((function(e){t.showTextTip(e)}))})).catch((function(e){t.showTextTip(e)}))}},data:function(){return{inputFocused:!1,code:""}},props:{include:{type:Boolean,default:!1}}},Jb=Qb,Zb=(n("99c8"),Object(wo["a"])(Jb,Kb,qb,!1,null,"1fdedcbf",null)),tg=Zb.exports,eg=function(){var t=this,e=t._self._c;return e("section",{staticClass:"error-data",class:{"in-mobile":t.inMobile}},[e("div",{staticClass:"box"},[e("div",{staticClass:"text"},[t._v(t._s(t.text))]),t.showLoginBtn?e("div",{staticClass:"btns"},[e("div",{staticClass:"button light",on:{click:t.goCloudLogin}},[t._v(t._s(t.cloudIsLogin?"切换账号":"立即登录"))])]):t._e()])])},ng=[],ig={props:{text:String,showLoginBtn:Boolean}},rg=ig,ag=(n("0e1f"),Object(wo["a"])(rg,eg,ng,!1,null,"5f104cd4",null)),og=ag.exports,sg=function(){var t=this,e=t._self._c;return e("section",{staticClass:"p-index",style:{backgroundColor:t.backgroundColor}},[e("ZoomContainer",{attrs:{type:t.EnumScaleType.ArtboardList}}),e("MultArtboardDownload")],1)},cg=[],lg={components:{ZoomContainer:Fl,MultArtboardDownload:Md},computed:{backgroundColor:function(){return this.$store.state.artboardDetail.interactionSet.backgroundColor},EnumScaleType:function(){return O}},created:function(){0}},ug=lg,dg=(n("9e45"),Object(wo["a"])(ug,sg,cg,!1,null,"7c2a4868",null)),hg=dg.exports,fg=function(){var t=this,e=t._self._c;return e("section",{staticClass:"p-info",style:{backgroundColor:t.backgroundColor}},[e("keep-alive",[e("LeftSide")],1),t.isError?e("div",{staticClass:"error"},[e("div",{staticClass:"box"},[e("div",{staticClass:"text"},[t._v(t._s(t.curArtboard.loadErrMsg))]),e("div",{staticClass:"btns"},[e("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:t.clickReload}},[t._v("重新加载")])])])]):t.isFetching?e("div",{staticClass:"loading"},[e("div",{staticClass:"box"},[t._v("正在加载画板详情...")])]):t.isLoaded?[e("ZoomContainer",{attrs:{type:t.EnumScaleType.ArtboardDetail}}),e("Properties"),e("MultDownload"),e("CommentMain")]:t._e()],2)},mg=[],pg=function(){var t=this,e=t._self._c;return e("section",{staticClass:"left-side",class:{on:t.visible}},[e("a",{staticClass:"btn-visible",class:{on:t.visible},attrs:{href:"javascript:;",title:t.visible?"收起左侧(F3)":"展开左侧(F3)"},on:{click:function(e){return t.setVisible(!t.visible)}}}),e("nav",[e("a",{staticClass:"btn-showart",class:{on:t.showArtboardList},attrs:{href:"javascript:;",title:"切换到画板列表(F1)"},on:{click:function(e){t.showArtboardList=!0,t.setVisible(!0)}}},[t._v("画板")]),e("a",{staticClass:"btn-shownode",class:{on:!t.showArtboardList},attrs:{href:"javascript:;",title:"切换到图层列表(F2)"},on:{click:function(e){t.showArtboardList=!1,t.setVisible(!0)}}},[t._v("图层")])]),t.showArtboardList?e("div",{staticClass:"search-art",class:{mini:t.inCloudMode}},[e("div",{staticClass:"search"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText.artboard,expression:"searchText.artboard"}],attrs:{type:"text",placeholder:"搜索画板名",spellcheck:"false"},domProps:{value:t.searchText.artboard},on:{input:function(e){e.target.composing||t.$set(t.searchText,"artboard",e.target.value)}}}),t.searchText.artboard?e("a",{staticClass:"btn-clear",attrs:{href:"javascript:;"},on:{click:function(e){t.searchText.artboard=""}}}):t._e()]),t.inCloudMode?e("FolderNavSortMenu",{attrs:{mini:!0}}):t._e()],1):t.artboardInComment?t._e():e("div",{staticClass:"search"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText.node,expression:"searchText.node"}],attrs:{type:"text",placeholder:"搜索节点名",spellcheck:"false"},domProps:{value:t.searchText.node},on:{input:function(e){e.target.composing||t.$set(t.searchText,"node",e.target.value)}}}),t.searchText.node?e("a",{staticClass:"btn-clear",attrs:{href:"javascript:;"},on:{click:function(e){t.searchText.node=""}}}):t._e()]),t.showArtboardList||!t.artboardInComment?e("div",{staticClass:"filter"},[e("div",{staticClass:"filters"},[t.artboardInComment?e("div",{staticClass:"filter-item filter-item-comment",class:{on:t.commentFilterOpen},on:{click:t.clickCommentFilter}}):[e("div",{staticClass:"filter-item filter-item-slice",class:{on:t.sliceFilterOpen},attrs:{title:t.showArtboardList?"筛选有切图的画板":"筛选有切图的节点"},on:{click:t.clickSliceFilter}}),t.showArtboardList?t._e():e("div",{staticClass:"filter-item filter-item-interaction",class:{on:t.interactionFilterOpen},attrs:{title:"筛选有原型跳转的节点"},on:{click:t.clickInteractionFilter}})]],2),t.showArtboardList?e("a",{staticClass:"artlist-mode",class:{min:!t.artlistModeMin},attrs:{href:"javascript:;",title:t.artlistModeMinTitle},on:{click:t.clickArtlistModeMin}}):t._e()]):t._e(),e("section",{staticClass:"box"},[!t.showArtboardList&&t.artboardInComment?e("section",{staticClass:"on incomment"},[t._v("评论模式下无法查看标注图层信息")]):t._e(),e("ArtboardList",{attrs:{artlistModeMin:t.artlistModeMin,visible:t.showArtboardList,list:t.renderDocumentArtboards,renderArtboardList:t.renderArtboardList,sliceFilterOpen:t.sliceFilterOpen,interactionFilterOpen:t.interactionFilterOpen}}),e("section",{ref:"nodeList",staticClass:"nodelist",class:{on:!t.showArtboardList&&!t.artboardInComment},on:{scroll:t.onNodeListScroll,mousewheel:t.onNodeListMouseWheel}},[e("div",{staticClass:"container",class:{"slice-filter":t.sliceFilterOpen||t.nodeInSearch||t.interactionFilterOpen,off:t.nodeListMousewheelTimes>0}},[0===t.nodeList.length?e("div",{staticClass:"empty"},[t._v(t._s(t.emptyNodeListText))]):t._e(),e("div",{staticClass:"brace",style:t.braceStyle},[e("div",{staticClass:"front",style:t.frontStyle},t._l(t.renderList,(function(n){return e("NodeListNew",{key:"".concat(n.index,":").concat(n.node.guid),attrs:{nodeListHeight:t.nodeListHeight,nodeListScrollTop:t.nodeListScrollTop,nodeLineHeight:t.nodeLineHeight,shiftKey:t.shiftKey,sliceFilterOpen:t.sliceFilterOpen,interactionFilterOpen:t.interactionFilterOpen,nodeInSearch:t.nodeInSearch,item:n.node}})})),1)])])])],1)])},vg=[],bg=function(){var t=this,e=t._self._c;return e("div",{staticClass:"item",class:{hover:t.enterNode===t.item,focused:t.curNode===t.item}},[t.sliceFilterOpen||t.nodeInSearch||t.interactionFilterOpen?t._e():e("div",{staticClass:"prex",class:{first:t.isFirstChild,last:t.isLastChild,"has-child":t.hasChild},style:{width:t.depthWidth}}),e("div",{ref:"$item_name",staticClass:"name",class:{export:t.item.markedForExport},style:{paddingLeft:t.paddingLeft},on:{mouseenter:t.mouseEnterNode,mouseleave:t.mouseLeaveNode,click:t.clickNode}},[t.item.renderTapInteraction?e("span",{staticClass:"interaction-node"}):t._e(),t._v(t._s(t.name))])])},gg=[],wg=10,xg={name:"NodeList",methods:{clickNode:function(){var t=this.item;this.inMultDownMode?t.markedForExport&&(t.mlUserSelectDown=!t.mlUserSelectDown):this.setCurNode(t)},mouseLeaveNode:function(){this.inMultDownMode||this.shiftKey&&null!=this.curNode||this.setEnterNode(null)},mouseEnterNode:function(){this.inMultDownMode||this.shiftKey&&null!=this.curNode||this.setEnterNode(this.item)}},computed:{itemStyle:function(){return{top:this.index*this.nodeLineHeight+"px"}},isFirstChild:function(){var t=this.item;if(t.types.Artboard)return!0;var e=t.parentNode.children;return!!e&&e[0]==t},isLastChild:function(){var t=this.item;if(t.types.Artboard)return!0;var e=t.parentNode.children;return!!e&&e[e.length-1]==t},hasChild:function(){var t=this.item.children;if(!t)return!1;if(0===t.length)return!1;var e=t.find((function(t){return!t.mlIgnoreLeftSide}));return!!e},depthWidth:function(){var t=this.nodeDepthIndex*wg;return t<0&&(t=0),t+"px"},paddingLeft:function(){return this.nodeDepthIndex*wg+6+"px"},nodeDepthIndex:function(){return this.item.nodeDepthIndex},name:function(){var t=Ke(this.item);return dt(t)?(t=t.trim(),t):this.item.guid}},props:{item:Object,sliceFilterOpen:Boolean,interactionFilterOpen:Boolean,nodeInSearch:Boolean,shiftKey:Boolean,nodeListScrollTop:Number,nodeListHeight:Number,index:Number,nodeLineHeight:Number}},yg=xg,kg=(n("1993"),Object(wo["a"])(yg,bg,gg,!1,null,"64bbd625",null)),Cg=kg.exports,Sg=function(){var t=this,e=t._self._c;return e("section",{ref:"artList",staticClass:"art-list",class:{on:t.visible},on:{scroll:t.onScroll,mousewheel:t.onMouseWheel}},[e("div",{staticClass:"brace",class:{off:t.mousewheelTimes>0},style:{height:t.boxRealHeight}},[e("div",{staticClass:"front",style:{marginTop:t.frontMarginTop}},t._l(t.lazyRenderArtboardList,(function(n){return e("ArtboardListItem",{key:"".concat(n.artboard.docGuid,"-").concat(n.artboard.guid),attrs:{item:n,artlistModeMin:t.artlistModeMin}})})),1)]),0===t.lazyRenderArtboardList.length?e("div",{staticClass:"empty"},[t._v(t._s(t.emptyNodeListText))]):t._e()])},Tg=[],Ag=function(){var t=this,e=t._self._c;return e("section",{ref:"$item",staticClass:"item",class:{on:t.focused,min:t.artlistModeMin},on:{click:function(e){return t.clickArtboard()},contextmenu:function(e){return e.preventDefault(),t.onContextmenu.apply(null,arguments)}}},[e("div",{staticClass:"name",attrs:{title:t.artboard.name},domProps:{textContent:t._s(t.artboard.name)}}),e("div",{staticClass:"img"},[t.imageSrc?e("img",{attrs:{src:t.imageSrc,alt:""},on:{error:t.errPreviewImage}}):t._e(),t.inInteractionMode&&t.artboard.flowStart?e("div",{staticClass:"flow-start"}):t._e(),!t.inInteractionMode&&!t.artboardInComment&&t.exportNodeCount>0?e("div",{staticClass:"slice-total"},[t._v(t._s(t.exportNodeCount))]):t._e(),!t.inInteractionMode&&t.artboardInComment&&t.commentReplyCount&&"0"!==t.commentReplyCount?e("div",{staticClass:"comment-total"},[t._v(t._s(t.commentReplyCount))]):t._e()])])},Ig=[],Fg={methods:{errPreviewImage:function(){this.userMiniPreviewImg&&(this.userMiniPreviewImg=!1)},onContextmenu:function(t){var e=this,n=t.pageX,i=t.pageY,r=this.item;requestAnimationFrame((function(){e.$store.commit("setArtboardMenu",{visible:!0,x:n,y:i,artboard:r})}))},clickArtboard:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.inCommentDrawing){e.next=5;break}return e.next=3,t.confirm({text:"正在编辑画板截图,是否清理截图信息并切换画板?"});case 3:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:t.setCurArtboard(t.item);case 6:case"end":return e.stop()}}),e)})))()},checkImage:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.pathPreviewMini,r=t.artboard,a=t.artboardReviewImg,!n){e.next=4;break}return t.imageSrc=n,e.abrupt("return");case 4:if(t.inCloudMode){e.next=7;break}return t.imageSrc=a,e.abrupt("return");case 7:if(e.prev=7,s=r.pathPreviewBlob,s){e.next=18;break}return e.next=12,Pu(a);case 12:if(s=e.sent,"string"!==typeof s){e.next=17;break}return r.pathPreviewMini=s,t.imageSrc=s,e.abrupt("return");case 17:r.pathPreviewBlob=s;case 18:o=URL.createObjectURL(s),t.imageSrc=o,e.next=29;break;case 22:return e.prev=22,e.t0=e["catch"](7),t.userMiniPreviewImg=!1,r.pathPreviewMini=a,t.imageSrc=a,e.abrupt("return");case 29:return e.prev=29,o&&t.$nextTick((function(){setTimeout((function(){try{URL.revokeObjectURL(o)}catch(t){}}),600)})),e.finish(29);case 32:case"end":return e.stop()}}),e,null,[[7,22,29,32]])})))()}},watch:{artboardReviewImg:function(t){var e=this;t&&this.$nextTick((function(){e.checkImage()}))}},computed:{commentReplyCount:function(){var t=this.artboard,e=this.artlistModeMin;if(!t)return"";var n=t.comments+t.replies;return e?n>999?"99+":n>0?n:"":n.toString()},exportNodeCount:function(){if(this.inCloudMode)return this.artboard.resNodeCount;var t=this.item.exportNodes;return t.length},artboardReviewImg:function(){var t=this.artboard,e=this.userMiniPreviewImg?t.artboardPreviewThumbPng:t.artboardPreviewPng;return this.inCloudMode?e:"".concat(e,"?").concat(t.mlOutputTime)},focused:function(){return this.curArtboard===this.item},artboard:function(){return this.item.artboard}},mounted:function(){this.checkImage()},data:function(){return{userMiniPreviewImg:!0,imageSrc:null}},props:{item:Object,artlistModeMin:Boolean,searchText:String}},Mg=Fg,Og=(n("5853"),Object(wo["a"])(Mg,Ag,Ig,!1,null,"530c8130",null)),_g=Og.exports,Lg={methods:{onMouseWheel:function(t){var e;this.mousewheelTimes=null!==(e=t.timeStamp)&&void 0!==e?e:Date.now()},onScroll:function(t){this.scrollTop=t.target.scrollTop},onResize:function(){var t=this.$refs.artList;t&&(this.boxHeight=t.offsetHeight)},goFocusItem:function(){var t=this.curArtboard;if(t){var e=this.$refs.artList;if(e){var n=this.renderArtboardList.findIndex((function(e){return e===t}));if(-1!==n){var i=this.itemHeight*n;i-=Math.floor((this.boxHeight-this.itemHeight)/2),e.scrollTop=i}}}}},props:{visible:Boolean,artlistModeMin:Boolean,list:Array,renderArtboardList:Array,sliceFilterOpen:Boolean,interactionFilterOpen:Boolean},components:{ArtboardListItem:_g},watch:{cloudListSortSortType:function(){var t=this;this.$nextTick((function(){t.goFocusItem()}))},cloudListSortOrderDesc:function(){var t=this;this.$nextTick((function(){t.goFocusItem()}))},mousewheelTimes:function(t){var e=this;clearTimeout(this.mousewheelHandle),t&&(this.mousewheelHandle=setTimeout((function(){e.mousewheelTimes=!1}),200))},filterDocumentGuid:function(){var t=this;this.$nextTick((function(){t.goFocusItem()}))},sliceFilterOpen:function(){var t=this;this.$nextTick((function(){t.goFocusItem()}))},artlistModeMin:function(){var t=this;this.$nextTick((function(){t.goFocusItem()}))},curArtboard:function(){this.goFocusItem()}},computed:{cloudListSort:function(){return this.$store.state.cloudListSort},cloudListSortSortType:function(){return this.cloudListSort.sortType},cloudListSortOrderDesc:function(){return this.cloudListSort.orderDesc},emptyNodeListText:function(){var t=this.sliceFilterOpen;return"未找到".concat(t?"包含切图的":"相关","画板")},lazyRenderArtboardList:function(){var t=this.renderArtboardList,e=this.lazyStartIndex,n=this.lazyLength;return t.slice(e,e+n)},lazyStartIndex:function(){var t=this.scrollTop,e=this.itemHeight,n=this.renderArtboardList.length-Math.floor(this.boxHeight/this.itemHeight);return Math.max(0,Math.min(n,Math.floor(t/e)-1))},lazyLength:function(){var t=this.boxHeight,e=this.itemHeight,n=this.renderArtboardList,i=this.lazyStartIndex;return Math.min(n.length-i,Math.ceil(t/e)+2)},frontMarginTop:function(){return this.lazyStartIndex*this.itemHeight+"px"},boxRealHeight:function(){return this.itemHeight*this.renderArtboardList.length+"px"},itemHeight:function(){return this.artlistModeMin?68:252}},data:function(){return{scrollTop:0,boxHeight:0,mousewheelTimes:0,mousewheelHandle:0}},mounted:function(){var t,e,n=this;this.scrollTop=null!==(t=null===(e=this.$refs.artList)||void 0===e?void 0:e.scrollTop)&&void 0!==t?t:0,this.onResize(),window.addEventListener("resize",this.onResize),this.$nextTick((function(){n.goFocusItem()}))},beforeDestroy:function(){window.removeEventListener("resize",this.onResize),clearTimeout(this.mousewheelHandle)}},Pg=Lg,Eg=(n("ef2d"),Object(wo["a"])(Pg,Sg,Tg,!1,null,"542ecd33",null)),Ng=Eg.exports,Dg={components:{ArtboardList:Ng,NodeListNew:Cg,FolderNavSortMenu:Ch},methods:{onNodeListResize:function(){var t=this.$refs.nodeList;t&&(this.nodeListHeight=t.offsetHeight)},onNodeListMouseWheel:function(t){var e;this.nodeListMousewheelTimes=null!==(e=t.timeStamp)&&void 0!==e?e:Date.now()},onNodeListScroll:function(){var t=this.$refs.nodeList;t&&(this.nodeListScrollTop=t.scrollTop)},clickArtlistModeMin:function(){this.artlistModeMin=!this.artlistModeMin,rn("leftside.artlistmodemin",this.artlistModeMin?"1":"0")},clickSliceFilter:function(){this.sliceFilterOpen=!this.sliceFilterOpen,rn("sliceFilterOpen",this.sliceFilterOpen?"1":"0")},clickCommentFilter:function(){this.commentFilterOpen=!this.commentFilterOpen,rn("commentFilterOpen",this.commentFilterOpen?"1":"0")},clickInteractionFilter:function(){this.interactionFilterOpen=!this.interactionFilterOpen,rn("interactionFilterOpen",this.interactionFilterOpen?"1":"0")},quickKeyShift:function(t){this.shiftKey=t.shiftKey},quickKey:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.quickKeyShift(t),r=t.keyCode||t.which,n.t0=r,n.next=112===n.t0||113===n.t0?5:114===n.t0?9:38===n.t0||40===n.t0?12:46;break;case 5:return e.showArtboardList=112===r,e.setVisible(!0),t.preventDefault(),n.abrupt("break",46);case 9:return e.setVisible(!e.visible),t.preventDefault(),n.abrupt("break",46);case 12:if(!e.keydownConfirming){n.next=14;break}return n.abrupt("return");case 14:if(!e.imageViewer.visible){n.next=16;break}return n.abrupt("return");case 16:if(a=38===r?-1:1,o=t.ctrlKey||t.metaKey,o){n.next=20;break}return n.abrupt("break",46);case 20:if(s=e.renderArtboardList,0!==s.length){n.next=24;break}return e.showTextTip(1===a?"已经到达最后一个画板":"已经到达第一个画板"),n.abrupt("return");case 24:if(c=s.findIndex((function(t){return e.curArtboard===t})),-1===c?c=0:c+=a,!(c<0)){n.next=31;break}return e.showTextTip("已经到达第一个画板"),n.abrupt("return");case 31:if(!(c>=s.length)){n.next=34;break}return e.showTextTip("已经到达最后一个画板"),n.abrupt("return");case 34:if(!e.inCommentDrawing){n.next=44;break}return e.keydownConfirming=!0,n.prev=36,n.next=39,e.confirm({text:"正在编辑画板截图,是否清理截图信息并切换画板?"});case 39:if(n.sent){n.next=41;break}return n.abrupt("return");case 41:return n.prev=41,e.keydownConfirming=!1,n.finish(41);case 44:return e.setCurArtboard(s[c]),n.abrupt("break",46);case 46:case"end":return n.stop()}}),n,null,[[36,,41,44]])})))()},getArtboardExportNodeCount:function(t){if(this.inCloudMode)return t.artboard.resNodeCount;var e=t.exportNodes;return e.length},setVisible:function(t){this.$store.commit("leftSideVisible",t)}},computed:{curArtboardRemoved:function(){var t;return!(null===(t=this.curArtboard)||void 0===t||!t.removed)},emptyNodeListText:function(){var t=this.sliceFilterOpen,e=this.interactionFilterOpen;return"未找到".concat(t&&e?"包含切图和原型的":t?"包含切图的":e?"包含原型的":"相关","图层信息")},imageViewer:function(){return this.$store.state.imageViewer},cloudListSort:function(){return this.$store.state.cloudListSort},sortRenderDocumentArtboards:function(){var t=this.renderDocumentArtboards,e=this.cloudListSort;return t=Object(Gn["a"])(t),Zr(t,"updateTimeTimes",N.Artboard,e),t},renderArtboardList:function(){var t=this,e=this.commentFilterOpen,n=this.artboardInComment,i=this.artboardSearchText,r=this.sliceFilterOpen,a=this.sortRenderDocumentArtboards,o=""!==i;return a.filter((function(a){if(!a||!a.artboard)return!1;if(n){var s=a.artboard.comments+a.artboard.replies;if(e&&!(s>0))return!1}else if(r&&0===t.getArtboardExportNodeCount(a))return!1;if(o){var c=a.artboard.name;if(!c)return!1;if(-1===c.toLowerCase().indexOf(i))return!1}return!0}))},artboardSearchText:function(){return this.searchText.artboard.toLowerCase()},nodeInSearch:function(){return""!==this.searchText.node},frontStyle:function(){var t=this.renderList,e=0;if(t.length>0){var n=t[0].index;e=n*this.nodeLineHeight}return{marginTop:e+"px"}},braceStyle:function(){return{height:this.nodeList.length*this.nodeLineHeight+"px"}},renderList:function(){var t=this.nodeList,e=[],n=new ee,i=new ee,r=this.nodeLineHeight,a=this.preloadCount*r,o=this.nodeListHeight,s=this.nodeListScrollTop;return i.set(0,s-a,100,o+2*a),t.forEach((function(t,a){n.set(0,a*r,100,r),ce(n,i)&&e.push({node:t,index:a})})),e},interactionNodeList:function(){var t=this.curArtboard;if(!t)return[];var e=t.childs;return e&&0!==e.length?e.filter((function(t){return!!t.renderTapInteraction})):[]},nodeList:function(){var t,e=this.sliceFilterOpen,n=this.curArtboard,i=this.interactionFilterOpen;if(e||i){var r,a;if(t=[],e&&n.exportNodes)(r=t).push.apply(r,Object(Gn["a"])(n.exportNodes));if(i)(a=t).push.apply(a,Object(Gn["a"])(this.interactionNodeList))}else t=n.childs;var o=[],s=this.nodeInSearch,c=s?this.searchText.node.toLowerCase():"";return t.forEach((function(t){if(t.visible&&!t.mlIgnoreLeftSide){if(s){var e=t.name;if(!e)return;if(-1==e.toLowerCase().indexOf(c))return}o.push(t)}})),o},artlistModeMinTitle:function(){return this.artlistModeMin?"单击切换到大图模式":"单击切换到小图模式"},visible:function(){return this.$store.state.artboardDetail.leftSideVisible}},data:function(){return{curArtboardRemovedTipId:0,keydownConfirming:!1,preloadCount:2,nodeLineHeight:24,nodeListScrollTop:0,nodeListMousewheelTimes:0,nodeListMousewheelHandle:0,nodeListHeight:0,shiftKey:!1,showArtboardList:!1,artlistModeMin:"1"===nn("leftside.artlistmodemin",!1),sliceFilterOpen:"1"===nn("sliceFilterOpen",!1),commentFilterOpen:"1"===nn("commentFilterOpen",!1),interactionFilterOpen:"1"===nn("interactionFilterOpen",!1),searchText:{artboard:"",node:""}}},watch:{curArtboardRemoved:function(t){var e=this;if(t){var n,i=null===(n=this.curArtboard)||void 0===n?void 0:n.artboard;if(!i)return;var r=this.curArtboardRemovedTipId;if(r===i.cid)return;this.curArtboardRemovedTipId=i.cid,this.alert({text:"当前画板[".concat(i.name,"]已经被删除"),title:"提示",yesText:"返回列表"}).then((function(){e.curArtboardRemovedTipId=0,e.setCurArtboard(null)}))}},nodeListMousewheelTimes:function(t){var e=this;clearTimeout(this.nodeListMousewheelHandle),t>0&&(this.nodeListMousewheelHandle=setTimeout((function(){e.nodeListMousewheelTimes=0}),200))},artboardInComment:function(t){t&&this.visible&&!this.showArtboardList&&(this.showArtboardList=!0)},"editComment.drawing":function(t){t&&this.setVisible(!1)},visible:function(t){t&&this.artboardInComment&&(this.showArtboardList=!0)},curNode:function(t,e){if(t){var n=this.nodeList.findIndex((function(e){return t===e}));if(-1!==n){var i=this.nodeListScrollTop,r=this.nodeLineHeight,a=this.nodeListHeight,o=i,s=o+a-r-r;o+=r;var c=n*r;if(c>o&&c<s)return;var l=c-a/2,u=this.$refs.nodeList;u&&u.scrollTo({top:l,behavior:null===e?"auto":"smooth"})}}},curArtboard:function(t){t&&(this.onNodeListResize(),this.onNodeListScroll())}},mounted:function(){this.onNodeListResize(),this.onNodeListScroll()},created:function(){window.addEventListener("keydown",this.quickKey),window.addEventListener("keyup",this.quickKeyShift),window.addEventListener("resize",this.onNodeListResize),this.visible&&this.artboardInComment&&(this.showArtboardList=!0)},beforeDestroy:function(){window.removeEventListener("keydown",this.quickKey),window.removeEventListener("keyup",this.quickKeyShift),window.removeEventListener("resize",this.onNodeListResize),clearTimeout(this.nodeListMousewheelHandle)}},jg=Dg,Rg=(n("9eda"),Object(wo["a"])(jg,pg,vg,!1,null,"8e9736ce",null)),Vg=Rg.exports,Bg=function(){var t=this,e=t._self._c;return e("section",{staticClass:"node-properties",class:{on:t.hasValue}},[t.hasValue?[e("Header"),e("main",{class:{export:t.curNode.markedForExport}},[e("PropertyInfo",{attrs:{nodeStyle:t.nodeStyle}}),t.nodeStyle.fill?e("PropertyFill",{attrs:{nodeStyle:t.nodeStyle}}):t._e(),t.curNode.types.GraphicNode?e("PropertiesGraphicNode",{attrs:{nodeStyle:t.nodeStyle}}):t._e(),t.curNode.types.Text?e("PropertyText",{attrs:{sketchGroupFillColor:t.sketchGroupFillColor}}):t._e(),t.curNode.markedForExport?e("PropertyExport"):t._e(),t.cssVisible?e("PropertyCss",{attrs:{sketchGroupFillColor:t.sketchGroupFillColor,nodeStyle:t.nodeStyle}}):t._e()],1),t.curNode.markedForExport?e("footer",[e("a",{staticClass:"button download-all",attrs:{href:"javascript:;"},on:{click:function(e){return t.setInMultDownMode(!0)}}},[t._v("查看当前画板全部切图")])]):t._e()]:t._e()],2)},Ug=[],Hg=function(){var t=this,e=t._self._c;return e("div",[t._l(t.nodeStyle.borders,(function(n,i){return e("section",{key:"border-".concat(i),staticClass:"prop-box"},[e("h5",[n.position===t.SketchEnumBorderPositionNumber.Center||n.position===t.SketchEnumBorderPositionNumber.Inside||n.position===t.SketchEnumBorderPositionNumber.Outside?e("span",{domProps:{textContent:t._s(t.SketchEnumBorderPositionNumberStr[n.position])}}):t._e(),t._v("边框 ")]),e("dl",{staticClass:"item"},[e("dt",[t._v("粗细")]),e("dd",[e("PropertyShowValue",{attrs:{value:n.widths||n.width}}),n.widths?t._e():e("div",{staticClass:"inp empty"})],1)]),e("dl",{staticClass:"item"},[e("dt",[t._v("线条类型")]),e("dd",[e("PropertyShowValue",{attrs:{value:n.style}}),n.customDashes?t._e():e("div",{staticClass:"inp empty"})],1)]),e("PropertyColor",{attrs:{fill:n}})],1)})),t._l(t.nodeStyle.textStrokeStyles,(function(n,i){return e("section",{key:"text-stroke-".concat(i),staticClass:"prop-box"},[e("h5",[n.position===t.SketchEnumBorderPositionNumber.Center||n.position===t.SketchEnumBorderPositionNumber.Inside||n.position===t.SketchEnumBorderPositionNumber.Outside?e("span",{domProps:{textContent:t._s(t.SketchEnumBorderPositionNumberStr[n.position])}}):t._e(),t._v("文本笔划描边 ")]),e("dl",{staticClass:"item"},[e("dt",[t._v("粗细")]),e("dd",[e("PropertyShowValue",{attrs:{value:n.widths||n.width}}),n.widths?t._e():e("div",{staticClass:"inp empty"})],1)]),e("dl",{staticClass:"item"},[e("dt",[t._v("线条类型")]),e("dd",[e("PropertyShowValue",{attrs:{value:n.style}}),n.customDashes?t._e():e("div",{staticClass:"inp empty"})],1)]),e("PropertyColor",{attrs:{fill:n}})],1)})),t._l(t.nodeStyle.shadows,(function(n,i){return e("section",{key:"shadow-".concat(i),staticClass:"prop-box"},[e("h5",[t._v("外阴影")]),e("dl",{staticClass:"item loc"},[e("dt",[t._v("偏移")]),e("dd",[e("span",{staticClass:"loc-name"},[t._v("X")]),e("PropertyShowValue",{attrs:{value:n.x}}),e("span",{staticClass:"loc-name"},[t._v("Y")]),e("PropertyShowValue",{attrs:{value:n.y,cls:{m2:1}}})],1)]),e("dl",{staticClass:"item"},[e("dt",[t._v("模糊距离")]),e("dd",[e("PropertyShowValue",{attrs:{value:n.blur}}),e("div",{staticClass:"inp empty"})],1)]),n.spread?e("dl",{staticClass:"item"},[e("dt",[t._v("阴影大小")]),e("dd",[e("PropertyShowValue",{attrs:{value:n.spread}}),e("div",{staticClass:"inp empty"})],1)]):t._e(),e("PropertyShowColor",{attrs:{name:"颜色",value:n.color}})],1)})),t._l(t.nodeStyle.innerShadows,(function(n,i){return e("section",{key:"innerShadow-".concat(i),staticClass:"prop-box"},[e("h5",[t._v("内阴影")]),e("dl",{staticClass:"item loc"},[e("dt",[t._v("偏移")]),e("dd",[e("span",{staticClass:"loc-name"},[t._v("X")]),e("PropertyShowValue",{attrs:{value:n.x}}),e("span",{staticClass:"loc-name"},[t._v("Y")]),e("PropertyShowValue",{attrs:{value:n.y,cls:{m2:1}}})],1)]),e("dl",{staticClass:"item"},[e("dt",[t._v("模糊距离")]),e("dd",[e("PropertyShowValue",{attrs:{value:n.blur}}),e("div",{staticClass:"inp empty"})],1)]),n.spread?e("dl",{staticClass:"item"},[e("dt",[t._v("阴影大小")]),e("dd",[e("PropertyShowValue",{attrs:{value:n.spread}}),e("div",{staticClass:"inp empty"})],1)]):t._e(),e("PropertyShowColor",{attrs:{name:"颜色",value:n.color}})],1)}))],2)},Wg=[],$g=function(){var t=this,e=t._self._c;return t.fill.type===t.EnumFillShowType.FillColor?e("PropertyShowColor",{attrs:{name:t.solidName,value:t.fill.color}}):t.fill.type===t.EnumFillShowType.LinearGradientFill?e("div",[e("dl",{staticClass:"item"},[e("dt",[t._v("线性渐变")]),e("dd",[e("PropertyShowValue",{attrs:{value:"linear"}}),e("PropertyShowValue",{attrs:{cls:{m2:1},value:t.canvasAngle,title:"起点和终点的角度为沿水平右侧方向顺时针旋转: ".concat(t.canvasAngle)}})],1)]),t.linearEndPoints?[e("dl",{staticClass:"item loc"},[e("dd",[e("span",{staticClass:"loc-name start"},[t._v("起点")]),e("span",{staticClass:"loc-name"},[t._v("X1")]),e("PropertyShowValue",{attrs:{value:t.linearEndPoints.x1,copyValue:t.linearEndPoints.decimal_x1}}),e("span",{staticClass:"loc-name"},[t._v("Y1")]),e("PropertyShowValue",{attrs:{value:t.linearEndPoints.y1,copyValue:t.linearEndPoints.decimal_y1,cls:{m2:1}}})],1)]),e("dl",{staticClass:"item loc"},[e("dd",[e("span",{staticClass:"loc-name start"},[t._v("终点")]),e("span",{staticClass:"loc-name"},[t._v("X2")]),e("PropertyShowValue",{attrs:{value:t.linearEndPoints.x2,copyValue:t.linearEndPoints.decimal_x2}}),e("span",{staticClass:"loc-name"},[t._v("Y2")]),e("PropertyShowValue",{attrs:{value:t.linearEndPoints.y2,copyValue:t.linearEndPoints.decimal_y2,cls:{m2:1}}})],1)])]:t._e(),e("ul",{staticClass:"fill-list"},t._l(t.fill.colorStops,(function(n,i){return e("li",{key:"line-colorStop-".concat(i)},[e("div",{staticClass:"title",on:{click:function(e){return t.clickCopy(n.stop,!0)}}},[t._v(t._s(n.stop))]),e("PropertyShowColor",{attrs:{name:"",value:n.color,"non-swatch":!0}})],1)})),0)],2):t.fill.type===t.EnumFillShowType.RadialGradientFill||t.fill.type===t.EnumFillShowType.AngularGradientFill||t.fill.type===t.EnumFillShowType.DiamondGradientFill?e("div",[e("dl",{staticClass:"item"},[e("dt",[t._v(t._s(t.gradientInfo.name)+"渐变")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.gradientInfo.value}}),e("PropertyShowValue",{attrs:{cls:{m2:1},value:t.canvasAngle,title:"沿水平右侧方向顺时针旋转: ".concat(t.canvasAngle)}})],1)]),e("dl",{staticClass:"item loc"},[e("dd",[e("span",{staticClass:"loc-name start"},[t._v("圆心")]),e("span",{staticClass:"loc-name"},[t._v("X")]),e("PropertyShowValue",{attrs:{value:t.ellipseEndPoints.startX,copyValue:t.ellipseEndPoints.decimal_startX}}),e("span",{staticClass:"loc-name"},[t._v("Y")]),e("PropertyShowValue",{attrs:{value:t.ellipseEndPoints.startY,copyValue:t.ellipseEndPoints.decimal_startY,cls:{m2:1}}})],1)]),e("dl",{staticClass:"item loc"},[e("dd",[e("span",{staticClass:"loc-name start"},[t._v("半径")]),e("span",{staticClass:"loc-name"},[t._v("X")]),e("PropertyShowValue",{attrs:{value:t.ellipseEndPoints.scaleX,copyValue:t.ellipseEndPoints.decimal_scaleX}}),e("span",{staticClass:"loc-name"},[t._v("Y")]),e("PropertyShowValue",{attrs:{value:t.ellipseEndPoints.scaleY,copyValue:t.ellipseEndPoints.decimal_scaleY,cls:{m2:1}}})],1)]),e("ul",{staticClass:"fill-list"},t._l(t.fill.colorStops,(function(n,i){return e("li",{key:"radial-colorStop-".concat(i)},[e("div",{staticClass:"title",on:{click:function(e){return t.clickCopy(n.stop,!0)}}},[t._v(t._s(n.stop))]),e("PropertyShowColor",{attrs:{name:"",value:n.color,"non-swatch":!0}})],1)})),0)]):t._e()},Gg=[],zg=function(){var t,e=this,n=e._self._c;return n("div",{staticClass:"inp",class:e.cls,on:{click:e.clickCopy}},[n("span",{attrs:{title:null!==(t=e.title)&&void 0!==t?t:e.value},domProps:{textContent:e._s(e.value)}})])},Yg=[],Xg={methods:{clickCopy:function(t){if(!1!==this.doNotAutoCopy){var e=this.copyValue,n=this.value,i=null!=e;i&&(n=e);var r=i?dn(n):hn(n);i&&this.selectElement(t.target),r?this.showTextTip("已复制文本: ".concat(n),2):this.showTextTip("复制到剪切板失败",2)}},selectElement:function(t){if(t)try{if(window.getSelection){var e=window.getSelection(),n=document.createRange();n.selectNodeContents(t),e.removeAllRanges(),e.addRange(n)}}catch(i){}}},props:{value:null,title:{type:String,default:null},cls:Object,copyValue:null,doNotAutoCopy:{type:Boolean,default:!0}}},Kg=Xg,qg=Object(wo["a"])(Kg,zg,Yg,!1,null,null,null),Qg=qg.exports,Jg=function(){var t=this,e=t._self._c;return e("dl",{staticClass:"item",class:{"in-swatch":t.hasSwatch}},[t.name?e("dt",[t._v(t._s(t.name))]):t._e(),e("dd",[e("div",{staticClass:"container"},[e("div",{staticClass:"color"},[e("i",{style:{backgroundColor:t.rgba.value},attrs:{title:"点击切换颜色类型"},on:{contextmenu:function(e){return e.preventDefault(),t.showColorSelect.apply(null,arguments)},click:t.clickColorTypeNext}}),e("span",{staticClass:"inp",class:[this.currentColorType],on:{click:function(e){return t.clickCopy(t.showValue.value)}}},[e("span",{attrs:{title:t.showValue.value},domProps:{textContent:t._s(t.showValue.value)}})])]),"hex"===this.currentColorType?e("div",{staticClass:"inp opacity",on:{click:function(e){return t.clickCopy(t.opacity)}}},[e("span",{staticClass:"opacity",attrs:{title:t.opacity},domProps:{textContent:t._s(t.opacity)}})]):t._e(),t.colors.visible?e("ul",{staticClass:"colors"},t._l(t.colorTypes,(function(n,i){return e("li",{key:n,class:{on:t.currentColorTypeIndex===i},on:{click:function(e){return t.onColorSelectChanged(i)}}},[t._v(t._s(n.toUpperCase()))])})),0):t._e()]),t.hasSwatch?e("div",{staticClass:"container"},[e("div",{staticClass:"swatch",attrs:{title:"颜色变量: ".concat(t.swatch)}},[e("span",{staticClass:"swatch-text",on:{click:function(e){return t.clickCopy(t.swatch)}}},[t._v(t._s(t.swatch))])])]):t._e()])])},Zg=[],tw={computed:{colorTypes:function(){return this.$store.state.setting.color.items},currentColorType:function(){return this.colorTypes[this.$store.state.setting.color.current]},currentColorTypeIndex:function(){return this.$store.state.setting.color.current}},methods:{getSweach:function(t){var e;if(null!=t){var n=null===(e=this.curArtboard)||void 0===e?void 0:e.artboard.swatches;if(!n)return null;var i=n[t];if(ht(i)){var r=i.doc,a=i.lib;return ut(r)&&r.length>0?r[r.length-1]:ut(a)&&a.length>0?a[a.length-1]:null}}},setSettingColor:function(t){this.$store.commit("setSettingColor",t)},getColorRGBAValue:function(t){return Ft(t)},getCssShowColor:function(t,e){var n=Ft(t),i=this.getSweach(n.hexa);return t=1===n.opacity?Lt(n).value:n.value,i&&(i="".concat(t," : ").concat(i)),{value:t,swatch:i,name:e}},getColorValue:function(t){var e=this.getColorRGBAValue(t);switch(this.currentColorType){case"hex":e=Lt(e);break;case"ahex":e=Pt(e);break;case"hexa":e=Et(e);break;case"hsla":e=Nt(e);break}return e}}},ew={props:{value:null,name:String,nonSwatch:{type:Boolean,default:!1}},methods:{clickCopy:function(t){hn(t)?this.showTextTip("已复制文本: ".concat(t),2):this.showTextTip("复制到剪切板失败",2)},showColorSelect:function(){this.colors.visible=!0},clickColorTypeNext:function(){this.setSettingColor(this.currentColorTypeIndex+1)},onColorSelectChanged:function(t){this.setSettingColor(t)},hideColorSelect:function(){var t=this;requestAnimationFrame((function(){t.colors.visible=!1}))}},computed:{rgba:function(){return this.getColorRGBAValue(this.value)},showValue:function(){return this.getColorValue(this.value)},hasSwatch:function(){return!!this.swatch},swatch:function(){return this.nonSwatch?null:this.getSweach(this.rgba.hexa)},opacity:function(){var t=this.showValue.opacity;return tt.mul(t,100)+"%"}},mixins:[tw],watch:{"colors.visible":function(t){t?(window.addEventListener("click",this.hideColorSelect,!0),window.addEventListener("contextmenu",this.hideColorSelect,!0)):(window.removeEventListener("click",this.hideColorSelect,!0),window.removeEventListener("contextmenu",this.hideColorSelect,!0))}},beforeDestroy:function(){window.removeEventListener("click",this.hideColorSelect,!0),window.removeEventListener("contextmenu",this.hideColorSelect,!0)},data:function(){return{colors:{visible:!1}}}},nw=ew,iw=(n("da24"),Object(wo["a"])(nw,Jg,Zg,!1,null,"07929568",null)),rw=iw.exports,aw={methods:{clickCopy:function(t,e){e&&(t=fn(parseFloat(t)/100,4)),dn(t)?this.showTextTip("已复制文本: ".concat(t),2):this.showTextTip("复制到剪切板失败",2)}},computed:{canvasAngle:function(){var t;return $n(null===(t=this.fill)||void 0===t?void 0:t.angle)},EnumFillShowType:function(){return A},gradientInfo:function(){var t,e;switch(this.fill.type){case A.RadialGradientFill:t="径向",e="radial";break;case A.AngularGradientFill:t="角度",e="angular";break;case A.DiamondGradientFill:t="菱形",e="diamond";break}return{name:t,value:e}},ellipseEndPoints:function(){var t=this.fill;if(t.type===A.RadialGradientFill||t.type===A.AngularGradientFill||t.type===A.DiamondGradientFill){var e=t.startX,n=t.startY,i=t.scaleX,r=t.scaleY,a=[e,n,i,r].map((function(t){return fn(parseFloat(t)/100,4)})),o=Object(Z["a"])(a,4),s=o[0],c=o[1],l=o[2],u=o[3];return{startX:e,startY:n,scaleX:i,scaleY:r,decimal_startX:s,decimal_startY:c,decimal_scaleX:l,decimal_scaleY:u}}},linearEndPoints:function(){var t=this.fill;if(t.type!==A.LinearGradientFill)return null;var e=t.endPoints;if(!ut(e)||4!==e.length)return null;var n=e.map((function(t){return fn(t,4)})),i=Object(Z["a"])(n,4),r=i[0],a=i[1],o=i[2],s=i[3],c=e.map((function(t){return fn(100*t,2)+"%"})),l=Object(Z["a"])(c,4),u=l[0],d=l[1],h=l[2],f=l[3];return{x1:u,y1:d,x2:h,y2:f,decimal_x1:r,decimal_y1:a,decimal_x2:o,decimal_y2:s}}},components:{PropertyShowColor:rw,PropertyShowValue:Qg},props:{fill:Object,solidName:{type:String,default:"纯色"}}},ow=aw,sw=(n("22cc"),Object(wo["a"])(ow,$g,Gg,!1,null,"f5e01fae",null)),cw=sw.exports,lw={components:{PropertyShowColor:rw,PropertyShowValue:Qg,PropertyColor:cw},props:{nodeStyle:Object},computed:{SketchEnumBorderPositionNumber:function(){return I},SketchEnumBorderPositionNumberStr:function(){return{0:"中心",1:"内",2:"外"}}}},uw=lw,dw=Object(wo["a"])(uw,Hg,Wg,!1,null,null,null),hw=dw.exports,fw=function(){var t=this,e=t._self._c;return e("section",{staticClass:"prop-box"},[e("dl",{staticClass:"item node-name"},[e("dt",[t._v("图层")]),e("dd",{staticClass:"cur-node-name"},[e("NodeName",{attrs:{node:t.curNode}})],1)]),t.renderTapInteraction?e("PropertyInfoInteraction",{attrs:{renderTapInteraction:t.renderTapInteraction}}):t._e(),e("h5",[t._v("比例")]),e("dl",{staticClass:"item loc"},[e("dd",[e("span",{staticClass:"loc-name mid"},[t._v("X")]),e("PropertyShowValue",{attrs:{value:t.nodeStyle.left}}),e("span",{staticClass:"loc-name"},[t._v("Y")]),e("PropertyShowValue",{attrs:{value:t.nodeStyle.top,cls:{m2:1}}})],1)]),e("dl",{staticClass:"item loc"},[e("dd",[e("span",{staticClass:"loc-name mid"},[t._v("W")]),e("PropertyShowValue",{attrs:{value:t.nodeStyle.width}}),e("span",{staticClass:"loc-name"},[t._v("H")]),e("PropertyShowValue",{attrs:{value:t.nodeStyle.height,cls:{m2:1}}})],1)]),e("dl",{staticClass:"item",class:{opa:t.showBlendOpacity}},[e("dt",{attrs:{title:"当前图层的不透明度"}},[t._v("不透明度")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.nodeStyle.opacity}}),e("div",{staticClass:"inp empty"})],1)]),t.showBlendOpacity?e("dl",{staticClass:"item opa"},[e("dt",{attrs:{title:"组合不透明度是指叠加了当前图层和所有父级图层透明度的计算值"}},[t._v("组合不透明度")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.nodeStyle.blendOpacity}}),e("div",{staticClass:"inp empty"})],1)]):t._e(),t.nodeStyle.cornerRadiiValue?e("dl",{staticClass:"item"},[e("dt",[t._v("圆角")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.nodeStyle.cornerRadiiValue}}),t.shortCornerRadiiValue?e("div",{staticClass:"inp empty"}):t._e()],1)]):t._e(),t.curNode.boxTransform?[0!==t.curNode.boxTransform.rotation?e("dl",{staticClass:"item"},[e("dt",[t._v("旋转")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.curNode.boxTransform.rotation+"deg"}}),e("div",{staticClass:"inp empty"})],1)]):t._e(),t.flippedText?e("dl",{staticClass:"item"},[e("dt",[t._v("翻转")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.flippedText}}),e("div",{staticClass:"inp empty"})],1)]):t._e()]:t._e(),t.objectEffect?e("dl",{staticClass:"item"},[e("dt",[t._v("高斯模糊")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.objectEffect}}),e("span",{staticClass:"inp empty"})],1)]):t._e(),t.backgroundEffect?e("dl",{staticClass:"item"},[e("dt",[t._v("背景模糊")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.backgroundEffect}}),null==t.backgroundEffectBrightness&&null==t.backgroundEffectSaturation?e("span",{staticClass:"inp empty"}):t.backgroundEffectBrightness?e("div",{staticClass:"brightness"},[e("span",{staticClass:"bn-name"},[t._v("亮度")]),e("PropertyShowValue",{attrs:{value:t.backgroundEffectBrightness}})],1):t.backgroundEffectSaturation?e("div",{staticClass:"saturation"},[e("span",{staticClass:"bn-name"},[t._v("饱和度")]),e("PropertyShowValue",{attrs:{value:t.backgroundEffectSaturation}})],1):t._e()],1)]):t._e()],2)},mw=[],pw=function(){var t=this,e=t._self._c;return e("dl",{staticClass:"item"},[e("dt",[t._v(t._s(t.typeName))]),e("dd",[e("a",{staticClass:"interaction-link",attrs:{href:"javascript:;",title:t.toArtboardName},on:{click:t.clickGoArtboard}},[t._v(t._s(t.toArtboardName))])])])},vw=[],bw={methods:{clickGoArtboard:function(){this.$store.commit("setInteractionArtboard",this.renderTapInteraction)}},computed:{typeName:function(){return zi.getTypeName(this.renderTapInteraction.type)},toArtboardName:function(){var t,e;switch(this.renderTapInteraction.type){case zi.goBack:case zi.goBackAndCloseAllOverlay:return"上一个画板";case zi.closeCurrentOverlay:return"最顶部遮罩层";case zi.goUrl:return this.renderTapInteraction.toUrl;default:return null!==(t=null===(e=this.toArtboardItem)||void 0===e?void 0:e.name)&&void 0!==t?t:"目标画板未上传"}},toArtboardItem:function(){var t,e;return null!==(t=null===(e=this.renderTapInteraction)||void 0===e?void 0:e.toArtboardItem)&&void 0!==t?t:null}},props:{renderTapInteraction:Object}},gw=bw,ww=(n("7eae"),Object(wo["a"])(gw,pw,vw,!1,null,"7e5908d3",null)),xw=ww.exports,yw=function(){var t=this,e=t._self._c;return e("div",{staticClass:"node-name",class:{focused:t.focused,"non-export":!t.node.markedForExport}},[this.node.markedForExport?e("input",{attrs:{type:"text","max-length":"50",spellcheck:"false"},domProps:{value:t.nodeShowName},on:{focus:t.inputFocus,blur:function(e){return t.inputBlur(e)},compositionstart:t.compositionstart,compositionend:t.compositionend,keyup:t.inputKeyup}}):e("div",{attrs:{title:t.nodeShowName}},[t._v(t._s(t.nodeShowName))])])},kw=[],Cw={methods:{inputKeyup:function(t){var e=t.keyCode||t.which;13==e&&(t.target.blur(),t.preventDefault())},compositionstart:function(){this.inComposition=!0},compositionend:function(){this.inComposition=!1},inputFocus:function(){this.focused=!0},inputBlur:function(t){this.focused=!1;var e=t.target.value.trim();if(e!==this.nodeShowName){var n=this.node;n.markedForExport?en(this,n,e):this.showTextTip("只有切图资源才可以进行重命名操作")}}},computed:{nodeShowName:function(){var t=this.node,e=Ke(t);if(!t.markedForExport&&dt(e)){e=e.trim();var n=e.length;n>33&&(e=e.substr(0,30)+"...")}return e}},data:function(){return{focused:!1,inComposition:!1}},props:{node:Object}},Sw=Cw,Tw=(n("2a5a"),Object(wo["a"])(Sw,yw,kw,!1,null,"58a95a4a",null)),Aw=Tw.exports,Iw={props:{nodeStyle:Object},components:{PropertyShowValue:Qg,NodeName:Aw,PropertyInfoInteraction:xw},computed:{showBlendOpacity:function(){var t=this.nodeStyle;return t.blendOpacity&&t.blendOpacity!=t.opacity},objectEffect:function(){var t=this.nodeStyle.objectEffect;return null==t||t<=0?"":this.getCalcPlatformValue(t,{needArtScale:!0})},backgroundEffect:function(){var t=this.nodeStyle.backgroundEffect;return null==t||t<=0?"":this.getCalcPlatformValue(t,{needArtScale:!0})},backgroundEffectBrightnessDecimal:function(){var t=this.nodeStyle.backgroundEffectBrightness;return"number"!==typeof t||1===t?null:fn(t,2)},backgroundEffectBrightness:function(){var t=this.backgroundEffectBrightnessDecimal;return null==t?null:Math.round(100*t)+"%"},backgroundEffectSaturationDecimal:function(){var t=this.nodeStyle.backgroundEffectSaturation;return"number"!==typeof t||1===t?null:fn(t,2)},backgroundEffectSaturation:function(){var t=this.backgroundEffectSaturationDecimal;return null==t?null:Math.round(100*t)+"%"},renderTapInteraction:function(){var t=this.curNode;if(!t)return null;var e=t.renderTapInteraction;if(e)return e;var n=t.parentNode,i=t.boundsInArtboard;while(n){if(i.isSame(n.boundsInArtboard)&&(e=n.renderTapInteraction,e))return e;n=n.parentNode}return null},flippedText:function(){var t=this.curNode.boxTransform;if(t){var e="";return t.flippedHorizontally&&(e="水平"),t.flippedVertically&&(e?e+=" & 垂直":e="垂直"),e}},shortCornerRadiiValue:function(){var t=this.nodeStyle.cornerRadiiValue;return!t||-1===t.indexOf(" ")}},created:function(){0}},Fw=Iw,Mw=(n("55ec"),Object(wo["a"])(Fw,fw,mw,!1,null,"3c295315",null)),Ow=Mw.exports,_w=function(){var t=this,e=t._self._c;return t.visible?e("section",{staticClass:"prop-box"},[e("h5",{staticClass:"fill-title"},[e("span",[t._v("填充")]),t.nodeStyle.blendMode?e("div",{staticClass:"blend-mode"},[e("span",[t._v("混合模式")]),e("PropertyShowValue",{attrs:{value:t.nodeStyle.blendMode}})],1):t._e()]),t._l(t.fills,(function(t,n){return e("PropertyColor",{key:"fill-".concat(n),attrs:{fill:t}})}))],2):t._e()},Lw=[],Pw={props:{nodeStyle:Object},computed:{fills:function(){return this.nodeStyle.fills},visible:function(){return this.fills.length>0}},components:{PropertyShowValue:Qg,PropertyColor:cw},data:function(){return{EnumFillShowType:A}}},Ew=Pw,Nw=(n("7cdb"),Object(wo["a"])(Ew,_w,Lw,!1,null,"5e9c8124",null)),Dw=Nw.exports,jw=function(){var t=this,e=t._self._c;return e("section",[e("section",{staticClass:"prop-box"},[e("h5",[t._v("文本")]),t._l(t.combineStyles,(function(n,i){return[n.color?e("PropertyTextColor",{key:i,attrs:{forKey:i,item:n,sketchGroupFillColor:t.sketchGroupFillColor,itemStyle:t.style}}):n.hideDefault&&t.styles[0][n.field]===n.default?t._e():e("dl",{key:i,staticClass:"item"},[e("dt",{domProps:{textContent:t._s(n.name)}}),e("dd",[e("PropertyShowValue",{attrs:{value:n.extendValue(t.styles[0][n.field],"fontWeight"===n.field?t.calcPlatformShowType:t.getCalcPlatformValue)}}),"fontWeight"===n.field?e("PropertyShowValue",{attrs:{value:t.styles[0].fontWeightCss,cls:t.fontWeightCls}}):n.halfWidth?e("div",{staticClass:"inp m2 empty"}):t._e()],1)])]})),t.paragraphIndent?e("dl",{staticClass:"item"},[e("dt",[t._v("段落缩进")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.paragraphIndent}}),e("div",{staticClass:"inp m2 empty"})],1)]):t._e(),t.paragraphSpacing?e("dl",{staticClass:"item"},[e("dt",[t._v("段落间距")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.paragraphSpacing}}),e("div",{staticClass:"inp m2 empty"})],1)]):t._e(),t.lineSpacing?e("dl",{staticClass:"item"},[e("dt",[t._v("行高")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.lineSpacing}}),e("div",{staticClass:"inp m2 empty"})],1)]):t._e(),e("dl",{staticClass:"item"},[e("dt",[t._v("对齐方式")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.curNode.textAlign}}),e("div",{staticClass:"inp m2 empty"})],1)]),t.curNode.textVerticalAlign?e("dl",{staticClass:"item"},[e("dt",[t._v("垂直对齐")]),e("dd",[e("PropertyShowValue",{attrs:{value:t.curNode.textVerticalAlign}}),e("div",{staticClass:"inp m2 empty"})],1)]):t._e()],2),t.unCombineStyles.length>0?e("div",[t._l(t.styles,(function(n,i){return[""!=t.subTexts[i]?e("section",{key:i,staticClass:"prop-box uncombine"},[e("h5",[t._v("文本"+t._s(i+1))]),t._l(t.unCombineStyles,(function(i,r){return[i.color?e("PropertyTextColor",{key:i.field,attrs:{forKey:i.field,item:i,sketchGroupFillColor:t.sketchGroupFillColor,itemStyle:n}}):i.hideDefault&&n[i.field]===i.default?t._e():e("dl",{key:r,staticClass:"item"},[e("dt",{domProps:{textContent:t._s(i.name)}}),e("dd",[e("PropertyShowValue",{attrs:{value:i.extendValue(n[i.field],"fontWeight"===i.field?t.calcPlatformShowType:t.getCalcPlatformValue)}}),"fontWeight"===i.field?e("PropertyShowValue",{attrs:{value:n.fontWeightCss,cls:t.fontWeightCls}}):i.halfWidth?e("div",{staticClass:"inp m2 empty"}):t._e()],1)])]}))],2):t._e()]}))],2):t._e(),e("h5",{staticClass:"mult-h5"},[t._v(" 文本内容 "),e("a",{staticClass:"copy",attrs:{href:"javascript:;"},on:{click:function(e){return t.copyText(t.text)}}},[t._v("复制文本")])]),e("dl",{staticClass:"item mult"},[e("dd",[e("PropertyShowValue",{attrs:{doNotAutoCopy:!1,value:t.text,cls:{multiple:1}}})],1)])])},Rw=[],Vw=function(){var t=this,e=t._self._c;return t.itemStyle.figmaFills?e("div",t._l(t.itemStyle.figmaFills,(function(n,i){return e("PropertyColor",{key:"".concat(t.forKey,"_").concat(i,"_fig"),attrs:{fill:n,solidName:"前景色"}})})),1):t.itemStyle.fills&&t.itemStyle.fills.length>1?e("div",t._l(t.itemStyle.fills,(function(n,i){return e("PropertyShowColor",{key:"".concat(t.forKey,"_").concat(i),attrs:{name:"".concat(t.item.name).concat(i+1),value:t.tintColor(n.value)}})})),1):e("PropertyShowColor",{key:t.forKey,attrs:{name:t.item.name,value:t.tintColor(t.itemStyle.fill.value)}})},Bw=[],Uw={components:{PropertyColor:cw,PropertyShowColor:rw},methods:{tintColor:function(t){return vn(this.sketchGroupFillColor,t)}},props:{itemStyle:Object,forKey:String,item:Object,sketchGroupFillColor:{type:Object,validator:function(){return!0}}}},Hw=Uw,Ww=Object(wo["a"])(Hw,Vw,Bw,!1,null,null,null),$w=Ww.exports,Gw=[{name:"字体",field:"fontFamily"},{name:"字重",field:"fontWeight",halfWidth:!1,hideDefault:!1,default:"normal",extendValue:function(t,e){if("number"===typeof t){var n=p[t];n&&(t=n.toLowerCase())}return e===s.IOS&&t&&"normal"===t.toLowerCase()&&(t="Regular"),t}},{name:"斜体",field:"fontItalic",halfWidth:!0,hideDefault:!0,default:"normal"},{name:"前景色",field:"fill",color:!0},{name:"字号",field:"fontSize",halfWidth:!0,extendValue:function(t,e){return e(t,{fontSize:!0,needArtScale:!0})}},{name:"字间距",field:"charSpacing",hideDefault:!0,default:null,halfWidth:!0,extendValue:function(t,e){return e(t,{needArtScale:!0})}}];Gw.forEach((function(t){t.extendValue||(t.extendValue=function(t){return t})}));var zw={components:{PropertyShowValue:Qg,PropertyTextColor:$w},methods:{copyText:function(t){null!=t&&(dn(t)?this.showTextTip("已复制文本到剪切板",2):this.showTextTip("复制到剪切板失败",2))}},computed:{fontWeightCls:function(){return{m2:1}},paragraphIndent:function(){var t=this.curNode,e=t.paragraphIndent;return 0===e||null==e?"":this.getCalcPlatformValue(e,{needArtScale:!0})},paragraphSpacing:function(){var t=this.curNode,e=t.paragraphSpacing;return 0===e||null==e?"":this.getCalcPlatformValue(e,{needArtScale:!0})},lineSpacing:function(){var t=this.curNode,e=t.lineSpacing;return 0===e||null==e?"auto":this.getCalcPlatformValue(e,{needArtScale:!0})},unCombineStyles:function(){var t=[],e=this.combineStyles;return Gw.forEach((function(n){e[n.field]||t.push(n)})),t},combineStyles:function(){var t={},e=this.styles,n=e.length;return n<=1?(1===n&&Gw.forEach((function(e){t[e.field]=e})),t):(Gw.forEach((function(i){var r=!0,a=e[0][i.field];i.color&&(a=a.value);for(var o=1;o<n;o++){var s=e[o];if(s){var c=s[i.field];if(i.color&&(c=c.value),c!==a){r=!1;break}}}r&&(t[i.field]=i)})),t)},subTexts:function(){var t=this.text,e=[],n=this.styles;if(0===n.length||1===n.length&&0===n[0].length)return e.push(t),e;var i=0;return n.forEach((function(r,a){var o;a===n.length-1?o=t.substr(i).trim():(o=t.substr(i,r.length).trim(),i+=r.length),e.push(o)})),e},text:function(){return this.curNode.text||""},styles:function(){return this.curNode.styleRanges||[]},style:function(){return this.styles[0]}},props:{sketchGroupFillColor:{type:Object,validator:function(){return!0}}}},Yw=zw,Xw=Object(wo["a"])(Yw,jw,Rw,!1,null,null,null),Kw=Xw.exports,qw=function(){var t=this,e=t._self._c;return t.visible?e("section",{staticClass:"prop-box css-box"},[e("h5",{staticClass:"mult-h5"},[t._v(" CSS "),e("a",{staticClass:"copy",attrs:{href:"javascript:;"},on:{click:function(e){return t.copyText(t.propertyText)}}},[t._v("复制样式")])]),e("dl",{staticClass:"item mult"},[e("dd",[e("ul",{staticClass:"css"},t._l(t.properties,(function(n,i){return e("li",{key:"property-".concat(i)},[n.name?[n.swatch?e("span",{staticClass:"desc desc-swatch"},[t._v("/* "+t._s(n.swatch)+" */")]):t._e(),e("span",{staticClass:"name"},[t._v(t._s(n.name)+":")]),e("span",{staticClass:"value"},[t._v(t._s(n.value)+";")])]:n.desc?[e("span",{staticClass:"desc"},[t._v(t._s(n.desc))])]:t._e()],2)})),0)])])]):t._e()},Qw=[],Jw={mixins:[tw],props:{nodeStyle:Object,sketchGroupFillColor:{type:Object,validator:function(){return!0}}},methods:{copyText:function(t){dn(t)?this.showTextTip("已复制样式到剪切板",2):this.showTextTip("复制到剪切板失败",2)}},computed:{visible:function(){return this.properties.length>0},properties:function(){var t,e,n,i=this,r=this.curNode,a=[],o=this.nodeStyle;n="opacity",e=o[n],e&&"100%"!==e&&a.push({name:n,value:e}),n="width",e=o[n],e&&a.push({name:n,value:e}),n="height",e=o[n],e&&a.push({name:n,value:e}),o.blendMode&&(n="mix-blend-mode",e=o.blendMode,e&&a.push({name:n,value:e}));var s=r.boxTransform;s&&(n="transform",e=0!==s.rotation?"rotate(".concat(s.rotation,"deg)"):"",s.flippedHorizontally&&(e+=" scaleX(-1)"),s.flippedVertically&&(e+=" scaleY(-1)"),e&&a.push({name:n,value:e}));var c=!!r.types.Text;function l(){if(c){var t=" -webkit-background-clip",e="text";a.push({name:t,value:e}),t=" -webkit-text-fill-color",e="transparent",a.push({name:t,value:e}),t=" background-clip",e="text",a.push({name:t,value:e}),t=" text-fill-color",e="transparent",a.push({name:t,value:e})}}var u=[];if(o.fills&&u.push.apply(u,Object(Gn["a"])(o.fills)),c&&(null===(t=r.styleRanges)||void 0===t?void 0:t.length)>0){var d,h=r.styleRanges[0];if((d=null===h||void 0===h?void 0:h.figmaFills)&&d.length>0){var f=d[0];null!=f.type&&f.type!=A.FillColor&&u.push(f)}}if(u.length>0){var m=[];u.forEach((function(t){switch(t.type){case A.FillColor:var r=i.getCssShowColor(t.color,n).value;m.push({color:r,image:"linear-gradient(0deg,".concat(r,",").concat(r,")")});break;case A.RadialGradientFill:e="radial-gradient(ellipse ".concat(t.scaleX," ").concat(t.scaleY," at ").concat(t.startX," ").concat(t.startY," ,").concat(t.colorStops.map((function(t){return"".concat(i.getCssShowColor(t.color).value," ").concat(t.stop)})).join(","),")");var o=$n(t.angle);"0deg"!==o&&a.push({desc:"/*\n径向渐变(radial-gradient)不支持旋转角度,可结合:before或:after配合transform实现\ntransform:rotate(".concat(o,");\n*/")}),m.push({image:e});break;case A.DiamondGradientFill:e="radial-gradient(ellipse ".concat(t.scaleX," ").concat(t.scaleY," at ").concat(t.startX," ").concat(t.startY," ,").concat(t.colorStops.map((function(t){return"".concat(i.getCssShowColor(t.color).value," ").concat(t.stop)})).join(","),")"),a.push({desc:"/*css不支持菱形渐变,当前写法为径向渐变(radial-gradient)且不含旋转角度*/"}),m.push({image:e});break;case A.AngularGradientFill:e="conic-gradient(from ".concat(t.angle," at ").concat(t.startX," ").concat(t.startY," ,").concat(t.colorStops.map((function(t){return"".concat(i.getCssShowColor(t.color).value," ").concat(t.stop)})).join(","),")"),m.push({image:e});break;case A.LinearGradientFill:e="linear-gradient(".concat(t.angle,",").concat(t.colorStops.map((function(t){var e;return"".concat(i.getCssShowColor(t.color).value," ").concat(null!==(e=t.cssStop)&&void 0!==e?e:t.stop)})).join(","),")"),m.push({image:e})}}));var p=m.length;if(p>0){var v=!1;n="background",e=m.map((function(t,e){var n=p===e+1;return n&&t.color?t.color:(v=!0,t.image)})).join(","),a.push({name:n,value:e}),v&&l()}}var b=o.border;if(b)switch(b.widths?(n="border-style",e=b.style,a.push({name:n,value:e}),n="border-width",e=b.widths,a.push({name:n,value:e})):(n="border",e="".concat(b.width," ").concat(b.style),a.push({name:n,value:e})),b.type){case A.FillColor:n="border-color",e=this.getCssShowColor(b.color,n),e&&a.push(e);break;case A.RadialGradientFill:case A.LinearGradientFill:n="border-image-source",e="linear-gradient(".concat(b.angle,",").concat(b.colorStops.map((function(t){return"".concat(i.getCssShowColor(t.color).value," ").concat(t.stop)})).join(","),")"),a.push({name:n,value:e}),n="border-image-slice",e="1",a.push({name:n,value:e})}var g,w=o.textStrokeStyle;if(w)switch(n="-webkit-text-stroke-width",e=null!==(g=w.widths)&&void 0!==g?g:w.width,a.push({name:n,value:e}),n="text-stroke-width",a.push({name:n,value:e}),w.type){case A.FillColor:n="-webkit-text-stroke-color",e=this.getCssShowColor(w.color,n),e&&(a.push(e),n="text-stroke-color",a.push({name:n,value:e.value}));break}if(o.strokesIncludedInLayout&&a.push({name:"box-sizing",value:"border-box"}),n="border-radius",e=o.cornerRadiiValue,e&&a.push({name:n,value:e}),o.objectEffect&&(n="filter",e="blur(".concat(this.getCalcPlatformValue(o.objectEffect,{needArtScale:!0}),")"),a.push({name:n,value:e})),o.backgroundEffect){n="backdrop-filter",e="blur(".concat(this.getCalcPlatformValue(o.backgroundEffect,{needArtScale:!0}),")");var x=o.backgroundEffectBrightness,y=o.backgroundEffectSaturation;"number"===typeof x&&1!==x&&(e+=" brightness(".concat(x,")")),"number"===typeof y&&1!==y&&(e+=" saturate(".concat(y,")")),a.push({name:n,value:e})}var k=[],C=[];if(o.shadows.forEach((function(t){if(t){var e=i.getCssShowColor(t.color);e.swatch&&C.push(e.swatch),k.push("".concat(t.x," ").concat(t.y," ").concat(t.blur).concat(t.spread?" "+t.spread:""," ").concat(e.value))}})),o.innerShadows.forEach((function(t){if(t){var e=i.getCssShowColor(t.color);e.swatch&&C.push(e.swatch),k.push("".concat(t.x," ").concat(t.y," ").concat(t.blur).concat(t.spread?" "+t.spread:""," ").concat(e.value," inset"))}})),k.length>0&&(n=r.types.Text?"text-shadow":"box-shadow",e=k.join(","),a.push({name:n,value:e,swatch:C.join("\n    ")})),!r.markedForExport&&r.types.Text){var S=r.styleRanges;if(ut(S)&&S.length>0&&(S=S[0],S)){if(S.fontFamily&&(n="font-family",e=S.fontFamily,a.push({name:n,value:e})),S.fontWeightCss&&"400"!==S.fontWeightCss&&(n="font-weight",e=S.fontWeightCss,a.push({name:n,value:e})),S.fontItalic&&"normal"!==S.fontItalic&&(n="font-style",e=S.fontItalic,a.push({name:n,value:e})),S.fill&&null!=S.fill.value){n="color";var T=S,I=T.fills,F=T.fill;if((null===I||void 0===I?void 0:I.length)>1){for(var M=Ft(I[I.length-1].value),O=I.length-2;O>=0;O--){var _=I[O];M=jt(M,Ft(_.value))}F={value:Ot(M.r,M.g,M.b,M.a)}}e=this.getCssShowColor(vn(this.sketchGroupFillColor,F.value),n),a.push(e)}null!=S.fontSize&&(n="font-size",e=this.getCalcPlatformValue(S.fontSize,{fontSize:!0,needArtScale:!0}),a.push({name:n,value:e})),0!==S.charSpacing&&null!=S.charSpacing&&(n="letter-spacing",e=this.getCalcPlatformValue(S.charSpacing,{needArtScale:!0}),a.push({name:n,value:e})),S.underline?(n="text-decoration",e="underline",a.push({name:n,value:e})):S.strikethrough&&(n="text-decoration",e="line-through",a.push({name:n,value:e}))}0!=r.paragraphIndent&&null!=r.paragraphIndent&&(n="text-indent",e=this.getCalcPlatformValue(r.paragraphIndent,{needArtScale:!0}),a.push({name:n,value:e})),0!=r.paragraphSpacing&&null!=r.paragraphSpacing&&(n="padding-bottom",e=this.getCalcPlatformValue(r.paragraphSpacing,{needArtScale:!0}),a.push({name:n,value:e})),n="line-height",e=0!=r.lineSpacing&&null!=r.lineSpacing?this.getCalcPlatformValue(r.lineSpacing,{needArtScale:!0}):"normal",a.push({name:n,value:e}),r.textAlign&&(n="text-align",e=r.textAlign,"left"!=e&&a.push({name:n,value:e})),r.textVerticalAlign&&(n="vertical-align",e=r.textVerticalAlign,a.push({name:n,value:e}))}var L=a.findIndex((function(t){return"height"===t.name})),P=-1===L?-1:a.findIndex((function(t){return"line-height"===t.name}));if(-1!==P){var E=a[P];a.splice(P,1),a.splice(L+1,0,E)}return a},propertyText:function(){var t=this.properties;return t.filter((function(t){return!!t.name||!!t.desc})).map((function(t){return t.name?"".concat(t.swatch?"/* ".concat(t.swatch," */\n"):"").concat(t.name,": ").concat(t.value,";"):t.desc})).join("\n").trim()}}},Zw=Jw,tx=(n("2128"),Object(wo["a"])(Zw,qw,Qw,!1,null,"1464cfc9",null)),ex=tx.exports,nx=function(){var t=this,e=t._self._c;return e("section",{staticClass:"prop-box prop-export"},[e("h5",[e("span",[t._v("切图")]),e("span",{staticClass:"export-bg"},[e("span",{class:{on:t.ExportBoxBackgroundType.Black===t.exportBoxBackground,black:1},attrs:{title:"深色背景填充"},on:{click:function(e){return t.clickExportBoxBackgroundType(t.ExportBoxBackgroundType.Black)}}}),e("span",{class:{on:t.ExportBoxBackgroundType.Transparent===t.exportBoxBackground,transparent:1},attrs:{title:"浅色背景填充"},on:{click:function(e){return t.clickExportBoxBackgroundType(t.ExportBoxBackgroundType.Transparent)}}})])]),e("section",{staticClass:"preview",class:["type"+t.exportBoxBackground]},[t.exportPdfOnly?e("PdfViewer",{attrs:{maxWidth:"290px",maxHeight:"112px",url:t.exportPreviewSrc}}):e("img",{class:{jpg:t.currentResInJpg},attrs:{src:t.exportPreviewSrc}})],1),e("section",{staticClass:"download-box"},[e("PropertyDownloadOptions",{ref:"downOptions",attrs:{currentResInPdf:t.currentResInPdf,currentResInSvg:t.currentResInSvg,currentResInJpg:t.currentResInJpg,exportPdfOnly:t.exportPdfOnly,exportSvgOnly:t.exportSvgOnly,jpgQuality:t.jpgQuality,downloadPlatform:t.calcPlatformUse,node:t.curNode},on:{setJpgQuality:t.setJpgQuality,clickDownSelect:t.clickDownSelect}}),e("div",{staticClass:"btns"},[e("Select",{attrs:{options:t.resTypeSelectOptions,checkShowUpFixedHeight:48},on:{changed:t.onResTypeSelectChanged}}),t.currentResInSvg||t.currentResInPdf?e("a",{staticClass:"button light download",attrs:{href:"javascript:;"},on:{click:t.clickDownSelect}},[t._v("下载切图")]):e("a",{staticClass:"button light download",attrs:{href:"javascript:;"},on:{click:t.clickDownSelectAll}},[t._v("下载切图")])],1)],1)])},ix=[],rx=function(){var t=this,e=t._self._c;return e("div",{staticClass:"down-options-box"},[t.downloadPlatform===t.CALC_PLATFORM_TYPE.ANDROID?e("Select",{attrs:{options:t.androidUseMipmapSelectOptions},on:{changed:t.onAndroidUseMipmapSelectChanged}}):t._e(),e("div",{staticClass:"down-options",class:t.optionsClass},[t._l(t.downloadPlatformItems,(function(n){return e("PropertyDownloadItem",{key:n.value.name,attrs:{config:n.value,node:t.node,enabled:n.enabled,selected:t.currentResInSvg||t.currentResInPdf||1==t.checkSetting[n.value.scale]},on:{clickItemSelect:t.clickItemSelect,clickDownSelect:t.clickDownSelect}})})),t.currentResInJpg?e("div",{staticClass:"jpg-quality"},[e("div",{staticClass:"text"},[t._v("JPG质量")]),e("div",{staticClass:"quality-num"},[t._v(t._s(t.jpgQuality))]),e("div",{staticClass:"pullrod"},[e("div",{staticClass:"line",on:{click:t.clickPullrodLine}}),e("span",{style:{left:t.jpgQualityCssLeft},on:{mousedown:t.onPullrodMouseDown}})]),e("div",{staticClass:"button",on:{click:t.clickResetQuality}},[t._v("重置")])]):t._e()],2)],1)},ax=[],ox=function(){var t=this,e=t._self._c;return e("section",{staticClass:"item",class:{disabled:!t.enabled},attrs:{title:t.title}},[e("Checkbox",{attrs:{text:t.name,selected:t.selected&&t.enabled},on:{click:t.clickItemSelect}}),null!=t.node?e("section",[e("span",{staticClass:"size"},[t._v(t._s(t.size))]),e("a",{staticClass:"btn-down-current",attrs:{href:"javascript:;",title:"下载该项切图"},on:{click:t.clickDownSelect}})]):t._e()],1)},sx=[],cx=function(){var t=this,e=t._self._c;return e("label",{staticClass:"checkbox",class:{on:t.selected},on:{click:t.click}},[t.text?e("i",[t._v(t._s(t.text))]):t._e()])},lx=[],ux={props:{text:String,selected:Boolean},methods:{click:function(){this.$emit("click",!this.selected)}}},dx=ux,hx=Object(wo["a"])(dx,cx,lx,!1,null,null,null),fx=hx.exports,mx={methods:{clickDownSelect:function(){var t={};t[this.config.scale]=1,this.$emit("clickDownSelect",t)},clickItemSelect:function(t){!t||this.enabled?this.$emit("clickItemSelect",this.config.scale,t):this.showTextTip("您无法导出该规格切图,因为设计狮没有为该画板导出该规格切图")}},computed:{inMultMode:function(){return null==this.node},title:function(){var t=this.config,e=t.name;return e},name:function(){var t,e=this.config;return t=e.name,t},originWidth:function(){return this.inMultMode?0:this.node.boundsInArtboard.width},originHeight:function(){return this.inMultMode?0:this.node.boundsInArtboard.height},size:function(){if(this.inMultMode)return"";if(!this.enabled)return"--";var t,e=this.node,n=this.curArtboard;if(n&&(t=n.artboard.mlConfig),t){var i=t.sizeMap;if(i){var r=(this.config.resname||this.config.filepath).replace("{$name$}",e.exportPath).toLowerCase(),a=i[r];if(a)return"".concat(a.width,"x").concat(a.height)}}var o=this.config.scale;return"".concat(Math.ceil(fn(this.originWidth*o,2)),"x").concat(Math.ceil(fn(this.originHeight*o,2)))}},props:{config:Object,node:Object,selected:Boolean,enabled:Boolean},components:{Checkbox:fx}},px=mx,vx=(n("9b1e"),Object(wo["a"])(px,ox,sx,!1,null,"463a32fa",null)),bx=vx.exports,gx={methods:{clickPullrodLine:function(t){var e=Math.round(t.layerX/1.06);isNaN(e)||(e=Math.max(1,e),e=Math.min(100,e),this.$emit("setJpgQuality",e))},onPullrodMouseDown:function(t){this.mouseDownStartQuality=this.jpgQuality,this.mouseDownStartX=t.pageX,window.addEventListener("mouseup",this.onPullrodMouseUp),window.addEventListener("mousemove",this.onPullrodMouseMove)},onPullrodMouseMove:function(t){var e=t.pageX-this.mouseDownStartX,n=Math.round(this.mouseDownStartQuality+e/1.06);n=Math.max(1,n),n=Math.min(100,n),this.$emit("setJpgQuality",n)},onPullrodMouseUp:function(){window.removeEventListener("mouseup",this.onPullrodMouseUp),window.removeEventListener("mousemove",this.onPullrodMouseMove)},clickResetQuality:function(){this.$emit("setJpgQuality",ri)},onAndroidUseMipmapSelectChanged:function(t){ht(t)&&this.clickSetAndroidUseMipmap(t.value)},clickSetAndroidUseMipmap:function(t){this.$store.commit("setAndroidUseMipmap",t)},clickDownSelect:function(t){this.$emit("clickDownSelect",t)},clickItemSelect:function(t,e){if(!this.currentResInSvg&&!this.currentResInPdf){var n=this.checkSetting;this.$set(n,t,e?1:0),this.setLocalCheckSetting(n)}},initCheckSetting:function(){var t=this.getLocalCheckSetting();this.checkSetting=t},setLocalCheckSetting:function(t){var e=this.downloadPlatform;rn("reschecked.".concat(e),t)},getLocalCheckSetting:function(){var t=this.downloadPlatform,e=nn("reschecked.".concat(t),!0);if(!ht(e))switch(t){case s.WEB:e={2:1};break;case s.IOS:e={1:1,2:1,3:1};break;case s.ANDROID:e={1:1,1.5:1,2:1,3:1,4:1};break}return[1,2,3,4,1.5].forEach((function(t){e[t]||(e[t]=0)})),e}},created:function(){this.initCheckSetting()},watch:{downloadPlatform:function(){this.initCheckSetting()}},computed:{jpgQualityCssLeft:function(){var t=this.jpgQuality;return Math.round(1.06*t)+"px"},optionsClass:function(){var t={};switch(this.currentResInSvg&&(t.svg=1),this.currentResInPdf&&(t.pdf=1),this.inMultMode&&(t.mult=1),this.downloadPlatform){case s.ANDROID:t.android=1;break;case s.WEB:t.web=1;break;case s.IOS:t.ios=1;break}return t},inMultMode:function(){return null==this.node},androidUseMipmapSelectOptions:function(){return[{name:"drawable-...",value:!1,selected:!this.androidUseMipmap,title:"Android目录前缀"},{name:"mipmap-...",value:!0,selected:this.androidUseMipmap,title:"Android目录前缀"}]},downloadPlatformItems:function(){return Ou(this.curArtboard,this.downloadPlatform,this.androidUseMipmap,this.currentResInSvg,this.currentResInPdf,this.currentResInJpg&&this.exportSvgOnly,this.currentResInJpg&&this.exportPdfOnly)}},data:function(){return{mouseDownStartX:0,mouseDownStartQuality:0,CALC_PLATFORM_TYPE:s,checkSetting:{}}},components:{PropertyDownloadItem:bx,Select:wd},props:{jpgQuality:Number,currentResInJpg:Boolean,exportSvgOnly:Boolean,currentResInSvg:Boolean,exportPdfOnly:Boolean,currentResInPdf:Boolean,downloadPlatform:Number,node:Object,bottomPosition:Boolean}},wx=gx,xx=(n("f877"),Object(wo["a"])(wx,rx,ax,!1,null,"588834c5",null)),yx=xx.exports,kx=function(){var t=this,e=t._self._c;return e("iframe",{ref:"iframe",staticClass:"pdf-viewer",style:t.style,attrs:{src:"about:blank"}})},Cx=[],Sx={methods:{loadUrl:function(t){Kt(this.$refs.iframe,t,this.maxWidth,this.maxHeight)},loadBlank:function(){try{this.$refs.iframe.src="about:blank"}catch(t){}}},computed:{style:function(){var t=this.maxWidth,e=this.maxHeight;return{maxWidth:t,maxHeight:e}}},beforeDestroy:function(){this.loadBlank()},mounted:function(){this.loadUrl(this.url)},watch:{url:function(t){t&&this.loadUrl(this.url)}},props:{url:String,maxWidth:String,maxHeight:String}},Tx=Sx,Ax=(n("9edf"),Object(wo["a"])(Tx,kx,Cx,!1,null,"aa8b5fba",null)),Ix=Ax.exports,Fx={methods:{setJpgQuality:function(t){t>0&&t<=100&&(this.jpgQuality=t,rn(ai,t))},clickExportBoxBackgroundType:function(t){this.$store.commit("exportBoxBackgroundType",t)},onResTypeSelectChanged:function(t){ht(t)&&this.clickCurrentResType(t.value)},clickCurrentResType:function(t){switch(t){case l.PNG:if(!this.exportPng)return void this.showTextTip("设计狮没有为该画板导出[PNG]格式的切图");break;case l.WEBP:if(!this.exportWebP)return void this.showTextTip("设计狮没有为该画板导出[WEBP]格式的切图");break;case l.SVG:if(!this.exportSvg)return void this.showTextTip("设计狮没有为该画板导出[SVG]格式的切图");break;case l.PDF:if(!this.exportPdf)return void this.showTextTip("设计狮没有为该画板导出[PDF]格式的切图");break;case l.JPG:break}this.currentResType=t,rn("resType",t)},clickDownSelectAll:function(){this.clickDownSelect(this.$refs.downOptions.checkSetting)},clickDownSelect:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.setInOutput(!0),n.prev=1,!e.currentResInPdf){n.next=7;break}return n.next=5,_u([e.curNode],e.curArtboard);case 5:n.next=19;break;case 7:if(!e.currentResInSvg){n.next=12;break}return n.next=10,Lu([e.curNode],e.curArtboard);case 10:n.next=19;break;case 12:if(!e.currentResInJpg){n.next=17;break}return n.next=15,Yu(e.calcPlatformUse,e.androidUseMipmap,t,[e.curNode],e.curArtboard,e.jpgQuality/100);case 15:n.next=19;break;case 17:return n.next=19,Xu(e.calcPlatformUse,e.androidUseMipmap,t,[e.curNode],e.curArtboard,e.currentResInWebP);case 19:n.next=24;break;case 21:n.prev=21,n.t0=n["catch"](1),e.showTextTip(n.t0);case 24:return n.prev=24,e.setInOutput(!1),n.finish(24);case 27:case"end":return n.stop()}}),n,null,[[1,21,24,27]])})))()},initJpgQuality:function(){var t=this.curArtboard;if(t){var e=parseInt(nn(ai,!1));(isNaN(e)||e<1||e>=100)&&(e=ri),this.jpgQuality=e}},initCurrentResType:function(){var t=this.curArtboard;if(t){var e=parseInt(nn("resType",!1));(isNaN(e)||!isFinite(e)||e!==l.SVG&&e!==l.PDF&&e!==l.WEBP&&e!==l.JPG)&&(e=l.PNG);var n=this.curArtboard.artboard.mlConfig.resType;n||(n=l.PNG);var i=this.exportPng,r=this.exportSvg,a=this.exportWebP,o=this.exportPdf;switch(e){case l.PNG:i||(a?e=l.WEBP:r?e=l.SVG:o&&(e=l.PDF));break;case l.SVG:r||(i?e=l.PNG:a?e=l.WEBP:o&&(e=l.PDF));break;case l.PDF:o||(i?e=l.PNG:a?e=l.WEBP:r&&(e=l.SVG));break;case l.WEBP:a||(i?e=l.PNG:r?e=l.SVG:o&&(e=l.PDF));break;case l.JPG:i||r||a||o||(e=l.PNG);break}this.currentResType=e}}},created:function(){this.initCurrentResType(),this.initJpgQuality()},watch:{inMultDownMode:function(){this.initCurrentResType(),this.initJpgQuality()},curArtboard:function(){this.initCurrentResType(),this.initJpgQuality()}},data:function(){return{currentResType:l.PNG,jpgQuality:ri}},computed:{ExportBoxBackgroundType:function(){return F},resTypeSelectOptions:function(){var t=this.currentResType,e={value:l.PNG,name:"PNG",selected:t===l.PNG,disabled:!this.exportPng},n={value:l.WEBP,name:"WEBP",selected:t===l.WEBP,disabled:!this.exportWebP},i={value:l.SVG,name:"SVG",selected:t===l.SVG,disabled:!this.exportSvg},r={value:l.PDF,name:"PDF",selected:t===l.PDF,disabled:!this.exportPdf},a={value:l.JPG,name:"JPG",selected:t===l.JPG,disabled:!1};return[e,n,i,r,a]},exportWebP:function(){return Pe(this.curArtboard.artboard)},exportPng:function(){return Le(this.curArtboard.artboard)},exportSvg:function(){return Ee(this.curArtboard.artboard)},exportPdf:function(){return Ne(this.curArtboard.artboard)},exportSvgOnly:function(){return this.exportSvg&&!this.exportPng&&!this.exportWebP},exportPdfOnly:function(){return this.exportPdf&&!this.exportSvg&&!this.exportPng&&!this.exportWebP},currentResInPdf:function(){return this.currentResType===l.PDF},currentResInSvg:function(){return this.currentResType===l.SVG},currentResInJpg:function(){return this.currentResType===l.JPG},currentResInWebP:function(){return this.currentResType===l.WEBP},exportPreviewSrc:function(){var t,e,n=null!==(t=null===(e=this.curNode)||void 0===e?void 0:e.mlConfig)&&void 0!==t?t:{},i=n.pngPreview,r=n.svgPreview,a=n.pdfPreview,o=i||r;return this.inCloudMode?this.exportPdfOnly&&!o&&a?a:o:o+"?"+this.curArtboard.artboard.mlOutputTime}},components:{PropertyDownloadOptions:yx,Select:wd,PdfViewer:Ix}},Mx=Fx,Ox=(n("9e96"),Object(wo["a"])(Mx,nx,ix,!1,null,"20f133bc",null)),_x=Ox.exports,Lx=function(){var t=this,e=t._self._c;return e("section",{staticClass:"header"},[e("div",{staticClass:"platform"},[e("a",{staticClass:"btn-set-platform",class:{on:t.setting},attrs:{href:"javascript:;"},on:{click:function(e){t.setting=!t.setting}}},[t._v(t._s(t.size)+" ")]),e("span",{staticClass:"size"},[e("span",{staticClass:"round-num",class:{on:t.numberAutoRound},on:{click:t.clickRoundNum}},[t._v("数值取整")])])]),t.setting?e("div",{staticClass:"set"},[e("SetPlatform",{attrs:{showCustom:!0},on:{clickCalcPlatform:t.clickCalcPlatform,hideSetting:t.hideSetting}})],1):t._e()])},Px=[],Ex=function(){var t=this,e=t._self._c;return e("section",{staticClass:"set-platform"},[e("ul",[e("li",{class:{on:t.calcPlatformType2===t.CALC_PLATFORM_TYPE.WEB}},[e("a",{staticClass:"name",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickCalcPlatform({type:t.CALC_PLATFORM_TYPE.WEB})}}},[t._v("Web")])]),e("li",{class:{on:t.calcPlatformType2===t.CALC_PLATFORM_TYPE.ANDROID}},[e("a",{staticClass:"name",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickCalcPlatform({type:t.CALC_PLATFORM_TYPE.ANDROID})}}},[t._v("Android")])]),e("li",{class:{on:t.calcPlatformType2===t.CALC_PLATFORM_TYPE.IOS}},[e("a",{staticClass:"name",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickCalcPlatform({type:t.CALC_PLATFORM_TYPE.IOS})}}},[t._v("iOS")])]),e("li",{staticClass:"custom"},[e("dl",{class:{on:t.calcPlatformType2===t.CALC_PLATFORM_TYPE.CUSTOM}},[e("dt",{staticClass:"name",attrs:{title:"无视文档设计尺寸,强制指定当前画板的宽度"}},[t._v(" 自定义宽度 ")]),e("dd",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.calcPlatformCustomDocWidth2,expression:"calcPlatformCustomDocWidth2"}],ref:"inpWidth",staticClass:"inp",attrs:{type:"text",spellcheck:"false"},domProps:{value:t.calcPlatformCustomDocWidth2},on:{input:function(e){e.target.composing||(t.calcPlatformCustomDocWidth2=e.target.value)}}})]),e("dd",[e("Select",{attrs:{options:t.unitSelectOptions},on:{changed:t.onUnitSelectChanged}})],1),e("dd",[e("a",{staticClass:"button light btn-save",attrs:{href:"javascript:;"},on:{click:t.clickCalcPlatformCustom}},[t._v("保存")])])]),e("div",{staticClass:"tip"},[t._v("注:填0则自动取对应画板设计尺寸")])]),e("li",{staticClass:"template"},[e("dl",[e("dt",[e("span",{staticClass:"name"},[t._v("自定义单位模板"),e("Checkbox2",{attrs:{text:"",selected:t.calcUnitTemplateEnable},on:{click:function(e){return t.clickTemplateEnable()}}})],1),e("a",{staticClass:"help",attrs:{href:"https://user.marklion.cn/router/linkto.ashx?id=10016",target:"_blank"}},[t._v("帮助")])]),e("dd",{staticClass:"input",class:{off:!t.calcUnitTemplateEnable}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.calcUnitTemplateValue2,expression:"calcUnitTemplateValue2"}],attrs:{autocomplete:"off",spellcheck:"false"},domProps:{value:t.calcUnitTemplateValue2},on:{input:function(e){e.target.composing||(t.calcUnitTemplateValue2=e.target.value)}}}),e("a",{staticClass:"button light btn-save",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickTemplateEnable(!0)}}},[t._v("保存")])]),t._m(0)])])])])},Nx=[function(){var t=this,e=t._self._c;return e("dd",{staticClass:"tip"},[e("div",[t._v("注:")]),e("ul",[e("li",[e("span",{staticClass:"t"},[t._v("%num%")]),t._v("当前数值")]),e("li",[e("span",{staticClass:"t"},[t._v("%W%")]),t._v("画板宽度")]),e("li",[e("span",{staticClass:"t"},[t._v("%H%")]),t._v("画板高度")]),e("li",[e("span",{staticClass:"t"},[t._v("%VW%")]),t._v("当前数值和画板宽度的百分比(1-100)")]),e("li",[e("span",{staticClass:"t"},[t._v("%VH%")]),t._v("当前数值和画板高度的百分比(1-100)")])])])}],Dx={methods:{clickTemplateEnable:function(t){var e=t?this.calcUnitTemplateEnable:!this.calcUnitTemplateEnable,n=this.curArtboard.artboard,i={guid:n.docGuid,enable:e,template:t?this.calcUnitTemplateValue2:this.calcUnitTemplateValue};this.$store.commit("setUnitTemplate",i),this.calcUnitTemplateValue2=this.calcUnitTemplateValue,t?this.$emit("hideSetting"):e||this.$emit("hideSetting")},onUnitSelectChanged:function(t){this.calcPlatformCustomUnit2=t.value},clickCalcPlatformCustom:function(){var t={type:s.CUSTOM,customUnit:this.calcPlatformCustomUnit2,customDocWidth:parseInt(this.calcPlatformCustomDocWidth2)};if(isNaN(t.customDocWidth)||!isFinite(t.customDocWidth)||t.customDocWidth<0)return this.showTextTip("指定宽度不合法,请正确输入"),void this.$refs.inpWidth.focus();this.clickCalcPlatform(t)},clickCalcPlatform:function(t){this.$emit("clickCalcPlatform",t)}},data:function(){return{calcPlatformType2:0,calcPlatformCustomUnit2:0,calcPlatformCustomDocWidth2:0,calcUnitTemplateValue2:"",CALC_PLATFORM_TYPE:s,CALC_PLATFORM_UNIT:c,unitSelectOptions:[{name:"px",value:c.PX},{name:"dp",value:c.DP},{name:"pt",value:c.PT}]}},components:{Select:wd,Checkbox2:yb},computed:{calcUnitTemplateEnable:function(){return this.$store.state.unitTemplate.enable}},created:function(){var t=this;this.calcPlatformType2=this.calcPlatformType,this.calcPlatformCustomUnit2=this.calcPlatformCustomUnit,this.unitSelectOptions.forEach((function(e){t.$set(e,"selected",e.value===t.calcPlatformCustomUnit2)})),this.calcPlatformCustomDocWidth2=this.calcPlatformCustomDocWidth,this.calcUnitTemplateValue2=this.calcUnitTemplateValue}},jx=Dx,Rx=(n("d87d"),Object(wo["a"])(jx,Ex,Nx,!1,null,"16ab6d60",null)),Vx=Rx.exports,Bx={methods:{clickRoundNum:function(){this.$store.commit("setNumberAutoRound",!this.numberAutoRound)},clickCalcPlatform:function(t){if(ht(t)&&!t.guid){var e=this.curArtboard.artboard;t.guid=e.docGuid}this.$store.commit("setPlatform",t),this.setting=!1},hideSetting:function(){this.setting=!1}},computed:{size:function(){if(!this.inArtboardMode)return"";var t=this.curArtboard.artboard.boundsInArtboard;return"".concat(this.getCalcPlatformValue(t.width,{noUnitTemplate:!0}),"*").concat(this.getCalcPlatformValue(t.height,{noUnitTemplate:!0}))},calcPlatformTypeText2:function(){switch(this.calcPlatformType){case s.CUSTOM:return"".concat(this.calcPlatformCustomDocWidthShow).concat(this.getCalcPlatformCustomUnitText(!1));default:return""}},calcPlatformTypeText:function(){switch(this.calcPlatformType){case s.ANDROID:return"Android";case s.IOS:return"iOS";case s.CUSTOM:return"自定义";default:return"Web"}}},data:function(){return{setting:!1,CALC_PLATFORM_TYPE:s}},components:{SetPlatform:Vx}},Ux=Bx,Hx=(n("e361"),Object(wo["a"])(Ux,Lx,Px,!1,null,"5c2038cd",null)),Wx=Hx.exports,$x={methods:{parseColor:function(t,e,n){return Rt(t,e,this.isSketchArtboard,this.curNode,this.sketchGroupFillColor,n)}},computed:{cssVisible:function(){return this.calcPlatformUse===s.WEB},hasValue:function(){return null!=this.curNode},borderStyle:function(){var t=this.curNode.strokeDashArray;if(!t||0===t.length)return"solid";var e,n=t[0];return e=1===t.length?n:t[1],n===e?"dashed":"dotted"},isSketchArtboard:function(){var t,e=this.curArtboard;if(!e)return!1;var n=e.artboard;return!(!n||!n.mlConfig)&&(null!==(t=n.fileType)&&void 0!==t?t:n.mlConfig.fileType)===u.SKETCH},isXDArtboard:function(){var t;if(this.isSketchArtboard)return!1;var e=this.curArtboard;if(!e)return!1;var n=e.artboard;return!(!n||!n.mlConfig)&&(null!==(t=n.fileType)&&void 0!==t?t:n.mlConfig.fileType)===u.XD},sketchGroupFillColor:function(){if(this.isSketchArtboard){var t=this.curNode;if(t){var e=t.types;if(e&&1!==e.Group)return pn(t)}}},nodeStyle:function(){var t=this;if(!this.hasValue)return{borders:[],shadows:[],innerShadows:[],fills:[]};var e=this.opacity,n=this.top,i=this.left,r=this.width,a=this.height,o=this.cornerRadiiValue,s=this.curNode,c={opacity:e,blendOpacity:la(ca(s)),top:n,left:i,width:r,height:a,cornerRadiiValue:o,borders:[],textStrokeStyles:[],shadows:[],innerShadows:[],fills:[],strokesIncludedInLayout:!!s.strokesIncludedInLayout,backgroundEffect:0,backgroundEffectBrightness:1,backgroundEffectSaturation:1,backgroundEffectOpacity:1,objectEffect:0};if(s.types.GraphicNode){var l,u,d,h,f=null!==(l=s.blurs)&&void 0!==l?l:[s.blur],m=this.isXDArtboard,p=this.isSketchArtboard;if(f.forEach((function(t){if(t&&t.visible&&t.blurAmount>=0){var e=t.isBackgroundEffect?"backgroundEffect":"objectEffect";if(c[e]=t.blurAmount,t.isBackgroundEffect){if(m){var n=t.brightnessAmount,i=t.fillOpacity;i=Math.round(100*i)/100,n=Math.round(100*n)/1e4,c.backgroundEffectOpacity=i,0!=n&&(c.backgroundEffectBrightness=fn(1+n,2))}if(p){var r=t.saturation;"number"===typeof r&&(r=fn(r,2),c.backgroundEffectSaturation=r)}}}})),s.strokeEnabled&&s.stroke)u=s.strokeArr?s.strokeArr:[{stroke:s.stroke,strokeEnabled:s.strokeEnabled,strokeWidth:s.strokeWidth,strokeWidths:s.strokeWidths,strokePosition:s.strokePosition}],u.forEach((function(e){if(e){var n,i=t.parseColor(e.stroke);!i&&s.types.Text&&(n=!0,i=t.parseColor(e.stroke,!0)),i&&(i.style=function(t){if(!t||0===t.length)return"solid";if(i.customDashes)return t.join(" ");var e,n=t[0];return e=1===t.length?n:t[1],n===e?"dashed":"dotted"}(e.strokeDashArray),i.width=t.getCalcPlatformValue(e.strokeWidth,{needArtScale:!0}),e.strokeWidths?i.widths=e.strokeWidths.map((function(e){return t.getCalcPlatformValue(e,{needArtScale:!0})})).join(" "):i.widths=null,i.position=e.strokePosition,n?(0===c.textStrokeStyles.length&&(c.textStrokeStyle=i),c.textStrokeStyles.push(i)):(0===c.borders.length&&(c.border=i),c.borders.push(i)))}}));if(s.shadow&&s.shadow.visible)d=s.shadowArr?s.shadowArr:[s.shadow],d.forEach((function(e){if(e){var n={x:t.getCalcPlatformValue(e.x,{needArtScale:!0}),y:t.getCalcPlatformValue(e.y,{needArtScale:!0}),blur:t.getCalcPlatformValue(e.blur,{needArtScale:!0}),color:e.color.value};"number"===typeof e.spread&&0!==e.spread&&(n.spread=t.getCalcPlatformValue(e.spread,{needArtScale:!0})),0===c.shadows.length&&(c.shadow=n),c.shadows.push(n)}}));if(s.innerShadow&&s.innerShadow.visible)h=s.innerShadowArr?s.innerShadowArr:[s.innerShadow],h.forEach((function(e){if(e){var n={x:t.getCalcPlatformValue(e.x,{needArtScale:!0}),y:t.getCalcPlatformValue(e.y,{needArtScale:!0}),blur:t.getCalcPlatformValue(e.blur,{needArtScale:!0}),color:e.color.value};"number"===typeof e.spread&&0!==e.spread&&(n.spread=t.getCalcPlatformValue(e.spread,{needArtScale:!0})),0===c.innerShadows.length&&(c.innerShadow=n),c.innerShadows.push(n)}}));s.blendMode&&s.blendMode!==un.PASSTHROUGH&&s.blendMode!==un.NORMAL&&(c.blendMode=s.blendMode);var v,b=c.backgroundEffectOpacity;if(s.fillEnabled&&s.fill&&0!==b)v=s.fillArr?s.fillArr:[{fillEnabled:!0,fill:s.fill}],v.forEach((function(e){if(e){var n=t.parseColor(e.fill,!1,b);n&&(0==c.fills.length&&(c.fill=n),c.fills.push(n))}}))}return c},cornerRadiiValue:function(){var t=this.curNode.cornerRadii;return t?ut(t)?null:t.bottomLeft!==t.bottomRight||t.bottomLeft!==t.topLeft||t.bottomLeft!==t.topRight?"".concat(this.getCalcPlatformValue(t.topLeft,{needArtScale:!0})," ").concat(this.getCalcPlatformValue(t.topRight,{needArtScale:!0})," ").concat(this.getCalcPlatformValue(t.bottomRight,{needArtScale:!0})," ").concat(this.getCalcPlatformValue(t.bottomLeft,{needArtScale:!0})):0!==t.topLeft?this.getCalcPlatformValue(t.topLeft,{needArtScale:!0}):void 0:null},width:function(){var t=this.curNode,e=t.markedForExport;return this.getCalcPlatformValue(t.boundsInArtboard.width,{markedForExport:e})},height:function(){var t=this.curNode,e=t.markedForExport;return this.getCalcPlatformValue(t.boundsInArtboard.height,{markedForExport:e})},top:function(){return this.curNode.types.Artboard?0:this.getCalcPlatformValue(this.curNode.boundsInArtboard.y)},left:function(){return this.curNode.types.Artboard?0:this.getCalcPlatformValue(this.curNode.boundsInArtboard.x)},opacity:function(){return la(this.curNode.opacity)}},components:{PropertiesGraphicNode:hw,PropertyInfo:Ow,PropertyFill:Dw,PropertyText:Kw,PropertyExport:_x,Header:Wx,PropertyCss:ex},created:function(){0}},Gx=$x,zx=(n("90ee"),Object(wo["a"])(Gx,Bg,Ug,!1,null,null,null)),Yx=zx.exports,Xx=function(){var t=this,e=t._self._c;return e("div",{staticClass:"comment-main",class:{on:t.artboardInComment&&t.artboardCommentVisible}},[t.inCloudMode?t.commentDetailVisible?e("DetailComment",{attrs:{errorText:t.errorText,fetchDetailState:t.fetchDetailState,listNeedRefresh:t.listNeedRefresh,notSupportCommentCloudVersion:t.notSupportCommentCloudVersion},on:{clickReload:t.clickRefresh,commentAdded:t.commentAdded,onCommentUpdateTime:t.onCommentUpdateTime}}):e("div",{staticClass:"login-tip"},[e("div",{staticClass:"box"},[e("div",{staticClass:"icon"}),e("div",{staticClass:"text"},[t._v("需要登录查看评论内容")]),e("div",{staticClass:"button light",on:{click:t.goCloudLogin}},[t._v("去登录")]),e("div",{staticClass:"text"},[t._v("还没有标记狮账号？去"),e("a",{attrs:{href:"javascript:;"},on:{click:t.goCloudLogin}},[t._v("注册")])])])]):e("div",{staticClass:"comment-support-tip"},[e("div",{staticClass:"box"},[e("div",{staticClass:"img"}),e("div",{staticClass:"tip"},[t._v("本地标注包无法使用评论功能")]),e("div",{staticClass:"text"},[t._v("试用标记狮私有云服务，体验画板评论功能")]),e("a",{staticClass:"button light",attrs:{href:t.cloudPage,target:"_blank"}},[t._v("前往官网了解更多")])])])],1)},Kx=[],qx={};function Qx(t,e,n,i){var r=qx[t];r||(r=qx[t]={});var a={diff:i,time:Date.now(),value:n};r[e]=a}function Jx(t,e){var n=qx[t];if(!n)return null;var i=n[e];if(!i)return null;var r=i.time,a=Date.now(),o=a-r;return o<=0||o>=i.diff?(delete n[e],null):i.value}var Zx=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"detail-comment"},[t.listNeedRefresh&&t.fetchDetailState===t.FetchState.Success?e("div",{staticClass:"comment-refresh"},[e("a",{staticClass:"btn-refresh",attrs:{href:"javascript:;"},on:{click:function(e){t.setSelectComment(null),t.clickReload()}}},[t._v("评论有更新，点击刷新")])]):t._e(),e("div",{staticClass:"comments"},[t.fetchDetailState===t.FetchState.Fetching||t.fetchDetailState===t.FetchState.Error?e("div",{staticClass:"error"},[e("NetworkLoading",{attrs:{loadText:"正在获取评论信息...",errorText:t.errorText,isLoading:t.fetchDetailState===t.FetchState.Fetching,isError:t.fetchDetailState===t.FetchState.Error,reLoadText:"刷新"},on:{reload:function(e){return t.clickReload()}}})],1):t.notSupportCommentCloudVersion?e("div",{staticClass:"feature"},[t._v(" 私有云部署包版本过低,"),e("br"),t._v("请先联系管理员升级私有云部署包 ")]):t.comments&&0===t.comments.length?e("div",{staticClass:"feature"},[t._v("暂无评论，快去添加吧！")]):t.comments?e("div",{ref:"commentList",staticClass:"comment-list"},t._l(t.comments,(function(n,i){return e("CommentItem",{key:0===n.id?"index_".concat(i):n.id,attrs:{users:t.users,comment:n},on:{commentAdded:t.commentAdded,commentRemove:t.commentRemove,onCommentUpdateTime:t.onCommentUpdateTime}})})),1):t._e()]),t.notSupportCommentCloudVersion?t._e():e("div",{staticClass:"art-editor"},[t.cloudIsLogin?e("Editor",{attrs:{commentId:0,replyId:0,parent:{id:0,comments:t.comments},users:t.users,initSummary:""},on:{commentAdded:t.commentAdded,onCommentUpdateTime:t.onCommentUpdateTime}}):e("div",{staticClass:"login-tip"},[e("div",{staticClass:"box"},[e("div",{staticClass:"text"},[t._v("需要登录才可进行评论")]),e("div",{staticClass:"button light",on:{click:t.goCloudLogin}},[t._v("去登录")]),e("div",{staticClass:"text"},[t._v("还没有标记狮账号？去"),e("a",{attrs:{href:"javascript:;"},on:{click:t.goCloudLogin}},[t._v("注册")])])])])],1)]):t._e()},ty=[],ey=function(){var t=this,e=t._self._c;return e("div",{staticClass:"editor"},[t.attachLoading?e("div",{staticClass:"attach-loading"},[e("p",[t._v("附件添加中...")])]):t._e(),t.attachFetching?e("div",{staticClass:"attach-fetching"},[t._v("评论数据提交中...")]):t._e(),e("EditorTextarea",{ref:"customInput",attrs:{initValue:t.initSummary,maxlength:t.maxLength,placeholder:"留下你的评论,支持@成员"},on:{setValue:t.setValue,submit:t.submit}}),t.attachments.length>0?e("ul",{staticClass:"attachments"},t._l(t.attachments,(function(n){return e("li",{key:n.id,on:{click:function(e){return e.preventDefault(),t.clickAttach(n)}}},[e("span",{staticClass:"btn-remove",attrs:{title:"移除"},on:{click:function(e){return e.stopPropagation(),t.clickRemove(n)}}}),e("BlobImage",{attrs:{image:n.thumbBlob||n.blob}})],1)})),0):t._e(),e("div",{ref:"btns",staticClass:"btns"},[e("ul",{staticClass:"menu"},[0===t.replyId?e("li",{staticClass:"point",class:{on:t.pointEnable,pointed:this.pointed},attrs:{title:"添加评注"},on:{click:t.startPoint}},[t.pointed?e("span",[t._v(t._s(t.pointIndex))]):t._e()]):t._e(),e("li",{staticClass:"localimage",attrs:{title:"上传本地图片"},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickLocalFile.apply(null,arguments)}}},[e("input",{ref:"file",attrs:{type:"file",accept:t.supportFileExt},on:{change:t.onLocalFileChange}})]),e("li",{staticClass:"drawimage",class:{on:t.inDrawingSelf},attrs:{title:"画板截图"},on:{click:t.startDraw}}),e("li",{staticClass:"emoji",class:{on:t.emojiListVisible},on:{click:function(e){return e.target!==e.currentTarget?null:t.openEmojiList.apply(null,arguments)}}},[t.emojiListVisible?e("div",{staticClass:"emoji-list"},t._l(t.EnumEmojiSupportList,(function(n){return e("div",{key:n.name,class:["icon-emoji","emoji-"+n.name],on:{click:function(e){return t.clickEmojiItem(n)}}})})),0):t._e()])]),e("div",{staticClass:"button light submit",class:{off:!t.canSubmit},on:{click:t.submit}},[t._v("评论")])])],1)},ny=[],iy=function(){var t=this,e=t._self._c;return e("div",{staticClass:"editor-textarea-container"},[e("div",{ref:"input",staticClass:"editor-textarea",attrs:{contenteditable:"true",placeholder:t.placeholder,autocomplete:"off",spellcheck:"false"},on:{click:t.clickInput,paste:function(e){return e.preventDefault(),t.onInputPaste.apply(null,arguments)},focus:t.onInputFocus,blur:t.onInputBlur,compositionstart:t.onCompositionStart,compositionend:t.onCompositionEnd,input:t.onInput,keyup:t.onInputKeyup}},[t._v(t._s(t.initValue))]),e("EditorUsers",{ref:"users",on:{clickUser:t.clickAtUser}})],1)},ry=[],ay=function(){var t=this,e=t._self._c;return t.visible?e("div",{ref:"box",staticClass:"at-users",class:{"in-top":t.showInTop}},[t.fetchState===t.FetchState.Fetching||t.fetchState===t.FetchState.Error?e("div",{staticClass:"error"},[e("NetworkLoading",{attrs:{loadText:"正在获取用户列表信息...",errorText:t.errorText,isLoading:t.fetchState===t.FetchState.Fetching,isError:t.fetchState===t.FetchState.Error,reLoadText:""},on:{reload:function(e){return t.clickReload()}}})],1):0===t.list.length?e("div",{staticClass:"empty"},[t._v('未检索到 "'+t._s(t.searchText)+'" 相关的用户')]):e("ul",t._l(t.list,(function(n){return e("li",{key:n.id,attrs:{title:"".concat(n.nickName,"(").concat(n.email,")")},on:{click:function(e){return t.clickUser(n)}}},[e("div",{staticClass:"name"},[t._v(t._s(n.nickName))]),e("div",{staticClass:"email"},[t._v("("+t._s(n.email)+")")])])})),0)]):t._e()},oy=[],sy={components:{NetworkLoading:$l},methods:{clickUser:function(t){this.$emit("clickUser",t),this.visible=!1},searchUser:function(t){var e=this;this.searchText=dt(t)?t.trim().toLowerCase():"",this.visible=!0,this.clickReload(),this.showInTop=!0,this.$nextTick((function(){var t=e.$refs.box;if(t){var n=t.getBoundingClientRect();n.top<144&&(e.showInTop=!1)}}))},hide:function(){this.visible=!1},clickReload:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.fetchState!==Cn.Fetching){e.next=2;break}return e.abrupt("return");case 2:if(t.visible){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,t.errorText=null,t.fetchState=Cn.Fetching,n=t.searchText,e.next=10,t.getAllUsers();case 10:r=e.sent,a=n.length>0,r=r.filter((function(t){if(t){if(!a)return!0;var e=(t.nickName||"").toLowerCase();return-1!==e.indexOf(n)}})),t.list=r,t.fetchState=Cn.Success,e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](4),t.errorText=e.t0,t.fetchState=Cn.Error;case 21:case"end":return e.stop()}}),e,null,[[4,17]])})))()}},data:function(){return{FetchState:Cn,fetchState:Cn.Normal,errorText:null,list:[],searchText:"",visible:!1,showInTop:!1}}},cy=sy,ly=(n("d28d"),Object(wo["a"])(cy,ay,oy,!1,null,"26289ab6",null)),uy=ly.exports,dy="marklion-cloud-uid",hy={components:{EditorUsers:uy},methods:{onInputKeyup:function(t){var e=t.keyCode||t.which,n=this.inMacOS?t.metaKey:t.ctrlKey;n&&13===e&&(t.preventDefault(),this.$emit("submit"))},clickAtUser:function(t){var e=this;t&&requestAnimationFrame((function(){e.insertAtUser(t)}))},onInput:function(){this.$emit("setValue",this.getValue()),this.autoParseSearchUserText()},autoParseSearchUserText:function(){var t=this;clearTimeout(this.searchUserHandle),this.searchUserHandle=setTimeout((function(){var e=t.getSearchUserText(),n=t.$refs.users;n&&(e?(e=e.substr(1),n.searchUser(e)):n.hide())}),50)},onCompositionStart:function(){this.inComposition=!0},onCompositionEnd:function(){this.inComposition=!1},onInputPaste:function(t){var e=t.clipboardData,n=e.getData("text/plain");this.insertText(n)},clickInput:function(t){var e,n=t.target,i=this.$refs.input;if(i!=n&&(e="INPUT"===n.tagName?+n.getAttribute(dy):NaN,!isNaN(e))){var r=window.getSelection(),a=document.createRange(),o=!1,s=n.nextSibling;if(s&&3===s.nodeType){var c=s.textContent;c&&c.length>0&&(c=c[0]," "!==c&&" "!==c||(a.setStart(s,1),o=!0))}o||a.setStartAfter(n),a.collapse(!0),r.removeAllRanges(),r.addRange(a)}},moveRangeToEnd:function(t){if(t||(t=this.$refs.input),t&&window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}},setFocus:function(){this.isInputFocus||this._setLastRange()},_setLastRange:function(){var t=this.$refs.input;if(t){t.focus();var e=this.lastRange;if(e){var n=window.getSelection();n.removeAllRanges(),n.addRange(e)}else this.moveRangeToEnd(t)}},_appendData:function(t,e){var n=this;this._setLastRange(),document.execCommand("insertHTML",!1,t),e&&document.execCommand("insertText",!1," "),requestAnimationFrame((function(){var t=n.$refs.input;if(t)for(var e=t.querySelectorAll("*"),i=0,r=e.length;i<r;i++){var a=e[i],o=a.tagName;switch(o){case"P":case"DIV":case"SPAN":case"FONT":var s=a.style.cssText;s&&(a.style.cssText="");break}}}))},getUserText:function(t){return"[@uid:".concat(t,";]")},insertAtUser:function(t){var e;if(t){null===(e=this.$refs.input)||void 0===e||e.focus();var n=this.canEnterTextLength(),i=this.getUserText(t.id);if(n-i<0)this.showTextTip("文本长度已超过输入框允许的最大值:".concat(this.maxlength));else{var r="<input type='button' ".concat(dy,"='").concat(t.id,"'  class='at-user' value='@").concat(t.nickName,"' />"),a=this.lastRange;if(a){var o=a.startContainer,s=a.endContainer,c=a.startOffset,l=a.endOffset;if(o&&o==s&&c==l&&3===o.nodeType){var u=o.textContent;if(u){var d=u.substring(0,c).lastIndexOf("@");if(-1!==d){var h=document.createRange();h.setStart(o,d),h.setEnd(o,c);var f=window.getSelection();f.removeAllRanges(),f.addRange(h),document.execCommand("insertText",!1,""),this.lastRange=h}}}}this._appendData(r,!0)}}},insertText:function(t){var e;if(dt(t)&&(t=_n(t),dt(t))){var n=this.canEnterTextLength();if(0!==n){var i=t.length;n<i&&(t=t.substr(0,n)),null===(e=this.$refs.input)||void 0===e||e.focus(),this._appendData(t)}else this.showTextTip("文本长度已超过输入框允许的最大值:".concat(this.maxlength))}},canEnterTextLength:function(){var t=this.maxlength,e=this.getValue().length,n=this.getSelectText().length;return Math.max(t-e+n,0)},getSearchUserText:function(){var t=this.lastRange;if(!t)return"";var e=t.startContainer,n=t.endContainer,i=t.startOffset,r=t.endOffset;if(e!=n)return"";if(i!=r)return"";if(3!==e.nodeType)return"";var a=e.textContent;if(!a)return"";a=a.substring(0,i);var o=a.substring(0,i).lastIndexOf("@");return-1===o?"":(a=a.substring(o),/[ [\]]/.test(a)?"":a)},getSelectText:function(){var t=this.lastRange;if(!t)return"";var e=t.cloneContents();try{for(var n=e.childNodes,i="",r=0,a=n.length;r<a;r++){var o=n[r];i+=this.getNodeValue(o)}return i.replace(/\xa0/g," ")}finally{e=null}},getNodeValue:function(t){var e=this;switch(t.nodeType){case 3:return t.textContent||"";case 1:var n=+t.getAttribute(dy);if(isNaN(n)||!(n>0)){var i,r=t.tagName;switch(r){case"DIV":case"P":case"SECTION":i=" ";break;default:i="";break}var a=t.childNodes;return a.forEach((function(t){i+=e.getNodeValue(t)})),i}return"[@uid:".concat(n,";]");default:return""}},getValue:function(){var t=this.$refs.input;if(t){for(var e=t.childNodes,n="",i=0,r=e.length;i<r;i++){var a=e[i];n+=this.getNodeValue(a)}return n.replace(/\xa0/g," ")}},setEmpty:function(){var t,e=this.$refs.input;if(e)while(null!=(t=e.firstChild))e.removeChild(t)},onSelectionChange:function(){var t=window.getSelection();this.lastRange=t.rangeCount>0?t.getRangeAt(0):null},onInputFocus:function(){this.isInputFocus=!0,document.addEventListener("selectionchange",this.onSelectionChange)},onInputBlur:function(){this.isInputFocus=!1,document.removeEventListener("selectionchange",this.onSelectionChange)}},watch:{isInputFocus:function(t){var e=this;clearTimeout(this.autoHideUsersHandle),t||(this.autoHideUsersHandle=setTimeout((function(){var t;null===(t=e.$refs.users)||void 0===t||t.hide()}),500))}},data:function(){return{isInputFocus:!1,searchUserHandle:0,lastRange:null,inComposition:!1,autoHideUsersHandle:0}},beforeDestroy:function(){this.lastRange=null,clearTimeout(this.searchUserHandle),document.removeEventListener("selectionchange",this.onSelectionChange),this.setEmpty()},created:function(){0},props:{placeholder:{type:String,default:""},maxlength:{type:Number,default:0},initValue:{type:String,default:""}}},fy=hy,my=(n("14c9"),Object(wo["a"])(fy,iy,ry,!1,null,"771515f8",null)),py=my.exports,vy={components:{BlobImage:Ds,EditorTextarea:py},methods:{setValue:function(t){this.summary=t},autoHideEmojiList:function(){var t=this;clearTimeout(this.emojiListHideHandle),this.emojiListHideHandle=setTimeout((function(){t.emojiListVisible=!1}),50)},clickEmojiItem:function(t){var e=this;this.emojiListVisible=!1,t&&requestAnimationFrame((function(){var n=e.$refs.customInput;n&&n.insertText("[".concat(t.text,"]"))}))},openEmojiList:function(){this.emojiListVisible=!this.emojiListVisible},startPoint:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.pointInfo,a=e.preventPoint,o=e.inDrawing,!o){n.next=4;break}return e.showTextTip("正在编辑截图，无法添加评注"),n.abrupt("return");case 4:if(!e.pointed){n.next=11;break}return n.next=7,e.confirm({text:"确认移除该评论的评注?"});case 7:if(!n.sent){n.next=10;break}r.point.enable=!1,r.instance=null;case 10:return n.abrupt("return");case 11:e.showTextTip("点击当前区域任意位置添加评注"),a.enable=!0,a.x=t.clientX,a.y=t.clientY,r.instance=e;case 16:case"end":return n.stop()}}),n)})))()},clickAttach:function(t){var e=this.attachments.map((function(t){return t.blob})),n=e.findIndex((function(e){return e===t.blob}));-1===n&&(n=0),this.$store.commit("setImageViewer",{imgList:e,currentIndex:n})},fixScroll:function(){var t=this.replyId;if(0!==t){var e=this.$refs.btns;e&&e.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"})}},focus:function(){var t=this.$refs.customInput;null===t||void 0===t||t.setFocus()},clean:function(){this.attachments.splice(0);var t=this.$refs.customInput;null===t||void 0===t||t.setEmpty();var e=this.preventPoint,n=this.point,i=this.pointInfo,r=this.editComment;i.instance===this&&(i.instance=null,n.enable=!1,n.x=n.y=0,e.enable=!1,e.x=e.y=0),this.inDrawingSelf&&(r.instance=null,r.drawing=!1)},clickRemove:function(t){var e=this.attachments,n=e.findIndex((function(e){return e===t}));-1!==n&&e.splice(n,1)},getCustomEditorValue:function(){var t,e,n=null!==(t=null===(e=this.$refs.customInput)||void 0===e?void 0:e.getValue())&&void 0!==t?t:"";return n},submit:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s,c,l,u,d,h,f,m,p,v;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.attachments,r=t.fetchState,a=t.curArtboardId,r!==Cn.Fetching){e.next=4;break}return e.abrupt("return");case 4:if(!t.inDrawing){e.next=7;break}return t.showTextTip("正在编辑截图,请先保存或取消"),e.abrupt("return");case 7:if(o=[],s=t.getCustomEditorValue(),c=t.maxLength,l=s.length,!(l>c)){e.next=14;break}return t.showTextTip("文本长度已超过输入框允许的最大值(".concat(c,")")),e.abrupt("return");case 14:if(u={artboardId:a,commentId:t.commentId,replyId:t.replyId,summary:s,attachments:[]},n.forEach((function(t){o.push(t.blob),t.thumbBlob&&o.push(t.thumbBlob),u.attachments.push(t.data)})),dt(u.summary)||0!==u.attachments.length){e.next=20;break}return t.showTextTip("评论内容和图片附件不能都为空"),t.focus(),e.abrupt("return");case 20:if(t.pointed&&(u.pointX=t.point.x,u.pointY=t.point.y,u.pointEnable=!0),t.fetchState=Cn.Fetching,e.prev=22,t.checkLoginThrow()){e.next=26;break}return t.fetchState=Cn.Error,e.abrupt("return");case 26:return d=An(JSON.stringify(u)),o.unshift(d),o.unshift(Tn(d.byteLength)),d=In(o),e.next=32,t.fetchPostCloudApi("addartboardcommentbyweb",{body:d});case 32:if(h=e.sent,t.fetchState=Cn.Success,o=u=null,ht(h)){e.next=37;break}throw"返回值异常:".concat(h);case 37:if(h.success){e.next=39;break}throw h.errMsg;case 39:if(ht(h.data)){e.next=41;break}throw"返回值异常:".concat(JSON.stringify(h));case 41:h=h.data,f=h.commentUpdateTime,t.$emit("onCommentUpdateTime",{commentUpdateTime:f,artboardId:a}),m=h,p=m.atUsers,u=h.comment,v=t.users,v&&ut(p)&&p.forEach((function(e){e&&t.$set(v,e.id,e)})),u=cs(u,{id:0,email:t.cloudUserEmail,userKey:t.cloudUserKey,nickName:t.cloudNickName},fe,t.parent,v),t.clean(),t.showTextTip("评论已提交成功"),t.$emit("commentAdded",u),e.next=58;break;case 54:e.prev=54,e.t0=e["catch"](22),t.showTextTip(e.t0),t.fetchState=Cn.Error;case 58:case"end":return e.stop()}}),e,null,[[22,54]])})))()},clickLocalFile:function(){var t;this.attachments.length>=ss?this.showTextTip("无法选择图片,已达图片提交上限"):null===(t=this.$refs.file)||void 0===t||t.click()},onLocalFileChange:function(t){var e=this,n=t.target,i=n.files?n.files[0]:null;if(i){n.value="";var r=i.name,a=i.size,o=i.type;if(r&&!(a<1)&&o)if(0===o.indexOf("image/"))if(a>os)this.showTextTip("选择的文件大小[".concat(Sn(a),"]太大,不能超过[").concat(Sn(os),"]"));else{r=r.toLowerCase();var s=r.length,c=this.isSupportWebp,l=as.find((function(t){if(!c&&t===rs)return!1;var e=r.indexOf(t);return-1!==e&&e+t.length===s}));l?this.addAttachMent(i).then((function(){e.showTextTip("图片已添加")})).catch((function(t){return e.showTextTip(t)})):this.showTextTip("请选择正确的图片文件")}else this.showTextTip("请选择正确的图片文件")}},addAttachMent:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.attachLoading=!0,n.next=3,wi(t);case 3:return r=n.sent,e.attachments.push(r),e.attachLoading=!1,n.abrupt("return",r);case 7:case"end":return n.stop()}}),n)})))()},startDraw:function(){this.inDrawing?this.showTextTip("当前已在画板截图编辑模式"):this.attachments.length>=ss?this.showTextTip("无法编辑画板截图,已达图片提交上限"):(this.$store.commit("startDraw",this),this.showTextTip("在当前区域编辑画板相关截图"))}},watch:{emojiListVisible:function(t){clearTimeout(this.emojiListHideHandle),t?window.addEventListener("click",this.autoHideEmojiList,!0):window.removeEventListener("click",this.autoHideEmojiList,!0)},curArtboardId:function(){this.clean()}},computed:{canSubmit:function(){var t=this.fetchState,e=this.summary,n=this.attachments;return t!==Cn.Fetching&&!(0===n.length&&!dt(e.trim()))},EnumEmojiSupportList:function(){return Ws},point:function(){return this.pointInfo.point},preventPoint:function(){return this.pointInfo.preventPoint},pointInfo:function(){return this.$store.state.editComment.pointInfo},pointed:function(){return this.pointInfo.instance===this&&this.point.enable},pointEnable:function(){return this.pointInfo.instance===this&&(this.point.enable||this.preventPoint.enable)},pointIndex:function(){return this.pointed?this.point.pointIndex:""},attachFetching:function(){return this.fetchState===Cn.Fetching},isSupportWebp:function(){return this.$store.state.isSupportWebp===Oa.Support},canDestory:function(){return 0===this.attachments.length&&!dt(this.summary)},supportFileExt:function(){var t=as;return this.isSupportWebp||(t=t.filter((function(t){return t!==rs}))),t.join(",")},inDrawing:function(){var t=this.editComment;return t.drawing},inDrawingSelf:function(){var t=this.editComment;return t.drawing&&t.instance===this},artboard:function(){var t=this.curArtboard;return t?t.artboard:null}},beforeDestroy:function(){clearTimeout(this.emojiListHideHandle),window.removeEventListener("click",this.autoHideEmojiList,!0),this.clean()},created:function(){this.summary=dt(this.initSummary)?this.initSummary:""},data:function(){return{maxLength:256,inputFocused:!1,emojiListHideHandle:0,emojiListVisible:!1,attachLoading:!1,summary:"",attachments:[],fetchState:Cn.Normal}},props:{commentId:Number,parent:Object,replyId:Number,users:Object,initSummary:{type:String,default:""}}},by=vy,gy=(n("3b76"),Object(wo["a"])(by,ey,ny,!1,null,"19e1ecbc",null)),wy=gy.exports,xy=function(){var t=this,e=t._self._c;return t.comment?e("div",{staticClass:"comment-detail",attrs:{id:"art_c".concat(t.comment.commentId,"_").concat(t.comment.id)}},[e("div",{staticClass:"content",class:{on:t.selectComment===t.comment},on:{click:t.clickPoint}},[e("UserFace2",{attrs:{self:t.isSelfComment,tourist:t.isTourist,title:t.userFaceTitle,text:t.userFaceText}}),e("div",{staticClass:"userinfo"},[e("div",{staticClass:"summary",class:{reply:t.isReply}},[t.canRemove?e("a",{staticClass:"btn-del",attrs:{href:"javascript:;",title:"删除评论"},on:{click:t.clickRemove}}):t._e(),e("div",{staticClass:"name"},[t._v(" "+t._s(t.userNickName)),t.isReplyOther?e("span",{staticClass:"reply-to"},[t._v("回复 "+t._s(t.comment.replyUser.nickName))]):t._e()]),t.comment.pointEnable?e("span",{staticClass:"point"},[t._v(t._s(t.comment.pointIndex))]):t._e(),e("span",{domProps:{innerHTML:t._s(t.summaryHTML)}})]),t.attachMentImgs.length>0?e("ul",{staticClass:"attachments"},t._l(t.attachMentImgs,(function(n,i){return e("li",{key:i,on:{click:function(e){return e.preventDefault(),t.clickAttach(n)}}},[e("BlobImage",{attrs:{image:n.preview}})],1)})),0):t._e(),e("div",{staticClass:"date"},[t._v(" "+t._s(t.comment.dateStr)),e("a",{class:{on:t.editorVisible},attrs:{href:"javascript:;"},on:{click:t.clickReply}},[t._v(t._s(t.editorVisible?"收起回复":"回复"))])])])],1),t.editorEnable?e("Editor",{directives:[{name:"show",rawName:"v-show",value:t.editorVisible,expression:"editorVisible"}],ref:"editor",attrs:{commentId:t.comment.commentId,replyId:t.comment.id,parent:t.comment.parent||t.comment,users:t.users},on:{commentAdded:t.commentAdded,onCommentUpdateTime:t.onCommentUpdateTime}}):t._e(),t.comment.comments?e("div",{staticClass:"child"},t._l(t.comment.comments,(function(n,i){return e("CommentItem",{key:0===n.id?"".concat(t.comment.id,"_index_").concat(i):"".concat(t.comment.id,"_id_").concat(n.id),attrs:{comment:n,selectComment:t.selectComment,users:t.users},on:{commentAdded:t.commentAdded,commentRemove:t.commentRemove,onCommentUpdateTime:t.onCommentUpdateTime}})})),1):t._e()],1):t._e()},yy=[],ky={off:1,on:2,hide:3},Cy={components:{UserFace2:Hs,Editor:wy,BlobImage:Ds},name:"CommentItem",methods:{onCommentUpdateTime:function(t){this.$emit("onCommentUpdateTime",t)},clickPoint:function(t){var e=t.target,n=this.comment,i=this.selectComment,r=n===i?null:n;if(!r&&e){var a=e.tagName;if("A"===a)return;if("LI"===a&&e.parentNode.classList.contains("attachments"))return}this.setSelectComment(r)},setSelectComment:function(t){this.$store.commit("setSelectComment",{comment:t,notScrollList:!0})},setCommentEditorVisibleId:function(t){this.$store.commit("setCommentEditorVisibleId",t)},commentRemove:function(t){if(t){var e=this.comment.comments;if(e){var n=e.findIndex((function(e){return e===t}));-1!==n&&e.splice(n,1)}}},clickRemove:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s,c,l,u,d,h,f,m,p;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.canRemove){e.next=2;break}return e.abrupt("return");case 2:if(n=t.comment,n){e.next=5;break}return e.abrupt("return");case 5:if(r=n.id,a=n.commentId,o=n.artboardId,e.prev=6,t.checkLoginThrow()){e.next=9;break}return e.abrupt("return");case 9:return s=0===a?"是否确认删除该评论及所属的所有二级评论?":"是否确认删除该评论?",e.next=12,t.confirm({text:s});case 12:if(e.sent){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,t.fetchPostCloudApi("removecommentbyweb",{body:{id:r,commentId:a,artboardId:o}});case 16:if(c=e.sent,ht(c)){e.next=19;break}throw new Error("返回值异常:".concat(c));case 19:if(c.success){e.next=21;break}throw new Error(c.errMsg);case 21:t.showTextTip("评论已删除"),t.$emit("commentRemove",n),l=t.artboard,u=t.artboardDetail,ht(c.data)&&l&&(d=c.data,h=d.comments,f=d.replies,m=d.commentUpdateTime,p=d.artboardMaxPointIndex,"number"===typeof h&&(l.comments-=h),"number"===typeof f&&(l.replies-=f),p>=0&&(u.maxPointIndex=p),t.$emit("onCommentUpdateTime",{commentUpdateTime:m,artboardId:o})),e.next=30;break;case 27:e.prev=27,e.t0=e["catch"](6),t.showTextTip(e.t0);case 30:case"end":return e.stop()}}),e,null,[[6,27]])})))()},clickAttach:function(t){var e=this.attachMentImgs.map((function(t){return t.imgSrc})),n=e.findIndex((function(e){return e===t.imgSrc}));-1===n&&(n=0),this.$store.commit("setImageViewer",{imgList:e,currentIndex:n})},commentAdded:function(t){this.$emit("commentAdded",t),this.editorVisible&&this.clickReply()},clickCopy:function(){var t=this.comment;dn(Xs(t.summary,t.atUsers))?this.showTextTip("已复制评论到剪切板",2):this.showTextTip("复制评论到剪切板失败",2)},clickReply:function(t){var e=this;if(this.cloudIsLogin)if(this.editorVisible&&!0!==t){var n=this.$refs.editor;if(n&&n.canDestory)return this.editorVisible&&this.setCommentEditorVisibleId(0),void(this.editorState=ky.off);this.editorState=ky.hide}else this.editorState=ky.on,this.setCommentEditorVisibleId(this.comment.id),this.$nextTick((function(){var t=e.$refs.editor;t&&(t.focus(),t.fixScroll())}));else this.showTextTip("未登录,需要登录才可进行评论")}},watch:{autoOpenEditor:function(t){var e=this;t&&(this.comment.autoOpenEditor=!1,setTimeout((function(){e.clickReply(!0)}),313))}},computed:{autoOpenEditor:function(){return!!this.comment.autoOpenEditor},summaryHTML:function(){return zs(Gs(this.comment.summary),this.comment.atUsers)},artboardDetail:function(){return this.$store.state.artboardDetail},selectComment:function(){return this.artboardDetail.selectComment},commentEditorVisibleId:function(){return this.$store.state.commentEditorVisibleId},artboard:function(){var t;return null===(t=this.curArtboard)||void 0===t?void 0:t.artboard},canRemove:function(){return this.isSelfComment||this.cloudUserIsOwner},attachMentImgs:function(){var t,e=null===(t=this.comment)||void 0===t?void 0:t.attachMents,n=[];return e?(e.forEach((function(t){if(t){var e=t.thumbFileName||t.fileName;e&&n.push({imgSrc:t.fold+t.fileName,preview:t.fold+e})}})),n):n},userFaceTitle:function(){var t=this.comment;if(!t)return null;var e=t.user;return e?"".concat(e.nickName,"(").concat(e.email,")"):null},userNickName:function(){var t=this.comment;if(!t)return"-";var e=t.user;if(!e)return"-";var n=e.nickName;return n||"-"},isSelfComment:function(){var t=this.comment;if(!t)return!1;var e=t.user;return!!e&&e.userKey===this.cloudUserKey},isTourist:function(){var t=this.comment;if(!t)return!1;var e=t.user;if(!e)return!1;switch(e.authority){case K.Admin:case K.Designer:return!1}return!0},userFaceText:function(){var t=this.userNickName;return t[t.length-1]},editorEnable:function(){return this.editorState!==ky.off},editorVisible:function(){return this.editorState===ky.on&&this.commentEditorVisibleId===this.comment.id},isReply:function(){var t=this.comment;return!!t&&0!==t.commentId},isReplyOther:function(){var t=this.comment;return!!t&&(0!==t.commentId&&t.replyUser)}},data:function(){return{editorState:ky.off}},props:{comment:Object,users:Object}},Sy=Cy,Ty=(n("f080"),Object(wo["a"])(Sy,xy,yy,!1,null,"c5f42606",null)),Ay=Ty.exports,Iy={components:{Editor:wy,CommentItem:Ay,NetworkLoading:$l},methods:{onCommentUpdateTime:function(t){this.$emit("onCommentUpdateTime",t)},commentRemove:function(t){if(t){var e=this.comments;if(e){var n=e.findIndex((function(e){return e===t}));-1!==n&&e.splice(n,1)}}},clickReload:function(){this.$emit("clickReload")},commentAdded:function(t){var e=this;this.setSelectComment(t),this.$emit("commentAdded",t),this.$nextTick((function(){if(0===t.commentId){var n=e.$refs.commentList;n&&(n.scrollTop=1e5)}else e.scrollToComment(t)}))},getCommentOrReplyFromId:function(t,e){var n=this.comments;if(!n)return null;for(var i=0,r=n.length;i<r;i++){var a=n[i];if(!e&&a.id==t)return a;if(e){var o=a.comments;if(o){var s=o.find((function(e){return e.id===t}));if(s)return s}}}},refreshCommentList:function(){var t,e,n,i=this,r=this.comments,a=this.autoIntoInfo,o=null!==(t=null===(e=this.selectComment)||void 0===e?void 0:e.id)&&void 0!==t?t:0,s=o>0&&(null===(n=this.selectComment)||void 0===n?void 0:n.commentId)>0;if(null!=r){this.setSelectComment(null);var c=a.commentId,l=a.commentArtboardId,u=a.isReply;if(0!==l&&l==this.curArtboardId&&c>0){var d=this.getCommentOrReplyFromId(c,u);if(!d)return this.showTextTip("未定位到评论信息,可能已经被删除"),this.$store.commit("artboardCommentVisible",!0),a.commentId=a.commentArtboardId=-1,void this.$nextTick((function(){var t=i.$refs.commentList;t&&(t.scrollTop=1e5)}));this.setSelectComment(d)}if(a.commentId=a.commentArtboardId=-1,null==this.selectComment&&o>0){var h=this.getCommentOrReplyFromId(o,s);h&&this.setSelectComment(h)}null==this.selectComment&&this.$nextTick((function(){var t=i.$refs.commentList;t&&(t.scrollTop=1e5)}))}},scrollToComment:function(t){var e=this.comments,n=e.findIndex((function(e){return e===t})),i=0===n,r=n===e.length-1,a="art_c".concat(t.commentId,"_").concat(t.id),o=document.getElementById(a),s=this.$refs.commentList;if(o&&s){var c=o.getBoundingClientRect(),l=s.getBoundingClientRect(),u=l.top+Math.round(l.height/2)-(i?0:r?c.height:Math.round(c.height/2));s.scrollBy({top:c.top-u,behavior:"smooth"})}},setSelectComment:function(t){this.$store.commit("setSelectComment",{comment:t})}},computed:{selectComment:function(){return this.$store.state.artboardDetail.selectComment},autoIntoInfo:function(){return this.$store.state.autoIntoInfo},FetchState:function(){return Cn},users:function(){var t;return null!==(t=this.$store.state.artboardDetail.commentUsers)&&void 0!==t?t:{}},comments:function(){return this.$store.state.artboardDetail.comments},commentRoot:function(){return{id:0,comments:this.comments}},artboard:function(){var t;return null===(t=this.curArtboard)||void 0===t?void 0:t.artboard},visible:function(){return!0},commentInfoList:function(){var t;return null===(t=this.commentInfo)||void 0===t?void 0:t.list}},watch:{"autoIntoInfo.commentId":function(t){if(t>0){var e=this.autoIntoInfo,n=this.autoIntoInfo,i=n.commentId,r=n.commentArtboardId,a=n.isReply;if(r>0&&r===this.curArtboardId){var o=this.getCommentOrReplyFromId(i,a);if(!o)return void this.clickReload();this.selectComment===o?this.scrollToComment(o):this.setSelectComment(o),e.commentId=-1,e.commentArtboardId=-1}}},selectComment:function(t){var e=this;if(t){var n=this.$store.state.artboardDetail.notScrollList;!n&&this.$nextTick((function(){e.scrollToComment(t)}))}},comments:function(t,e){t!==e&&this.refreshCommentList()}},props:{listNeedRefresh:Boolean,fetchDetailState:Number,notSupportCommentCloudVersion:Boolean,errorText:{validator:function(){return!0}}},created:function(){this.refreshCommentList()}},Fy=Iy,My=(n("a0f7"),Object(wo["a"])(Fy,Zx,ty,!1,null,"58e13052",null)),Oy=My.exports,_y={components:{DetailComment:Oy},methods:{onCommentUpdateTime:function(t){if(ht(t)){var e=t.artboardId,n=t.commentUpdateTime;e===this.curArtboardId&&this.$set(this.selfChangecommentUpdateTimes,n,1)}},commentAdded:function(t){if(t){var e=this.artboardDetail,n=this.artboard;n&&(t.pointEnable&&(e.maxPointIndex=Math.max(e.maxPointIndex,t.pointIndex)),0===t.commentId?n.comments++:n.replies++)}},_getCommentsWithCache:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.curArtboardId,r){n.next=3;break}throw new Error("画板id不存在");case 3:if(t){n.next=7;break}if(a=Jx("comment",r),!a){n.next=7;break}return n.abrupt("return",a);case 7:return o=new FormData,o.append("artboardid",r),n.next=11,e.fetchPostCloudApi("GetCommentsByArtboard",{body:o});case 11:if(a=n.sent,s=ht(a),s){n.next=17;break}throw new Error("获取评论返回值异常:".concat(a));case 17:a.success&&Qx("comment",r,a,8e3);case 18:return n.abrupt("return",a);case 19:case"end":return n.stop()}}),n)})))()},clickRefresh:function(){this.getComments(!0)},getComments:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c,l,u,d,h,f,m;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.inCloudMode){n.next=2;break}return n.abrupt("return");case 2:if(e.inArtboardMode){n.next=4;break}return n.abrupt("return");case 4:if(e.artboardInComment||e.pointCommentShowAlways){n.next=6;break}return n.abrupt("return");case 6:if(e.commentDetailVisible){n.next=8;break}return n.abrupt("return");case 8:if(r=e.curArtboardId,r){n.next=11;break}return n.abrupt("return");case 11:if(e.fetchDetailState!==Cn.Fetching){n.next=13;break}return n.abrupt("return");case 13:return a=e.artboardDetail,e.fetchDetailState=Cn.Fetching,e.errorText="",a.comments=null,a.commentUsers=null,n.prev=18,e.selfChangecommentUpdateTimes={},n.next=22,e._getCommentsWithCache(t||e.listNeedRefresh);case 22:if(l=n.sent,l.success){n.next=25;break}throw l.errMsg;case 25:l=l.data,u=ls(l,fe),a.comments=u,a.commentUsers=null===(o=l)||void 0===o?void 0:o.users,a.maxPointIndex=null!==(s=null===(c=l)||void 0===c?void 0:c.artboardMaxPointIndex)&&void 0!==s?s:0,e.refreshedMinNotifyId=e.maxNotifyId,ht(l)&&(d=0,h=0,ut(l.list)&&(d=l.list.length,l.list.forEach((function(t){var e,n;h+=null!==(e=null===t||void 0===t||null===(n=t.comments)||void 0===n?void 0:n.length)&&void 0!==e?e:0}))),f=e.artboard,f&&(f.comments=d,f.replies=h,l.commentUpdateTime>=0&&(f.commentUpdateTime=l.commentUpdateTime,m=e.$store.state.userNotify.commentUpdateStates,e.$set(m,e.cloudKey,{artboardId:r,commentUpdateTime:l.commentUpdateTime})))),e.listNeedRefresh=!1,e.fetchDetailState=Cn.Success,n.next=41;break;case 36:n.prev=36,n.t0=n["catch"](18),e.errorText=n.t0,e.fetchDetailState=Cn.Error,e.showTextTip(n.t0);case 41:case"end":return n.stop()}}),n,null,[[18,36]])})))()}},computed:{cloudPage:function(){var t;return this.curArtboard&&(t=this.curArtboard.artboard.mlConfig.softVersion),t||(t=this.$store.state.config.softVer),"https://www.marklion.cn/cloud.shtml?invoke=MarkLion.Output".concat(dt(t)?"&ver=".concat(t):"")},pointCommentShowAlways:function(){return this.$store.state.pointCommentShowAlways},commentDetailVisible:function(){return this.cloudIsLogin||!this.cloudNeedLogin&&this.supportPublicCloudShowCommentCloudVersion},supportPublicCloudShowCommentCloudVersion:function(){return!wt(this.cloudVersion)},artboardCommentUpdateTimeChanged:function(){var t,e=this.artboardNewCommentUpdateTime,n=this.listNeedRefresh,i=this.selfChangecommentUpdateTimes,r=this.curArtboardId;return!(r<1)&&(!n&&(0!==e&&(!i[e]&&e!==(null===(t=this.artboard)||void 0===t?void 0:t.commentUpdateTime))))},artboardNewCommentUpdateTime:function(){var t,e=this.$store.state.userNotify.commentUpdateStates[this.cloudKey];return e?e.artboardId!==this.curArtboardId?0:null!==(t=e.commentUpdateTime)&&void 0!==t?t:0:0},maxNotifyId:function(){var t,e=this.notifyList;return 0===e.length?0:null===(t=e[0])||void 0===t?void 0:t.id},notifyList:function(){var t,e;return null!==(t=null===(e=this.$store.state.userNotify.cloudList[this.cloudKey])||void 0===e?void 0:e.list)&&void 0!==t?t:[]},artboardCommentVisible:function(){return this.$store.state.artboardCommentVisible},artboardDetail:function(){return this.$store.state.artboardDetail},notSupportCommentCloudVersion:function(){return ft(this.cloudVersion)},artboard:function(){var t=this.curArtboard;return t?t.artboard:null},curArtboardId:function(){var t,e;return null!==(t=null===(e=this.artboard)||void 0===e?void 0:e.cid)&&void 0!==t?t:0}},watch:{artboardCommentUpdateTimeChanged:function(t){t&&(this.listNeedRefresh=!0)},inArtboardMode:function(){this.getComments()},pointCommentShowAlways:function(){this.getComments()},curArtboardId:function(){this.getComments()},cloudIsLogin:function(){this.getComments()}},data:function(){return{selfChangecommentUpdateTimes:{},listNeedRefresh:!1,refreshedMinNotifyId:0,fetchDetailState:Cn.Normal,errorText:""}},created:function(){this.getComments()}},Ly=_y,Py=(n("e270"),Object(wo["a"])(Ly,Xx,Kx,!1,null,"7687c16a",null)),Ey=Py.exports,Ny=function(){var t=this,e=t._self._c;return t.inMultDownMode&&t.curArtboard?e("section",{staticClass:"mult-download"},[e("Header",{attrs:{exportNodeCount:t.exportNodeCount,options:t.platformSelectOptions},on:{onPlatformSelectChanged:t.onPlatformSelectChanged}}),0===t.exportNodeCount?[e("div",{staticClass:"empty"},[t._v("当前画板不存在切图")])]:[e("div",{staticClass:"list"},t._l(t.curArtboard.exportNodes,(function(n,i){return e("ExportNodeItem",{key:"".concat(i,"-").concat(n.guid),attrs:{node:n,exportPdfOnly:t.exportPdfOnly}})})),1),t.currentResInSvg||t.currentResInPdf?t._e():e("div",{staticClass:"platform-set"},[e("PropertyDownloadOptions",{ref:"downOptions",attrs:{jpgQuality:t.jpgQuality,currentResInSvg:t.currentResInSvg,currentResInPdf:t.currentResInPdf,currentResInJpg:t.currentResInJpg,exportSvgOnly:t.exportSvgOnly,exportPdfOnly:t.exportPdfOnly,downloadPlatform:t.downloadPlatform,node:null,bottomPosition:!0},on:{setJpgQuality:t.setJpgQuality}})],1)],e("div",{staticClass:"btns"},[e("Select",{attrs:{options:t.resTypeSelectOptions,expandUp:!0},on:{changed:t.onResTypeSelectChanged}}),e("a",{staticClass:"button light download",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickDownSelectAll()}}},[t._v("下载切图")])],1),e("footer",[e("a",{staticClass:"button",attrs:{href:"javascript:;"},on:{click:function(e){return t.setInMultDownMode(!1)}}},[t._v("关闭")])])],2):t._e()},Dy=[],jy=function(){var t=this,e=t._self._c;return e("section",{staticClass:"header"},[e("a",{staticClass:"btn-set-platform",class:{on:t.setting},attrs:{href:"javascript:;"},on:{click:function(e){t.setting=!t.setting}}},[t._v(" "+t._s(t.calcPlatformTypeText)+" ")]),t.setting?e("div",{staticClass:"platforms"},[e("SetPlatform",{attrs:{options:t.options},on:{clickCalcPlatform:t.clickCalcPlatform}})],1):t._e(),e("div",[0!==t.exportNodeCount?e("Radio",{attrs:{text:t.selectAllText,selected:t.allSelected},on:{click:t.clickAllSelectBtn}}):t._e()],1)])},Ry=[],Vy=function(){var t=this,e=t._self._c;return e("section",{staticClass:"set-platform"},[e("ul",t._l(t.options,(function(n){return e("li",{key:n.name,class:{on:t.calcPlatformType2===n.value}},[e("a",{staticClass:"name",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickCalcPlatform(n)}}},[t._v(t._s(n.name))])])})),0)])},By=[],Uy={methods:{clickCalcPlatform:function(t){this.$emit("clickCalcPlatform",t)}},data:function(){return{calcPlatformType2:0,CALC_PLATFORM_TYPE:s}},created:function(){this.calcPlatformType2=(this.options.find((function(t){return t.selected}))||{value:0}).value},props:{options:Array}},Hy=Uy,Wy=(n("6753"),Object(wo["a"])(Hy,Vy,By,!1,null,"61524a7c",null)),$y=Wy.exports,Gy={methods:{clickCalcPlatform:function(t){this.$emit("onPlatformSelectChanged",t),this.setting=!1},clickAllSelectBtn:function(t){t=!this.allSelected&&(this.exportNodeCount,!0);var e=this.curArtboard.exportNodes;e.forEach((function(e){e.markedForExport&&(e.mlUserSelectDown=t)}))}},computed:{selectAllText:function(){return"全选(".concat(this.selectNodeCount,"/").concat(this.exportNodeCount,")")},calcPlatformTypeText:function(){if(!ut(this.options))return"UnKnown";var t=this.options.find((function(t){return t.selected}));return t?t.name:"UnKnown"},allSelected:function(){return 0!==this.exportNodeCount&&this.exportNodeCount===this.selectNodeCount},selectNodeCount:function(){var t=this.curArtboard.exportNodes,e=0;return t.forEach((function(t){t.markedForExport&&t.mlUserSelectDown&&(e+=1)})),e}},data:function(){return{setting:!1}},props:{exportNodeCount:Number,options:Array},components:{Radio:Td,SetPlatform:$y}},zy=Gy,Yy=(n("be70"),Object(wo["a"])(zy,jy,Ry,!1,null,"5349ca90",null)),Xy=Yy.exports,Ky=function(){var t=this,e=t._self._c;return e("div",{staticClass:"item"},[e("div",{staticClass:"preview",class:{on:t.node.mlUserSelectDown,white:t.exportBoxBackground===t.ExportBoxBackgroundType.White,black:t.exportBoxBackground===t.ExportBoxBackgroundType.Black},on:{click:function(e){t.node.mlUserSelectDown=!t.node.mlUserSelectDown},contextmenu:function(e){e.preventDefault(),t.exportBgTabVisible=!0}}},[t.exportPdfOnly?e("PdfViewer",{attrs:{maxWidth:"95%",maxHeight:"95%",url:t.exportPreviewPng}}):e("img",{attrs:{src:t.exportPreviewPng}}),e("Radio",{attrs:{text:"",selected:t.node.mlUserSelectDown}})],1),e("div",{staticClass:"info"},[e("NodeName",{attrs:{node:t.node}}),e("div",{staticClass:"size"},[t._v(t._s(t.size))])],1),t.exportBgTabVisible?e("ul",{staticClass:"export-bg"},[e("li",{class:{on:t.ExportBoxBackgroundType.Black===t.exportBoxBackground,black:1},on:{click:function(e){return t.clickExportBoxBackgroundType(t.ExportBoxBackgroundType.Black)}}},[t._v(" 深色预览背景 ")]),e("li",{class:{on:t.ExportBoxBackgroundType.Transparent===t.exportBoxBackground,transparent:1},on:{click:function(e){return t.clickExportBoxBackgroundType(t.ExportBoxBackgroundType.Transparent)}}},[t._v(" 浅色预览背景 ")])]):t._e()])},qy=[],Qy={methods:{clickExportBoxBackgroundType:function(t){this.$store.commit("exportBoxBackgroundType",t)},hideSelect:function(){var t=this;requestAnimationFrame((function(){t.exportBgTabVisible=!1}))}},computed:{ExportBoxBackgroundType:function(){return F},exportPreviewPng:function(){var t,e,n=null!==(t=null===(e=this.node)||void 0===e?void 0:e.mlConfig)&&void 0!==t?t:{},i=n.pngPreview,r=n.svgPreview,a=n.pdfPreview,o=i||r;return this.inCloudMode?this.exportPdfOnly&&!o&&a?a:o:o+"?"+this.curArtboard.artboard.mlOutputTime},size:function(){var t,e=this.node,n=this.curArtboard;if(n&&(t=n.artboard.mlConfig),t){var i=t.sizeMap;if(i)for(var r=e.exportPath.toLowerCase(),a=0;a<Mu.length;a++){var o=Mu[a],s=o.scale,c=o.ext,l=i[r+c];if(l){var u=Math.ceil(l.width/s),d=Math.ceil(l.height/s);return"".concat(u,"x").concat(d)}}}return"".concat(Math.ceil(fn(this.originWidth,2)),"x").concat(Math.ceil(fn(this.originHeight,2)))},originWidth:function(){return this.node.boundsInArtboard.width},originHeight:function(){return this.node.boundsInArtboard.height}},watch:{exportBgTabVisible:function(t){t?(window.addEventListener("click",this.hideSelect,!0),window.addEventListener("contextmenu",this.hideSelect,!0)):(window.removeEventListener("click",this.hideSelect,!0),window.removeEventListener("contextmenu",this.hideSelect,!0))}},beforeDestroy:function(){window.removeEventListener("click",this.hideSelect,!0),window.removeEventListener("contextmenu",this.hideSelect,!0)},data:function(){return{exportBgTabVisible:!1}},components:{Radio:Td,NodeName:Aw,PdfViewer:Ix},props:{node:Object,exportPdfOnly:Boolean}},Jy=Qy,Zy=(n("6a75"),Object(wo["a"])(Jy,Ky,qy,!1,null,"5da504da",null)),tk=Zy.exports;function ek(t,e){if(ht(t)){var n=t.exportNodes;ut(n)&&(e=!!e,n.forEach((function(t){t.mlUserSelectDown=e})))}}var nk={methods:{setJpgQuality:function(t){t>0&&t<=100&&(this.jpgQuality=t,rn(ai,t))},onPlatformSelectChanged:function(t){ht(t)&&(this.downloadPlatform=t.value)},onResTypeSelectChanged:function(t){ht(t)&&this.clickCurrentResType(t.value)},clickCurrentResType:function(t){switch(t){case l.PNG:if(!this.exportPng)return void this.showTextTip("设计狮没有为该画板导出[PNG]格式的切图");break;case l.WEBP:if(!this.exportWebP)return void this.showTextTip("设计狮没有为该画板导出[WEBP]格式的切图");break;case l.SVG:if(!this.exportSvg)return void this.showTextTip("设计狮没有为该画板导出[SVG]格式的切图");break;case l.PDF:if(!this.exportPfd)return void this.showTextTip("设计狮没有为该画板导出[PDF]格式的切图");break;case l.JPG:break}this.currentResType=t,rn("resType",t)},clickDownSelectAll:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==t.exportNodeCount){e.next=3;break}return t.showTextTip("当前画板不存在切图"),e.abrupt("return");case 3:if(t.setInOutput(!0),e.prev=4,!t.currentResInPdf){e.next=10;break}return e.next=8,_u(t.selectNodes,t.curArtboard);case 8:e.next=22;break;case 10:if(!t.currentResInSvg){e.next=15;break}return e.next=13,Lu(t.selectNodes,t.curArtboard);case 13:e.next=22;break;case 15:if(!t.currentResInJpg){e.next=20;break}return e.next=18,Yu(t.downloadPlatform,t.androidUseMipmap,t.$refs.downOptions.checkSetting,t.selectNodes,t.curArtboard,t.jpgQuality/100);case 18:e.next=22;break;case 20:return e.next=22,Xu(t.downloadPlatform,t.androidUseMipmap,t.$refs.downOptions.checkSetting,t.selectNodes,t.curArtboard,t.currentResInWebP);case 22:e.next=27;break;case 24:e.prev=24,e.t0=e["catch"](4),t.showTextTip(e.t0);case 27:return e.prev=27,t.setInOutput(!1),e.finish(27);case 30:case"end":return e.stop()}}),e,null,[[4,24,27,30]])})))()},initJpgQuality:function(){var t=this.curArtboard;if(t){var e=parseInt(nn(ai,!1));(isNaN(e)||e<1||e>=100)&&(e=ri),this.jpgQuality=e}},initCurrentResType:function(){var t=this.curArtboard;if(t){var e=parseInt(nn("resType",!1));(isNaN(e)||!isFinite(e)||e!==l.SVG&&e!==l.PDF&&e!==l.WEBP&&e!==l.JPG)&&(e=l.PNG);var n=this.curArtboard.artboard.mlConfig.resType;n||(n=l.PNG);var i=this.exportPng,r=this.exportSvg,a=this.exportWebP,o=this.exportPdf;switch(e){case l.PNG:i||(a?e=l.WEBP:r?e=l.SVG:o&&(e=l.PDF));break;case l.SVG:r||(i?e=l.PNG:a?e=l.WEBP:o&&(e=l.PDF));break;case l.PDF:o||(i?e=l.PNG:a?e=l.WEBP:r&&(e=l.SVG));break;case l.WEBP:a||(i?e=l.PNG:r?e=l.SVG:o&&(e=l.PDF));break;case l.JPG:i||r||a||o||(e=l.PNG);break}this.currentResType=e}}},computed:{platformSelectOptions:function(){return[{name:"Web",value:s.WEB,selected:this.downloadPlatform===s.WEB},{name:"Android",value:s.ANDROID,selected:this.downloadPlatform===s.ANDROID},{name:"iOS",value:s.IOS,selected:this.downloadPlatform===s.IOS}]},resTypeSelectOptions:function(){var t=this.currentResType,e={value:l.PNG,name:"PNG",selected:t===l.PNG,disabled:!this.exportPng},n={value:l.WEBP,name:"WEBP",selected:t===l.WEBP,disabled:!this.exportWebP},i={value:l.SVG,name:"SVG",selected:t===l.SVG,disabled:!this.exportSvg},r={value:l.PDF,name:"PDF",selected:t===l.PDF,disabled:!this.exportPdf},a={value:l.JPG,name:"JPG",selected:t===l.JPG,disabled:!1};return[e,n,i,r,a]},exportWebP:function(){return Pe(this.curArtboard.artboard)},exportPng:function(){return Le(this.curArtboard.artboard)},exportSvg:function(){return Ee(this.curArtboard.artboard)},exportPdf:function(){return Ne(this.curArtboard.artboard)},exportSvgOnly:function(){return this.exportSvg&&!this.exportPng&&!this.exportWebP},exportPdfOnly:function(){return this.exportPdf&&!this.exportSvg&&!this.exportPng&&!this.exportWebP},currentResInPdf:function(){return this.currentResType===l.PDF},currentResInSvg:function(){return this.currentResType===l.SVG},currentResInJpg:function(){return this.currentResType===l.JPG},currentResInWebP:function(){return this.currentResType===l.WEBP},selectNodes:function(){var t=this.curArtboard.exportNodes,e=[];return t.forEach((function(t){t.markedForExport&&t.mlUserSelectDown&&e.push(t)})),e},exportNodeCount:function(){var t=this.curArtboard.exportNodes;return t.length}},components:{Header:Xy,ExportNodeItem:tk,PropertyDownloadOptions:yx,Select:wd},watch:{inMultDownMode:function(t){this.downloadPlatform=this.calcPlatformUse,ek(this.curArtboard,t),this.initCurrentResType(),this.initJpgQuality()},curArtboard:function(t,e){ek(e,!1),this.inMultDownMode&&ek(t,!0),this.initCurrentResType(),this.initJpgQuality()}},data:function(){return{currentResType:l.PNG,jpgQuality:ri,CALC_PLATFORM_TYPE:s,downloadPlatform:s.WEB}},created:function(){this.downloadPlatform=this.calcPlatformUse,this.inMultDownMode&&ek(this.curArtboard,!0),this.initCurrentResType(),this.initJpgQuality()}},ik=nk,rk=(n("6df1"),Object(wo["a"])(ik,Ny,Dy,!1,null,"996c731c",null)),ak=rk.exports,ok={components:{ZoomContainer:Fl,Properties:Yx,LeftSide:Vg,MultDownload:ak,CommentMain:Ey},methods:{clickReload:function(){window.location.reload()},checkArtboardData:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c,l,u,d,h,f,m;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return");case 2:return r=!0,ht(t)&&!1===t.isLoaded&&(r=!1),n.next=7,Qr(t,e.documentArtboards);case 7:a=n.sent,!r&&a.isLoaded&&(o=a.artboard,ht(o)&&(s=o.mlConfig,ht(s)&&"number"===typeof s.platform&&(c=ye(o.docGuid,s.platform),e.$store.commit("setPlatform",c),l=xe(o.docGuid),e.$store.commit("setUnitTemplate",l)),u=ge.initNodeGuid,u?(ge.initNodeGuid=null,d=a.childs.find((function(t){return t.guid===u})),d&&e.curNode!==d&&e.setCurNode(d)):e.curNode&&(f=e.curNode.guid,m=null!==(h=a.childs.find((function(t){return f===(null===t||void 0===t?void 0:t.guid)})))&&void 0!==h?h:null,e.setCurNode(m))));case 9:case"end":return n.stop()}}),n)})))()}},watch:{pathDataUpdateTimeTimes:function(t){t&&this.checkArtboardData(this.curArtboard).catch((function(t){}))}},computed:{pathDataUpdateTimeTimes:function(){var t=this.pathData,e=this.updateTimeTimes;return t?"".concat(t,"-").concat(e):null},backgroundColor:function(){return this.$store.state.artboardDetail.interactionSet.backgroundColor},EnumScaleType:function(){return O},isLoaded:function(){return this.curArtboard.isLoaded},isFetching:function(){return this.curArtboard.isFetching},isError:function(){return this.curArtboard.isError},updateTimeTimes:function(){var t,e;return null!==(t=null===(e=this.curArtboard)||void 0===e||null===(e=e.artboard)||void 0===e?void 0:e.updateTimeTimes)&&void 0!==t?t:0},pathData:function(){var t,e;return null!==(t=null===(e=this.curArtboard)||void 0===e||null===(e=e.artboard)||void 0===e?void 0:e.pathData)&&void 0!==t?t:""}},created:function(){this.checkArtboardData(this.curArtboard)}},sk=ok,ck=(n("4869"),Object(wo["a"])(sk,fg,mg,!1,null,"459b6778",null)),lk=ck.exports,uk=function(){var t=this,e=t._self._c;return t.visible?e("section",{staticClass:"pop-box webp-tip"},[e("div",{staticClass:"box"},[e("h4",[t._v("浏览器性能提示")]),e("p",[t._v("Safari浏览器可能会出现响应卡顿及WebP资源无法加载,建议使用Chrome、Firefox浏览器访问.")]),e("div",{staticClass:"footer"},[e("div",[e("a",{staticClass:"checkbox",class:{on:t.remember},attrs:{href:"javascript:;"},on:{click:function(e){t.remember=!t.remember}}},[e("i",[t._v("浏览器关闭前不再提示")])])]),e("div",[e("a",{staticClass:"button light",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickConfirm()}}},[t._v("我知道了")])])])])]):t._e()},dk=[],hk="safari_webp_notip",fk={methods:{clickConfirm:function(){this.remember&&sn(hk,"1"),this.visible=!1},checkWebPSupport:function(){var t=this;clearTimeout(this.handle),this.handle=setTimeout((function(){t._checkWebPSupport()}),100)},_checkWebPSupport:function(){var t=this;if(this.inCloudMode&&this.allArtboardLoadChecked){var e="1"===on(hk,!1);e||Ma((function(e){_a?t.visible=!0:e===Oa.Support&&sn(hk,"1")}))}}},computed:{allArtboardLoadChecked:function(){return this.$store.state.allArtboardLoadChecked}},watch:{allArtboardLoadChecked:function(){this.checkWebPSupport()},inCloudMode:function(){this.checkWebPSupport()}},data:function(){return{visible:!1,remember:!1,handle:0}},beforeDestroy:function(){clearTimeout(this.handle)},created:function(){this.checkWebPSupport()}},mk=fk,pk=(n("4b69"),Object(wo["a"])(mk,uk,dk,!1,null,"d989a384",null)),vk=pk.exports,bk={components:{EmptyData:og,ArtboardList:hg,ArtboardInfo:lk,Header:Xb,Tip:sd,ArtboardListItemMenu:ed,InOutputTip:rf,Authority:tg,FolderNav:Qh,CloudNeedLoginTip:hu,SafariWebpTip:vk,ImageViewer:Ll,NetDiskFileMain:ou,AutomaticSync:yo,ChangeArtboardsTip:Io},computed:{emptyText:function(){return this.inCloudMode?0===this.cloudCurrentFolderId?"私有云下还没有文件夹,请在标记狮中添加":this.inNetDiskFileMode?"文件不存在,可能已经被移动或删除":"当前文件夹是空的":"未检测到数据,请尝试重新导出画板"},artboardLoadProgressText:function(){return Math.floor(1e4*this.artboardLoadProgress.current/this.artboardLoadProgress.count)/100+"%"},artboardLoadProgress:function(){return this.$store.state.artboardLoadProgress},allArtboardLoadChecked:function(){return this.$store.state.allArtboardLoadChecked},isEmptyArtboardData:function(){return this.inNetDiskFileMode?null==this.curNetDiskFile:0===this.documentArtboards.length},isEmptyFolder:function(){return this.isEmptyArtboardData&&0===this.cloudSubFiles.length&&0===this.cloudSubFolders.length}},watch:{cloudCurrentFolderId:function(){ql.clear(150)},curArtboard:function(t){var e=this;this.checkUserState().then((function(t){e.$store.commit("setMyState",t)})).catch((function(){})),t||this.setInMultDownMode(!1)}},created:function(){window.vueApp=this}},gk=bk,wk=(n("6094"),Object(wo["a"])(gk,ho,fo,!1,null,"1a683ae4",null)),xk=wk.exports,yk=!1;function kk(){var t=nn("evmu",!1);return dt(t)&&32===t.length||(t=Wn(32,16),rn("evmu",t)),t}function Ck(){var t,e;if(!yk&&(yk=!0,ya&&!ya.inCloudMode)){var n=ge.config,i=n.guid,r=n.softVer,a=ge.fileType,o={ver:r,type:a,f:i.replace(/-/gi,""),u:kk(),ot:null!==(t=null===(e=ya.documentArtboards.find((function(t){var e;return(null===t||void 0===t||null===(e=t.artboard)||void 0===e?void 0:e.mlOutputTime)>0})))||void 0===e?void 0:e.artboard.mlOutputTime)&&void 0!==t?t:0};if(!(o.ot<1)){var s="evmu".concat(o.type).concat(o.f).concat(o.ot),c=+on(s,!1);if(!isNaN(c)&&c>0){var l=Math.abs(Date.now()-c);if(l>=0&&l<36e5)return}sn(s,Date.now().toString());var u=new URLSearchParams(o),d=new Image,h=function(){d.onload=d.onerror=null,d.removeAttribute("src")};d.onload=d.onerror=h,d.src="".concat("https://log.marklion.cn","/st/?").concat(u.toString())}}}function Sk(){try{return Ck()}catch(t){}}function Tk(t,e){return Ak.apply(this,arguments)}function Ak(){return Ak=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,o,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=+ln("commentid","#"),o="1"===ln("isreply","#"),e().then((function(){ge.inCloudMode?function(){try{var t=lo.state;if(ya.cloud.renderMode==U.File)return void(t.cloud.allFoldersBoxVisible=!1);t.cloud.allFoldersBoxVisible="1"===on(E,!1),Zi(t.documentArtboards);var e=t.cloud.defaultArtboardGuid,i=null,a=null;if(e){if(i=ya.documentArtboards.find((function(t){return t.artboard.guid===e})),i){var s=window.location.href,c=/\/viewer\/\d+\/[^\\/]+\/([^\\/]+)\//i.exec(s),l=c?decodeURIComponent(c[1]):null;a=i.childs.find((function(t){return t.guid===l})),a||(ge.initNodeGuid=l)}if(t.curArtboard!==i&&lo.commit("curArtboard",{artboard:i}),t.curNode!==a&&(lo.commit("curNode",a),lo.commit("setArtboardInComment",!1)),r>0){var u,d,h=t.autoIntoInfo;h.commentArtboardId=null!==(u=null===(d=i)||void 0===d||null===(d=d.artboard)||void 0===d?void 0:d.cid)&&void 0!==u?u:0,h.commentId=r,h.isReply=o,lo.commit("setArtboardInComment",!0)}}n()}finally{lo.commit("allArtboardLoadChecked",!0)}}():function(){var t=function(){var t=window.location.hash,e=null,n=null;if(t){var i=/\/artboard\/([^\\/]+)/i.exec(t);if(i){var r=i[1];e=ya.documentArtboards.find((function(t){return t.artboard.guid===r}))}if(e&&(i=/\/node\/([^\\/]+)/i.exec(t),i)){var a=i[1],o=e.childs;n=o.find((function(t){return t.guid===a}))}}lo.state.curArtboard!==e&&lo.commit("curArtboard",{artboard:e}),lo.state.curNode!==n&&lo.commit("curNode",n)};window.addEventListener("hashchange",t),t(),setTimeout((function(){lo.commit("allArtboardLoadChecked",!0),Sk()}),100)}()})),s=new a["a"]({store:lo,render:function(t){return t(xk)}}),Ma((function(t){lo.commit("isSupportWebp",t),s.$mount("#app")}));case 5:case"end":return t.stop()}}),t)}))),Ak.apply(this,arguments)}var Ik=function(){var t=this,e=t._self._c;return e("section",{class:{"header-off":!t.headerVisible},attrs:{id:"main"}},[!t.cloudNeedLogin||t.cloudIsLogin?e("div",{staticClass:"loading",class:{on:!t.allArtboardLoadChecked}},[t._v("正在加载画板数据中("+t._s(t.artboardLoadProgressText)+"),请稍后...")]):t._e(),t.cloudNeedLogin&&!t.cloudIsLogin?e("CloudNeedLoginTip"):t.allArtboardLoadChecked?[e("Header"),e("a",{staticClass:"btn-visible-pop",attrs:{href:"javascript:;",title:t.headerVisibleTitle},on:{click:t.clickHeaderVisible}}),e("main",{style:{backgroundColor:t.backgroundColor}},[t.cloudFolderNotFound?e("EmptyData",{attrs:{text:t.cloudFolderErrorText,showLoginBtn:t.cloudFolderInSpecify}}):t.permission?t.isEmptyArtboardData?e("EmptyData",{attrs:{text:t.emptyText}}):[e("LeftSide")]:e("Authority"),e("device-container")],2)]:t._e(),e("Tip"),e("AutomaticSync")],2)},Fk=[],Mk=function(){var t=this,e=t._self._c;return e("section",{staticClass:"left-side-pc",class:{on:t.leftSideVisible}},[e("a",{staticClass:"btn-visible",class:{on:t.leftSideVisible,off:!t.headerVisible},attrs:{href:"javascript:;",title:t.leftSideVisible?"收起左侧(F3)":"展开左侧(F3)"},on:{click:function(e){return t.setVisible(!t.visible)}}}),e("div",{staticClass:"filter"},[e("div",{staticClass:"search"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText.artboard,expression:"searchText.artboard"}],attrs:{type:"text",placeholder:"搜索画板名",spellcheck:"false"},domProps:{value:t.searchText.artboard},on:{input:function(e){e.target.composing||t.$set(t.searchText,"artboard",e.target.value)}}}),t.searchText.artboard?e("a",{staticClass:"btn-clear",attrs:{href:"javascript:;"},on:{click:function(e){t.searchText.artboard=""}}}):t._e()]),e("a",{staticClass:"artlist-mode",class:{min:!t.artlistModeMin},attrs:{href:"javascript:;",title:t.artlistModeMinTitle},on:{click:t.clickArtlistModeMin}})]),e("section",{staticClass:"box"},[e("ArtboardList",{attrs:{artlistModeMin:t.artlistModeMin,visible:!0,list:t.renderDocumentArtboards,renderArtboardList:t.renderArtboardList,sliceFilterOpen:t.sliceFilterOpen}})],1)])},Ok=[],_k=[],Lk={toggleFullscreen:function(){this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()},isFullscreen:function(){var t=!0===document.fullscreen||null!=document.fullscreenElement||null!=document.msFullscreenElement||null!=document.mozFullscreenElement||null!=document.webkitFullscreenElement;return t||(t=screen.height==Math.max(window.outerHeight,window.innerHeight)&&screen.width==Math.max(window.outerWidth,window.innerWidth),t)},requestFullscreen:function(){var t=document.documentElement,e=t.requestFullscreen||t.webkitRequestFullscreen||t.msRequestFullscreen||t.mozRequestFullscreen;try{e&&e.call(t).catch((function(){}))}catch(n){}},exitFullscreen:function(){var t=document.exitFullscreen||document.webkitExitFullscreen||document.msExitFullscreen||document.mozExitFullscreen;t&&t.call(document)},onChange:function(t){if("function"===typeof t){var e=_k.findIndex((function(e){return e===t}));-1===e&&_k.push(t)}},offChange:function(t){if("function"===typeof t){var e=_k.findIndex((function(e){return e===t}));-1!==e&&_k.splice(e,1)}}};function Pk(){if(0!=_k.length){var t=Lk.isFullscreen();_k.forEach((function(e){try{e(t)}catch(n){console.error(n)}}))}}document.addEventListener("webkitfullscreenchange",Pk),document.addEventListener("mozfullscreenchange",Pk),document.addEventListener("msfullscreenchange",Pk),document.addEventListener("fullscreenchange",Pk),window.addEventListener("resize",Pk);var Ek={components:{ArtboardList:Ng},methods:{clickArtlistModeMin:function(){this.artlistModeMin=!this.artlistModeMin,rn("leftside.artlistmodemin",this.artlistModeMin?"1":"0")},quickKeyShift:function(t){this.shiftKey=t.shiftKey},quickKey:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.quickKeyShift(t),r=t.keyCode||t.which,n.t0=r,n.next=112===n.t0||122===n.t0?5:113===n.t0?8:114===n.t0?11:38===n.t0||40===n.t0?14:48;break;case 5:return Lk.toggleFullscreen(),t.preventDefault(),n.abrupt("break",48);case 8:return e.$store.commit("setInteractionHeaderVisible",!e.headerVisible),t.preventDefault(),n.abrupt("break",48);case 11:return e.setVisible(!e.visible),t.preventDefault(),n.abrupt("break",48);case 14:if(!e.keydownConfirming){n.next=16;break}return n.abrupt("return");case 16:if(!e.imageViewer.visible){n.next=18;break}return n.abrupt("return");case 18:if(a=38===r?-1:1,o=t.ctrlKey||t.metaKey,o){n.next=22;break}return n.abrupt("break",48);case 22:if(s=e.renderArtboardList,0!==s.length){n.next=26;break}return e.showTextTip(1===a?"已经到达最后一个画板":"已经到达第一个画板"),n.abrupt("return");case 26:if(c=s.findIndex((function(t){return e.curArtboard===t})),-1===c?c=0:c+=a,!(c<0)){n.next=33;break}return e.showTextTip("已经到达第一个画板"),n.abrupt("return");case 33:if(!(c>=s.length)){n.next=36;break}return e.showTextTip("已经到达最后一个画板"),n.abrupt("return");case 36:if(!e.inCommentDrawing){n.next=46;break}return e.keydownConfirming=!0,n.prev=38,n.next=41,e.confirm({text:"正在编辑画板截图,是否清理截图信息并切换画板?"});case 41:if(n.sent){n.next=43;break}return n.abrupt("return");case 43:return n.prev=43,e.keydownConfirming=!1,n.finish(43);case 46:return e.setCurArtboard(s[c]),n.abrupt("break",48);case 48:case"end":return n.stop()}}),n,null,[[38,,43,46]])})))()},getArtboardExportNodeCount:function(t){if(this.inCloudMode)return t.artboard.resNodeCount;var e=t.exportNodes;return e.length},setVisible:function(t){if(!this.headerVisible)return this.$store.commit("setInteractionHeaderVisible",!0),void this.$store.commit("leftSideVisible",!0);this.$store.commit("leftSideVisible",t)}},computed:{leftSideVisible:function(){return this.visible&&this.headerVisible},headerVisible:function(){return this.$store.state.artboardDetail.interactionSet.headerVisible},imageViewer:function(){return this.$store.state.imageViewer},renderArtboardList:function(){var t=this,e=this.artboardSearchText,n=this.sliceFilterOpen,i=this.renderDocumentArtboards,r=""!==e,a=[];return i.forEach((function(i){if(i&&i.artboard&&(!n||0!==t.getArtboardExportNodeCount(i))){if(r){var o=i.artboard.name;if(!o)return;if(-1===o.toLowerCase().indexOf(e))return}a.push(i)}})),a},artboardSearchText:function(){return this.searchText.artboard.toLowerCase()},artlistModeMinTitle:function(){return this.artlistModeMin?"单击切换到大图模式":"单击切换到小图模式"},visible:function(){return this.$store.state.artboardDetail.leftSideVisible}},data:function(){return{keydownConfirming:!1,preloadCount:2,shiftKey:!1,artlistModeMin:"1"===nn("leftside.artlistmodemin",!1),sliceFilterOpen:!1,commentFilterOpen:!1,searchText:{artboard:""}}},created:function(){window.addEventListener("keydown",this.quickKey),window.addEventListener("keyup",this.quickKeyShift)},beforeDestroy:function(){window.removeEventListener("keydown",this.quickKey),window.removeEventListener("keyup",this.quickKeyShift)}},Nk=Ek,Dk=(n("3f10"),Object(wo["a"])(Nk,Mk,Ok,!1,null,"7839b219",null)),jk=Dk.exports,Rk=function(){var t=this,e=t._self._c;return e("header",[e("div",{staticClass:"nav"},[e("PathNav")],1),e("device-set"),e("div",{staticClass:"preview-set"},[e("a",{staticClass:"btn-fullscreen",class:{on:t.isFullscreen},attrs:{href:"javascript:;",title:t.isFullscreen?"退出全屏(F1)":"全屏查看(F1)"},on:{click:t.clickFullscreen}}),e("BtnContainerColor"),e("BtnContainerVerticalAlign"),e("div",{staticClass:"line"}),e("div",{staticClass:"helper",class:{on:t.helperVisible},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickHelper(!t.helperVisible)}}},[e("Helper")],1),t.inCloudMode?e("BtnGoInteraction",{attrs:{fixRight:!t.cloudIsLogin}}):t._e(),t.inCloudMode&&t.cloudIsLogin?e("UserNotifyButton"):t._e(),t.inCloudMode?e("UserInfo",{attrs:{setVisible:t.setVisible}}):t._e()],1),t.inCloudMode?e("UserNotify"):t._e()],1)},Vk=[],Bk=function(){var t=this,e=t._self._c;return e("div",{staticClass:"nav-item"},[e("div",{staticClass:"name",attrs:{title:t.folderName},on:{click:t.clickNav}},[t._v(t._s(t.folderName))]),t.showArtboardPages?e("PathNavArtboardPages"):t._e()],1)},Uk=[],Hk={components:{PathNavArtboardPages:ib},methods:{clickNav:function(){tn(this.cloudCurrentFolderId)}},computed:{folderName:function(){var t=this.cloudName,e=this.cloudCurrentFolderId,n=this.cloudFolderNotFound,i=this.documentName,r=this.cloudFolderInSpecify;return 0===e?t||"私有云根目录":r?"没有访问权限":n?"链接已失效":i},showArtboardPages:function(){return this.documents.length>0}}},Wk=Hk,$k=(n("7bcc"),Object(wo["a"])(Wk,Bk,Uk,!1,null,"cfeba876",null)),Gk=$k.exports,zk=function(){var t=this,e=t._self._c;return e("div",{staticClass:"btn-container-vertical-align"},[e("div",{staticClass:"current",class:Object(Ht["a"])(Object(Ht["a"])({},t.verticalAlignCss,1),"off",t.isWeb),attrs:{title:"在移动设备模拟中，当画板无法垂直完全覆盖屏幕时，画板的垂直对齐方式"},on:{click:t.clickVerticalAlign}})])},Yk=[],Xk={methods:{clickVerticalAlign:function(){var t,e=this.verticalAlign,n=this.isWeb;if(n)this.showTextTip("Web模式下,无法调整画板的垂直对齐方式");else{var i=Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])({},q.Top,q.Middle),q.Middle,q.Bottom),q.Bottom,q.Top),r=null!==(t=i[e])&&void 0!==t?t:q.Middle;this.$store.commit("setInteractionArtboardVerticalAlign",r),this.showTextTip("已修改画板的对齐方式为[".concat(q.getName(r),"]"))}}},computed:{isWeb:function(){return this.pcDeviceSet.type===Na.Web},pcDeviceSet:function(){return this.$store.state.artboardDetail.interactionSet.pcDeviceSet},verticalAlignCss:function(){switch(this.verticalAlign){case q.Bottom:return"align-bottom";case q.Top:return"align-top";default:return"align-middle"}},verticalAlign:function(){return this.$store.state.artboardDetail.interactionSet.verticalAlign}}},Kk=Xk,qk=(n("04a4"),Object(wo["a"])(Kk,zk,Yk,!1,null,"00a7a355",null)),Qk=qk.exports,Jk=function(){var t=this,e=t._self._c;return e("div",{staticClass:"device-set"},[e("div",{staticClass:"device-name"},[e("div",{staticClass:"cur-text",class:{on:t.boxVisible},on:{click:function(e){t.boxVisible=!t.boxVisible}}},[t._v(t._s(t.pcDeviceSet.name))]),t.boxVisible?e("div",{staticClass:"device-list"},t._l(t.interactionDeviceList,(function(n,i){return e("div",{key:i,staticClass:"device-item",class:{web:n.type===t.InteractionDeviceType.Web}},[e("div",{staticClass:"text",class:{on:t.pcDeviceSet.name===n.name},on:{click:function(e){return t.clickDevice(n)}}},[t._v(t._s(n.name))]),n.type===t.InteractionDeviceType.Group?e("div",{staticClass:"device-sublist"},t._l(n.list,(function(n,r){return e("div",{key:"".concat(i,"-").concat(r),staticClass:"device-subitem"},[e("div",{staticClass:"subtext",class:{on:t.pcDeviceSet.name===n.name},on:{click:function(e){return t.clickDevice(n)}}},[t._v(t._s(n.name)+" ("+t._s(n.width)+" × "+t._s(n.height)+")")])])})),0):t._e()])})),0):t._e()]),e("div",{staticClass:"device-size",class:{off:!t.showDeviceSize}},[e("input",{attrs:{type:"number",readonly:!t.canChangeDeviceSize},domProps:{value:t.pcDeviceSet.width},on:{blur:function(e){return t.blurDeviceSize(e,"width")}}}),e("div",{staticClass:"split"},[t._v("x")]),e("input",{attrs:{type:"number",readonly:!t.canChangeDeviceSize},domProps:{value:t.pcDeviceSet.height},on:{blur:function(e){return t.blurDeviceSize(e,"height")}}})]),e("a",{staticClass:"btn btn-use-horizontal",class:{off:!t.showUseHorizontal},attrs:{href:"javascript:;",title:"切换横竖屏"},on:{click:t.clickHorizontal}})])},Zk=[],tC={methods:{blurDeviceSize:function(t,e){if(this.canChangeDeviceSize){var n=this.pcDeviceSet,i=+t.target.value;isNaN(i)?t.target.value=n[e]:(i<100&&(i=100,t.target.value=i),n[e]=i)}},clickHorizontal:function(){var t=this.pcDeviceSet,e=t.height,n=t.width;this.setPCDeviceSet({isHorizontal:!this.isHorizontal,width:e,height:n})},clickDevice:function(t){if(ht(t))switch(t.type){case Na.Group:return void(this.notCloseThisTime=!0);case Na.Web:case Na.Mobile:return void this.setPCDeviceSet(t);case Na.Custom:var e=this.pcDeviceSet,n={width:0===e.width?375:Math.max(e.width,100),height:0===e.height?667:Math.max(e.height,100)};return n.type=Na.Custom,n.name=t.name,n.hasBangs=!1,n.iosDynamicIsland=!1,void this.setPCDeviceSet(n)}},setPCDeviceSet:function(t){this.$store.commit("setPCDeviceSet",t)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.boxHandle),this.boxHandle=setTimeout((function(){e.notCloseThisTime?e.notCloseThisTime=!1:e.boxVisible=!1}),100))}},watch:{boxVisible:function(t){t?(clearTimeout(this.boxHandle),window.addEventListener("mouseup",this.hideContextmenu,!0),window.addEventListener("contextmenu",this.hideContextmenu,!0)):(window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0))}},computed:{isHorizontal:function(){return this.pcDeviceSet.isHorizontal},canChangeDeviceSize:function(){switch(this.pcDeviceSet.type){case Na.Custom:return!0}return!1},showDeviceSize:function(){switch(this.pcDeviceSet.type){case Na.Custom:return!0}return!1},showUseHorizontal:function(){switch(this.pcDeviceSet.type){case Na.Mobile:case Na.Custom:return!0}return!1},pcDeviceSet:function(){return this.$store.state.artboardDetail.interactionSet.pcDeviceSet}},data:function(){return{interactionDeviceList:ja,InteractionDeviceType:Na,boxVisible:!1,boxHandle:0,notCloseThisTime:!1}},created:function(){0},beforeDestroy:function(){window.removeEventListener("mouseup",this.hideContextmenu,!0),window.removeEventListener("contextmenu",this.hideContextmenu,!0)}},eC=tC,nC=(n("29f2"),Object(wo["a"])(eC,Jk,Zk,!1,null,"dad1955c",null)),iC=nC.exports,rC={components:{PathNav:Gk,BtnContainerColor:hf,BtnContainerVerticalAlign:Qk,DeviceSet:iC,UserNotifyButton:_b,UserNotify:$b,UserInfo:Tb,Helper:sv,BtnGoInteraction:Im},methods:{clickHelper:function(t){this.$store.commit("setHelperVisible",t)},clickFullscreen:function(){Lk.toggleFullscreen()},onFullscreen:function(t){this.isFullscreen=t}},computed:{helperVisible:function(){return this.$store.state.helper.visible},setVisible:function(){return!this.cloudFolderNotFound&&this.permission&&this.documentArtboards.length>0}},data:function(){return{isFullscreen:Lk.isFullscreen()}},beforeDestroy:function(){Lk.offChange(this.onFullscreen)},created:function(){Lk.onChange(this.onFullscreen)}},aC=rC,oC=(n("c817"),Object(wo["a"])(aC,Rk,Vk,!1,null,"1d52e112",null)),sC=oC.exports,cC=function(){var t=this,e=t._self._c;return e("div",{staticClass:"device-container",class:{"margin-left":t.leftSideVisible,pc:t.isWeb,mobile:!t.isWeb}},[e("div",{staticClass:"device-ui"},[t.isWeb?t._e():e("div",{staticClass:"device-border"},[t.pcDeviceSet.hasBangs?e("div",{staticClass:"device-bangs",class:{horizontal:t.isHorizontal}}):t.pcDeviceSet.iosDynamicIsland?e("div",{staticClass:"device-ios-dynamic-island",class:{horizontal:t.isHorizontal}}):t._e(),e("div",{staticClass:"device-top-left"}),e("div",{staticClass:"device-top-center"}),e("div",{staticClass:"device-top-right"}),e("div",{staticClass:"device-middle-left"}),e("div",{staticClass:"device-middle-right"}),e("div",{staticClass:"device-bottom-left"}),e("div",{staticClass:"device-bottom-center"}),e("div",{staticClass:"device-bottom-right"})]),e("device-box")],1)])},lC=[],uC=function(){var t=this,e=t._self._c;return e("div",{staticClass:"device-box",style:t.boxStyle,on:{click:t.clickDeviceBox}},t._l(t.renderList,(function(t){return e("InteractionArtboardItem",{key:t.key,attrs:{artboard:t.artboard,overlayArtboards:t.overlayArtboards,renderTapInteraction:t.renderTapInteraction,overlayVisible:t.overlayVisible}})})),1)},dC=[],hC=function(){var t=this,e=t._self._c;return e("div",{ref:"container",staticClass:"interaction-artboard-item",class:t.itemCls,style:t.itemStyle,attrs:{"data-unset-control":t.rootSize?"1":""},on:{dragstart:function(t){t.preventDefault()},"!touchstart":function(e){return t.onTouchStart.apply(null,arguments)},"!mousedown":function(e){return t.onMouseDown.apply(null,arguments)},click:function(e){return e.target!==e.currentTarget?null:t.clickArtboardItemSelf.apply(null,arguments)}}},[t.itemOverlayStyle?e("div",{staticClass:"artboard-overlay-background",style:t.itemOverlayStyle}):t._e(),e("div",{ref:"artboardScrollBox",staticClass:"artboard-content-scroll",class:Object(Ht["a"])({"non-width-scroll":!(t.isWeb&&t.isTopArtboard),top:t.isTopArtboard},t.verticalAlignCss,1),style:t.artboardContentScrollStyle,attrs:{"data-unset-control":t.rootSize?"1":""},on:{scroll:t.onScroll,click:function(e){return e.target!==e.currentTarget?null:t.clickArtboardItemSelf.apply(null,arguments)}}},[e("div",{staticClass:"artboard-content",class:{pc:t.isWeb,"interaction-node-show":t.isMouseDown&&!t.isMouseDownInInteractionNode||t.interactionRectAlwaysVisible},style:t.contentStyle,on:{dragstart:function(t){t.preventDefault()}}},[e("img",{staticClass:"preview",style:t.imgStyle,attrs:{src:t.imgSrc},on:{load:t.onImgLoad,error:t.onImgError}}),e("InteractionNodePoints",{attrs:{artboard:t.artboard,overlayScale:t.overlayScale}}),t.imgLoading?e("div",{staticClass:"img-loading",style:{backgroundColor:t.backgroundColor}},[e("div",{staticClass:"loading"},[t._v("正在加载画板预览图...")])]):t._e()],1)]),t.renderOverlayArtboardDatas.length>0?t._l(t.renderOverlayArtboardDatas,(function(n,i){return e("interaction-artboard-item",{key:n.key,attrs:{artboard:n.overlayArtboard.artboard.artboard,renderTapInteraction:n.overlayArtboard.renderTapInteraction,overlayArtboards:null,rootSize:t.artboard.boundsInParentForList,overlayOffset:n.overlayArtboardOffset,overlayVisible:n.overlayArtboard.visible,lastOverlay:t.renderOverlayArtboardDatas.length-1===i}})})):t._e()],2)},fC=[],mC=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"interaction-node-points"},t._l(t.renderInteractions,(function(n,i){return e("InteractionNodePointItem",{key:i,attrs:{item:n,index:i,itemScale:t.itemScale}})})),1):t._e()},pC=[],vC=function(){var t=this,e=t._self._c;return e("div",{staticClass:"interaction-node-pointitem",class:{on:t.hoverGuid===t.item.guid,pc:!t.inMobile},style:t.style,attrs:{"data-unset-control":"1","data-interaction-node":"1"},on:{mouseenter:function(e){return t.mouseEnterItem(!0)},mouseleave:function(e){return t.mouseEnterItem(!1)},click:t.clickGoArtboard}})},bC=[],gC={methods:{mouseEnterItem:function(t){var e;st||(this.interactionSet.hoverGuid=t?null===(e=this.item)||void 0===e?void 0:e.guid:null)},clickGoArtboard:function(){this.$store.commit("setInteractionArtboard",this.item.renderTapInteraction)}},computed:{interactionRectAlwaysVisible:function(){return this.$store.state.artboardDetail.interactionSet.rectAlwaysVisible},style:function(){var t=this.rect;return"top:".concat(t.top,"px;left:").concat(t.left,"px;width:").concat(t.width,"px;height:").concat(t.height,"px;")},hoverGuid:function(){return this.interactionSet.hoverGuid},artboardDetail:function(){return this.$store.state.artboardDetail},interactionSet:function(){return this.artboardDetail.interactionSet},boundsInArtboard:function(){var t,e;return null!==(t=null===(e=this.item)||void 0===e?void 0:e.boundsInArtboard)&&void 0!==t?t:new ee},rect:function(){var t=this.boundsInArtboard,e=this.itemScale,n=t.width,i=t.height,r=t.x,a=t.y;return n*=e,i*=e,r*=e,a*=e,{width:n,height:i,left:r,top:a}}},props:{item:Object,index:Number,itemScale:Number}},wC=gC,xC=(n("0227"),Object(wo["a"])(wC,vC,bC,!1,null,"33a6a087",null)),yC=xC.exports,kC={components:{InteractionNodePointItem:yC},methods:{},computed:{visible:function(){var t=this.currentInteractionData;if(t.fetchState!=Cn.Success)return!1;var e=this.renderInteractions;return 0!=e.length},isWeb:function(){return!st&&this.pcDeviceSet.type===Na.Web},pcDeviceSet:function(){return this.$store.state.artboardDetail.interactionSet.pcDeviceSet},mobileSize:function(){return this.$store.state.mobileInteraction.mobileSize},renderSize:function(){var t,e,n=this.mobileSize,i=this.pcDeviceSet;return this.inMobile?(t=n.width,e=n.height):(t=i.width,e=i.height),{width:t,height:e}},itemScale:function(){if(this.isWeb)return 1;var t=this.renderSize.width/this.rect.width;return isNaN(t)&&(t=1),t*this.overlayScale},currentInteractionData:function(){return this.artboard.interactionInfo},renderInteractions:function(){var t,e,n=this.currentInteractionData;return n.fetchState===Cn.Success&&null!==(t=null===(e=n.data)||void 0===e?void 0:e.renderInteractions)&&void 0!==t?t:[]},rect:function(){var t,e=this.artboard,n=null!==(t=null===e||void 0===e?void 0:e.boundsInParentForList)&&void 0!==t?t:new ee;return(new ee).set(0,0,n.width,n.height)}},props:{artboard:Object,overlayScale:Number},created:function(){}},CC=kC,SC=(n("44a7"),Object(wo["a"])(CC,mC,pC,!1,null,"6a3b9a21",null)),TC=SC.exports,AC={},IC={name:"interaction-artboard-item",components:{InteractionNodePoints:TC},methods:{checkIsMouseDownInInteractionNode:function(t){var e=t.target;if(!e)return!1;if("1"===e.getAttribute("data-interaction-node"))return!0;var n=e;while(n){if(n.classList.contains("interaction-artboard-item"))break;n=n.parentNode}return!!n&&n!==this.$refs.container},onTouchStart:function(t){this.isMouseDown=!0,this.isMouseDownInInteractionNode=this.checkIsMouseDownInInteractionNode(t),window.addEventListener("touchend",this.onTouchEnd,!0)},onTouchEnd:function(){window.removeEventListener("touchend",this.onTouchEnd,!0),this.isMouseDown=!1},onMouseDown:function(t){st||(this.isMouseDown=!0,this.isMouseDownInInteractionNode=this.checkIsMouseDownInInteractionNode(t),window.addEventListener("mouseup",this.onMouseUp,!0))},onMouseUp:function(){window.removeEventListener("mouseup",this.onMouseUp,!0),st||(this.isMouseDown=!1)},clickArtboardItemSelf:function(){var t,e=this.rootSize,n=this.renderTapInteraction;if(e){var i=null!==(t=null===n||void 0===n?void 0:n.overlayBackgroundInteraction)&&void 0!==t?t:void 0;"NONE"!==i&&this.$store.commit("setInteractionArtboard",{type:zi.goBack})}},onImgLoad:function(){this.imgState=Cn.Success,AC[this.imgSrc]=1},onImgError:function(){this.imgState=Cn.Error},onScroll:function(t){if(this.isTopArtboard){var e=this.scrollYCache;e[this.artboard.cid]=t.target.scrollTop}},resetScroll:function(){var t;if(this.isTopArtboard){var e=this.$refs.artboardScrollBox;if(e){var n=null!==(t=this.scrollYCache[this.artboard.cid])&&void 0!==t?t:0;e.scrollTop=n}}}},watch:{imgSrc:function(t){t&&(AC[t]||(this.imgState=Cn.Fetching))},curArtboard:function(){this.resetScroll()}},computed:{verticalAlignCss:function(){switch(this.verticalAlign){case q.Bottom:return"align-bottom";case q.Top:return"align-top";default:return"align-middle"}},verticalAlign:function(){return this.$store.state.artboardDetail.interactionSet.verticalAlign},interactionRectAlwaysVisible:function(){return this.interactionSet.rectAlwaysVisible},overlayArtboardOffset:function(){var t=new di,e=this.overlayArtboards;if(!e)return t;var n=e.length;if(n<=1)return t;for(var i=0;i<n-1;i++){var r=e[i].renderTapInteraction;if(r){var a=r.overlayTopLeft;a&&(t.x+=a.x,t.y+=a.y)}}return t},previousOverlayArtboardOffset:function(){var t=new di,e=this.overlayArtboards;if(!e)return t;var n=e.length;if(n<1)return t;for(var i=0;i<n-2;i++){var r=e[i].renderTapInteraction;if(r){var a=r.overlayTopLeft;a&&(t.x+=a.x,t.y+=a.y)}}return t},renderOverlayArtboardDatas:function(){var t=[],e=this.overlayArtboard,n=this.previousOverlayArtboard,i=this.previousOverlayArtboardOffset,r=this.overlayArtboardOffset,a=this.artboard.guid;return n&&t.push({overlayArtboard:n,overlayArtboardOffset:i,key:"".concat(a,"-").concat(n.artboard.artboard.guid)}),e&&t.push({overlayArtboard:e,overlayArtboardOffset:r,key:"".concat(a,"-").concat(e.artboard.artboard.guid)}),t},previousOverlayArtboard:function(){var t=this.overlayArtboards;if(!t)return null;var e=t.length;return e<1?null:t[e-2]},overlayArtboard:function(){var t=this.overlayArtboards;if(!t)return null;var e=t.length;return 0===e?null:t[e-1]},isTopArtboard:function(){var t=this.rootSize;return!t},itemOverlayStyle:function(){var t,e=null===(t=this.renderTapInteraction)||void 0===t?void 0:t.overlayBackground;if(!e)return null;var n=this.animationStyle;return{"background-color":e,"animation-duration":n?n["animation-duration"]:void 0}},artboardContentScrollStyle:function(){var t=this.isTopArtboard,e=this.animationStyle;return t?null:e},animationStyle:function(){var t=this.renderTapInteraction;if(!t)return null;var e=t.transition;if(!e)return null;var n={},i=e.customEasing?e.easing:Gi[e.easing];return i||(i=Gi.linear),n["animation-timing-function"]=i,n["animation-duration"]=(e.duration||.3).toFixed(3)+"s",n},itemStyle:function(){var t=this.imgStyle,e=this.isWeb,n=this.backgroundColor,i=this.isTopArtboard,r=this.animationStyle,a={};return i&&(a["background-color"]=e?n:"#000"),e&&i&&(a=Object.assign(a,t,{position:"relative",top:"auto",left:"auto","max-height":"100%","max-width":"100%"})),r?(Object.assign(a,r),this.overlayVisible||(a["pointer-events"]="none"),a):a},itemCls:function(){var t=this.renderTapInteraction,e=this.isTopArtboard,n=[];if(this.inMobile&&n.push("in-mobile"),this.imgLoading&&n.push("inloading"),!t)return n;var i=t.transition;if(!i)return n;!e&&null!==t&&void 0!==t&&t.overlayBackground?n.push("in-overlay"):n.push("in-top");var r=this.overlayVisible?"":"-reverse";switch(i.type){case"dissolve":case"autoAnimate":n.push("animation-opacity".concat(r));break;case"push":case"slide":case"move":var a=$i[i.fromSide];a||(a=$i.L),n.push("animation-slide-".concat(a).concat(r));break;case"push-background":case"slide-background":case"move-background":case"move_out":case"move_out-background":case"slide_out":case"slide_out-background":var o=$i[i.fromSide];o||(o=$i.L),n.push("animation-".concat(i.type,"-").concat(o).concat(r)),n.push(i.type);break}return n},isWeb:function(){return!this.inMobile&&this.pcDeviceSet.type===Na.Web},interactionSet:function(){return this.$store.state.artboardDetail.interactionSet},backgroundColor:function(){return this.interactionSet.backgroundColor},mobileSize:function(){return this.$store.state.mobileInteraction.mobileSize},renderSize:function(){var t,e,n=this.mobileSize,i=this.pcDeviceSet;return this.inMobile?(t=n.width,e=n.height):(t=i.width,e=i.height),{width:t,height:e}},pcDeviceSet:function(){return this.interactionSet.pcDeviceSet},overlayScale:function(){if(this.isWeb)return 1;var t=this.rootSize;return t?this.artboard.boundsInParentForList.width/t.width:1},rootScale:function(){if(this.isWeb)return 1;var t=this.rootSize,e=this.artboard,n=this.renderSize,i=t?t.width:e.boundsInParentForList.width;return n.width/i},contentStyle:function(){var t=this.isTopArtboard;if(t)return o;var e=this.animationStyle,n=this.renderTapInteraction,i=this.isWeb,r=this.rootScale,a=this.overlayOffset,o=this.imgStyle;n||(n={});var s=n,c=s.overlayPositionType,l=s.overlayTopLeft,u=0,d=0;if(null!=c){var h={top:0,left:0,bottom:"auto",right:"auto"},f=o.width,m=o.height;switch(c){case Ki.CENTER:case Ki.MANUAL:h.top="calc(50% - ".concat(m," / 2)");break;case Ki.TOP_LEFT:case Ki.TOP_CENTER:case Ki.TOP_RIGHT:h.top="0px";break;case Ki.BOTTOM_LEFT:case Ki.BOTTOM_CENTER:case Ki.BOTTOM_RIGHT:h.top="auto",h.bottom="0px";break}switch(c){case Ki.CENTER:case Ki.TOP_CENTER:case Ki.BOTTOM_CENTER:case Ki.MANUAL:h.left="calc(50% - ".concat(f," / 2)");break;case Ki.TOP_LEFT:case Ki.BOTTOM_LEFT:h.left="0px";break;case Ki.TOP_RIGHT:case Ki.BOTTOM_RIGHT:h.left="auto",h.right="0px";break}return Object(Q["a"])(Object(Q["a"])(Object(Q["a"])({},h),o),e)}return l&&(u=l.x,d=l.y),a&&(u+=a.x,d+=a.y),i||(u*=r,d*=r),Object(Q["a"])(Object(Q["a"])({top:d+"px",left:u+"px"},o),e)},imgStyle:function(){var t=this.artboard.boundsInParentForList;if(this.isWeb)return{width:t.width+"px",height:t.height+"px"};var e=this.renderSize.width;return e=Math.round(this.overlayScale*e),{width:e+"px",height:Math.round(e/t.width*t.height)+"px"}},imgLoading:function(){return this.imgState===Cn.Fetching},imgSrc:function(){var t,e=this.artboard,n=this.isSupportWebp;return n&&(t=e.artboardPreviewWebp,t)?t:e.artboardPreviewPng},isSupportWebp:function(){return this.$store.state.isSupportWebp===Oa.Support},scrollYCache:function(){return this.$store.state.mobileInteraction.scrollYCache}},data:function(){return{imgState:Cn.Normal,isMouseDown:!1,isMouseDownInInteractionNode:!1}},props:{artboard:Object,overlayArtboards:{type:Array,default:null},lastOverlay:{type:Boolean,default:!1},rootSize:{type:Object,default:null},renderTapInteraction:{type:Object,default:null},overlayOffset:{type:Object,default:null},overlayVisible:{type:Boolean,default:!0}},mounted:function(){this.resetScroll()},beforeDestroy:function(){window.removeEventListener("touchend",this.onTouchEnd,!0),window.removeEventListener("mouseup",this.onMouseUp,!0)}},FC=IC,MC=(n("df29"),Object(wo["a"])(FC,hC,fC,!1,null,"fa8784d0",null)),OC=MC.exports,_C={components:{InteractionArtboardItem:OC},methods:{clickDeviceBox:function(){this.currentArtboardHasRenderInteraction||this.showTextTip("当前画板没有或未提交交互原型热区",1)}},computed:{renderList:function(){var t=[],e=this.itemCurrent,n=this.gobackArtboard,i=this.gotoArtboard,r={};if(e&&(t.push(e),r[e.key]=1),n){var a,o=n.fromArtboard.artboard,s=null!==(a=o.cid)&&void 0!==a?a:o.guid;r[s]&&(s+="_1"),r[s]=1,t.push({key:s,artboard:o,renderTapInteraction:n.renderTapInteraction,overlayArtboards:null,overlayVisible:!1})}if(i){var c,l=i.fromArtboard.artboard,u=null!==(c=l.cid)&&void 0!==c?c:l.guid;r[u]&&(u+="_2"),r[u]=1,t.push({key:u,artboard:l,renderTapInteraction:i.renderTapInteraction,overlayArtboards:null,overlayVisible:!0})}return t},currentOverlayVisible:function(){return!this.gobackArtboard},currentArtboardHasRenderInteraction:function(){return null!=this.currentArtboardRenderInteractions},currentArtboardRenderInteractions:function(){var t,e,n=null===(t=this.curArtboard)||void 0===t||null===(t=t.artboard)||void 0===t?void 0:t.interactionInfo;if(!n)return null;if(n.fetchState!==Cn.Success)return null;var i=null===(e=n.data)||void 0===e?void 0:e.renderInteractions;return ut(i)&&i.length>0?i:null},currentRenderTapInteraction:function(){var t,e=this.gobackArtboard,n=this.gotoArtboard,i=null===(t=null!==e&&void 0!==e?e:n)||void 0===t?void 0:t.renderTapInteraction;if(i){var r=i,a=r.transition,o=r.trigger_type,s=r.type,c=r.preserveScrollPosition,l=r.toArtboard;if(!ht(a))return null;switch(a=Object(Q["a"])({},a),a.type){case"dissolve":case"autoAnimate":return null;case"push":case"slide":case"slide_out":case"move":case"move_out":a.type="".concat(a.type,"-background");break}i={transition:a,trigger_type:o,type:s,preserveScrollPosition:c,toArtboard:l}}return i},itemCurrent:function(){var t,e,n=null===(t=this.curArtboard)||void 0===t?void 0:t.artboard;return n?{artboard:n,renderTapInteraction:this.currentRenderTapInteraction,overlayArtboards:this.interactionSet.overlayArtboards,overlayVisible:this.currentOverlayVisible,key:null!==(e=n.cid)&&void 0!==e?e:n.guid}:null},gobackArtboard:function(){return this.interactionSet.gobackArtboard},gotoArtboard:function(){return this.interactionSet.gotoArtboard},interactionSet:function(){return this.$store.state.artboardDetail.interactionSet},boxStyle:function(){return this.isWeb?{width:"100%",height:"100%"}:{width:this.pcDeviceSet.width+"px",height:this.pcDeviceSet.height+"px"}},isWeb:function(){return this.pcDeviceSet.type===Na.Web},pcDeviceSet:function(){return this.interactionSet.pcDeviceSet},headerVisible:function(){return this.interactionSet.headerVisible},leftSideVisible:function(){return this.$store.state.artboardDetail.leftSideVisible&&this.headerVisible}}},LC=_C,PC=(n("ffca"),Object(wo["a"])(LC,uC,dC,!1,null,"5970a26f",null)),EC=PC.exports,NC={components:{DeviceBox:EC},computed:{isWeb:function(){return this.pcDeviceSet.type===Na.Web},pcDeviceSet:function(){return this.$store.state.artboardDetail.interactionSet.pcDeviceSet},isHorizontal:function(){return this.pcDeviceSet.isHorizontal},headerVisible:function(){return this.$store.state.artboardDetail.interactionSet.headerVisible},leftSideVisible:function(){return this.$store.state.artboardDetail.leftSideVisible&&this.headerVisible}}},DC=NC,jC=(n("2afb"),Object(wo["a"])(DC,cC,lC,!1,null,"54a50b64",null)),RC=jC.exports,VC={components:{CloudNeedLoginTip:hu,Header:sC,EmptyData:og,Authority:tg,Tip:sd,LeftSide:jk,DeviceContainer:RC,AutomaticSync:yo},methods:{clickHeaderVisible:function(){this.$store.commit("setInteractionHeaderVisible",!this.headerVisible)}},computed:{emptyText:function(){return this.inCloudMode?this.inNetDiskFileMode?"文件不存在,可能已经被移动或删除":"当前文件夹不存在画板":"未检测到数据,请尝试重新导出画板"},backgroundColor:function(){return this.interactionSet.backgroundColor},interactionSet:function(){return this.$store.state.artboardDetail.interactionSet},headerVisibleTitle:function(){return this.headerVisible?"隐藏顶部(F2)":"显示顶部(F2)"},headerVisible:function(){return this.interactionSet.headerVisible},artboardLoadProgressText:function(){return Math.floor(1e4*this.artboardLoadProgress.current/this.artboardLoadProgress.count)/100+"%"},artboardLoadProgress:function(){return this.$store.state.artboardLoadProgress},allArtboardLoadChecked:function(){return this.$store.state.allArtboardLoadChecked},isEmptyArtboardData:function(){return 0===this.documentArtboards.length}},created:function(){0}},BC=VC,UC=(n("fa2f"),Object(wo["a"])(BC,Ik,Fk,!1,null,"6ffc441e",null)),HC=UC.exports,WC=function(){var t=this,e=t._self._c;return e("section",{attrs:{id:"main"}},[!t.cloudNeedLogin||t.cloudIsLogin?e("div",{staticClass:"loading",class:{on:!t.allArtboardLoadChecked}},[t._v("正在加载画板数据中("+t._s(t.artboardLoadProgressText)+"),请稍后...")]):t._e(),t.cloudNeedLogin&&!t.cloudIsLogin?e("CloudNeedLoginTip"):t.allArtboardLoadChecked?[t.cloudFolderNotFound||!t.permission?[e("Header"),e("Nav"),e("main",[t.cloudFolderNotFound?e("EmptyData",{attrs:{text:t.cloudFolderErrorText,showLoginBtn:t.cloudFolderInSpecify}}):t.permission?t._e():e("Authority",{attrs:{include:!0}})],1)]:[t.inList?e("ArtboardList"):e("ArtboardInfo")]]:t._e(),e("TipInMobile"),e("AutomaticSync")],2)},$C=[],GC=function(){var t=this,e=t._self._c;return e("header",[t.cloudNeedLogin||t.cloudIsLogin?e("user-info"):t._e(),e("div",{staticClass:"search"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.mobileInteraction.searchText,expression:"mobileInteraction.searchText"}],ref:"searchInput",attrs:{type:"text",placeholder:t.showAll?"搜索文件夹和画板":"搜索画板",autocomplete:"off"},domProps:{value:t.mobileInteraction.searchText},on:{input:function(e){e.target.composing||t.$set(t.mobileInteraction,"searchText",e.target.value)}}}),t.hasSearchText?e("span",{staticClass:"search-clear",on:{click:t.clickSearchClear}}):t._e()]),e("div",{staticClass:"btn-control-refresh",on:{click:t.clickRefresh}})],1)},zC=[],YC=function(){var t=this,e=t._self._c;return e("div",{staticClass:"userinfo"},[e("div",{staticClass:"nickname",class:{on:t.menuVisible},on:{click:t.clickShowMenu}},[e("UserFace",{attrs:{canClick:!1}})],1),t.menuVisible?e("div",{staticClass:"m-popbox",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.menuVisible=!1}}},[e("div",{staticClass:"box"},[e("div",{staticClass:"u-info"},[e("UserFace",{attrs:{canClick:!1}}),e("div",{staticClass:"info"},[e("div",{staticClass:"name"},[t._v(t._s(t.showName))]),e("div",{staticClass:"email"},[t._v(t._s(t.showEmail))])])],1),t.cloudIsLogin?e("a",{staticClass:"button btn-logout",attrs:{href:"javascript:;"},on:{click:function(e){return t.clickLogout()}}},[t._v("退出登录")]):t._e()])]):t._e()])},XC=[],KC=function(){var t=this,e=t._self._c;return e("div",{staticClass:"userface",class:{on:t.canClick},attrs:{title:t.title},on:{click:function(e){return e.stopPropagation(),t.clickUserFace.apply(null,arguments)}}},[t.showIcon?e("div",{staticClass:"icon"}):e("div",{staticClass:"user",class:{tourist:!t.cloudUserIsDesigner}},[t._v(t._s(t.iconText))])])},qC=[],QC={methods:{clickUserFace:function(){this.$emit("click")}},computed:{showIcon:function(){return!this.cloudIsLogin},iconText:function(){if(!this.cloudIsLogin)return"";var t=this.cloudNickName;return dt(t)||(t=this.cloudUserEmail),t[t.length-1]}},props:{title:String,canClick:Boolean}},JC=QC,ZC=(n("e2d4"),Object(wo["a"])(JC,KC,qC,!1,null,"079399e5",null)),tS=ZC.exports,eS={components:{UserFace:tS},methods:{clickLogout:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.logoutting){e.next=2;break}return e.abrupt("return");case 2:return t.logoutting=!0,e.prev=3,e.next=6,t.goCloudLogout();case 6:return e.prev=6,t.logoutting=!1,e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[3,,6,9]])})))()},clickShowMenu:function(){this.cloudIsLogin?this.menuVisible=!0:this.goCloudLogin()}},computed:{showName:function(){return this.cloudIsLogin?this.cloudNickName:"未登录"},showEmail:function(){return this.cloudIsLogin?this.cloudUserEmail:""}},data:function(){return{menuVisible:!1,logoutting:!1}}},nS=eS,iS=(n("bb5a"),Object(wo["a"])(nS,YC,XC,!1,null,"35031a94",null)),rS=iS.exports,aS={components:{UserInfo:rS},methods:{clickRefresh:function(){this.goCloudFolderInteractionUrl(this.cloudCurrentFolderId,this.curArtboardGuid)},clickSearchClear:function(){var t;this.mobileInteraction.searchText="",null===(t=this.$refs.searchInput)||void 0===t||t.focus()}},computed:{mobileInteraction:function(){return this.$store.state.mobileInteraction},hasSearchText:function(){return!!this.searchText},searchText:function(){return this.mobileInteraction.searchText}},props:{showAll:Boolean}},oS=aS,sS=(n("7eea"),Object(wo["a"])(oS,GC,zC,!1,null,"9ac34f88",null)),cS=sS.exports,lS=function(){var t=this,e=t._self._c;return e("div",{staticClass:"nav"},[e("path-nav"),e("nav-filter")],1)},uS=[],dS=function(){var t=this,e=t._self._c;return e("div",{staticClass:"path-nav"},[e("div",{staticClass:"navs"},t._l(t.navs,(function(n,i){return e("div",{key:i,staticClass:"nav-item",class:{"no-link":!n.link}},[e("div",{staticClass:"name",attrs:{title:n.name},on:{click:function(e){return t.clickNav(n)}}},[t._v(t._s(n.name))]),t.showArtboardPages&&n.selectPages?e("PathNavArtboardPages"):t._e()],1)})),0)])},hS=[],fS=function(){var t=this,e=t._self._c;return e("div",{staticClass:"select-artboard-page",attrs:{title:"点击切换显示的页面"}},[e("div",{staticClass:"page-current",on:{click:function(e){t.visible=!t.visible}}},[e("div",{staticClass:"text"},[t._v(t._s(t.currentPageName))])]),e("ul",{staticClass:"page-list",class:{on:t.visible}},[e("li",{class:{on:!t.filterDocumentGuid},on:{click:function(e){return t.clickItem(null)}}},[e("span",{staticClass:"text"},[t._v(t._s(t.allPageName)),e("span",{staticClass:"art-count"},[t._v("("+t._s(t.documentArtboards.length)+")")])])]),t._l(t.sortDocumentsWithSketchDocument,(function(n){return e("li",{key:n.guid,class:{on:t.filterDocumentGuid===n.guid},on:{click:function(e){return t.clickItem(n)}}},[e("span",{staticClass:"text"},[t._v(t._s(n.docFullName)),e("span",{staticClass:"art-count"},[t._v("("+t._s(n.arts.length)+")")])])])}))],2)])},mS=[],pS={methods:{clickItem:function(t){var e,n=null!==(e=null===t||void 0===t?void 0:t.guid)&&void 0!==e?e:null;this.$store.commit("setFilterDocumentGuid",n)},hideContextmenu:function(t){var e=this;"mouseup"===t.type&&2===t.button||(clearTimeout(this.handle),this.handle=setTimeout((function(){e.visible=!1}),100))}},computed:{sortDocumentsWithSketchDocument:function(){return this.$store.state.sortDocumentsWithSketchDocument},currentPageName:function(){var t,e,n,i=this.filterDocumentGuid;return i&&(n=this.sortDocumentsWithSketchDocument.find((function(t){return t.guid===i}))),null!==(t=null===(e=n)||void 0===e?void 0:e.name)&&void 0!==t?t:this.allPageName}},watch:{visible:function(t){t?(clearTimeout(this.handle),window.addEventListener("mouseup",this.hideContextmenu,!0)):window.removeEventListener("mouseup",this.hideContextmenu,!0)}},data:function(){return{allPageName:"全部页面",visible:!1,handle:0}},beforeDestroy:function(){clearTimeout(this.handle),window.removeEventListener("mouseup",this.hideContextmenu,!0)}},vS=pS,bS=(n("cdac"),Object(wo["a"])(vS,fS,mS,!1,null,"612a8505",null)),gS=bS.exports,wS={components:{PathNavArtboardPages:gS},methods:{clickNav:function(t){t.link&&setTimeout((function(){t.link()}),100)}},computed:{showArtboardPages:function(){return this.inCloudMode&&!this.inNetDiskFileMode&&this.documents.length>0},navs:function(){var t=this,e=[],n=this.inCloudMode,i=this.inArtboardMode,r=this.curArtboard,a=this.cloudCurrentFolderId,o=this.curNetDiskFile,s=this.inNetDiskFileMode;if(n){var c=this.cloudName,l=this.cloudParentFolder,u=this;i||(0===a?e.push({name:c||"私有云根目录",link:null}):l&&e.push({name:0===l.id&&c||l.name,id:l.id,link:function(){u.goCloudFolderInteractionUrl(this.id)}}))}if(n&&this.cloudFolderNotFound?e.push({name:this.cloudFolderInSpecify?"没有访问权限":"链接已失效",link:null}):n&&0==a||e.push({name:this.documentName,selectPages:!0,link:i?function(){t.setCurArtboard(null)}:s?function(){t.goCloudFolderInteractionUrl(a)}:null}),i){var d,h,f=null!==(d=null===r||void 0===r||null===(h=r.artboard)||void 0===h?void 0:h.name)&&void 0!==d?d:"";f&&e.push({name:f,link:null})}else if(s){var m,p=null!==(m=null===o||void 0===o?void 0:o.name)&&void 0!==m?m:"";p&&e.push({name:p,link:null})}return e}}},xS=wS,yS=(n("64be"),Object(wo["a"])(xS,dS,hS,!1,null,"09eb5e34",null)),kS=yS.exports,CS=function(){var t=this,e=t._self._c;return e("div",{staticClass:"nav-filter"},[e("div",{staticClass:"nav-sort"},[e("div",{staticClass:"title",class:{desc:t.listConfig.orderDesc},on:{click:function(e){t.menuVisible=!0}}},[t._v(t._s(t.renderTitle))]),t.menuVisible?e("div",{staticClass:"m-popbox",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.menuVisible=!1}}},[e("div",{staticClass:"box"},[e("div",{staticClass:"sort-order"},[e("div",{staticClass:"item asc",class:{on:!t.listConfig.orderDesc},on:{click:function(e){return t.setMobileInteractionListConfig({orderDesc:!1},!0)}}},[t._v("升序")]),e("div",{staticClass:"item desc",class:{on:t.listConfig.orderDesc},on:{click:function(e){return t.setMobileInteractionListConfig({orderDesc:!0},!0)}}},[t._v("降序")])]),e("div",{staticClass:"sort-types"},[e("div",{staticClass:"item",class:{on:t.listConfig.sortType===t.EnumCloudListSortType.Name},on:{click:function(e){return t.setMobileInteractionListConfig({sortType:t.EnumCloudListSortType.Name},!0)}}},[t._v("按名称排序")]),e("div",{staticClass:"item",class:{on:t.listConfig.sortType===t.EnumCloudListSortType.Date},on:{click:function(e){return t.setMobileInteractionListConfig({sortType:t.EnumCloudListSortType.Date},!0)}}},[t._v("按时间排序")]),e("div",{staticClass:"item",class:{on:t.listConfig.sortType===t.EnumCloudListSortType.ArtboardRect},attrs:{title:"画板列表按画板在文档中的坐标从上到下,从左到右排序;文件夹按名称排序"},on:{click:function(e){return t.setMobileInteractionListConfig({sortType:t.EnumCloudListSortType.ArtboardRect},!0)}}},[t._v("按坐标排序")])])])]):t._e()]),e("div",{staticClass:"nav-render"},[e("div",{staticClass:"item",class:{on:t.listConfig.renderType===t.EnumCloudMobileInteractionListRenderType.All},on:{click:function(e){return t.setMobileInteractionListConfig({renderType:t.EnumCloudMobileInteractionListRenderType.All})}}},[t._v("全部")]),e("div",{staticClass:"item",class:{on:t.listConfig.renderType===t.EnumCloudMobileInteractionListRenderType.Artboard},on:{click:function(e){return t.setMobileInteractionListConfig({renderType:t.EnumCloudMobileInteractionListRenderType.Artboard})}}},[t._v("画板")])])])},SS=[],TS={methods:{setMobileInteractionListConfig:function(t,e){this.$store.commit("setMobileInteractionListConfig",t),e&&(this.menuVisible=!1)}},computed:{EnumCloudMobileInteractionListRenderType:function(){return j},EnumCloudListSortType:function(){return D},renderTitle:function(){var t=this.listConfig,e=t.sortType,n=t.orderDesc;return"按".concat(e===D.Name?"名称":e===D.Date?"时间":"坐标").concat(n?"降序":"升序")},listConfig:function(){return this.$store.state.mobileInteraction.listConfig}},data:function(){return{menuVisible:!1}}},AS=TS,IS=(n("e934"),Object(wo["a"])(AS,CS,SS,!1,null,"d85c16d8",null)),FS=IS.exports,MS={components:{PathNav:kS,NavFilter:FS}},OS=MS,_S=(n("31a4"),Object(wo["a"])(OS,lS,uS,!1,null,"72e5b43a",null)),LS=_S.exports,PS=function(){var t=this,e=t._self._c;return e("div",{staticClass:"artboard-list",class:{"safari-standalone":t.inSafariStandalone}},[e("Header",{attrs:{showAll:t.showAll}}),e("Nav"),t.isEmptyList?e("main",[e("EmptyData",{attrs:{text:t.emptyText}})],1):t.showAll?e("main",{ref:"mainAll",on:{scroll:t.onMainAllViewScroll,mousewheel:t.onMainAllViewMouseWheel}},[e("div",{staticClass:"box",class:{off:t.mainAllView.mousewheelTimes>0},style:{height:t.mainAllView.boxRealHeight+"px"}},[e("div",{staticClass:"brace",style:t.allListBraceStyle},t._l(t.showLazyAllList,(function(t){return e("ArtboardListItem",{key:t.key,attrs:{item:t.item}})})),1)])]):e("main",{ref:"mainArtboard",on:{scroll:t.onMainArtboardViewScroll,mousewheel:t.onMainArtboardViewMouseWheel}},[e("div",{staticClass:"box",class:{off:t.mainArtboardView.mousewheelTimes>0},style:{height:t.mainArtboardView.boxRealHeight+"px"}},t._l(t.showLazyArtboardList,(function(t){return e("ArtboardListArtboardItem",{key:t.key,attrs:{item:t}})})),1)]),t.listFetchState===t.FetchState.Fetching?e("div",{staticClass:"list-loading"},[e("div",{staticClass:"box"},[t.listFetchState===t.FetchState.Fetching?e("NetworkLoading",{attrs:{loadText:"正在获取文件夹数据...",errorText:"",isLoading:t.listFetchState===t.FetchState.Fetching,isError:!1,reLoadText:""}}):t._e()],1)]):t._e()],1)},ES=[],NS=function(){var t=this,e=t._self._c;return e("div",{staticClass:"artboard-item",style:t.style},[e("div",{staticClass:"title"},[t._v(t._s(t.item.artboard.name))]),e("div",{staticClass:"img",on:{click:function(e){return t.setCurArtboard(t.item.item)}}},[e("img",{attrs:{src:t.artboardReviewImg,alt:""},on:{error:t.errPreviewImage}}),t.artboard.flowStart?e("div",{staticClass:"flow-start"}):t._e()])])},DS=[],jS={methods:{errPreviewImage:function(){this.userMiniPreviewImg&&(this.userMiniPreviewImg=!1)}},computed:{isSupportWebp:function(){return this.$store.state.isSupportWebp===Oa.Support},artboardReviewImg:function(){var t=this.artboard,e=this.userMiniPreviewImg?this.isSupportWebp&&t.artboardPreviewWebp?t.artboardPreviewWebp:t.artboardPreviewThumbPng:t.artboardPreviewPng;return e},artboard:function(){return this.item.artboard},style:function(){var t=this.item.rect;return"top:".concat(t.top,"px;left:").concat(t.left,"px;width:").concat(t.width,"px;height:").concat(t.height,"px;")}},props:{item:Object},data:function(){return{userMiniPreviewImg:!0}}},RS=jS,VS=(n("2cd5c"),Object(wo["a"])(RS,NS,DS,!1,null,"904ae240",null)),BS=VS.exports,US=function(){var t=this,e=t._self._c;return e("div",{staticClass:"item",on:{click:t.clickItem}},[e("div",{staticClass:"img",class:t.itemClass},[t.isArtboard?e("img",{attrs:{src:t.artboardReviewImg,alt:""},on:{error:t.errPreviewImage}}):t._e()]),e("div",{staticClass:"info"},[e("div",{staticClass:"name"},[t._v(t._s(t.name))]),e("div",{staticClass:"summary"},[t._v(t._s(t.summary))])])])},HS=[],WS={methods:{errPreviewImage:function(){this.userMiniPreviewImg&&(this.userMiniPreviewImg=!1)},clickItem:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.item,r=t.isFolder,a=t.isArtboard,!r){e.next=5;break}return e.next=4,t.goCloudFolderInteractionUrl(n.id);case 4:return e.abrupt("return");case 5:a&&t.setCurArtboard(n);case 6:case"end":return e.stop()}}),e)})))()}},computed:{itemClass:function(){var t=this.item,e=this.isFolder,n=this.isArtboard,i={folder:e,lock:e&&t.shareMode===Y.PrivateCode,"share-sm":e&&t.shareMode===Y.SpecifyMembers,artboard:n};if(null!=t.color){var r=H.getName(t.color);r&&(i[r]=1)}return i},artboardReviewImg:function(){var t=this.item,e=this.isArtboard;if(!e)return null;var n=t.artboard,i=this.userMiniPreviewImg?n.artboardPreviewThumbPng:n.artboardPreviewPng;return i},name:function(){var t=this.item,e=this.isFolder,n=this.isArtboard;return e?t.name:n?t.artboard.name:null},summary:function(){var t=this.item,e=this.isFolder,n=this.isArtboard;return e?"".concat(t.folderCount," 文件夹, ").concat(t.artboardCount," 画板"):n?ma(t.artboard):null},isFolder:function(){return this.item.id>0},isArtboard:function(){var t;return!this.isFolder&&(null===(t=this.item.artboard)||void 0===t?void 0:t.cid)>0}},data:function(){return{userMiniPreviewImg:!0}},props:{item:Object}},$S=WS,GS=(n("0445"),Object(wo["a"])($S,US,HS,!1,null,"65d72cae",null)),zS=GS.exports,YS=68,XS={components:{Header:cS,ArtboardListArtboardItem:BS,ArtboardListItem:zS,Nav:LS,EmptyData:og,NetworkLoading:$l},methods:{sortData:function(t,e,n){var i=this.orderDesc,r=this.sortType,a=n===N.Artboard;if(r===D.Date)t.sort((function(t,n){a&&(t=t.artboard,n=n.artboard);var r=t[e]>n[e]?1:-1;return i?-r:r}));else if(r===D.ArtboardRect&&a){var o={},s=[];t.forEach((function(t){var e=t.artboard,n=e.docName,i=e.docGuid,r=e.pageGuid,a=e.pageName,c=r||i||"",l=a||n||"",u="".concat(n).concat(a?"/".concat(a):""),d=o[c];d||(d=o[c]={arts:[],guid:c,name:l,fileType:t.artboard.fileType,docFullName:u,docGuid:i,docName:n},s.push(d)),d.arts.push(t.artboard)})),o=null;var c=function(t,e){var n=t.boundsInParentForList||t.frame,i=e.boundsInParentForList||e.frame;if(t.updateTimeTimes>0&&e.updateTimeTimes>0){var r=(new ee).set(n.x,n.y,n.width,n.height),a=(new ee).set(i.x,i.y,i.width,i.height);if(r.isOverlap(a)){var o=t.updateTimeTimes-e.updateTimeTimes;if(Math.abs(o)>1500){if(o>0)return 1;if(o<0)return-1}}}var s=n.y,c=i.y,l=s-c;if(l>100)return 1;if(l<-100)return-1;var u=n.x,d=i.x,h=u-d;return 0===h?0===l?0:l>0?1:-1:h>0?1:-1};s.sort((function(t,e){var n=ke(t.docFullName,e.docFullName);return i?-n:n}));var l=0,u={};s.forEach((function(t){t.arts.sort((function(t,e){var n=c(t,e);return i?-n:n})),t.arts.forEach((function(t){u[t.cid]=l++}))})),t.sort((function(t,e){return a&&(t=t.artboard,e=e.artboard),u[t.cid]-u[e.cid]>0?1:-1}))}else t.sort((function(t,e){a&&(t=t.artboard,e=e.artboard);var n=ke(t.name,e.name);return i?-n:n}))},designPXToShowPX:function(t,e){var n=t/pe*this.mainArtboardView.docWidth;return e?Math.ceil(n):Math.floor(n)},designPXToShowVW:function(t){return t/pe*100+"vw"},onMainViewResize:function(){var t=this.$refs.mainArtboard,e=this.$refs.mainAll,n=document.documentElement.offsetWidth,i=this.mainArtboardView;i.docWidth=n,t&&(i.height=Math.ceil(t.getBoundingClientRect().height));var r=this.mainAllView;r.docWidth=n,e&&(r.height=Math.ceil(e.getBoundingClientRect().height))},onMainAllViewScroll:function(){var t=this.$refs.mainAll;if(t){var e=this.mainAllView;e.scrollTop=t.scrollTop}},onMainAllViewMouseWheel:function(t){var e;this.mainAllView.mousewheelTimes=null!==(e=t.timeStamp)&&void 0!==e?e:Date.now()},onMainArtboardViewMouseWheel:function(t){var e;this.mainArtboardView.mousewheelTimes=null!==(e=t.timeStamp)&&void 0!==e?e:Date.now()},onMainArtboardViewScroll:function(){var t=this.$refs.mainArtboard;if(t){var e=this.mainArtboardView;e.scrollTop=t.scrollTop}},refreshBrowserInfo:function(){var t=this,e=this.showAll,n=this.isEmptyList;n||this.$nextTick((function(){t.onMainViewResize();var n=e?t.$refs.mainAll:t.$refs.mainArtboard,i=e?t.mainAllView:t.mainArtboardView;n&&(i.scrollTop=n.scrollTop=0)}))}},watch:{"mainAllView.mousewheelTimes":function(t){var e=this,n=this.mainAllView;clearTimeout(n.handle),t&&(n.handle=setTimeout((function(){e.mainAllView.mousewheelTimes=0}),200))},"mainArtboardView.mousewheelTimes":function(t){var e=this,n=this.mainArtboardView;clearTimeout(n.handle),t&&(n.handle=setTimeout((function(){e.mainArtboardView.mousewheelTimes=0}),200))},cloudCurrentFolderId:function(){this.refreshBrowserInfo()},isEmptyList:function(){this.refreshBrowserInfo()},showAll:function(){this.refreshBrowserInfo()}},computed:{FetchState:function(){return Cn},listFetchState:function(){return this.$store.state.mobileInteraction.listFetchState},allListBraceStyle:function(){var t;return t=this.renderAllListIndexStart*YS,{paddingTop:this.designPXToShowVW(t)}},isEmptyList:function(){var t=this.showAll,e=this.renderSortArtboardList,n=this.renderSortedAllList,i=t?n:e;return 0===i.length},emptyText:function(){var t=this.showAll,e=this.searchText,n=this.hasSearchText,i=t?"子文件夹和画板":"画板";return n?"未找到“".concat(e,"”相关的").concat(i):"当前文件夹不存在".concat(i)},showAll:function(){return this.renderType===j.All},sortType:function(){return this.listConfig.sortType},orderDesc:function(){return this.listConfig.orderDesc},renderType:function(){return this.listConfig.renderType},listConfig:function(){return this.$store.state.mobileInteraction.listConfig},mobileInteraction:function(){return this.$store.state.mobileInteraction},hasSearchText:function(){return!!this.searchText},searchText:function(){return this.mobileInteraction.searchText},showLazyArtboardList:function(){var t=[],e=this.renderArtboardList,n=this.mainArtboardView,i=(new ee).set(0,n.scrollTop,n.docWidth,n.height);return e.forEach((function(e){var n=e.rect;i.isOverlap(n)&&t.push(e)})),t},renderArtboardList:function(){var t=this.renderSortArtboardList,e=this.mainArtboardView,n=e.docWidth,i=[];if(e.boxRealHeight=0,0===n)return i;var r={titleHeight:this.designPXToShowPX(39,!0),imgWidth:this.designPXToShowPX(154,!0),lineCount:2,offsetX:this.designPXToShowPX(21),artboardFullEqualWidth:0};r.lineCount=Math.floor(n/r.imgWidth),r.artboardFullEqualWidth=Math.round(n/r.lineCount);var a=new Array(r.lineCount).fill(0),o=0;return t.forEach((function(t){var n,s=t.artboard,c=s.boundsInParentForList;if(c){var l=new ee,u=a[o],d=Math.ceil(c.height*r.imgWidth/c.width)+r.titleHeight;l.set(r.offsetX+(r.offsetX+r.imgWidth)*o,u,r.imgWidth,d),u+=d,a[o]=u,e.boxRealHeight=Math.max(e.boxRealHeight,u),o++,o>=r.lineCount&&(o=0),i.push({item:t,artboard:s,rect:l,titleHeight:r.titleHeight,key:null!==(n=s.cid)&&void 0!==n?n:"".concat(s.fileType,":").concat(s.guid)})}})),i},renderSortArtboardList:function(){var t,e,n=this.hasSearchText,i=this.searchText,r=this.renderDocumentArtboards,a=[];return i=n&&null!==(t=null===(e=i)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"",r.forEach((function(t){var e=null===t||void 0===t?void 0:t.artboard;if(e){if(n){var r=e.name;if(!r)return;if(-1===r.toLowerCase().indexOf(i))return}a.push(t)}})),a.length>0&&this.sortData(a,"updateTimeTimes",N.Artboard),a},renderAllListIndexStart:function(){var t=this.mainAllView;return Math.floor(t.scrollTop/this.designPXToShowPX(YS))},showLazyAllList:function(){for(var t=this.renderSortedAllList,e=this.mainAllView,n=this.renderAllListIndexStart,i=Math.ceil(e.height/this.designPXToShowPX(YS))+1,r=[],a=Math.min(n+i,t.length);n<a;n++){var o,s,c=t[n];r.push({item:c,key:"".concat(c.id,"-").concat(null!==(o=null===(s=c.artboard)||void 0===s?void 0:s.cid)&&void 0!==o?o:0)})}return r},renderSortedAllList:function(){var t,e,n=this.cloudSubFolders,i=this.hasSearchText,r=this.searchText,a=this.mainAllView,o=[];r=i&&null!==(t=null===(e=r)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"",ut(n)&&n.forEach((function(t){if(i){var e=t.name;if(!e)return;if(-1===e.toLowerCase().indexOf(r))return}o.push(t)})),this.sortData(o,"updateTimes",N.Folder);var s=this.renderSortArtboardList;return s.length>0&&o.push.apply(o,Object(Gn["a"])(s)),a.boxRealHeight=this.designPXToShowPX(YS)*o.length,o}},data:function(){return{mainArtboardView:{scrollTop:0,height:0,docWidth:0,boxRealHeight:0,mousewheelTimes:0,handle:0},mainAllView:{scrollTop:0,height:0,docWidth:0,boxRealHeight:0,mousewheelTimes:0,handle:0},inSafariStandalone:ct}},created:function(){window.addEventListener("resize",this.onMainViewResize)},mounted:function(){this.onMainViewResize(),this.onMainArtboardViewScroll(),this.onMainAllViewScroll()},beforeDestroy:function(){window.removeEventListener("resize",this.onMainViewResize),clearTimeout(this.mainArtboardView.handle),clearTimeout(this.mainAllView.handle)}},KS=XS,qS=(n("002a"),Object(wo["a"])(KS,PS,ES,!1,null,"197eced6",null)),QS=qS.exports,JS=function(){var t=this,e=t._self._c;return e("div",{staticClass:"artboard-info"},[e("ArtboardPanel",{attrs:{renderArtboardList:t.renderDocumentArtboards,curArtboardIndex:t.curArtboardIndex}}),!t.homeListVisible&&t.mobileInteraction.controlVisible?e("div",{staticClass:"control"},[e("div",{staticClass:"btns"},[e("div",{staticClass:"btn btn-control-golist",on:{click:function(e){return t.setCurArtboard(null)}}})]),e("menu",[e("span",{staticClass:"btn btn-homelist",class:{disabled:0===t.homeList.length},on:{click:t.clickHomeList}}),e("span",{staticClass:"line"}),e("span",{staticClass:"btn btn-interaction-rect-always-visible",class:{on:t.interactionRectAlwaysVisible},on:{click:t.clickInteractionRectAlwaysVisible}}),e("span",{staticClass:"line"}),e("span",{staticClass:"btn btn-vertical-align",class:t.verticalAlignCss,on:{click:t.clickVerticalAlign}})])]):t._e(),e("home-list",{attrs:{homeList:t.homeList,visible:t.homeListVisible},on:{hideHomeList:t.hideHomeList}})],1)},ZS=[],tT=function(){var t=this,e=t._self._c;return e("div",{staticClass:"artboard-panel",on:{touchstart:t.touchstartPanel}},[e("div",{staticClass:"box",class:{animation:t.animation,moving:t.movingX,out:t.isAnimationOut},style:t.style},t._l(t.showArtboards,(function(t){return e("div",{key:t.key,staticClass:"item"},[t.artboard?e("InteractionArtboardItem",{attrs:{artboard:t.artboard,overlayArtboards:t.overlayArtboards,renderTapInteraction:t.renderTapInteraction,overlayVisible:t.overlayVisible}}):e("artboard-empty")],1)})),0),t.gobackArtboard?e("InteractionArtboardItem",{attrs:{overlayVisible:!1,artboard:t.gobackArtboard.fromArtboard.artboard,overlayArtboards:[],renderTapInteraction:t.gobackArtboard.renderTapInteraction}}):t._e(),t.gotoArtboard?e("InteractionArtboardItem",{attrs:{artboard:t.gotoArtboard.fromArtboard.artboard,overlayArtboards:[],renderTapInteraction:t.gotoArtboard.renderTapInteraction}}):t._e()],1)},eT=[],nT=function(){var t=this;t._self._c;return t._m(0)},iT=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"artboard-empty"},[e("div",{staticClass:"box"},[e("div",{staticClass:"text"},[t._v("没有画板了")])])])}],rT=(n("938c"),{}),aT=Object(wo["a"])(rT,nT,iT,!1,null,"dbda9962",null),oT=aT.exports,sT={components:{InteractionArtboardItem:OC,ArtboardEmpty:oT},methods:{touchmovePanel:function(t){var e=t.changedTouches[0];if(e){var n=this.maxDiffNum,i=this.docWidth,r=e.pageX-this.touchStartX,a=e.pageY-this.touchStartY,o=Math.abs(r),s=Math.abs(a);this.movingX||this.movingY||(s>=n&&o<s&&(this.movingY=!0),!this.movingY&&o>=n&&(this.movingX=!0)),this.movingX&&(t.preventDefault(),r=r>0?Math.min(r,i):Math.max(r,-i),this.mouseDiffX=r)}},touchendPanel:function(t){window.removeEventListener("touchmove",this.touchmovePanel,{passive:!1}),window.removeEventListener("touchend",this.touchendPanel);var e=t.changedTouches[0];if(e)if(this.movingX){var n=e.pageX-this.touchStartX;this.onSlide(n)}else if(this.movingY)this.movingY=!1;else{var i,r=t.target,a=r&&!!r.getAttribute("data-unset-control"),o=this.mobileInteraction,s=Math.abs(Date.now()-this.touchStartTime),c=s<300,l=s>1500,u=o.controlVisible;a&&c?a=!1:(l&&a||c)&&(i=!u),i!==u&&setTimeout((function(){o.controlVisible=i}),10),this.currentArtboardHasRenderInteraction||this.showTextTip("当前画板没有或未提交交互原型热区",1)}},touchstartPanel:function(t){if(!this.animation){window.addEventListener("touchmove",this.touchmovePanel,{passive:!1}),window.addEventListener("touchend",this.touchendPanel);var e=t.touches[0];e&&(this.mouseDiffX=0,this.movingX=this.movingY=!1,this.touchStartX=e.pageX,this.touchStartY=e.pageY,this.touchStartTime=Date.now())}},onSlide:function(t){var e,n=this,i=this.mouseDiffX,r=0;try{if(0===t)return;var a=this.prevArtboard,o=this.nextArtboard,s=this.docWidth;if(null==a&&t>0)return;if(null==o&&t<0)return;if(Math.abs(t)<s/5)return;if(t>0?(e=a,r=s):(e=o,r=-s),!e)return}finally{0!==i&&(this.animation=!0,this.mouseDiffX=r,setTimeout((function(){n.animation=!1,n.mouseDiffX=0,n.movingX=!1,n.movingY=!1,e&&n.setCurArtboard(e)}),200))}}},computed:{isAnimationOut:function(){var t=this.gobackArtboard,e=this.gotoArtboard;return null!=[t,e].find((function(t){var e,n;return!!t&&-1!==(null!==(e=null===(n=t.renderTapInteraction)||void 0===n||null===(n=n.transition)||void 0===n?void 0:n.type)&&void 0!==e?e:"").indexOf("_out")}))},gobackArtboard:function(){return this.interactionSet.gobackArtboard},gotoArtboard:function(){return this.interactionSet.gotoArtboard},currentOverlayVisible:function(){return!this.gobackArtboard},currentRenderTapInteraction:function(){var t,e=this.gobackArtboard,n=this.gotoArtboard,i=null===(t=null!==e&&void 0!==e?e:n)||void 0===t?void 0:t.renderTapInteraction;if(i){var r=i,a=r.transition,o=r.trigger_type,s=r.type,c=r.preserveScrollPosition,l=r.toArtboard;if(!ht(a))return null;switch(a=Object(Q["a"])({},a),a.type){case"dissolve":case"autoAnimate":return null;case"push":case"slide":case"slide_out":case"move":case"move_out":a.type="".concat(a.type,"-background");break}i={transition:a,trigger_type:o,type:s,preserveScrollPosition:c,toArtboard:l}}return i},currentArtboardHasRenderInteraction:function(){return null!=this.currentArtboardRenderInteractions},currentArtboardRenderInteractions:function(){var t,e,n=null===(t=this.curArtboard)||void 0===t||null===(t=t.artboard)||void 0===t?void 0:t.interactionInfo;if(!n)return null;if(n.fetchState!==Cn.Success)return null;var i=null===(e=n.data)||void 0===e?void 0:e.renderInteractions;return ut(i)&&i.length>0?i:null},showArtboards:function(){var t=this.prevArtboard,e=this.nextArtboard,n=this.curArtboard,i=this.overlayArtboards,r=[];return t?r.push({key:t.artboard.cid,artboard:t.artboard,overlayArtboards:null,renderTapInteraction:null,overlayVisible:!0}):r.push({key:"prevArtboard.null",artboard:null,overlayArtboards:null,renderTapInteraction:null,overlayVisible:!0}),r.push({key:n.artboard.cid,artboard:n.artboard,overlayArtboards:i,renderTapInteraction:this.currentRenderTapInteraction,overlayVisible:this.currentOverlayVisible}),e?r.push({key:e.artboard.cid,artboard:e.artboard,overlayArtboards:null,renderTapInteraction:null,overlayVisible:!0}):r.push({key:"nextArtboard.null",artboard:null,overlayArtboards:null,renderTapInteraction:null,overlayVisible:!0}),r},moving:function(){return this.movingX||this.movingY},style:function(){var t=this.mouseDiffX;return{transform:"translate3d(".concat(t,"px, 0, 1px)")}},docWidth:function(){return this.mobileInteraction.mobileSize.width},mobileInteraction:function(){return this.$store.state.mobileInteraction},interactionSet:function(){return this.$store.state.artboardDetail.interactionSet},overlayArtboards:function(){return this.interactionSet.overlayArtboards},prevArtboard:function(){var t=this.curArtboardIndex,e=this.renderArtboardList;return t<=0?null:e[t-1]},nextArtboard:function(){var t=this.curArtboardIndex,e=this.renderArtboardList,n=e.length;return t>=n-1?null:e[t+1]}},data:function(){return{touchStartTime:0,touchStartX:0,touchStartY:0,movingX:!1,movingY:!1,maxDiffNum:3,animation:!1,mouseDiffX:0}},props:{renderArtboardList:Array,curArtboardIndex:Number}},cT=sT,lT=(n("d42b"),Object(wo["a"])(cT,tT,eT,!1,null,"68e735ff",null)),uT=lT.exports,dT=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home-list",class:{on:t.visible},on:{click:function(e){return e.target!==e.currentTarget?null:t.clickHide.apply(null,arguments)}}},[e("ul",{staticClass:"box"},t._l(t.homeList,(function(n,i){return e("li",{key:i,on:{click:function(e){return t.clickItem(n)}}},[e("span",{staticClass:"text"},[t._v(t._s(n.artboard.name))])])})),0)])},hT=[],fT={methods:{clickItem:function(t){this.setCurArtboard(t),this.clickHide()},clickHide:function(){this.$emit("hideHomeList")}},props:{homeList:Array,visible:Boolean}},mT=fT,pT=(n("b3ac"),Object(wo["a"])(mT,dT,hT,!1,null,"10774c3a",null)),vT=pT.exports,bT={components:{ArtboardPanel:uT,HomeList:vT},methods:{clickVerticalAlign:function(){var t,e=this.verticalAlign,n=Object(Ht["a"])(Object(Ht["a"])(Object(Ht["a"])({},q.Top,q.Middle),q.Middle,q.Bottom),q.Bottom,q.Top),i=null!==(t=n[e])&&void 0!==t?t:q.Middle;this.$store.commit("setInteractionArtboardVerticalAlign",i),this.showTextTip("已修改画板的对齐方式为[".concat(q.getName(i),"]"))},hideHomeList:function(){this.homeListVisible=!1},clickHomeList:function(){var t=this.homeList;if(0!==t.length)return 1===t.length?(this.setCurArtboard(t[0]),void this.showTextTip("已切换到起始画板")):void(this.homeListVisible=!0);this.showTextTip("当前没有配置起始画板")},clickInteractionRectAlwaysVisible:function(){var t=!this.interactionRectAlwaysVisible;this.showTextTip(t?"已开启原型热区常显":"已关闭原型热区常显"),this.$store.commit("setInteractionRectAlwaysVisible",t)},clickGoArtboardByIndex:function(t){t<0&&(t=0);var e=this.renderDocumentArtboards,n=e.length;t>n-1&&(t=n-1);var i=e[t];this.setCurArtboard(i)}},computed:{verticalAlignCss:function(){switch(this.verticalAlign){case q.Bottom:return"align-bottom";case q.Top:return"align-top";default:return"align-middle"}},verticalAlign:function(){return this.$store.state.artboardDetail.interactionSet.verticalAlign},homeList:function(){var t=this.renderDocumentArtboards;return t.filter((function(t){var e;return null===(e=t.artboard)||void 0===e?void 0:e.flowStart}))},hasPrevArtboard:function(){var t=this.curArtboardIndex;return t>0},hasNextArtboard:function(){var t=this.renderDocumentArtboards,e=this.curArtboardIndex,n=t.length;return e<n-1},curArtboardIndex:function(){var t=this.curArtboard;return this.renderDocumentArtboards.findIndex((function(e){return e===t}))},interactionRectAlwaysVisible:function(){return this.$store.state.artboardDetail.interactionSet.rectAlwaysVisible},mobileInteraction:function(){return this.$store.state.mobileInteraction},hasSearchText:function(){return!!this.searchText},searchText:function(){return this.mobileInteraction.searchText},renderArtboardList:function(){var t,e,n=this.searchText,i=this.renderDocumentArtboards,r=this.hasSearchText,a=[];return n=r&&null!==(t=null===(e=n)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"",i.forEach((function(t){var e=null===t||void 0===t?void 0:t.artboard;if(e){if(r){var i=e.name;if(!i)return;if(-1===i.toLowerCase().indexOf(n))return}var o=e.boundsInParent;o&&a.push(t)}})),a}},watch:{curArtboard:function(t){t||(this.mobileInteraction.controlVisible=!1)}},data:function(){return{homeListVisible:!1}},created:function(){this.mobileInteraction.controlVisible=!1}},gT=bT,wT=(n("b13d"),Object(wo["a"])(gT,JS,ZS,!1,null,"b3020be6",null)),xT=wT.exports,yT=function(){var t=this,e=t._self._c;return t.tipVisible?e("div",{staticClass:"pop-tip-text"},[e("p",[t._v(t._s(t.tipText))])]):t._e()},kT=[],CT={computed:{tipText:function(){return this.$store.state.textTip.text},tipVisible:function(){return this.$store.state.textTip.visible}}},ST=CT,TT=(n("2ec9"),Object(wo["a"])(ST,yT,kT,!1,null,"74a7e4ce",null)),AT=TT.exports,IT=st&&/MQQBrowser/i.test(navigator.userAgent),FT={components:{ArtboardList:QS,ArtboardInfo:xT,TipInMobile:AT,CloudNeedLoginTip:hu,Authority:tg,EmptyData:og,Header:cS,Nav:LS,AutomaticSync:yo},methods:{onResize:function(){var t=document.documentElement,e=this.mobileSize;e.width=t.offsetWidth,e.height=t.offsetHeight},fullScreen:function(){var t=this.allArtboardLoadChecked,e=this.cloudIsLogin,n=this.cloudNeedLogin,i=this.cloudFolderNotFound,r=this.permission,a=this.isEmptyArtboardData,o=this.inList;t&&(n&&!e||i||r&&(a||o||this.isQQBrowser||this.isFullscreen||Lk.requestFullscreen()))},onFullscreen:function(t){this.isFullscreen=t},setFullscreen:function(t){var e=document.documentElement;t?Lk.onChange(this.onFullscreen):Lk.offChange(this.onFullscreen);var n=t?"addEventListener":"removeEventListener";e[n]("touchend",this.fullScreen),e[n]("click",this.fullScreen),e=null}},data:function(){return{isFullscreen:Lk.isFullscreen()}},computed:{isQQBrowser:function(){return IT},emptyText:function(){return this.inCloudMode?0===this.cloudCurrentFolderId?"私有云下还没有文件夹,请在标记狮中添加":this.inNetDiskFileMode?"文件不存在,可能已经被移动或删除":"当前文件夹没有画板信息":"未检测到数据,请尝试重新导出画板"},artboardLoadProgressText:function(){return Math.floor(1e4*this.artboardLoadProgress.current/this.artboardLoadProgress.count)/100+"%"},artboardLoadProgress:function(){return this.$store.state.artboardLoadProgress},allArtboardLoadChecked:function(){return this.$store.state.allArtboardLoadChecked},isEmptyArtboardData:function(){return 0===this.documentArtboards.length},mobileSize:function(){return this.$store.state.mobileInteraction.mobileSize},inList:function(){return null==this.curArtboard}},created:function(){this.setFullscreen(!0),window.addEventListener("resize",this.onResize),this.onResize()},beforeDestroy:function(){this.setFullscreen(!1),window.removeEventListener("resize",this.onResize)}},MT=FT,OT=(n("d6df"),Object(wo["a"])(MT,WC,$C,!1,null,"39ffaee1",null)),_T=OT.exports;function LT(t,e){Dn(!0),jn();var n=+ln("commentid","#"),i="1"===ln("isreply","#");t().then((function(){var t=lo.state;lo.commit("allArtboardLoadChecked",!0),t.cloud.allFoldersBoxVisible="1"===on(E,!1),Zi(t.documentArtboards);var r=t.cloud.defaultArtboardGuid,a=null;if(r&&(a=ya.documentArtboards.find((function(t){return t.artboard.guid===r})),t.curArtboard!==a&&lo.commit("curArtboard",{artboard:a})),n>0){var o,s,c=t.autoIntoInfo;c.commentArtboardId=null!==(o=null===(s=a)||void 0===s||null===(s=s.artboard)||void 0===s?void 0:s.cid)&&void 0!==o?o:0,c.commentId=n,c.isReply=i,lo.commit("setArtboardInComment",!0)}e(),a||st||(t.renderDocuments.find((function(t){if(a=t.arts.find((function(t){return t.artboard.flowStart})),a)return!0})),a||t.renderDocuments.find((function(t){if(t.arts.length>0)return a=t.arts[0],!0})),a&&t.curArtboard!==a&&lo.commit("curArtboard",{artboard:a}))}));var r=new a["a"]({store:lo,render:function(t){return t(st?_T:HC)}});Ma((function(t){lo.commit("isSupportWebp",t),r.$mount("#app")}))}var PT,ET,NT=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pop-box confirm",class:{"in-mobile":t.inMobile}},[e("div",{staticClass:"box"},[t.showCancel?e("a",{staticClass:"sys-close",attrs:{href:"javascript:;"},on:{click:t.clickCancel}}):t._e(),e("div",{staticClass:"title"},[t._v(t._s(t.title))]),e("div",{staticClass:"text"},[t._v(t._s(t.text))]),e("div",{staticClass:"btns"},[t.noText?e("a",{staticClass:"button btn-no",attrs:{href:"javascript:;"},on:{click:t.clickNo}},[t._v(t._s(t.noText))]):t._e(),e("a",{staticClass:"button btn-yes",class:{light:!t.inMobile},attrs:{href:"javascript:;"},on:{click:t.clickYes}},[t._v(t._s(t.yesText))])])])])},DT=[],jT={created:function(){window.addEventListener("keydown",this.onKeyDown)},beforeDestroy:function(){window.removeEventListener("keydown",this.onKeyDown)},methods:{onKeyDown:function(t){var e=t.keyCode||t.which;if(27===e){try{t.preventDefault(),t.stopPropagation()}catch(n){}this.showCancel?this.clickCancel():this.clickNo()}},clickCancel:function(){this.$emit("clickCancel")},clickYes:function(){this.$emit("clickYes")},clickNo:function(){this.$emit("clickNo")}},props:{title:{type:String,default:"提示"},text:{validator:function(){return!0}},yesText:{type:String,default:"确认"},noText:{type:String,default:"取消"},showCancel:{type:Boolean,default:!1}}},RT=jT,VT=(n("567c"),Object(wo["a"])(RT,NT,DT,!1,null,"8aa1124e",null)),BT=VT.exports,UT=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pop-box prompt"},[e("form",{on:{submit:t.clickSubmit}},[e("div",{staticClass:"box"},[e("a",{staticClass:"sys-close",attrs:{href:"javascript:;",title:t.noText},on:{click:t.clickNo}}),e("div",{staticClass:"title"},[t._v(t._s(t.title))]),e("div",{staticClass:"text"},[e("UserInput",{ref:"text",attrs:{defaultBorder:!0,placeholder:t.placeholder,target:"text",initValue:t.text,maxLength:t.maxLength},on:{change:t.onChange}})],1),e("div",{staticClass:"btns"},[e("a",{staticClass:"button light btn-yes",attrs:{href:"javascript:;"},on:{click:t.clickYes}},[t._v(t._s(t.yesText))])])])])])},HT=[],WT={methods:{clickSubmit:function(t){t.preventDefault(),this.clickYes()},onChange:function(t){this.value=t}},components:{UserInput:kf},props:{title:{type:String,default:"提示"},maxLength:{type:Number,default:256},placeholder:{type:String,default:""},text:String,yesText:{type:String,default:"确认"},noText:{type:String,default:"取消"}},data:function(){return{value:""}},created:function(){var t=this;this.value=this.text,dt(this.value)&&this.$nextTick((function(){var e=t.$refs.text;e&&e.setFocus&&e.setFocus()}))}},$T=WT,GT=(n("0913"),Object(wo["a"])($T,UT,HT,!1,null,"bebbefea",null)),zT=GT.exports,YT=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a,s,c=arguments;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=!(c.length>2&&void 0!==c[2])||c[2],"string"!==typeof n&&(n=JSON.stringify(n)),a="".concat(me,"/api/").concat(e),t.next=5,fetch(a,{method:"post",body:n,credentials:void 0});case 5:s=t.sent,t.t0=s.status,t.next=200===t.t0?9:500===t.t0?21:25;break;case 9:return t.next=11,s.text();case 11:if(n=t.sent,dt(n)){t.next=14;break}throw"接口".concat(e,"请求失败,不存在返回值");case 14:if(n=gn(n),ht(n)){t.next=17;break}throw"接口".concat(e,"请求失败,无法解析返回值");case 17:if(n.success){t.next=20;break}throw n.code===o.NotLogin&&be(2e3).then((function(){window.location.reload(!0)})),n.errMsg;case 20:return t.abrupt("return",r?wn(n.data):n.data);case 21:return t.next=23,s.text();case 23:throw n=t.sent,n;case 25:throw"接口".concat(e,"请求失败");case 26:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),XT=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var r,a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(ht(n)){t.next=2;break}throw"接口[".concat(e,"]返回值格式异常");case 2:if(n.success){t.next=4;break}return t.abrupt("return",n);case 4:if(n=n.data,dt(n)){t.next=7;break}throw"接口[".concat(e,"]返回值格式异常,无法解析data");case 7:return r="".concat(me,"/api/").concat(e),t.next=10,fetch(r,{method:"post",body:n,credentials:void 0});case 10:a=t.sent,t.t0=a.status,t.next=200===t.t0?14:500===t.t0?23:27;break;case 14:return t.next=16,a.text();case 16:if(n=t.sent,dt(n)){t.next=19;break}throw"接口[".concat(e,"]请求失败,不存在返回值");case 19:if(n=gn(n),ht(n)){t.next=22;break}throw"接口[".concat(e,"]请求失败,无法解析返回值");case 22:return t.abrupt("return",n);case 23:return t.next=25,a.text();case 25:throw n=t.sent,"接口[".concat(e,"]").concat(n);case 27:throw"接口[".concat(e,"]请求失败");case 28:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),KT=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(e,n){var a,o,s,c,l,u,d,h,f=arguments;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=f.length>2&&void 0!==f[2]?f[2]:0,o="pre"+e,t.next=4,YT(o,n,!1);case 4:return s=t.sent,c="".concat(he,"router/web/webupdate.ashx"),l=document.createElement("iframe"),u="__postdata_"+Date.now(),l.name=u,l.style.cssText="width:1px;height:1px;position: absolute;top:-10px;left:-10px;overflow:hidden;",d=document.createElement("form"),d.style.cssText="width:1px;height:1px;position: absolute;top:-10px;left:-10px;overflow:hidden;",d.appendChild(l),d.target=u,d.method="POST",d.action=c,d.enctype="multipart/form-data",h=document.createElement("input"),h.name="router",h.value=e,d.appendChild(h),h=document.createElement("input"),h.name="body",h.value=s,d.appendChild(h),h=null,document.body.appendChild(d),t.abrupt("return",new Promise((function(t,n){var o,s=function(){clearTimeout(o),c&&(window.removeEventListener("message",c),document.body.removeChild(d),c=d=l=null)};a>0&&(o=setTimeout((function(){s(),n("[".concat(e,"]操作已超时"))}),a));var c=function(){var a=Object(r["a"])(Object(i["a"])().mark((function r(a){var o,c;return Object(i["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(o=a.source,o===l.contentWindow){i.next=3;break}return i.abrupt("return");case 3:if(i.prev=3,c=a.data,"string"!==typeof c){i.next=9;break}return i.abrupt("return",n(c));case 9:return i.prev=9,i.t0=t,i.next=13,XT(e,c);case 13:i.t1=i.sent,(0,i.t0)(i.t1),i.next=20;break;case 17:i.prev=17,i.t2=i["catch"](9),n(i.t2);case 20:return i.prev=20,s(),i.finish(20);case 23:case"end":return i.stop()}}),r,null,[[3,,20,23],[9,17]])})));return function(t){return a.apply(this,arguments)}}();window.addEventListener("message",c),d.submit()})));case 28:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),qT={computed:{webViewFocus:function(){return this.$store.state.webViewFocus},webViewHidden:function(){return this.$store.state.webViewHidden},allFoldersBoxVisible:function(){return this.$store.state.cloud.allFoldersBoxVisible},fileViewUrl:function(){var t=this.curNetDiskFile;return t&&t.viewUrl?"".concat(t.viewUrl,"?type=res&t=").concat(t.updateTimeTimes):null},fileDownloadUrl:function(){var t=this.curNetDiskFile;return t&&t.viewUrl?"".concat(t.viewUrl,"?type=download&t=").concat(t.updateTimeTimes):null},inMobile:function(){return st},inMacOS:function(){return nt},editComment:function(){return this.$store.state.editComment},inCommentDrawing:function(){var t=this.editComment;if(!t.drawing)return!1;var e=t.drawInfo.histories;return e.length>0},numberAutoRound:function(){return this.$store.state.setting.numberAutoRound},exportBoxBackground:function(){return this.$store.state.setting.exportBoxBackground},inCloudMode:function(){return this.$store.state.inCloudMode},artShowInListMode:function(){return this.inCloudMode&&this.$store.state.artShowInListMode},permission:function(){return this.$store.state.permission},cloudNeedLogin:function(){return this.$store.state.cloudNeedLogin},cloudIsLogin:function(){return this.$store.state.cloudIsLogin},cloudNickName:function(){return this.$store.state.cloudNickName},cloudUserEmail:function(){return this.$store.state.cloudUserEmail},cloudUserId:function(){return this.$store.state.cloudUserId},cloudUserIsDesigner:function(){return this.$store.state.cloudUserIsDesigner},cloudUserIsOwner:function(){return this.$store.state.cloudUserIsOwner},cloudUserKey:function(){return this.$store.state.cloudUserKey},cloudName:function(){return this.$store.state.cloudName},cloudKey:function(){return this.$store.state.cloudKey},cloudVersion:function(){return this.$store.state.cloudVersion},cloudFolderNotFound:function(){return this.$store.state.cloud.folderNotFound},cloudFolderInSpecify:function(){return this.$store.state.cloud.folderInSpecify},cloudFolderErrorText:function(){var t=this.cloudFolderNotFound,e=this.cloudFolderInSpecify;return e?st?"当前文件夹仅限定人员访问\n请使用有访问权限的账户登录":"当前文件夹仅限定人员访问,请使用有访问权限的账户登录":t?"链接已失效,无法找到对应的文件夹":null},cloudCurrentFolderId:function(){return this.$store.state.cloud.currentFolderId},cloudDefaultArtboardGuid:function(){return this.$store.state.cloud.defaultArtboardGuid},cloudSubFolders:function(){return this.$store.state.cloud.subFolders},cloudSubFiles:function(){return this.$store.state.cloud.subFiles},cloudParentFolder:function(){return this.$store.state.cloud.parentFolder},androidUseMipmap:function(){return this.$store.state.androidUseMipmap},calcPlatformUse:function(){var t=this.calcPlatformType;switch(t){case s.ANDROID:case s.IOS:return t;case s.CUSTOM:switch(this.calcPlatformCustomUnit){case c.DP:return s.ANDROID;case c.PT:return s.IOS;default:return s.WEB}default:return s.WEB}},calcArtScale:function(){var t=this.curArtboard;if(!t)return 1;var e=t.artboard;if(!e)return 1;var n=e.mlConfig;if(!n)return 1;var i=n.artScale;return null==i||i<=0?1:i},calcPlatformType:function(){return this.$store.state.platform.type},calcPlatformCustomUnit:function(){return this.$store.state.platform.customUnit},calcPlatformShowType:function(){switch(this.calcPlatformType){case s.ANDROID:case s.IOS:return this.calcPlatformType;case s.CUSTOM:switch(this.calcPlatformCustomUnit){case c.DP:return s.ANDROID;case c.PT:return s.IOS;default:return s.WEB}default:return s.WEB}},calcUnitTemplateValue:function(){if(!this.inArtboardMode)return"";var t=this.$store.state.unitTemplate.template;return t||""},calcPlatformCustomDocWidth:function(){if(!this.inArtboardMode)return 1;var t=this.$store.state.platform.customDocWidth;return(isNaN(t)||!isFinite(t)||t<1)&&(t=0),t},calcPlatformCustomDocWidthShow:function(){var t=this.calcPlatformCustomDocWidth;return 0===t&&(t=this.curArtboard.artboard.boundsInArtboard.width),t},scaleArtboard:function(){return this.$store.state.scale.artboard},scaleList:function(){return this.$store.state.scale.list},scaleImageViewer:function(){var t=this.$store.state.imageViewer;return t.scale},inArtboardMode:function(){return null!==this.curArtboard},inCloudViewerMode:function(){return this.inCloudMode&&this.$store.state.cloud.renderMode===U.Normal},inNetDiskFileMode:function(){return this.inCloudMode&&this.$store.state.cloud.renderMode===U.File},inInteractionMode:function(){return this.inCloudMode&&this.$store.state.cloud.renderMode===U.Interaction},curNetDiskFile:function(){return this.inNetDiskFileMode?this.$store.state.cloud.fileInfo:null},curArtboard:function(){return this.$store.state.curArtboard},curArtboardGuid:function(){var t,e;return null!==(t=null===(e=this.curArtboard)||void 0===e||null===(e=e.artboard)||void 0===e?void 0:e.guid)&&void 0!==t?t:""},curArtboardId:function(){var t;return null===(t=this.curArtboard)||void 0===t||null===(t=t.artboard)||void 0===t?void 0:t.cid},curNode:function(){return this.$store.state.curNode},propertyVisible:function(){return this.inMultDownMode||this.inArtboardMode&&null!==this.curNode},artboardInComment:function(){return this.$store.state.artboardInComment},clickedNode:function(){return this.$store.state.clickedNode},enterNode:function(){return this.$store.state.enterNode},documents:function(){return this.$store.state.documents},renderDocuments:function(){return this.$store.state.renderDocuments},filterDocumentGuid:function(){return this.$store.state.filterDocumentGuid},documentArtboards:function(){return this.$store.state.documentArtboards},renderDocumentArtboards:function(){return this.$store.state.renderDocumentArtboards},documentName:function(){return this.$store.state.documentName},inMultDownMode:function(){return this.inArtboardMode&&this.$store.state.inMultDownMode&&!this.artboardInComment},inArtboardMultDownMode:function(){return!this.inArtboardMode&&this.$store.state.inArtboardMultDownMode},userFolderSpecifyMemberAuthority:function(){return this.$store.state.cloud.userFolderSpecifyMemberAuthority}},methods:{removeCloudItem:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,ht(t)){n.next=3;break}throw new Error("参数异常");case 3:return r=new FormData,r.append("parentId",t.parentId),t.fileSecId&&r.append("fileSecId",t.fileSecId),t.artboardGuid&&r.append("artGuid",t.artboardGuid),n.next=9,e.fetchPostCloudApi("ItemRemoveByWeb",{timeout:3e4,body:r});case 9:if(t=n.sent,ht(t)){n.next=12;break}throw new Error("返回值异常,无法解析数据:".concat(t));case 12:if(t.success){n.next=14;break}throw new Error(t.errMsg);case 14:return e.showTextTip(t.errMsg),n.abrupt("return",!0);case 18:return n.prev=18,n.t0=n["catch"](0),e.alert({title:"删除失败",text:n.t0}),n.abrupt("return",!1);case 22:case"end":return n.stop()}}),n,null,[[0,18]])})))()},goCloudFolderInteractionUrl:function(t,e){var n=this;return Object(r["a"])(Object(i["a"])().mark((function a(){var o,s,c,l,u,d;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(o="/interactionviewer/".concat(t,"/").concat(e?"".concat(e,"/"):""),!ct){a.next=28;break}if(s=n.$store,c=t!==s.state.cloud.currentFolderId,a.prev=4,s.state.mobileInteraction.listFetchState!==Cn.Fetching){a.next=7;break}return a.abrupt("return");case 7:return s.state.mobileInteraction.listFetchState=Cn.Fetching,a.next=10,n.fetchPostCloudApi(o,{timeout:1e4,abortKey:"goCloudFolderInteractionUrl"});case 10:return l=a.sent,n.setCurArtboard(null),ya.dataInit({cloudData:l},s.state.cloudListSort),u=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ya.allArtboardLoadChecked((function(){}));case 2:s.commit("setDocument",ya);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=function(){c&&s.commit("setFilterDocumentGuid",null)},a.next=17,u();case 17:Zi(s.state.documentArtboards),d(),s.state.mobileInteraction.listFetchState=Cn.Success,a.next=26;break;case 22:a.prev=22,a.t0=a["catch"](4),s.state.mobileInteraction.listFetchState=Cn.Error,n.showTextTip(a.t0);case 26:a.next=29;break;case 28:location.href=o;case 29:case"end":return a.stop()}}),a,null,[[4,22]])})))()},checkCloudItem:function(t,e){var n=this;return Object(r["a"])(Object(i["a"])().mark((function r(){var a,o;return Object(i["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return a=new FormData,a.append("number"===typeof t?"id":e===$.File?"secid":"id",t),a.append("type",e),i.next=5,n.fetchPostCloudApi("checkitemexistbyweb",{timeout:1e4,body:a});case 5:if(o=i.sent,ht(o)){i.next=8;break}throw new Error("返回值异常[checkitemexistbyweb]:".concat(o));case 8:if(o.success){i.next=10;break}throw new Error(o.errMsg);case 10:if(o.data){i.next=12;break}throw new Error("返回值异常[checkitemexistbyweb]:".concat(JSON.stringify(o)));case 12:return i.abrupt("return",o.data);case 13:case"end":return i.stop()}}),r)})))()},clickNetDiskFile:function(t){t&&(V.isSupportOnlineViewType(t.fileType)?window.open(t.viewUrl):this.clickDownloadNetDiskFile(t))},clickDownloadNetDiskFile:function(t){var e,n,i=t&&t.viewUrl?"".concat(t.viewUrl,"?type=download&t=").concat(t.updateTimeTimes):null;if(i){var r=null!==(e=t.name)&&void 0!==e?e:"".concat(t.fileName).concat(null!==(n=t.fileExt)&&void 0!==n?n:"");De(r,i)}},alert:function(t){var e=t.title,n=t.text,i=t.yesText,r=void 0===i?"确认":i;return this.confirm({title:e,text:n,noText:"",yesText:r})},confirm:function(t){var e=t.title,n=t.text,i=t.noText,r=void 0===i?"取消":i,o=t.yesText,s=void 0===o?"确认":o,c=t.showCancel,l=void 0!==c&&c;return new Promise((function(t){var i=function(){if(o){var t=o.$el;o.$destroy(),o=null,t&&t.parentNode&&(t.parentNode.removeChild(t),t=null)}},o=new(a["a"].extend(BT))({propsData:{title:e,text:n,noText:r,yesText:s,showCancel:l},methods:{clickCancel:function(){i(),t("cancel")},clickYes:function(){i(),t(!0)},clickNo:function(){i(),t(!1)}}}).$mount();document.body.appendChild(o.$el)}))},prompt:function(t){var e=t.title,n=t.text,i=t.placeholder,r=void 0===i?"":i,o=t.beforeYes,s=t.maxLength,c=void 0===s?256:s,l=t.noText,u=void 0===l?"取消":l,d=t.yesText,h=void 0===d?"确认":d;return new Promise((function(t,i){var s=function(){if(l){var t=l.$el;l.$destroy(),l=null,t&&t.parentNode&&(t.parentNode.removeChild(t),t=null)}},l=new(a["a"].extend(zT))({propsData:{title:e,text:n,noText:u,yesText:h,placeholder:r,maxLength:c},methods:{clickYes:function(){var e=this.value;"function"!==typeof o||!1!==o(e)?(s(),t(e)):this.$refs.text.setFocus()},clickNo:function(){s(),i()}}}).$mount();document.body.appendChild(l.$el)}))},cleanFoldersCache:function(t){var e=this,n=function(t){var n="allfoldersbyweb_".concat(e.cloudUserKey,"_").concat(t?1:0);cn(n),cn("".concat(n,".t"))};void 0===t||null===t?(n(!0),n(!1)):n(t)},getAllUsers:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r,a,o,s;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.cloudVersion,r=t.inCloudMode,a=t.cloudIsLogin,r){e.next=3;break}return e.abrupt("return",null);case 3:if(!mt(n)){e.next=5;break}throw new Error("无法使用@功能,私有云版本过低(".concat(n,"),请先升级私有云部署包"));case 5:if(a){e.next=7;break}throw new Error("未登录,请先登录");case 7:if(o=Jx("cloudusers","all"),!o){e.next=10;break}return e.abrupt("return",o);case 10:return e.next=12,t.fetchPostCloudApi("GetUsersByWeb",{method:"post",body:"",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});case 12:if(s=e.sent,ht(s)){e.next=15;break}throw new Error("返回值异常,无法解析数据:".concat(s));case 15:if(s.success){e.next=17;break}throw new Error(s.errMsg);case 17:if(o=s.data,ut(o)){e.next=20;break}throw new Error("返回值异常,无法解析数据:".concat(JSON.stringify(s)));case 20:return o.forEach((function(t){var e,n=t.nickName;e=n?n[n.length-1]:"-",t.userFaceText=e})),o.sort((function(t,e){var n=ke(t.nickName,e.nickName);return 0==n&&(n=ke(t.email,e.email)),n})),Qx("cloudusers","all",o,3e4),e.abrupt("return",o);case 24:case"end":return e.stop()}}),e)})))()},searchWebItem:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c,l,u,d,h,f,m,p,v;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.cloudVersion,a=e.inCloudMode,a){n.next=3;break}return n.abrupt("return",null);case 3:if(!gt(r)){n.next=5;break}throw new Error("私有云版本过低(".concat(r,"),请先升级私有云部署包"));case 5:if(o="webitemsearch",s="".concat(e.cloudUserKey,"_").concat(t),c=Jx(o,s),ut(c)){n.next=32;break}return n.next=11,e.fetchPostCloudApi("webitemsearch",{abortKey:"webitemsearch",timeout:1e4,method:"post",body:"wd=".concat(encodeURIComponent(t)),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});case 11:if(c=n.sent,ht(c)){n.next=14;break}throw new Error("返回值异常,无法解析数据:".concat(c));case 14:if(c.success){n.next=16;break}throw new Error(c.errMsg);case 16:if(c=c.data,ht(c)){n.next=19;break}throw new Error("返回值异常,无法解析数据:".concat(JSON.stringify(c)));case 19:l=c,u=l.folders,d=l.artboards,h=l.files,f=l.updaterNames,m=l.fromFolders,p=l.allParents,ut(u)||(u=[]),ut(d)||(d=[]),ut(h)||(h=[]),ht(f)||(f={}),ht(m)||(m={}),c=[],v=function(t){if(p){var e=t.parents=[],n=t.parentId;while(n>0){var i=m[n];if(!i)break;e.unshift(i),n=i.parentId}0==e.length&&e.push({folderId:0,name:"私有云根目录",parentId:0,shareMode:Y.Public})}else t.parents=null},u.forEach((function(t){var e=m[t];e&&(e=Object.assign({localSearchType:B.Folder},e),e.parent=m[e.parentId],v(e),c.push(e))})),d.forEach((function(t){var e;t&&(t.localSearchType=B.Artboard,t.updaterName=null!==(e=f[t.updaterId])&&void 0!==e?e:"undefined",t.parent=m[t.parentId],v(t),c.push(t))})),h.forEach((function(t){var e;t&&(t.localSearchType=B.File,t.updaterName=null!==(e=f[t.updaterId])&&void 0!==e?e:"undefined",t.parent=m[t.parentId],v(t),c.push(t))})),c.sort((function(t,e){return ke(t.name,e.name)})),Qx(o,s,c,8e3);case 32:return n.abrupt("return",c);case 33:case"end":return n.stop()}}),n)})))()},getAllFolders:function(t,e){var n=this;return Object(r["a"])(Object(i["a"])().mark((function r(){var a,o,s,c,l,u,d,h,f,m,p,v,b,g,w,x,y,k;return Object(i["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a=n.cloudVersion,o=n.inCloudMode,o){i.next=3;break}return i.abrupt("return",null);case 3:if(!mt(a)){i.next=5;break}throw new Error("私有云版本过低(".concat(a,"),请先升级私有云部署包"));case 5:if(c=!1,l="allfoldersbyweb_".concat(n.cloudUserKey,"_").concat(t?1:0),u=on(l+".t",!0),"number"===typeof u&&u>0&&(d=Math.abs(Date.now()-u),c=d<1e4),c&&(s=on(l,!0)),ut(s)){i.next=23;break}return i.next=13,n.fetchPostCloudApi("getallfoldersbyweb",{method:"post",body:"needPreview=".concat(t?1:0),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}});case 13:if(s=i.sent,ht(s)){i.next=16;break}throw new Error("返回值异常,无法解析数据:".concat(s));case 16:if(s.success){i.next=18;break}throw new Error(s.errMsg);case 18:if(s=s.data,ut(s)){i.next=21;break}throw new Error("返回值异常,无法解析数据:".concat(JSON.stringify(s)));case 21:sn(l,s),sn(l+".t",Date.now());case 23:if(h={},f={},m=null,s.forEach((function(t){if(t){0===t.id&&(m=t),t.childArtboardCount=0,t.childFileCount=0,t.childFolderCount=0,h[t.id]=t;var e=f[t.parentId];e||(e=f[t.parentId]=[]);var n=f[t.id];n||(n=f[t.id]=[]),t.childs=n,0===t.id&&0===t.parentId||e.push(t)}})),p=!1,v=function(t,e){var n=ke(t.name,e.name);return p?-n:n},Object.keys(f).forEach((function(t){var e=f[t];e.sort(v)})),s.forEach((function(t){t&&(t.parent=0===t.id?null:h[t.parentId],t.childsVisible=0===t.id,t.deepCount=0===t.id?0:1,t.name?t.nameLower=t.name.toLowerCase():t.name=t.nameLower="")})),s.forEach((function(t){var e;if(t&&!((null===(e=t.childs)||void 0===e?void 0:e.length)>0)){var n=t,i=n.parent;while(i)i.updateTimes=Math.max(i.updateTimes,t.updateTimes),t=i,i=i.parent}})),b=on(P,!0),ht(b)||(b={}),g=Object.keys(b),w=n.cloudCurrentFolderId,w>=0&&g.push(w),g.forEach((function(t){var e=h[t];while(e)(e.id||0!==e.childs.length)&&(e.childsVisible=!0),e=e.parent})),s.forEach((function(t){var e=t;while(null!=(e=e.parent)){var n,i,r;e.childArtboardCount+=null!==(n=t.artboardCount)&&void 0!==n?n:0,e.childFileCount+=null!==(i=t.fileCount)&&void 0!==i?i:0,e.childFolderCount+=null!==(r=t.folderCount)&&void 0!==r?r:0}})),!e){i.next=47;break}return x=[],y=!1,k=function t(e,n,i,r,a){if(n){n.deepCount=i,n.rootId=r,(0!==n.id||y)&&e.push(n);var o=n.childs;null!=a&&(o=o.map((function(t){return t})),ta(o,"updateTimes",N.Folder,a)),o.forEach((function(n){t(e,n,i+1,r,a)}))}},k(x,m,y?0:-1,m.id,null),i.t0=m,i.t1=function(t){var e=[],n=this.root;return k(e,n,y?0:-1,n.id,t),e},i.abrupt("return",{root:i.t0,_folders:null,get folders(){return x=this._folders,x||(x=this._folders=this.sortBy(null)),x},sortBy:i.t1});case 47:return i.abrupt("return",m);case 48:case"end":return i.stop()}}),r)})))()},goCloudPath:function(t){var e=this;return Object(r["a"])(Object(i["a"])().mark((function n(){var r,a,o,s,c,l,u,d,h,f,m,p,v,b,g,w,x;return Object(i["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.folderId,a=void 0===r?0:r,o=t.artboardId,s=void 0===o?0:o,c=t.artboardGuid,l=void 0===c?"":c,u=t.commentId,d=void 0===u?0:u,h=t.isReply,f=void 0!==h&&h,m=t.newWindow,p=void 0!==m&&m,!(d>0&&e.cloudCurrentFolderId===a&&e.inCloudViewerMode)){n.next=21;break}if(v=e.documentArtboards,b=e.curArtboardId,g=e.$store.state.autoIntoInfo,b!==s){n.next=11;break}return e.$store.commit("setArtboardInComment",!0),g.isReply=f,g.commentArtboardId=s,g.commentId=d,n.abrupt("return");case 11:if(!ut(v)){n.next=21;break}if(w=v.find((function(t){var e;return(null===t||void 0===t||null===(e=t.artboard)||void 0===e?void 0:e.cid)===s})),!w){n.next=21;break}return e.$store.commit("setArtboardInComment",!0),e.setCurArtboard(w),g.commentArtboardId=s,g.commentId=d,g.isReply=f,n.abrupt("return");case 21:x=Ze(a),l&&(x+="".concat(l,"/"),d>0&&(x+="#commentid=".concat(d,"&isreply=").concat(f?"1":"0"))),p?window.open(x):window.location.href=x;case 24:case"end":return n.stop()}}),n)})))()},checkUserState:function(){var t=this;return Object(r["a"])(Object(i["a"])().mark((function e(){var n,r;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.inCloudMode&&t.cloudNeedLogin){e.next=2;break}return e.abrupt("return");case 2:return n=new FormData,n.append("folderid",t.cloudCurrentFolderId),e.next=6,t.fetchPostCloudApi("getmystate",{body:n});case 6:if(r=e.sent,ht(r)){e.next=9;break}throw"返回值异常";case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})))()},cryptoMarklionWeb2:function(t,e){var n=arguments,a=this;return Object(r["a"])(Object(i["a"])().mark((function r(){var s,c;return Object(i["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return s=n.length>2&&void 0!==n[2]?n[2]:0,i.next=3,KT(t,e,s);case 3:if(e=i.sent,e.success){i.next=19;break}i.t0=e.code,i.next=i.t0===o.NotLogin?8:18;break;case 8:return a.showTextTip(e.errMsg),i.next=11,fetch("".concat(me,"/api/logout"),{method:"post",body:""});case 11:return c=i.sent,i.next=14,c.text();case 14:return i.next=16,be(2e3);case 16:return window.location.reload(!0),i.abrupt("break",18);case 18:throw e.errMsg;case 19:return i.abrupt("return",e);case 20:case"end":return i.stop()}}),r)})))()},goCloudLogout:function(){return Object(r["a"])(Object(i["a"])().mark((function t(){var e,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(me,"/api/logout"),{method:"post",body:""});case 3:return e=t.sent,t.next=6,e.text();case 6:t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:return t.prev=10,n="".concat(he,"router/web/weblogout.ashx?redirect=").concat(encodeURIComponent(Ba.href)),ct?location.replace(n):window.location.href=n,t.finish(10);case 14:case"end":return t.stop()}}),t,null,[[0,8,10,14]])})))()},getCurrentInteractionUrl:function(){if(this.inNetDiskFileMode)return null;var t,e=this.cloudCurrentFolderId,n=this.curArtboard,i=this.filterDocumentGuid,r=window.location;t="".concat(r.protocol,"//").concat(r.host,"/interactionviewer/").concat(e,"/"),n&&(t+="".concat(encodeURIComponent(n.artboard.guid),"/"));var a=!1,o=function(e,n){t+="".concat(a?"&":"?").concat(e,"=").concat(encodeURIComponent(n)),a=!0};return i&&o("filterDoc",i),t},goCloudLogin:function(){var t=location.href;t=t.replace(/https?:\/\/[^/]+\//i,"/"),t="".concat(he,"web/?action=cloud.login&cloudkey=").concat(encodeURIComponent(this.cloudKey),"&ver=").concat(encodeURIComponent(this.cloudVersion),"&redirect=").concat(encodeURIComponent(t)),ct?location.replace(t):location.href=t},getCalcPlatformUnit:function(t){var e;switch(this.calcPlatformType){case s.ANDROID:e=t?"sp":"dp";break;case s.IOS:e="pt";break;case s.CUSTOM:e=this.getCalcPlatformCustomUnitText(t);break;default:e="px";break}return e},getCalcPlatformCustomUnitText:function(t){var e,n=this.calcPlatformCustomUnit;switch(n){case c.DP:e=t?"sp":"dp";break;case c.PT:e="pt";break;default:e="px";break}return e},getCalcRectScale:function(){if(!this.inArtboardMode)return 1;switch(this.calcPlatformType){case s.CUSTOM:var t=this.calcPlatformCustomDocWidthShow,e=this.curArtboard.artboard.boundsInArtboard.width;return t/e;default:return 1}},getCalcValue:function(t,e,n){if(!this.inArtboardMode)return 0;var i;switch(ge.inCloudMode&&n&&(t=ue(t,this.calcArtScale,e)),this.calcPlatformType){case s.ANDROID:i=t;break;case s.IOS:i=t;break;case s.CUSTOM:var r=this.calcPlatformCustomDocWidthShow,a=this.curArtboard.artboard.boundsInArtboard.width;i=r/a*t;break;default:i=t;break}return i=Math.round(100*i)/100,this.numberAutoRound&&(i=i>0&&i<1?1:e?Math.ceil(i):Math.round(i)),i},getCalcPlatformValue:function(t,e){if("string"===typeof t)return t;if(null==t)return 0;if(!this.inArtboardMode)return 0;var n,i,r,a;e?(n=e.fontSize,i=e.markedForExport,r=e.noUnitTemplate,a=e.needArtScale):(n=!1,i=!1,r=!1,a=!1);var o=this.getCalcValue(t,i,a);if(r){var s=this.getCalcPlatformUnit(n);return o+s}return this.getCalcUnitTemplateValue(o,n)},getCalcUnitTemplateValue:function(t,e){var n=this.$store.state.unitTemplate;if(n.enable){var i=this.curArtboard.artboard.boundsInArtboard;return n.template.replace(/%[^%]+%/g,(function(e){switch(e){case"%num%":return t.toString();case"%W%":return i.width.toString();case"%H%":return i.height.toString();case"%VW%":return fn(t/i.width*100,2).toString();case"%VH%":return fn(t/i.height*100,2).toString();default:return e}}))}var r=this.getCalcPlatformUnit(e);return t+r},setInOutput:function(t){this.$store.commit("setInOutput",t)},setInMultDownMode:function(t){this.$store.commit("setInMultDownMode",t)},setInArtboardMultDownMode:function(t){this.$store.commit("setInArtboardMultDownMode",t)},setScaleArtboard:function(t){this.$store.commit("setScale",{artboard:t})},setScaleList:function(t){this.$store.commit("setScale",{list:t})},setScaleImageViewer:function(t){var e=this.$store.state.imageViewer;e.scale=Hn(!1,t)},resetImageViewerScale:function(){var t=this.$store.state.imageViewer,e=t.imgList;e&&0!==e.length&&(t.resetScale=Date.now())},setCurArtboard:function(t,e){this.$store.commit("curArtboard",{artboard:t,extral:e}),this.setCurNode(null),this.setEnterNode(null),this.setClickedNode(null)},setCurNode:function(t){this.$store.commit("curNode",t)},setClickedNode:function(t){this.$store.commit("clickedNode",t)},setEnterNode:function(t){this.$store.commit("enterNode",t)},showTextTip:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;"string"!==typeof t&&null!=t&&(t=t.toString()),this.$store.commit("Tip_showTextTip",{second:e,text:t})},hideTextTip:function(){this.$store.commit("Tip_hideTextTip")},fetchPostCloudApi:function(t,e){var n=this;return Object(r["a"])(Object(i["a"])().mark((function r(){var a;return Object(i["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,Wi(t,e);case 2:if(a=i.sent,!ht(a)){i.next=9;break}i.t0=a.code,i.next=i.t0===_.WebUser_NotLogin?7:9;break;case 7:return n.$store.commit("setUserLogout"),i.abrupt("break",9);case 9:return i.abrupt("return",a);case 10:case"end":return i.stop()}}),r)})))()},updateCloudUsersByCloud:function(t){var e=this.cloudKey;if(e){var n=this.$store.state.userNotify.cloudUsersByCloud;this.$set(n,e,t)}},getFolderPrecis:function(t,e){var n=this;return Object(r["a"])(Object(i["a"])().mark((function r(){var a,o;return Object(i["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n.inCloudViewerMode){i.next=2;break}return i.abrupt("return");case 2:if(!xt(n.cloudVersion)){i.next=4;break}throw new Error("私有云版本过低,不支持获取文件夹信息");case 4:return a=new FormData,a.append("folderId",t),null!=e&&a.append("fut",e),i.next=9,n.fetchPostCloudApi("getfolderprecisbyweb",{body:a,timeout:1e4});case 9:if(o=i.sent,ht(o)){i.next=12;break}throw new Error("文件夹摘要返回值异常:".concat(o));case 12:if(o.success){i.next=14;break}throw new Error(o.errMsg);case 14:return o=o.data,n.$store.commit("setFolderPrecis",o),i.abrupt("return",o);case 17:case"end":return i.stop()}}),r)})))()},getCloudNotifies:function(t,e,n,a){var o=this;return Object(r["a"])(Object(i["a"])().mark((function r(){var s,c,l,u,d,h,f,m,p,v,b,g,w,x,y,k,C,S,T,A,I,F,M,O;return Object(i["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return s=new FormData,s.append("minNotifyId",t),s.append("artboardId",e),null!=n&&s.append("folderId",n),null!=a&&s.append("fut",a),i.next=7,o.fetchPostCloudApi("getnotifiesbyweb",{body:s,timeout:t>0?1e4:3e4});case 7:if(c=i.sent,ht(c)){i.next=10;break}throw new Error("消息列表返回值异常:".concat(c));case 10:if(c.success){i.next=12;break}throw new Error(c.errMsg);case 12:if(c=c.data,l=c,u=l.list,d=l.folders,h=l.users,f=l.cloudUserListNeedUpdate,m=l.cloudUserListState,p=l.cloudUserListTimes,v=l.folderUpdateTime,a>0&&v>0&&v!==a&&o.getFolderPrecis(n,a).catch((function(t){})),b=[],ut(u)){i.next=18;break}return i.abrupt("return",b);case 18:if(ht(d)||(d={}),ht(h)||(h={}),u.forEach((function(t){if(t){t.date=new Date(t.date);try{t.dateStr=kt(t.date)}catch(r){t.dateStr=t.date}switch(t.type){case L.Artboard_Comment:case L.Artboard_Reply:case L.Artboard_Comment_At:case L.Artboard_Reply_At:var e=t.msg;if(!e)return;if(e.commentUser=h[e.commentUserId],!e.commentUser)return;e.folder=d[e.folderId];var n=e.commentSummary,i=e.atUserIds;ut(i)&&i.length>0&&dt(n)&&(e.commentSummary=n.replace(/\[@uid:(\d+);\]/g,(function(t,e){var n=h[e];return n?"@"+n.nickName:t})));break}b.push(t)}})),g=o.$store.state.userNotify,w=g.cloudList,x=g.sysTipIds,y=g.commentUpdateStates,k=o.cloudKey,C=w[k],S=x[k]||0,null!=m&&o.updateCloudUsersByCloud({needUpdate:f,userListState:m,times:p}),c.artboardId>0&&o.$set(y,k,{artboardId:c.artboardId,commentUpdateTime:c.commentUpdateTime}),0!==t&&C){for(C.updateTime=Date.now(),F=null!==(A=null===(I=C.list[0])||void 0===I?void 0:I.id)&&void 0!==A?A:0,M=b.length-1;M>=0;M--)O=b[M],O.id>F&&(C.list.unshift(O),S=Math.max(O.id,S));S&&(x[k]=S)}else x[k]=Math.max((null===(T=b[0])||void 0===T?void 0:T.id)||0,S),o.$set(w,k,{updateTime:Date.now(),list:b});return i.abrupt("return",b);case 29:case"end":return i.stop()}}),r)})))()},checkLoginThrow:function(){if(!this.cloudIsLogin){var t="未登录,请先登录";throw t}return!0}}};n("4809");a["a"].config.productionTip=!1,a["a"].mixin(qT);var QT=window.__marklionData;QT&&(window.__marklionData=null);var JT=null!==(PT=null===QT||void 0===QT||null===(ET=QT.cloudData)||void 0===ET?void 0:ET.renderMode)&&void 0!==PT?PT:U.Normal,ZT=-1!==navigator.userAgent.indexOf("MSIE");if(ZT)document.body.innerHTML="很抱歉,不支持在IE浏览器中浏览标注信息,请使用Chrome,Firefox,Edge等浏览器浏览";else{co(),ya.dataInit(QT,lo.state.cloudListSort),uo();var tA=function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ya.allArtboardLoadChecked((function(t){lo.commit("artboardLoadProgress",t)}));case 2:lo.commit("setDocument",ya);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),eA=function(){var t=lo.state,e=t.cloud.defaultArtboardGuid,n=ln("filterDoc");if("none"===n)n=null;else if(n){var i=t.sortDocumentsWithSketchDocument.find((function(t){return t.guid===n}));if(i){var r=ya.documentArtboards.find((function(t){var n=t.artboard;return n.guid===e&&n.docGuid===i.guid||n.pageGuid===i.guid}));e&&!r&&(n=null)}else n=null}n?lo.commit("setFilterDocumentGuid",n):lo.commit("setFilterDocumentGuid",null)};switch(JT){case U.Interaction:LT(tA,eA);break;default:Tk(tA,eA);break}}},5705:function(t,e,n){"use strict";n("cfbf")},"57d4":function(t,e,n){},5853:function(t,e,n){"use strict";n("511c")},"597f":function(t,e,n){"use strict";n("d01d")},"59bb":function(t,e,n){},"59c8":function(t,e,n){"use strict";n("0040")},"5b47":function(t,e,n){"use strict";n("f8f3")},"5c3c":function(t,e,n){"use strict";n("062b")},"5ccb":function(t,e,n){"use strict";n("ffc4")},"5db6":function(t,e,n){},"5ebc":function(t,e,n){},"5ebd":function(t,e,n){},6011:function(t,e,n){},6094:function(t,e,n){"use strict";n("43ef")},6168:function(t,e,n){"use strict";n("c45e")},"62bb":function(t,e,n){},6337:function(t,e,n){},"64be":function(t,e,n){"use strict";n("aa69")},6635:function(t,e,n){},6690:function(t,e,n){},"66af":function(t,e,n){},6753:function(t,e,n){"use strict";n("dfa5")},"6a67":function(t,e,n){},"6a75":function(t,e,n){"use strict";n("fe10")},"6aca":function(t,e,n){},"6bc0":function(t,e,n){},"6bd8":function(t,e,n){"use strict";n("e0e6")},"6df1":function(t,e,n){"use strict";n("0950")},"6ef0":function(t,e,n){},"6efe":function(t,e,n){"use strict";n("7a25")},"6fec":function(t,e,n){},7080:function(t,e,n){},"71f6":function(t,e,n){"use strict";n("4d7c")},7353:function(t,e,n){},7544:function(t,e,n){},"76c3":function(t,e,n){},7787:function(t,e,n){},"780a":function(t,e,n){},"794b":function(t,e,n){},7970:function(t,e,n){"use strict";n("cb56")},"7a25":function(t,e,n){},"7bcc":function(t,e,n){"use strict";n("f111")},"7cdb":function(t,e,n){"use strict";n("7dd7")},"7d1a":function(t,e,n){},"7dd7":function(t,e,n){},"7eae":function(t,e,n){"use strict";n("0d20")},"7eea":function(t,e,n){"use strict";n("178d")},"813d":function(t,e,n){"use strict";n("fce2")},"858c":function(t,e,n){},"85d9":function(t,e,n){},8747:function(t,e,n){"use strict";n("2289")},"877e":function(t,e,n){},8785:function(t,e,n){},"8a88":function(t,e,n){"use strict";n("fa08")},"8ae6":function(t,e,n){},"8c01":function(t,e,n){},"8d75":function(t,e,n){},"8e46":function(t,e,n){},"8f57":function(t,e,n){},9072:function(t,e,n){},"90ee":function(t,e,n){"use strict";n("db86")},"938c":function(t,e,n){"use strict";n("7d1a")},"99c8":function(t,e,n){"use strict";n("1202")},"9b1e":function(t,e,n){"use strict";n("c63d")},"9e45":function(t,e,n){"use strict";n("c9b3")},"9e96":function(t,e,n){"use strict";n("6fec")},"9ed9":function(t,e,n){},"9eda":function(t,e,n){"use strict";n("d07a")},"9edf":function(t,e,n){"use strict";n("8e46")},a0f7:function(t,e,n){"use strict";n("d80c1")},a1ca:function(t,e,n){"use strict";n("0e1c")},a266:function(t,e,n){},a6d6:function(t,e,n){"use strict";n("aa93")},a76f:function(t,e,n){},aa69:function(t,e,n){},aa93:function(t,e,n){},ab61:function(t,e,n){},b13d:function(t,e,n){"use strict";n("00b8")},b146:function(t,e,n){"use strict";n("0b7a")},b2f4:function(t,e,n){"use strict";n("8f57")},b322:function(t,e,n){"use strict";n("23ce")},b330:function(t,e,n){"use strict";n("f822")},b3ac:function(t,e,n){"use strict";n("6bc0")},b403:function(t,e,n){"use strict";n("ca7f")},b5cc:function(t,e,n){"use strict";n("6aca")},b63c:function(t,e,n){},b63d:function(t,e,n){},b63f:function(t,e,n){},b757:function(t,e,n){},b8be:function(t,e,n){"use strict";n("8c01")},b9ce:function(t,e,n){},ba26:function(t,e,n){},bb5a:function(t,e,n){"use strict";n("16d5")},bcea:function(t,e,n){},bd5b:function(t,e,n){},be70:function(t,e,n){"use strict";n("1bd6")},be79:function(t,e,n){"use strict";n("e24a")},c018:function(t,e,n){},c02b:function(t,e,n){"use strict";n("ea6d")},c050:function(t,e,n){"use strict";n("4ea5")},c0eb:function(t,e,n){"use strict";n("ab61")},c192:function(t,e,n){"use strict";n("e5d6")},c204:function(t,e,n){},c332:function(t,e,n){"use strict";n("3087")},c45e:function(t,e,n){},c5ca:function(t,e,n){"use strict";n("b63d")},c63d:function(t,e,n){},c761:function(t,e,n){"use strict";n("7787")},c817:function(t,e,n){"use strict";n("01eb")},c956:function(t,e,n){"use strict";n("f281")},c9b3:function(t,e,n){},ca7f:function(t,e,n){},ca84:function(t,e,n){},caa5:function(t,e,n){},cb56:function(t,e,n){},ccd9:function(t,e,n){"use strict";n("6690")},cdac:function(t,e,n){"use strict";n("0263")},cdc8:function(t,e,n){},ce75:function(t,e,n){},ceea:function(t,e,n){"use strict";n("a266")},cf16:function(t,e,n){},cfbf:function(t,e,n){},d01d:function(t,e,n){},d07a:function(t,e,n){},d0a3:function(t,e,n){},d28d:function(t,e,n){"use strict";n("4b97")},d294:function(t,e,n){},d2eb:function(t,e,n){"use strict";n("794b")},d3ec:function(t,e,n){},d42b:function(t,e,n){"use strict";n("d6af")},d6af:function(t,e,n){},d6df:function(t,e,n){"use strict";n("cdc8")},d80c1:function(t,e,n){},d87d:function(t,e,n){"use strict";n("f09c")},da24:function(t,e,n){"use strict";n("4cce")},db86:function(t,e,n){},dba0:function(t,e,n){},dc1f:function(t,e,n){"use strict";n("1d4d")},dd65:function(t,e,n){"use strict";n("dba0")},df29:function(t,e,n){"use strict";n("ba26")},dfa5:function(t,e,n){},dffd:function(t,e,n){"use strict";n("5ebc")},e0e6:function(t,e,n){},e24a:function(t,e,n){},e270:function(t,e,n){"use strict";n("d0a3")},e2d4:function(t,e,n){"use strict";n("7353")},e361:function(t,e,n){"use strict";n("14ee")},e4aa:function(t,e,n){},e5d6:function(t,e,n){},e5e8:function(t,e,n){"use strict";n("66af")},e934:function(t,e,n){"use strict";n("877e")},ea6d:function(t,e,n){},eb07:function(t,e,n){},ec5d:function(t,e,n){"use strict";n("bcea")},ed29:function(t,e,n){"use strict";n("b9ce")},eee2:function(t,e,n){"use strict";n("6ef0")},ef2d:function(t,e,n){"use strict";n("5521")},f080:function(t,e,n){"use strict";n("d294")},f09c:function(t,e,n){},f111:function(t,e,n){},f245:function(t,e,n){"use strict";n("4853")},f281:function(t,e,n){},f3a3:function(t,e,n){},f437:function(t,e,n){"use strict";n("9072")},f452:function(t,e,n){},f4c0:function(t,e,n){},f7cf:function(t,e,n){"use strict";n("a76f")},f81c:function(t,e,n){},f822:function(t,e,n){},f877:function(t,e,n){"use strict";n("5db6")},f8f3:function(t,e,n){},f92b:function(t,e,n){},f9bd:function(t,e,n){},fa08:function(t,e,n){},fa2f:function(t,e,n){"use strict";n("59bb")},fce2:function(t,e,n){},fe10:function(t,e,n){},fe87:function(t,e,n){},fec7:function(t,e,n){"use strict";n("c204")},ffc4:function(t,e,n){},ffca:function(t,e,n){"use strict";n("858c")}});